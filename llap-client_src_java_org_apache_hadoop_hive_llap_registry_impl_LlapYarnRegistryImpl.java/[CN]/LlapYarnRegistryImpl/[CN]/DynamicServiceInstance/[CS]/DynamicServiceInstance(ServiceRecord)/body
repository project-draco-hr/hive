{
  this.srv=srv;
  final Endpoint shuffle=srv.getInternalEndpoint("shuffle");
  final Endpoint rpc=srv.getInternalEndpoint("llap");
  this.host=RegistryTypeUtils.getAddressField(rpc.addresses.get(0),AddressTypes.ADDRESS_HOSTNAME_FIELD);
  this.rpcPort=Integer.valueOf(RegistryTypeUtils.getAddressField(rpc.addresses.get(0),AddressTypes.ADDRESS_PORT_FIELD));
  this.shufflePort=Integer.valueOf(RegistryTypeUtils.getAddressField(shuffle.addresses.get(0),AddressTypes.ADDRESS_PORT_FIELD));
}
