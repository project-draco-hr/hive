{
  String path=getPath();
  ServiceRecord srv=new ServiceRecord();
  srv.addInternalEndpoint(getRpcEndpoint());
  srv.addInternalEndpoint(getMngEndpoint());
  srv.addInternalEndpoint(getShuffleEndpoint());
  srv.addExternalEndpoint(getServicesEndpoint());
  for (  Map.Entry<String,String> kv : this.conf) {
    if (kv.getKey().startsWith(HiveConf.PREFIX_LLAP) || kv.getKey().startsWith(HiveConf.PREFIX_HIVE_LLAP)) {
      srv.set(kv.getKey(),kv.getValue());
    }
  }
  srv.set(UNIQUE_IDENTIFIER,uniq.toString());
  client.mknode(RegistryPathUtils.parentOf(path),true);
  client.zkCreate(path,CreateMode.EPHEMERAL_SEQUENTIAL,encoder.toBytes(srv),client.getClientAcls());
}
