{
  File f=new File("binary.dat");
  f.delete();
  f.createNewFile();
  f.deleteOnExit();
  OutputStream fileOutStream=new FileOutputStream(f);
  DataOutput outStream=new DataOutputStream(fileOutStream);
  HCatRecord[] recs=getHCatRecords();
  for (int i=0; i < recs.length; i++) {
    recs[i].write(outStream);
  }
  fileOutStream.flush();
  fileOutStream.close();
  InputStream fInStream=new FileInputStream(f);
  DataInput inpStream=new DataInputStream(fInStream);
  for (int i=0; i < recs.length; i++) {
    HCatRecord rec=new DefaultHCatRecord();
    rec.readFields(inpStream);
    Assert.assertEquals(recs[i],rec);
  }
  Assert.assertEquals(fInStream.available(),0);
  fInStream.close();
}
