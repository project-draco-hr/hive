{
  if (factoryInstance == null) {
    if (factoryClassName == null) {
      factoryClassName=client.getConfVal(HiveConf.ConfVars.HIVE_REPL_TASK_FACTORY.varname,"");
    }
    if ((factoryClassName != null) && (!factoryClassName.isEmpty())) {
      try {
        Class<? extends Factory> factoryClass=(Class<? extends Factory>)Class.forName(factoryClassName);
        factoryInstance=factoryClass.newInstance();
      }
 catch (      Exception e) {
        factoryClassName=null;
        throw new RuntimeException("Error instantiating ReplicationTask.Factory " + HiveConf.ConfVars.HIVE_REPL_TASK_FACTORY.varname + "="+ factoryClassName);
      }
    }
 else {
      factoryInstance=new NoopFactory();
    }
  }
}
