{
  if (factoryInstance == null) {
    if (factoryClassName == null) {
      factoryClassName=client.getConfVal(HiveConf.ConfVars.HIVE_REPL_TASK_FACTORY.varname,"");
    }
    try {
      Class<? extends Factory> factoryClass=(Class<? extends Factory>)Class.forName(factoryClassName);
      factoryInstance=factoryClass.newInstance();
    }
 catch (    Exception e) {
      factoryInstance=new Factory(){
        @Override public ReplicationTask create(        HCatClient client,        HCatNotificationEvent event){
          throw new IllegalStateException("Error instantiating ReplicationTask.Factory " + HiveConf.ConfVars.HIVE_REPL_TASK_FACTORY.varname + "="+ factoryClassName+ ". Call resetFactory() if you need to reset to a valid one.");
        }
      }
;
    }
  }
}
