{
  if (indexes == null || indexes.size() == 0) {
    return false;
  }
  for (  Index index : indexes) {
    LOG.info("checking index staleness...");
    try {
      FileSystem srcFs=src.getPath().getFileSystem(hive.getConf());
      FileStatus srcFss=srcFs.getFileStatus(src.getPath());
      String ts=index.getParameters().get("base_timestamp");
      if (ts == null) {
        return false;
      }
      long indexTs=Long.parseLong(ts);
      LOG.info(srcFss.getModificationTime());
      LOG.info(ts);
      if (srcFss.getModificationTime() > indexTs) {
        LOG.info("index is stale ");
        return false;
      }
    }
 catch (    IOException e) {
      LOG.info("failed to grab timestamp info");
      throw new HiveException(e);
    }
  }
  return true;
}
