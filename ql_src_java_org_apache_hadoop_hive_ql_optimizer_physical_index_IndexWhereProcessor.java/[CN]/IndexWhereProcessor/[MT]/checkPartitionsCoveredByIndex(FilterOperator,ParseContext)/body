{
  TableScanOperator tableScan=(TableScanOperator)operator.getParentOperators().get(0);
  Hive hive=Hive.get(pctx.getConf());
  PrunedPartitionList queryPartitionList=pctx.getOpToPartList().get(tableScan);
  Set<Partition> queryPartitions=queryPartitionList.getConfirmedPartns();
  for (  Partition part : queryPartitions) {
    List<Table> sourceIndexTables=getIndexTables(hive,part);
    if (!containsPartition(hive,sourceIndexTables,part)) {
      return null;
    }
  }
  return queryPartitions;
}
