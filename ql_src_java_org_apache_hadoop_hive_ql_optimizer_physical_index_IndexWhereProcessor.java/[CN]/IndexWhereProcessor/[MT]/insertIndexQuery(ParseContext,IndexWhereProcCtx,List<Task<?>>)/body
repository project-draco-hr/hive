{
  Task<?> wholeTableScan=context.getCurrentTask();
  LinkedHashSet<Task<?>> rewriteLeaves=new LinkedHashSet<Task<?>>();
  findLeaves(chosenRewrite,rewriteLeaves);
  for (  Task<?> leaf : rewriteLeaves) {
    leaf.addDependentTask(wholeTableScan);
  }
  pctx.replaceRootTask(wholeTableScan,chosenRewrite);
}
