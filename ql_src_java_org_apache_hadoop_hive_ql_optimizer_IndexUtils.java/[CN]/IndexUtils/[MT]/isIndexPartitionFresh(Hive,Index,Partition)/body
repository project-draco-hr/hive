{
  LOG.info("checking index staleness...");
  try {
    FileSystem partFs=part.getDataLocation().getFileSystem(hive.getConf());
    FileStatus partFss=partFs.getFileStatus(part.getDataLocation());
    String ts=index.getParameters().get(part.getSpec().toString());
    if (ts == null) {
      return false;
    }
    long indexTs=Long.parseLong(ts);
    LOG.info(partFss.getModificationTime());
    LOG.info(ts);
    if (partFss.getModificationTime() > indexTs) {
      LOG.info("index is stale on the partitions that matched " + part.getSpec());
      return false;
    }
  }
 catch (  IOException e) {
    LOG.info("failed to grab timestamp info");
    throw new HiveException(e);
  }
  return true;
}
