{
  LOG.info("checking index staleness...");
  try {
    String indexTs=index.getParameters().get(part.getSpec().toString());
    if (indexTs == null) {
      return false;
    }
    FileSystem partFs=part.getDataLocation().getFileSystem(hive.getConf());
    FileStatus[] parts=partFs.listStatus(part.getDataLocation(),FileUtils.HIDDEN_FILES_PATH_FILTER);
    for (    FileStatus status : parts) {
      if (status.getModificationTime() > Long.parseLong(indexTs)) {
        LOG.info("Index is stale on partition '" + part.getName() + "'. Modified time ("+ status.getModificationTime()+ ") for '"+ status.getPath()+ "' is higher than index creation time ("+ indexTs+ ").");
        return false;
      }
    }
  }
 catch (  IOException e) {
    throw new HiveException("Failed to grab timestamp information from partition '" + part.getName() + "': "+ e.getMessage(),e);
  }
  return true;
}
