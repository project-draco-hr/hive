{
  if (indexes == null || indexes.size() == 0) {
    return false;
  }
  for (  Index index : indexes) {
    LOG.info("checking index staleness...");
    try {
      String indexTs=index.getParameters().get("base_timestamp");
      if (indexTs == null) {
        return false;
      }
      FileSystem srcFs=src.getPath().getFileSystem(hive.getConf());
      FileStatus[] srcs=srcFs.listStatus(src.getPath(),FileUtils.HIDDEN_FILES_PATH_FILTER);
      for (      FileStatus status : srcs) {
        if (status.getModificationTime() > Long.parseLong(indexTs)) {
          LOG.info("Index is stale on table '" + src.getTableName() + "'. Modified time ("+ status.getModificationTime()+ ") for '"+ status.getPath()+ "' is higher than index creation time ("+ indexTs+ ").");
          return false;
        }
      }
    }
 catch (    IOException e) {
      throw new HiveException("Failed to grab timestamp information from table '" + src.getTableName() + "': "+ e.getMessage(),e);
    }
  }
  return true;
}
