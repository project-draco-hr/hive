{
  HiveConf.setBoolVar(builderConf,HiveConf.ConfVars.HIVEOPTINDEXFILTER,false);
  Driver driver=new Driver(builderConf,SessionState.get().getUserName());
  driver.compile(command.toString(),false);
  Task<?> rootTask=driver.getPlan().getRootTasks().get(0);
  inputs.addAll(driver.getPlan().getInputs());
  outputs.addAll(driver.getPlan().getOutputs());
  IndexMetadataChangeWork indexMetaChange=new IndexMetadataChangeWork(partSpec,indexTableName,dbName);
  IndexMetadataChangeTask indexMetaChangeTsk=(IndexMetadataChangeTask)TaskFactory.get(indexMetaChange,builderConf);
  indexMetaChangeTsk.setWork(indexMetaChange);
  rootTask.addDependentTask(indexMetaChangeTsk);
  driver.destroy();
  return rootTask;
}
