{
  Hive hive=Hive.get(pctx.getConf());
  Set<Partition> queryPartitions=null;
  PrunedPartitionList queryPartitionList=pctx.getOpToPartList().get(tableScan);
  if (queryPartitionList.getConfirmedPartns() != null && !queryPartitionList.getConfirmedPartns().isEmpty()) {
    queryPartitions=queryPartitionList.getConfirmedPartns();
  }
 else   if (queryPartitionList.getUnknownPartns() != null && !queryPartitionList.getUnknownPartns().isEmpty()) {
    queryPartitions=queryPartitionList.getUnknownPartns();
  }
  for (  Partition part : queryPartitions) {
    List<Table> sourceIndexTables=getIndexTables(hive,part,indexes);
    if (!containsPartition(hive,part,indexes)) {
      return null;
    }
  }
  return queryPartitions;
}
