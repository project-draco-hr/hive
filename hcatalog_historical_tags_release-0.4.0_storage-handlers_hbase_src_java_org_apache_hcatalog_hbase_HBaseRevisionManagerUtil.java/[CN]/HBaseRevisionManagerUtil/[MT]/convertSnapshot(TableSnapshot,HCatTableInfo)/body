{
  HCatSchema hcatTableSchema=hcatTableInfo.getDataColumns();
  Map<String,String> hcatHbaseColMap=getHCatHBaseColumnMapping(hcatTableInfo);
  HashMap<String,Long> revisionMap=new HashMap<String,Long>();
  for (  HCatFieldSchema fSchema : hcatTableSchema.getFields()) {
    if (hcatHbaseColMap.containsKey(fSchema.getName())) {
      String colFamily=hcatHbaseColMap.get(fSchema.getName());
      long revisionID=hbaseSnapshot.getRevision(colFamily);
      revisionMap.put(fSchema.getName(),revisionID);
    }
  }
  HCatTableSnapshot hcatSnapshot=new HCatTableSnapshot(hcatTableInfo.getDatabaseName(),hcatTableInfo.getTableName(),revisionMap,hbaseSnapshot.getLatestRevision());
  return hcatSnapshot;
}
