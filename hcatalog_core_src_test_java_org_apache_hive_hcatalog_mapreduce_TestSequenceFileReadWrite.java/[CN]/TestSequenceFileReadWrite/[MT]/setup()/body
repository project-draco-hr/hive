{
  dataDir=new File(System.getProperty("java.io.tmpdir") + File.separator + TestSequenceFileReadWrite.class.getCanonicalName()+ "-"+ System.currentTimeMillis());
  hiveConf=new HiveConf(this.getClass());
  warehouseDir=new File(dataDir,"warehouse").getAbsolutePath();
  inputFileName=new File(dataDir,"input.data").getAbsolutePath();
  hiveConf=new HiveConf(this.getClass());
  hiveConf.set(HiveConf.ConfVars.PREEXECHOOKS.varname,"");
  hiveConf.set(HiveConf.ConfVars.POSTEXECHOOKS.varname,"");
  hiveConf.set(HiveConf.ConfVars.HIVE_SUPPORT_CONCURRENCY.varname,"false");
  hiveConf.set(HiveConf.ConfVars.METASTOREWAREHOUSE.varname,warehouseDir);
  driver=new Driver(hiveConf);
  SessionState.start(new CliSessionState(hiveConf));
  if (!(new File(warehouseDir).mkdirs())) {
    throw new RuntimeException("Could not create " + warehouseDir);
  }
  int numRows=3;
  input=new String[numRows];
  for (int i=0; i < numRows; i++) {
    String col1="a" + i;
    String col2="b" + i;
    input[i]=i + "," + col1+ ","+ col2;
  }
  HcatTestUtils.createTestDataFile(inputFileName,input);
  server=new PigServer(ExecType.LOCAL);
}
