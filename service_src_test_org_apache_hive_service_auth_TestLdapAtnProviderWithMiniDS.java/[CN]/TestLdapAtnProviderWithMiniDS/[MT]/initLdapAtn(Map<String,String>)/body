{
  hiveConf=new HiveConf();
  int port;
  if (ldapUrl == null) {
    port=ldapServer.getPort();
    ldapUrl=new String("ldap://localhost:" + port);
  }
  hiveConf.set("hive.root.logger","DEBUG,console");
  hiveConf.set("hive.server2.authentication.ldap.url",ldapUrl);
  if (hiveProperties != null) {
    String key;
    String value;
    Iterator<String> iter=hiveProperties.keySet().iterator();
    while (iter.hasNext()) {
      key=iter.next();
      value=hiveProperties.get(key);
      hiveConf.set(key,value);
    }
  }
  ldapProvider=new LdapAuthenticationProviderImpl(hiveConf);
}
