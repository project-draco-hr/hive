{
  try {
    LOG.info("Looking for jobs to kill...");
    Set<ApplicationId> childJobs=getYarnChildJobs(tag,timestamp);
    if (childJobs.isEmpty()) {
      LOG.info("No jobs found from");
      return;
    }
 else {
      LOG.info(String.format("Found MR jobs count: %d",childJobs.size()));
      LOG.info("Killing all found jobs");
      YarnClient yarnClient=YarnClient.createYarnClient();
      yarnClient.init(conf);
      yarnClient.start();
      for (      ApplicationId app : childJobs) {
        LOG.info(String.format("Killing job: %s ...",app));
        yarnClient.killApplication(app);
        LOG.info(String.format("Job %s killed",app));
      }
    }
  }
 catch (  YarnException ye) {
    throw new RuntimeException("Exception occurred while killing child job(s)",ye);
  }
catch (  IOException ioe) {
    throw new RuntimeException("Exception occurred while killing child job(s)",ioe);
  }
}
