{
  initUserRoles();
  if (NONE.equalsIgnoreCase(roleName)) {
    currentRoles.clear();
    return;
  }
  if (ALL.equalsIgnoreCase(roleName)) {
    currentRoles.clear();
    currentRoles.addAll(getRolesFromMS());
    return;
  }
  for (  HiveRoleGrant role : getRolesFromMS()) {
    if (role.getRoleName().equalsIgnoreCase(roleName)) {
      currentRoles.clear();
      currentRoles.add(role);
      return;
    }
  }
  if (HiveMetaStore.ADMIN.equalsIgnoreCase(roleName) && null != this.adminRole) {
    currentRoles.clear();
    currentRoles.add(adminRole);
    return;
  }
  LOG.info("Current user : " + currentUserName + ", Current Roles : "+ currentRoles);
  throw new HiveAccessControlException(currentUserName + " doesn't belong to role " + roleName);
}
