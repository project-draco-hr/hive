{
  List<Role> roles;
  try {
    roles=metastoreClientFactory.getHiveMetastoreClient().list_roles(currentUserName,PrincipalType.USER);
    List<HiveRole> currentRoles=new ArrayList<HiveRole>(roles.size());
    for (    Role role : roles) {
      if (!HiveMetaStore.ADMIN.equalsIgnoreCase(role.getRoleName())) {
        currentRoles.add(new HiveRole(role));
      }
 else {
        this.adminRole=new HiveRole(role);
      }
    }
    return currentRoles;
  }
 catch (  Exception e) {
    throw new HiveAuthzPluginException("Failed to retrieve roles for " + currentUserName,e);
  }
}
