{
  hivePrivileges=expandAndValidatePrivileges(hivePrivileges);
  IMetaStoreClient metastoreClient=metastoreClientFactory.getHiveMetastoreClient();
  GrantPrivAuthUtils.authorize(hivePrincipals,hivePrivileges,hivePrivObject,grantOption,metastoreClient,authenticator.getUserName(),getCurrentRoleNames(),isUserAdmin());
  PrivilegeBag privBag=SQLAuthorizationUtils.getThriftPrivilegesBag(hivePrincipals,hivePrivileges,hivePrivObject,grantorPrincipal,grantOption);
  try {
    metastoreClient.grant_privileges(privBag);
  }
 catch (  Exception e) {
    throw SQLAuthorizationUtils.getPluginException("Error granting privileges",e);
  }
}
