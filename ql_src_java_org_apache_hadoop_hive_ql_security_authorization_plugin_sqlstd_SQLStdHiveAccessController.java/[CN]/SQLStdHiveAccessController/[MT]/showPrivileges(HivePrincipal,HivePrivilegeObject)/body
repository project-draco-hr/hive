{
  try {
    List<HivePrivilegeInfo> resPrivInfos=new ArrayList<HivePrivilegeInfo>();
    IMetaStoreClient mClient=metastoreClientFactory.getHiveMetastoreClient();
    List<HiveObjectPrivilege> msObjPrivs=mClient.list_privileges(principal.getName(),AuthorizationUtils.getThriftPrincipalType(principal.getType()),getThriftHiveObjectRef(privObj));
    for (    HiveObjectPrivilege msObjPriv : msObjPrivs) {
      HivePrincipal resPrincipal=new HivePrincipal(msObjPriv.getPrincipalName(),AuthorizationUtils.getHivePrincipalType(msObjPriv.getPrincipalType()));
      PrivilegeGrantInfo msGrantInfo=msObjPriv.getGrantInfo();
      HivePrivilege resPrivilege=new HivePrivilege(msGrantInfo.getPrivilege(),null);
      HiveObjectRef msObjRef=msObjPriv.getHiveObject();
      HivePrivilegeObject resPrivObj=new HivePrivilegeObject(getPluginObjType(msObjRef.getObjectType()),msObjRef.getDbName(),msObjRef.getObjectName());
      HivePrincipal grantorPrincipal=new HivePrincipal(msGrantInfo.getGrantor(),AuthorizationUtils.getHivePrincipalType(msGrantInfo.getGrantorType()));
      HivePrivilegeInfo resPrivInfo=new HivePrivilegeInfo(resPrincipal,resPrivilege,resPrivObj,grantorPrincipal,msGrantInfo.isGrantOption());
      resPrivInfos.add(resPrivInfo);
    }
    return resPrivInfos;
  }
 catch (  Exception e) {
    throw new HiveAuthorizationPluginException("Error showing privileges",e);
  }
}
