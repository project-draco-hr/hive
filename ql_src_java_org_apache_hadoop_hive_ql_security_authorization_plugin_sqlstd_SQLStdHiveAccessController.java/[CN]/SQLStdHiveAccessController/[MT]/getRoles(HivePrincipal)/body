{
  try {
    List<Role> roles=metastoreClientFactory.getHiveMetastoreClient().list_roles(hivePrincipal.getName(),AuthorizationUtils.getThriftPrincipalType(hivePrincipal.getType()));
    List<HiveRole> roleNames=new ArrayList<HiveRole>(roles.size());
    for (    Role role : roles) {
      ;
      roleNames.add(new HiveRole(role));
    }
    return roleNames;
  }
 catch (  Exception e) {
    throw new HiveAuthorizationPluginException("Error listing roles for user" + hivePrincipal.getName(),e);
  }
}
