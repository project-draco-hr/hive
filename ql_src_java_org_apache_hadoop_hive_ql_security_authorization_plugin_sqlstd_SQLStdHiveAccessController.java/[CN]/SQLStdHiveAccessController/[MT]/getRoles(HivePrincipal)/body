{
  try {
    List<Role> roles=metastoreClientFactory.getHiveMetastoreClient().list_roles(hivePrincipal.getName(),AuthorizationUtils.getThriftPrincipalType(hivePrincipal.getType()));
    List<HiveRole> hiveRoles=new ArrayList<HiveRole>(roles.size());
    for (    Role role : roles) {
      hiveRoles.add(new HiveRole(role));
    }
    return hiveRoles;
  }
 catch (  Exception e) {
    throw new HiveAuthzPluginException("Error listing roles for user " + hivePrincipal.getName() + ": "+ e.getMessage(),e);
  }
}
