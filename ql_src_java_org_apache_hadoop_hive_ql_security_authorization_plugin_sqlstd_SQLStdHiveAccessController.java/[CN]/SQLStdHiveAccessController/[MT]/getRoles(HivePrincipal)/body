{
  try {
    List<Role> roles=metastoreClientFactory.getHiveMetastoreClient().list_roles(hivePrincipal.getName(),AuthorizationUtils.getThriftPrincipalType(hivePrincipal.getType()));
    List<String> roleNames=new ArrayList<String>(roles.size());
    for (    Role role : roles) {
      roleNames.add(role.getRoleName());
    }
    return roleNames;
  }
 catch (  Exception e) {
    throw new HiveAuthorizationPluginException("Error listing roles for user" + hivePrincipal.getName(),e);
  }
}
