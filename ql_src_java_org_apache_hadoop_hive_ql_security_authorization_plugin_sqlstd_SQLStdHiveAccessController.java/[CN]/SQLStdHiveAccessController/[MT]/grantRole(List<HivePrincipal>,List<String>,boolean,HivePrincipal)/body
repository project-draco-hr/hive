{
  for (  HivePrincipal hivePrincipal : hivePrincipals) {
    for (    String roleName : roleNames) {
      try {
        metastoreClientFactory.getHiveMetastoreClient().grant_role(roleName,hivePrincipal.getName(),AuthorizationUtils.getThriftPrincipalType(hivePrincipal.getType()),grantorPrinc.getName(),AuthorizationUtils.getThriftPrincipalType(grantorPrinc.getType()),grantOption);
      }
 catch (      MetaException e) {
        throw new HiveAuthorizationPluginException(e.getMessage(),e);
      }
catch (      Exception e) {
        String msg="Error granting roles for " + hivePrincipal.getName() + " to role "+ roleName+ ": "+ e.getMessage();
        throw new HiveAuthorizationPluginException(msg,e);
      }
    }
  }
}
