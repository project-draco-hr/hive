{
  List<HiveRoleGrant> currentRoles;
  try {
    currentRoles=getCurrentRoles();
  }
 catch (  Exception e) {
    throw new HiveAuthzPluginException(e);
  }
  for (  String roleName : roleNames) {
    boolean roleFound=false;
    for (    HiveRoleGrant currentRole : currentRoles) {
      if (roleName.equalsIgnoreCase(currentRole.getRoleName())) {
        roleFound=true;
        if (!currentRole.isGrantOption()) {
          return false;
        }
 else {
          break;
        }
      }
    }
    if (!roleFound) {
      return false;
    }
  }
  return true;
}
