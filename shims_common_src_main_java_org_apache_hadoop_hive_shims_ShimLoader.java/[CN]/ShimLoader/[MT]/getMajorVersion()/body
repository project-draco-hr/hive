{
  String vers=VersionInfo.getVersion();
  String[] parts=vers.split("\\.");
  if (parts.length < 2) {
    throw new RuntimeException("Illegal Hadoop Version: " + vers + " (expected A.B.* format)");
  }
switch (Integer.parseInt(parts[0])) {
case 0:
    break;
case 1:
  return "0.20S";
case 2:
return "0.23";
default :
throw new IllegalArgumentException("Unrecognized Hadoop major version number: " + vers);
}
String majorVersion=parts[0] + "." + parts[1];
try {
Class.forName("org.apache.hadoop.security.UnixUserGroupInformation");
}
 catch (ClassNotFoundException cnf) {
if ("0.20".equals(majorVersion)) {
majorVersion+="S";
}
}
return majorVersion;
}
