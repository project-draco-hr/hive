{
  try {
    OperatorDesc conf=op.getConf();
    if (conf != null) {
      LOG.info("setRuntimeStatsDir for " + op.getOperatorId());
      String path=new Path(pctx.getContext().getExplainConfig().getExplainRootPath(),op.getOperatorId()).toString();
      StatsPublisher statsPublisher=new FSStatsPublisher();
      StatsCollectionContext runtimeStatsContext=new StatsCollectionContext(pctx.getConf());
      runtimeStatsContext.setStatsTmpDir(path);
      if (!statsPublisher.init(runtimeStatsContext)) {
        LOG.error("StatsPublishing error: StatsPublisher is not initialized.");
        throw new HiveException(ErrorMsg.STATSPUBLISHER_NOT_OBTAINED.getErrorCodedMsg());
      }
      conf.setRuntimeStatsTmpDir(path);
    }
 else {
      LOG.debug("skip setRuntimeStatsDir for " + op.getOperatorId() + " because OperatorDesc is null");
    }
  }
 catch (  HiveException e) {
    throw new SemanticException(e);
  }
}
