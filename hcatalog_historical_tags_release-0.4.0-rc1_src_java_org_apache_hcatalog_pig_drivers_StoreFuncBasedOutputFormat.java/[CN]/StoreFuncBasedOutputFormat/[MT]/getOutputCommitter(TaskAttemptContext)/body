{
  String serializedJobInfo=ctx.getConfiguration().get(HCatConstants.HCAT_KEY_OUTPUT_INFO);
  OutputJobInfo outputJobInfo=(OutputJobInfo)HCatUtil.deserialize(serializedJobInfo);
  ResourceSchema rs=PigHCatUtil.getResourceSchema(outputJobInfo.getOutputSchema());
  String location=outputJobInfo.getLocation();
  OutputFormat<BytesWritable,Tuple> outputFormat=storeFunc.getOutputFormat();
  return new StoreFuncBasedOutputCommitter(storeFunc,outputFormat.getOutputCommitter(ctx),location,rs);
}
