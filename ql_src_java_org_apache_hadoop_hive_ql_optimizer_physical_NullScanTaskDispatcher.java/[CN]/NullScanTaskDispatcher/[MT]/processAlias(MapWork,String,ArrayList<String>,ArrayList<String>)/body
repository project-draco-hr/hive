{
  ArrayList<String> allowed=new ArrayList<String>();
  for (  String alias : aliasesAffected) {
    if (aliases.contains(alias)) {
      allowed.add(alias);
    }
  }
  if (allowed.size() > 0) {
    work.setUseOneNullRowInputFormat(true);
    PartitionDesc partDesc=work.getPathToPartitionInfo().get(path).clone();
    PartitionDesc newPartition=changePartitionToMetadataOnly(partDesc);
    Path fakePath=new Path(physicalContext.getContext().getMRTmpPath() + newPartition.getTableName() + encode(newPartition.getPartSpec()));
    work.getPathToPartitionInfo().put(fakePath.getName(),newPartition);
    work.getPathToAliases().put(fakePath.getName(),new ArrayList<String>(allowed));
    aliasesAffected.removeAll(allowed);
    if (aliasesAffected.isEmpty()) {
      work.getPathToAliases().remove(path);
      work.getPathToPartitionInfo().remove(path);
    }
  }
}
