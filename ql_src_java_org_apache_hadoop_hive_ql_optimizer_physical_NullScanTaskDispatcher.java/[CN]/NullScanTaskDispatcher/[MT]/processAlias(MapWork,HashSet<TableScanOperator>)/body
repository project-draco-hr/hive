{
  ArrayList<String> aliases=new ArrayList<String>();
  for (  TableScanOperator tso : tableScans) {
    if (tso.getConf().getTableMetadata().getStorageHandler() != null) {
      continue;
    }
    String alias=getAliasForTableScanOperator(work,tso);
    aliases.add(alias);
    tso.getConf().setIsMetadataOnly(true);
  }
  LinkedHashMap<Path,ArrayList<String>> candidates=new LinkedHashMap<>();
  for (  Path path : work.getPaths()) {
    ArrayList<String> aliasesAffected=work.getPathToAliases().get(path);
    if (aliasesAffected != null && aliasesAffected.size() > 0) {
      candidates.put(path,aliasesAffected);
    }
  }
  for (  Entry<Path,ArrayList<String>> entry : candidates.entrySet()) {
    processAlias(work,entry.getKey(),entry.getValue(),aliases);
  }
}
