{
  List<String> paths=getPathsForAlias(work,alias);
  if (paths.isEmpty()) {
    return;
  }
  work.setUseOneNullRowInputFormat(true);
  PartitionDesc aliasPartn=work.getAliasToPartnInfo().get(alias);
  changePartitionToMetadataOnly(aliasPartn);
  for (  String path : paths) {
    PartitionDesc partDesc=work.getPathToPartitionInfo().get(path);
    PartitionDesc newPartition=changePartitionToMetadataOnly(partDesc);
    Path fakePath=new Path(physicalContext.getContext().getMRTmpPath() + newPartition.getTableName() + encode(newPartition.getPartSpec()));
    work.getPathToPartitionInfo().remove(path);
    work.getPathToPartitionInfo().put(fakePath.getName(),newPartition);
    ArrayList<String> aliases=work.getPathToAliases().remove(path);
    work.getPathToAliases().put(fakePath.getName(),aliases);
  }
}
