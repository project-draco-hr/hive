{
  Properties properties=new Properties();
  String zkHostList=conf.get(HConstants.ZOOKEEPER_QUORUM);
  int port=conf.getInt(HConstants.ZOOKEEPER_CLIENT_PORT,HConstants.DEFAULT_ZOOKEPER_CLIENT_PORT);
  if (zkHostList != null) {
    String[] splits=zkHostList.split(",");
    StringBuffer sb=new StringBuffer();
    for (    String split : splits) {
      sb.append(split);
      sb.append(':');
      sb.append(port);
      sb.append(',');
    }
    sb.deleteCharAt(sb.length() - 1);
    properties.put(ZKBasedRevisionManager.HOSTLIST,sb.toString());
  }
  String dataDir=conf.get(ZKBasedRevisionManager.DATADIR);
  if (dataDir != null) {
    properties.put(ZKBasedRevisionManager.DATADIR,dataDir);
  }
  RevisionManager revisionMgr=RevisionManagerFactory.getRevisionManager(className,properties);
  if (revisionMgr instanceof Configurable) {
    ((Configurable)revisionMgr).setConf(conf);
  }
  revisionMgr.open();
  return revisionMgr;
}
