{
  String username=getAccumuloUserName();
  if (null == username) {
    throw new IllegalArgumentException("Accumulo user name must be provided in hiveconf using " + USER_NAME);
  }
  if (useSasl()) {
    return inst.getConnector(username,getKerberosToken());
  }
 else {
    String password=getAccumuloPassword();
    if (null == password) {
      throw new IllegalArgumentException("Accumulo password must be provided in hiveconf using " + USER_PASS);
    }
    return inst.getConnector(username,new PasswordToken(password));
  }
}
