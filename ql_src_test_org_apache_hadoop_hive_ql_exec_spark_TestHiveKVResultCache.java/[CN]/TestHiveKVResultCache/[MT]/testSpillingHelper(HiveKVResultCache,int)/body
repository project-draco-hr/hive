{
  for (int i=0; i < numRecords; i++) {
    String key="key_" + i;
    String value="value_" + i;
    cache.add(new BytesWritable(key.getBytes()),new BytesWritable(value.getBytes()));
  }
  int recordsSeen=0;
  while (cache.hasNext()) {
    String key="key_" + recordsSeen;
    String value="value_" + recordsSeen;
    Tuple2<BytesWritable,BytesWritable> row=cache.next();
    assertTrue("Unexpected key at position: " + recordsSeen,new String(row._1().getBytes()).equals(key));
    assertTrue("Unexpected value at position: " + recordsSeen,new String(row._2().getBytes()).equals(value));
    recordsSeen++;
  }
  assertTrue("Retrieved record count doesn't match inserted record count",numRecords == recordsSeen);
  cache.clear();
}
