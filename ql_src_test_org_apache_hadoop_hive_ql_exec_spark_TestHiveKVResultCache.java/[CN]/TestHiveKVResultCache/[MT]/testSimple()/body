{
  HiveConf conf=new HiveConf();
  HiveKVResultCache cache=new HiveKVResultCache(conf);
  HiveKey key=new HiveKey("key".getBytes(),"key".hashCode());
  BytesWritable value=new BytesWritable("value".getBytes());
  cache.add(key,value);
  assertTrue("KV result cache should have at least one element",cache.hasNext());
  Tuple2<HiveKey,BytesWritable> row=cache.next();
  assertTrue("Incorrect key",row._1().equals(key));
  assertTrue("Incorrect value",row._2().equals(value));
  assertTrue("Cache shouldn't have more records",!cache.hasNext());
}
