{
  final long iteratorCount=threshold == 0 ? 1 : rows * (100 - separate) / 100 / threshold;
  MyHiveFunctionResultList resultList=new MyHiveFunctionResultList(new Iterator(){
    private int i=0;
    @Override public boolean hasNext(){
      return i++ < iteratorCount;
    }
    @Override public Object next(){
      return Integer.valueOf(i);
    }
    @Override public void remove(){
    }
  }
);
  resultList.init(rows,threshold,separate,prefix1,prefix2);
  long startTime=System.currentTimeMillis();
  while (resultList.hasNext()) {
    Object item=resultList.next();
    if (output != null) {
      output.add((Tuple2<HiveKey,BytesWritable>)item);
    }
  }
  long endTime=System.currentTimeMillis();
  return endTime - startTime;
}
