{
  HCatReader reader=DataTransferFactory.getHCatReader(split,config);
  Iterator<HCatRecord> itr=reader.read();
  int i=1;
  while (itr.hasNext()) {
    HCatRecord read=itr.next();
    HCatRecord written=getRecord(i++);
    Assert.assertTrue("Read: " + read.get(0) + "Written: "+ written.get(0),written.get(0).equals(read.get(0)));
    Assert.assertTrue("Read: " + read.get(1) + "Written: "+ written.get(1),written.get(1).equals(read.get(1)));
    Assert.assertEquals(2,read.size());
  }
  Assert.assertFalse(itr.hasNext());
}
