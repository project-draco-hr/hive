{
  if (oi.getCategory() != ObjectInspector.Category.STRUCT) {
    throw new RuntimeException("Invalid object datatype : " + oi.getCategory().toString());
  }
  StructObjectInspector soi=(StructObjectInspector)oi;
  List<? extends StructField> fields=soi.getAllStructFieldRefs();
  List<Object> list=soi.getStructFieldsDataAsList(o);
  for (int i=0; i < fields.size(); i++) {
    ObjectInspector foi=fields.get(i).getFieldObjectInspector();
    Object f=(list == null ? null : list.get(i));
    String fieldName=fields.get(i).getFieldName();
    if (foi.getCategory() == ObjectInspector.Category.PRIMITIVE) {
      unpackPrimitiveObject(foi,f,fieldName,cStatsObj);
    }
 else {
      unpackStructObject(foi,f,fieldName,cStatsObj);
    }
  }
}
