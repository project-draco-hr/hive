{
  ConcurrentMap<String,SourceStateProto> dagMap=sourceCompletionMap.get(queryIdentifier);
  if (dagMap == null) {
    dagMap=new ConcurrentHashMap<>();
    ConcurrentMap<String,SourceStateProto> old=sourceCompletionMap.putIfAbsent(queryIdentifier,dagMap);
    dagMap=(old != null) ? old : dagMap;
  }
  return dagMap;
}
