{
  LOG.info("Processing queryComplete for dagName={} with deleteDelay={} seconds",dagName,deleteDelay);
  QueryInfo queryInfo=queryInfoMap.remove(dagName);
  if (queryInfo == null) {
    LOG.warn("Ignoring query complete for unknown dag: {}",dagName);
  }
  String[] localDirs=queryInfo.getLocalDirsNoCreate();
  if (localDirs != null) {
    for (    String localDir : localDirs) {
      queryFileCleaner.cleanupDir(localDir,deleteDelay);
      ShuffleHandler.get().unregisterDag(localDir,dagName,queryInfo.dagIdentifier);
    }
  }
}
