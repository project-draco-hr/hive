{
  Map<String,String> partitionMap=new HashMap<String,String>();
  runMRCreate(null,partitionColumns,writeRecords,10,true);
  IOException exc=null;
  try {
    Job j=runMRCreate(null,partitionColumns,writeRecords,20,true);
    assertEquals(!isTableImmutable(),j.isSuccessful());
  }
 catch (  IOException e) {
    exc=e;
    assertTrue(exc instanceof HCatException);
    assertEquals(ErrorType.ERROR_NON_EMPTY_TABLE,((HCatException)exc).getErrorType());
  }
  if (!isTableImmutable()) {
    assertNull(exc);
  }
  exc=null;
  partitionMap.clear();
  partitionMap.put("px","p1value2");
  try {
    Job j=runMRCreate(partitionMap,partitionColumns,writeRecords,20,true);
    assertFalse(j.isSuccessful());
  }
 catch (  IOException e) {
    exc=e;
    assertTrue(exc != null);
    assertTrue(exc instanceof HCatException);
    assertEquals(ErrorType.ERROR_INVALID_PARTITION_VALUES,((HCatException)exc).getErrorType());
  }
  if (isTableImmutable()) {
    runMRRead(10);
  }
 else {
    runMRRead(30);
  }
  hiveReadTest();
}
