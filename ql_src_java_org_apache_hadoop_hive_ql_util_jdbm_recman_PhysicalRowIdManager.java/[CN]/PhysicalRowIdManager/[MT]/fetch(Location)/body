{
  PageCursor curs=new PageCursor(pageman,rowid.getBlock());
  BlockIo block=file.get(curs.getCurrent());
  RecordHeader head=new RecordHeader(block,rowid.getOffset());
  byte[] retval=new byte[head.getCurrentSize()];
  if (retval.length == 0) {
    file.release(curs.getCurrent(),false);
    return retval;
  }
  int offsetInBuffer=0;
  int leftToRead=retval.length;
  short dataOffset=(short)(rowid.getOffset() + RecordHeader.SIZE);
  while (leftToRead > 0) {
    int toCopy=RecordFile.BLOCK_SIZE - dataOffset;
    if (leftToRead < toCopy) {
      toCopy=leftToRead;
    }
    System.arraycopy(block.getData(),dataOffset,retval,offsetInBuffer,toCopy);
    leftToRead-=toCopy;
    offsetInBuffer+=toCopy;
    file.release(block);
    if (leftToRead > 0) {
      block=file.get(curs.next());
      dataOffset=DataPage.O_DATA;
    }
  }
  return retval;
}
