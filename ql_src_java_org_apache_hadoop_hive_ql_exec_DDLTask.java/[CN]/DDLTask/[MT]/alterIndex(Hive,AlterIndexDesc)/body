{
  String dbName=alterIndex.getDbName();
  String baseTableName=alterIndex.getBaseTableName();
  String indexName=alterIndex.getIndexName();
  Index idx=db.getIndex(dbName,baseTableName,indexName);
  if (alterIndex.getOp() == AlterIndexDesc.AlterIndexTypes.ADDPROPS) {
    idx.getParameters().putAll(alterIndex.getProps());
  }
 else {
    console.printError("Unsupported Alter commnad");
    return 1;
  }
  if (!updateModifiedParameters(idx.getParameters(),conf)) {
    return 1;
  }
  try {
    db.alterIndex(dbName,baseTableName,indexName,idx);
  }
 catch (  InvalidOperationException e) {
    console.printError("Invalid alter operation: " + e.getMessage());
    LOG.info("alter index: " + stringifyException(e));
    return 1;
  }
catch (  HiveException e) {
    console.printError("Invalid alter operation: " + e.getMessage());
    return 1;
  }
  return 0;
}
