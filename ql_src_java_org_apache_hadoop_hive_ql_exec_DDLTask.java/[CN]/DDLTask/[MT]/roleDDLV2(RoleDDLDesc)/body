{
  HiveAuthorizer authorizer=SessionState.get().getAuthorizerV2();
  RoleDDLDesc.RoleOperation operation=roleDDLDesc.getOperation();
switch (operation) {
case CREATE_ROLE:
    authorizer.createRole(roleDDLDesc.getName(),null);
  break;
case DROP_ROLE:
authorizer.dropRole(roleDDLDesc.getName());
break;
case SHOW_ROLE_GRANT:
List<String> roles=authorizer.getRoles(new HivePrincipal(roleDDLDesc.getName(),getHivePrincipalType(roleDDLDesc.getPrincipalType())));
writeListToFile(roles,roleDDLDesc.getResFile());
break;
case SHOW_ROLES:
List<String> allRoles=authorizer.getAllRoles();
writeListToFile(allRoles,roleDDLDesc.getResFile());
break;
default :
throw new HiveException("Unkown role operation " + operation.getOperationName());
}
return 0;
}
