{
  Context ctx=driverContext.getCtx();
  HiveLockManager lockMgr=ctx.getHiveLockMgr();
  if (lockMgr == null) {
    throw new HiveException("unlock Database LockManager not specified");
  }
  String dbName=unlockDb.getDatabaseName();
  Database dbObj=db.getDatabase(dbName);
  if (dbObj == null) {
    throw new HiveException("Database " + dbName + " does not exist ");
  }
  HiveLockObject obj=new HiveLockObject(dbObj.getName(),null);
  List<HiveLock> locks=lockMgr.getLocks(obj,false,false);
  if ((locks == null) || (locks.isEmpty())) {
    throw new HiveException("Database " + dbName + " is not locked ");
  }
  for (  HiveLock lock : locks) {
    lockMgr.unlock(lock);
  }
  return 0;
}
