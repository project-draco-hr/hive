{
  Table tbl=db.getTable(touchDesc.getTableName());
  if (touchDesc.getPartSpec() == null) {
    try {
      db.alterTable(touchDesc.getTableName(),tbl);
    }
 catch (    InvalidOperationException e) {
      throw new HiveException("Uable to update table");
    }
    work.getInputs().add(new ReadEntity(tbl));
    work.getOutputs().add(new WriteEntity(tbl,WriteEntity.WriteType.DDL_NO_LOCK));
  }
 else {
    Partition part=db.getPartition(tbl,touchDesc.getPartSpec(),false);
    if (part == null) {
      throw new HiveException("Specified partition does not exist");
    }
    try {
      db.alterPartition(touchDesc.getTableName(),part);
    }
 catch (    InvalidOperationException e) {
      throw new HiveException(e);
    }
    work.getInputs().add(new ReadEntity(part));
    work.getOutputs().add(new WriteEntity(part,WriteEntity.WriteType.DDL_NO_LOCK));
  }
  return 0;
}
