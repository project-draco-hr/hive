{
  Table tbl=db.getTable(alterPartitionProtectModeDesc.getDbName(),alterPartitionProtectModeDesc.getTableName());
  validateAlterTableType(tbl,AlterTableDesc.AlterTableTypes.ALTERPARTITIONPROTECTMODE);
  Partition oldPart=db.getPartition(tbl,alterPartitionProtectModeDesc.getPartSpec(),false);
  if (oldPart == null) {
    console.printError("Cannot modify protect mode of not existing partition");
  }
  ProtectMode mode=oldPart.getProtectMode();
  if (alterPartitionProtectModeDesc.isProtectModeEnable() && alterPartitionProtectModeDesc.getProtectModeType() == AlterPartitionProtectModeDesc.ProtectModeType.OFFLINE) {
    mode.offline=true;
  }
 else   if (alterPartitionProtectModeDesc.isProtectModeEnable() && alterPartitionProtectModeDesc.getProtectModeType() == AlterPartitionProtectModeDesc.ProtectModeType.NO_DROP) {
    mode.noDrop=true;
  }
 else   if (!alterPartitionProtectModeDesc.isProtectModeEnable() && alterPartitionProtectModeDesc.getProtectModeType() == AlterPartitionProtectModeDesc.ProtectModeType.OFFLINE) {
    mode.offline=false;
  }
 else   if (!alterPartitionProtectModeDesc.isProtectModeEnable() && alterPartitionProtectModeDesc.getProtectModeType() == AlterPartitionProtectModeDesc.ProtectModeType.NO_DROP) {
    mode.noDrop=false;
  }
  oldPart.setProtectMode(mode);
  try {
    db.alterPartition(alterPartitionProtectModeDesc.getTableName(),oldPart);
  }
 catch (  InvalidOperationException e) {
    throw new HiveException(e);
  }
  return 0;
}
