{
  Context ctx=driverContext.getCtx();
  HiveLockManager lockMgr=ctx.getHiveLockMgr();
  if (lockMgr == null) {
    throw new HiveException("lock Database LockManager not specified");
  }
  HiveLockMode mode=HiveLockMode.valueOf(lockDb.getMode());
  String dbName=lockDb.getDatabaseName();
  Database dbObj=db.getDatabase(dbName);
  if (dbObj == null) {
    throw new HiveException("Database " + dbName + " does not exist ");
  }
  HiveLockObjectData lockData=new HiveLockObjectData(lockDb.getQueryId(),String.valueOf(System.currentTimeMillis()),"EXPLICIT",lockDb.getQueryStr());
  HiveLock lck=lockMgr.lock(new HiveLockObject(dbObj.getName(),lockData),mode,true);
  if (lck == null) {
    return 1;
  }
  return 0;
}
