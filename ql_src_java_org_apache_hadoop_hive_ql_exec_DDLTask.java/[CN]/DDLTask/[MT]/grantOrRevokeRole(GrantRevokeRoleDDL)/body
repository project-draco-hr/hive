{
  try {
    boolean grantRole=grantOrRevokeRoleDDL.getGrant();
    List<PrincipalDesc> principals=grantOrRevokeRoleDDL.getPrincipalDesc();
    List<String> roles=grantOrRevokeRoleDDL.getRoles();
    if (SessionState.get().isAuthorizationModeV2()) {
      return grantOrRevokeRoleV2(grantOrRevokeRoleDDL);
    }
    for (    PrincipalDesc principal : principals) {
      String userName=principal.getName();
      for (      String roleName : roles) {
        if (grantRole) {
          db.grantRole(roleName,userName,principal.getType(),grantOrRevokeRoleDDL.getGrantor(),grantOrRevokeRoleDDL.getGrantorType(),grantOrRevokeRoleDDL.isGrantOption());
        }
 else {
          db.revokeRole(roleName,userName,principal.getType(),grantOrRevokeRoleDDL.isGrantOption());
        }
      }
    }
  }
 catch (  Exception e) {
    throw new HiveException(e);
  }
  return 0;
}
