{
  Table tbl=db.getTable(addPartitionDesc.getDbName(),addPartitionDesc.getTableName());
  validateAlterTableType(tbl,AlterTableDesc.AlterTableTypes.ADDPARTITION);
  Partition checkPart=db.getPartition(tbl,addPartitionDesc.getPartSpec(),false);
  if (checkPart != null && addPartitionDesc.getIfNotExists()) {
    return 0;
  }
  if (addPartitionDesc.getLocation() == null) {
    db.createPartition(tbl,addPartitionDesc.getPartSpec());
  }
 else {
    db.createPartition(tbl,addPartitionDesc.getPartSpec(),new Path(tbl.getPath(),addPartitionDesc.getLocation()));
  }
  Partition part=db.getPartition(tbl,addPartitionDesc.getPartSpec(),false);
  work.getOutputs().add(new WriteEntity(part));
  return 0;
}
