{
  Table tbl=db.getTable(addPartitionDesc.getDbName(),addPartitionDesc.getTableName());
  if (tbl.isView()) {
    throw new HiveException("Cannot use ALTER TABLE on a view");
  }
  if (addPartitionDesc.getLocation() == null) {
    db.createPartition(tbl,addPartitionDesc.getPartSpec());
  }
 else {
    db.createPartition(tbl,addPartitionDesc.getPartSpec(),new Path(tbl.getPath(),addPartitionDesc.getLocation()));
  }
  Partition part=db.getPartition(tbl,addPartitionDesc.getPartSpec(),false);
  work.getOutputs().add(new WriteEntity(part));
  return 0;
}
