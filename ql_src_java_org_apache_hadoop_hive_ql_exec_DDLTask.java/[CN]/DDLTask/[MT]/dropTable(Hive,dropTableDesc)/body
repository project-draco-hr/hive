{
  Table tbl=null;
  try {
    tbl=db.getTable(MetaStoreUtils.DEFAULT_DATABASE_NAME,dropTbl.getTableName());
  }
 catch (  InvalidTableException e) {
  }
  if (dropTbl.getPartSpecs() == null) {
    db.dropTable(MetaStoreUtils.DEFAULT_DATABASE_NAME,dropTbl.getTableName());
    if (tbl != null)     work.getOutputs().add(new WriteEntity(tbl));
  }
 else {
    List<Partition> parts=new ArrayList<Partition>();
    for (    Map<String,String> partSpec : dropTbl.getPartSpecs()) {
      Partition part=db.getPartition(tbl,partSpec,false);
      if (part == null) {
        console.printInfo("Partition " + partSpec + " does not exist.");
      }
 else {
        parts.add(part);
      }
    }
    for (    Partition partition : parts) {
      console.printInfo("Dropping the partition " + partition.getName());
      db.dropPartition(MetaStoreUtils.DEFAULT_DATABASE_NAME,dropTbl.getTableName(),partition.getValues(),true);
      work.getOutputs().add(new WriteEntity(partition));
    }
  }
  return 0;
}
