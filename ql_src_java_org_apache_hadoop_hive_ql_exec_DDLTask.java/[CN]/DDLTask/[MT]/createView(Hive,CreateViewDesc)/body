{
  Table oldview=db.getTable(crtView.getViewName(),false);
  if (crtView.getOrReplace() && oldview != null) {
    oldview.setViewOriginalText(crtView.getViewOriginalText());
    oldview.setViewExpandedText(crtView.getViewExpandedText());
    oldview.setFields(crtView.getSchema());
    if (crtView.getComment() != null) {
      oldview.setProperty("comment",crtView.getComment());
    }
    if (crtView.getTblProps() != null) {
      oldview.getTTable().getParameters().putAll(crtView.getTblProps());
    }
    oldview.setPartCols(crtView.getPartCols());
    oldview.checkValidity();
    try {
      db.alterTable(crtView.getViewName(),oldview);
    }
 catch (    InvalidOperationException e) {
      throw new HiveException(e);
    }
    work.getOutputs().add(new WriteEntity(oldview,WriteEntity.WriteType.DDL_NO_LOCK));
  }
 else {
    Table tbl=db.newTable(crtView.getViewName());
    tbl.setTableType(TableType.VIRTUAL_VIEW);
    tbl.setSerializationLib(null);
    tbl.clearSerDeInfo();
    tbl.setViewOriginalText(crtView.getViewOriginalText());
    tbl.setViewExpandedText(crtView.getViewExpandedText());
    tbl.setFields(crtView.getSchema());
    if (crtView.getComment() != null) {
      tbl.setProperty("comment",crtView.getComment());
    }
    if (crtView.getTblProps() != null) {
      tbl.getTTable().getParameters().putAll(crtView.getTblProps());
    }
    if (crtView.getPartCols() != null) {
      tbl.setPartCols(crtView.getPartCols());
    }
    db.createTable(tbl,crtView.getIfNotExists());
    work.getOutputs().add(new WriteEntity(tbl,WriteEntity.WriteType.DDL_NO_LOCK));
  }
  return 0;
}
