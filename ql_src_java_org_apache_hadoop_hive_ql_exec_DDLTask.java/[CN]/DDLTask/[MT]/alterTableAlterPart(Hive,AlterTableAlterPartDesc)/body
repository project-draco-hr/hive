{
  Table tbl=db.getTable(alterPartitionDesc.getDbName(),alterPartitionDesc.getTableName());
  String tabName=alterPartitionDesc.getTableName();
  assert(tbl.isPartitioned());
  List<FieldSchema> newPartitionKeys=new ArrayList<FieldSchema>();
  for (  FieldSchema col : tbl.getTTable().getPartitionKeys()) {
    if (col.getName().compareTo(alterPartitionDesc.getPartKeySpec().getName()) == 0) {
      newPartitionKeys.add(alterPartitionDesc.getPartKeySpec());
    }
 else {
      newPartitionKeys.add(col);
    }
  }
  tbl.getTTable().setPartitionKeys(newPartitionKeys);
  try {
    db.alterTable(tabName,tbl);
  }
 catch (  InvalidOperationException e) {
    throw new HiveException(e,ErrorMsg.GENERIC_ERROR,"Unable to alter " + tabName);
  }
  work.getInputs().add(new ReadEntity(tbl));
  work.getOutputs().add(new WriteEntity(tbl,WriteEntity.WriteType.DDL));
  return 0;
}
