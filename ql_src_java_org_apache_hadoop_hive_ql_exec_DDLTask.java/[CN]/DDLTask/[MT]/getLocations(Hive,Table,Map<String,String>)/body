{
  List<Path> locations=new ArrayList<Path>();
  if (partSpec == null) {
    if (table.isPartitioned()) {
      for (      Partition partition : db.getPartitions(table)) {
        locations.add(partition.getDataLocation());
        if (needToUpdateStats(partition.getParameters())) {
          db.alterPartition(table.getDbName(),table.getTableName(),partition);
        }
      }
    }
 else {
      locations.add(table.getPath());
      if (needToUpdateStats(table.getParameters())) {
        db.alterTable(table.getDbName() + "." + table.getTableName(),table);
      }
    }
  }
 else {
    for (    Partition partition : db.getPartitionsByNames(table,partSpec)) {
      locations.add(partition.getDataLocation());
      if (needToUpdateStats(partition.getParameters())) {
        db.alterPartition(table.getDbName(),table.getTableName(),partition);
      }
    }
  }
  return locations;
}
