{
  Table table=db.getTable(showCols.getTableName());
  DataOutputStream outStream=null;
  try {
    Path resFile=new Path(showCols.getResFile());
    FileSystem fs=resFile.getFileSystem(conf);
    outStream=fs.create(resFile);
    List<FieldSchema> cols=table.getCols();
    cols.addAll(table.getPartCols());
    boolean isOutputPadded=!SessionState.get().isHiveServerQuery();
    outStream.writeBytes(MetaDataFormatUtils.getAllColumnsInformation(cols,false,isOutputPadded,null));
    outStream.close();
    outStream=null;
  }
 catch (  IOException e) {
    throw new HiveException(e,ErrorMsg.GENERIC_ERROR);
  }
 finally {
    IOUtils.closeStream(outStream);
  }
  return 0;
}
