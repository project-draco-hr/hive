{
  String dbName=showCols.getDbName();
  String tableName=showCols.getTableName();
  Table table=null;
  if (dbName == null) {
    table=db.getTable(tableName);
  }
 else {
    table=db.getTable(dbName,tableName);
  }
  DataOutput outStream=null;
  try {
    Path resFile=new Path(showCols.getResFile());
    FileSystem fs=resFile.getFileSystem(conf);
    outStream=fs.create(resFile);
    List<FieldSchema> cols=table.getCols();
    cols.addAll(table.getPartCols());
    outStream.writeBytes(MetaDataFormatUtils.getAllColumnsInformation(cols));
    ((FSDataOutputStream)outStream).close();
    outStream=null;
  }
 catch (  IOException e) {
    LOG.warn("show columns: " + stringifyException(e));
    return 1;
  }
 finally {
    IOUtils.closeStream((FSDataOutputStream)outStream);
  }
  return 0;
}
