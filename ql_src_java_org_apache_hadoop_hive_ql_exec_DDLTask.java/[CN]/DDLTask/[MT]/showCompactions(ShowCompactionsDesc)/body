{
  ShowCompactResponse rsp=db.showCompactions();
  DataOutputStream os=null;
  try {
    Path resFile=new Path(desc.getResFile());
    FileSystem fs=resFile.getFileSystem(conf);
    os=fs.create(resFile);
    os.writeBytes("Database");
    os.write(separator);
    os.writeBytes("Table");
    os.write(separator);
    os.writeBytes("Partition");
    os.write(separator);
    os.writeBytes("Type");
    os.write(separator);
    os.writeBytes("State");
    os.write(separator);
    os.writeBytes("Worker");
    os.write(separator);
    os.writeBytes("Start Time");
    os.write(terminator);
    for (    ShowCompactResponseElement e : rsp.getCompacts()) {
      os.writeBytes(e.getDbname());
      os.write(separator);
      os.writeBytes(e.getTablename());
      os.write(separator);
      String part=e.getPartitionname();
      os.writeBytes(part == null ? "NULL" : part);
      os.write(separator);
      os.writeBytes(e.getType().toString());
      os.write(separator);
      os.writeBytes(e.getState());
      os.write(separator);
      String wid=e.getWorkerid();
      os.writeBytes(wid == null ? "NULL" : wid);
      os.write(separator);
      os.writeBytes(Long.toString(e.getStart()));
      os.write(terminator);
    }
    os.close();
  }
 catch (  IOException e) {
    LOG.warn("show compactions: " + stringifyException(e));
    return 1;
  }
 finally {
    IOUtils.closeStream((FSDataOutputStream)os);
  }
  return 0;
}
