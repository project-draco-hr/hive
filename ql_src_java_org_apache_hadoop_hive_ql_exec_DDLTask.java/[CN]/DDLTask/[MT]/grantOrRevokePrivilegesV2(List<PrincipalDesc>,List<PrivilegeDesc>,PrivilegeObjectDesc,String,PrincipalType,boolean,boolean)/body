{
  HiveAuthorizer authorizer=SessionState.get().getAuthorizerV2();
  List<HivePrincipal> hivePrincipals=getHivePrincipals(principals);
  List<HivePrivilege> hivePrivileges=getHivePrivileges(privileges);
  HivePrivilegeObject hivePrivObject=getHivePrivilegeObject(privSubjectDesc);
  HivePrincipal grantorPrincipal=new HivePrincipal(grantor,getHivePrincipalType(grantorType));
  if (isGrant) {
    authorizer.grantPrivileges(hivePrincipals,hivePrivileges,hivePrivObject,grantorPrincipal,grantOption);
  }
 else {
    authorizer.revokePrivileges(hivePrincipals,hivePrivileges,hivePrivObject,grantorPrincipal,grantOption);
  }
  return 0;
}
