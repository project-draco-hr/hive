{
  Context ctx=driverContext.getCtx();
  HiveLockManager lockMgr=ctx.getHiveLockMgr();
  if (lockMgr == null) {
    throw new HiveException("unlock Table LockManager not specified");
  }
  String tabName=unlockTbl.getTableName();
  Table tbl=db.getTable(MetaStoreUtils.DEFAULT_DATABASE_NAME,tabName);
  if (tbl == null) {
    throw new HiveException("Table " + tabName + " does not exist ");
  }
  Map<String,String> partSpec=unlockTbl.getPartSpec();
  HiveLockObject obj=null;
  if (partSpec == null) {
    obj=new HiveLockObject(tbl);
  }
 else {
    Partition par=db.getPartition(tbl,partSpec,false);
    if (par == null) {
      throw new HiveException("Partition " + partSpec + " for table "+ tabName+ " does not exist");
    }
    obj=new HiveLockObject(par);
  }
  List<HiveLock> locks=lockMgr.getLocks(obj);
  if ((locks == null) || (locks.isEmpty())) {
    throw new HiveException("Table " + tabName + " is not locked ");
  }
  Iterator<HiveLock> locksIter=locks.iterator();
  while (locksIter.hasNext()) {
    HiveLock lock=locksIter.next();
    lockMgr.unlock(lock);
  }
  return 0;
}
