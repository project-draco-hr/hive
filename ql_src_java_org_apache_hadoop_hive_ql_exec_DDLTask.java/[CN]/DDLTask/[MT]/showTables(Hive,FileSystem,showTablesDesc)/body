{
  List<String> tbls=null;
  if (showTbls.getPattern() != null) {
    LOG.info("pattern: " + showTbls.getPattern());
    tbls=db.getTablesByPattern(showTbls.getPattern());
    LOG.info("results : " + tbls.size());
  }
 else   tbls=db.getAllTables();
  try {
    DataOutput outStream=(DataOutput)fs.create(showTbls.getResFile());
    SortedSet<String> sortedTbls=new TreeSet<String>(tbls);
    Iterator<String> iterTbls=sortedTbls.iterator();
    boolean firstCol=true;
    while (iterTbls.hasNext()) {
      if (!firstCol)       outStream.write(separator);
      outStream.write(iterTbls.next().getBytes("UTF-8"));
      firstCol=false;
    }
    ((FSDataOutputStream)outStream).close();
  }
 catch (  FileNotFoundException e) {
    LOG.info("show table: " + StringUtils.stringifyException(e));
    return 1;
  }
catch (  IOException e) {
    LOG.info("show table: " + StringUtils.stringifyException(e));
    return 1;
  }
  return 0;
}
