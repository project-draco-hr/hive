{
  String dbName=alterDbDesc.getDatabaseName();
  Database database=db.getDatabase(dbName);
  if (database == null) {
    throw new HiveException(ErrorMsg.DATABASE_NOT_EXISTS,dbName);
  }
switch (alterDbDesc.getAlterType()) {
case ALTER_PROPERTY:
    Map<String,String> newParams=alterDbDesc.getDatabaseProperties();
  Map<String,String> params=database.getParameters();
if (params != null && newParams != null) {
  params.putAll(newParams);
  database.setParameters(params);
}
 else {
  database.setParameters(newParams);
}
break;
case ALTER_OWNER:
database.setOwnerName(alterDbDesc.getOwnerPrincipal().getName());
database.setOwnerType(alterDbDesc.getOwnerPrincipal().getType());
break;
default :
throw new AssertionError("Unsupported alter database type! : " + alterDbDesc.getAlterType());
}
db.alterDatabase(database.getName(),database);
return 0;
}
