{
  HiveAuthorizer authorizer=SessionState.get().getAuthorizerV2();
  HivePrincipal grantorPrinc=null;
  if (grantOrRevokeRoleDDL.getGrantor() != null) {
    grantorPrinc=new HivePrincipal(grantOrRevokeRoleDDL.getGrantor(),getHivePrincipalType(grantOrRevokeRoleDDL.getGrantorType()));
  }
  List<HivePrincipal> hivePrincipals=getHivePrincipals(grantOrRevokeRoleDDL.getPrincipalDesc());
  List<String> roles=grantOrRevokeRoleDDL.getRoles();
  if (grantOrRevokeRoleDDL.getGrant()) {
    authorizer.grantRole(hivePrincipals,roles,grantOrRevokeRoleDDL.isGrantOption(),grantorPrinc);
  }
 else {
    authorizer.revokeRole(hivePrincipals,roles,grantOrRevokeRoleDDL.isGrantOption(),grantorPrinc);
  }
  return 0;
}
