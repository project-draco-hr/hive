{
  List<String> databases=null;
  if (showDatabasesDesc.getPattern() != null) {
    LOG.info("pattern: " + showDatabasesDesc.getPattern());
    databases=db.getDatabasesByPattern(showDatabasesDesc.getPattern());
  }
 else {
    databases=db.getAllDatabases();
  }
  LOG.info("results : " + databases.size());
  DataOutput outStream=null;
  try {
    Path resFile=new Path(showDatabasesDesc.getResFile());
    FileSystem fs=resFile.getFileSystem(conf);
    outStream=fs.create(resFile);
    for (    String database : databases) {
      outStream.writeBytes(database);
      outStream.write(terminator);
    }
    ((FSDataOutputStream)outStream).close();
    outStream=null;
  }
 catch (  FileNotFoundException e) {
    LOG.warn("show databases: " + stringifyException(e));
    return 1;
  }
catch (  IOException e) {
    LOG.warn("show databases: " + stringifyException(e));
    return 1;
  }
catch (  Exception e) {
    throw new HiveException(e.toString());
  }
 finally {
    IOUtils.closeStream((FSDataOutputStream)outStream);
  }
  return 0;
}
