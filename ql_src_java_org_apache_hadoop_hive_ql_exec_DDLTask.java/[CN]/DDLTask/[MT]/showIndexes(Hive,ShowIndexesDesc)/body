{
  String tableName=showIndexes.getTableName();
  Table tbl=null;
  List<Index> indexes=null;
  tbl=db.getTable(tableName);
  indexes=db.getIndexes(tbl.getDbName(),tbl.getTableName(),(short)-1);
  DataOutputStream outStream=null;
  try {
    Path resFile=new Path(showIndexes.getResFile());
    FileSystem fs=resFile.getFileSystem(conf);
    outStream=fs.create(resFile);
    if (showIndexes.isFormatted()) {
      outStream.writeBytes(MetaDataFormatUtils.getIndexColumnsHeader());
      outStream.write(terminator);
      outStream.write(terminator);
    }
    for (    Index index : indexes) {
      outStream.writeBytes(MetaDataFormatUtils.getAllColumnsInformation(index));
    }
    outStream.close();
    outStream=null;
  }
 catch (  FileNotFoundException e) {
    LOG.info("show indexes: " + stringifyException(e));
    throw new HiveException(e.toString());
  }
catch (  IOException e) {
    LOG.info("show indexes: " + stringifyException(e));
    throw new HiveException(e.toString());
  }
catch (  Exception e) {
    throw new HiveException(e.toString());
  }
 finally {
    IOUtils.closeStream((FSDataOutputStream)outStream);
  }
  return 0;
}
