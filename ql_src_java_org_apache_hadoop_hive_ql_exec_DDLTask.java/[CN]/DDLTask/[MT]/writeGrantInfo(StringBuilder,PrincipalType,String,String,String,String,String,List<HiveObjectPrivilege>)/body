{
  if (privileges == null || privileges.isEmpty()) {
    return;
  }
  sortPrivileges(privileges);
  for (  HiveObjectPrivilege privilege : privileges) {
    PrivilegeGrantInfo grantInfo=privilege.getGrantInfo();
    String privName=grantInfo.getPrivilege();
    long unixTimestamp=grantInfo.getCreateTime() * 1000L;
    Date createTime=new Date(unixTimestamp);
    String grantor=grantInfo.getGrantor();
    if (dbName != null) {
      writeKeyValuePair(builder,"database",dbName);
    }
    if (tableName != null) {
      writeKeyValuePair(builder,"table",tableName);
    }
    if (partName != null) {
      writeKeyValuePair(builder,"partition",partName);
    }
    if (columnName != null) {
      writeKeyValuePair(builder,"columnName",columnName);
    }
    writeKeyValuePair(builder,"principalName",principalName);
    writeKeyValuePair(builder,"principalType","" + principalType);
    writeKeyValuePair(builder,"privilege",privName);
    writeKeyValuePair(builder,"grantTime","" + createTime);
    if (grantor != null) {
      writeKeyValuePair(builder,"grantor",grantor);
    }
  }
}
