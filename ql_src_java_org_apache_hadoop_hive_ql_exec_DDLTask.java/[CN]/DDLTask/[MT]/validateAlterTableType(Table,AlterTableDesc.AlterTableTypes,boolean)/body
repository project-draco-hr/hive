{
  if (tbl.isView()) {
    if (!expectView) {
      throw new HiveException("Cannot alter a view with ALTER TABLE");
    }
switch (alterType) {
case ADDPARTITION:
case DROPPARTITION:
case ADDPROPS:
      break;
default :
    throw new HiveException("Cannot use this form of ALTER on a view");
}
}
 else {
if (expectView) {
  throw new HiveException("Cannot alter a base table with ALTER VIEW");
}
}
if (tbl.isNonNative()) {
throw new HiveException("Cannot use ALTER TABLE on a non-native table");
}
}
