{
  DbLockManager lockMgr;
  if (!(lm instanceof DbLockManager)) {
    throw new RuntimeException("New lock format only supported with db lock manager.");
  }
  lockMgr=(DbLockManager)lm;
  ShowLocksResponse rsp=lockMgr.getLocks();
  DataOutputStream os=getOutputStream(showLocks.getResFile());
  try {
    dumpLockInfo(os,rsp);
  }
 catch (  FileNotFoundException e) {
    LOG.warn("show function: " + stringifyException(e));
    return 1;
  }
catch (  IOException e) {
    LOG.warn("show function: " + stringifyException(e));
    return 1;
  }
catch (  Exception e) {
    throw new HiveException(e.toString());
  }
 finally {
    IOUtils.closeStream(os);
  }
  return 0;
}
