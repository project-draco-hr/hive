{
  if (!ArchiveUtils.isArchived(p) && !recovery) {
    throw new HiveException("Partition " + p.getName() + " is not archived.");
  }
  int archiveLevel=ArchiveUtils.getArchivingLevel(p);
  if (partSpecLevel > archiveLevel) {
    throw new HiveException("Partition " + p.getName() + " is archived at level "+ archiveLevel+ ", and given partspec only has "+ partSpecLevel+ " specs.");
  }
}
