{
  List<String> tbls=null;
  String dbName=showTbls.getDbName();
  if (!db.databaseExists(dbName)) {
    throw new HiveException("ERROR: The database " + dbName + " does not exist.");
  }
  if (showTbls.getPattern() != null) {
    LOG.info("pattern: " + showTbls.getPattern());
    tbls=db.getTablesByPattern(dbName,showTbls.getPattern());
    LOG.info("results : " + tbls.size());
  }
 else {
    tbls=db.getAllTables(dbName);
  }
  DataOutputStream outStream=null;
  try {
    Path resFile=new Path(showTbls.getResFile());
    FileSystem fs=resFile.getFileSystem(conf);
    outStream=fs.create(resFile);
    SortedSet<String> sortedTbls=new TreeSet<String>(tbls);
    formatter.showTables(outStream,sortedTbls);
    ((FSDataOutputStream)outStream).close();
    outStream=null;
  }
 catch (  FileNotFoundException e) {
    formatter.logWarn(outStream,"show table: " + stringifyException(e),formatter.ERROR);
    return 1;
  }
catch (  IOException e) {
    formatter.logWarn(outStream,"show table: " + stringifyException(e),formatter.ERROR);
    return 1;
  }
catch (  Exception e) {
    throw new HiveException(e.toString());
  }
 finally {
    IOUtils.closeStream((FSDataOutputStream)outStream);
  }
  return 0;
}
