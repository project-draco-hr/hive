{
  String tableName=showTblPrpt.getTableName();
  Table tbl=db.getTable(tableName,false);
  try {
    if (tbl == null) {
      String errMsg="Table " + tableName + " does not exist";
      writeToFile(errMsg,showTblPrpt.getResFile());
      return 0;
    }
    LOG.info("DDLTask: show properties for " + tbl.getTableName());
    StringBuilder builder=new StringBuilder();
    String propertyName=showTblPrpt.getPropertyName();
    if (propertyName != null) {
      String propertyValue=tbl.getProperty(propertyName);
      if (propertyValue == null) {
        String errMsg="Table " + tableName + " does not have property: "+ propertyName;
        builder.append(errMsg);
      }
 else {
        builder.append(propertyValue);
      }
    }
 else {
      Map<String,String> properties=tbl.getParameters();
      for (      Entry<String,String> entry : properties.entrySet()) {
        appendNonNull(builder,entry.getKey(),true);
        appendNonNull(builder,entry.getValue());
      }
    }
    LOG.info("DDLTask: written data for showing properties of " + tbl.getTableName());
    writeToFile(builder.toString(),showTblPrpt.getResFile());
  }
 catch (  FileNotFoundException e) {
    LOG.info("show table properties: " + stringifyException(e));
    return 1;
  }
catch (  IOException e) {
    LOG.info("show table properties: " + stringifyException(e));
    return 1;
  }
catch (  Exception e) {
    throw new HiveException(e);
  }
  return 0;
}
