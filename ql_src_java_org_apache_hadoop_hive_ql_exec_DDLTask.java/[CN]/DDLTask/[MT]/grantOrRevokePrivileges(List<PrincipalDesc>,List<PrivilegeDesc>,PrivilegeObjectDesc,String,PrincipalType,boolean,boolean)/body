{
  HiveAuthorizer authorizer=getSessionAuthorizer();
  List<HivePrincipal> hivePrincipals=authorizer.getHivePrincipals(principals);
  List<HivePrivilege> hivePrivileges=authorizer.getHivePrivileges(privileges);
  HivePrivilegeObject hivePrivObject=authorizer.getHivePrivilegeObject(privSubjectDesc);
  HivePrincipal grantorPrincipal=new HivePrincipal(grantor,AuthorizationUtils.getHivePrincipalType(grantorType));
  if (isGrant) {
    authorizer.grantPrivileges(hivePrincipals,hivePrivileges,hivePrivObject,grantorPrincipal,grantOption);
  }
 else {
    authorizer.revokePrivileges(hivePrincipals,hivePrivileges,hivePrivObject,grantorPrincipal,grantOption);
  }
  return 0;
}
