{
  HiveAuthorizer authorizer=getSessionAuthorizer();
  List<HivePrincipal> hivePrincipals=AuthorizationUtils.getHivePrincipals(principals,getAuthorizationTranslator(authorizer));
  List<HivePrivilege> hivePrivileges=AuthorizationUtils.getHivePrivileges(privileges,getAuthorizationTranslator(authorizer));
  HivePrivilegeObject hivePrivObject=getAuthorizationTranslator(authorizer).getHivePrivilegeObject(privSubjectDesc);
  HivePrincipal grantorPrincipal=new HivePrincipal(grantor,AuthorizationUtils.getHivePrincipalType(grantorType));
  if (isGrant) {
    authorizer.grantPrivileges(hivePrincipals,hivePrivileges,hivePrivObject,grantorPrincipal,grantOption);
  }
 else {
    authorizer.revokePrivileges(hivePrincipals,hivePrivileges,hivePrivObject,grantorPrincipal,grantOption);
  }
  return 0;
}
