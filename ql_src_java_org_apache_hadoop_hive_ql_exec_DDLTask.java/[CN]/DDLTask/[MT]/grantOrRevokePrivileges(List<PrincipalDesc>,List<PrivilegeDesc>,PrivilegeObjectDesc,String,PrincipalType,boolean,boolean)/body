{
  HiveAuthorizer authorizer=getSessionAuthorizer();
  List<HivePrincipal> hivePrincipals=AuthorizationUtils.getHivePrincipals(principals);
  List<HivePrivilege> hivePrivileges=AuthorizationUtils.getHivePrivileges(privileges);
  HivePrivilegeObject hivePrivObject=AuthorizationUtils.getHivePrivilegeObject(privSubjectDesc,null);
  HivePrincipal grantorPrincipal=new HivePrincipal(grantor,AuthorizationUtils.getHivePrincipalType(grantorType));
  if (isGrant) {
    authorizer.grantPrivileges(hivePrincipals,hivePrivileges,hivePrivObject,grantorPrincipal,grantOption);
  }
 else {
    authorizer.revokePrivileges(hivePrincipals,hivePrivileges,hivePrivObject,grantorPrincipal,grantOption);
  }
  return 0;
}
