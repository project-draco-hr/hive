{
  if (crtIndex.getSerde() != null) {
    validateSerDe(crtIndex.getSerde());
  }
  String indexTableName=crtIndex.getIndexTableName() != null ? crtIndex.getIndexTableName() : MetaStoreUtils.getIndexTableName(SessionState.get().getCurrentDatabase(),crtIndex.getTableName(),crtIndex.getIndexName());
  if (!Utilities.isDefaultNameNode(conf)) {
    makeLocationQualified(crtIndex,indexTableName);
  }
  db.createIndex(crtIndex.getTableName(),crtIndex.getIndexName(),crtIndex.getIndexTypeHandlerClass(),crtIndex.getIndexedCols(),crtIndex.getIndexTableName(),crtIndex.getDeferredRebuild(),crtIndex.getInputFormat(),crtIndex.getOutputFormat(),crtIndex.getSerde(),crtIndex.getStorageHandler(),crtIndex.getLocation(),crtIndex.getIdxProps(),crtIndex.getTblProps(),crtIndex.getSerdeProps(),crtIndex.getCollItemDelim(),crtIndex.getFieldDelim(),crtIndex.getFieldEscape(),crtIndex.getLineDelim(),crtIndex.getMapKeyDelim(),crtIndex.getIndexComment());
  if (HiveUtils.getIndexHandler(conf,crtIndex.getIndexTypeHandlerClass()).usesIndexTable()) {
    Table indexTable=db.getTable(indexTableName);
    work.getOutputs().add(new WriteEntity(indexTable,WriteEntity.WriteType.DDL_NO_LOCK));
  }
  return 0;
}
