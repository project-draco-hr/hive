{
  String tableName=truncateTableDesc.getTableName();
  Map<String,String> partSpec=truncateTableDesc.getPartSpec();
  Table table=db.getTable(tableName,true);
  FsShell fshell=new FsShell(conf);
  try {
    for (    Path location : getLocations(db,table,partSpec)) {
      fshell.run(new String[]{"-rmr",location.toString()});
      location.getFileSystem(conf).mkdirs(location);
    }
  }
 catch (  Exception e) {
    throw new HiveException(e);
  }
 finally {
    try {
      fshell.close();
    }
 catch (    IOException e) {
    }
  }
  return 0;
}
