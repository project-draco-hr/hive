{
  if (truncateTableDesc.getColumnIndexes() != null) {
    ColumnTruncateWork truncateWork=new ColumnTruncateWork(truncateTableDesc.getColumnIndexes(),truncateTableDesc.getInputDir(),truncateTableDesc.getOutputDir());
    truncateWork.setListBucketingCtx(truncateTableDesc.getLbCtx());
    truncateWork.setMapperCannotSpanPartns(true);
    DriverContext driverCxt=new DriverContext();
    ColumnTruncateTask taskExec=new ColumnTruncateTask();
    taskExec.initialize(queryState,null,driverCxt,null);
    taskExec.setWork(truncateWork);
    taskExec.setQueryPlan(this.getQueryPlan());
    subtask=taskExec;
    return taskExec.execute(driverCxt);
  }
  String tableName=truncateTableDesc.getTableName();
  Map<String,String> partSpec=truncateTableDesc.getPartSpec();
  Table table=db.getTable(tableName,true);
  try {
    for (    Path location : getLocations(db,table,partSpec)) {
      FileSystem fs=location.getFileSystem(conf);
      HdfsUtils.HadoopFileStatus status=new HdfsUtils.HadoopFileStatus(conf,fs,location);
      fs.delete(location,true);
      fs.mkdirs(location);
      try {
        HdfsUtils.setFullFileStatus(conf,status,fs,location);
      }
 catch (      Exception e) {
        LOG.warn("Error setting permissions of " + location,e);
      }
    }
  }
 catch (  Exception e) {
    throw new HiveException(e,ErrorMsg.GENERIC_ERROR);
  }
  return 0;
}
