{
  if (buildIndex) {
    int posn=0;
    while (posn < batch.size) {
      int chunkSize=Math.min(batch.size - posn,rowIndexStride - rowsInIndex);
      treeWriter.writeRootBatch(batch,posn,chunkSize);
      posn+=chunkSize;
      rowsInIndex+=chunkSize;
      rowsInStripe+=chunkSize;
      if (rowsInIndex >= rowIndexStride) {
        createRowIndexEntry();
      }
    }
  }
 else {
    rowsInStripe+=batch.size;
    treeWriter.writeRootBatch(batch,0,batch.size);
  }
  memoryManager.addedRow(batch.size);
}
