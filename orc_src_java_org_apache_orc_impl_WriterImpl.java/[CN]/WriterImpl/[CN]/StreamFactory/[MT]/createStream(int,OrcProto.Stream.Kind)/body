{
  final StreamName name=new StreamName(column,kind);
  final EnumSet<CompressionCodec.Modifier> modifiers;
switch (kind) {
case BLOOM_FILTER:
case DATA:
case DICTIONARY_DATA:
    if (getCompressionStrategy() == OrcFile.CompressionStrategy.SPEED) {
      modifiers=EnumSet.of(CompressionCodec.Modifier.FAST,CompressionCodec.Modifier.TEXT);
    }
 else {
      modifiers=EnumSet.of(CompressionCodec.Modifier.DEFAULT,CompressionCodec.Modifier.TEXT);
    }
  break;
case LENGTH:
case DICTIONARY_COUNT:
case PRESENT:
case ROW_INDEX:
case SECONDARY:
modifiers=EnumSet.of(CompressionCodec.Modifier.FASTEST,CompressionCodec.Modifier.BINARY);
break;
default :
LOG.warn("Missing ORC compression modifiers for " + kind);
modifiers=null;
break;
}
BufferedStream result=streams.get(name);
if (result == null) {
result=new BufferedStream(name.toString(),bufferSize,codec == null ? codec : codec.modify(modifiers));
streams.put(name,result);
}
return result.outStream;
}
