{
  this.configuration=configuration;
  this.mutatorFactory=mutatorFactory;
  this.partitionHelper=partitionHelper;
  this.groupingValidator=groupingValidator;
  this.sequenceValidator=sequenceValidator;
  this.table=table;
  this.deleteDeltaIfExists=deleteDeltaIfExists;
  this.recordInspector=this.mutatorFactory.newRecordInspector();
  bucketIdResolver=this.mutatorFactory.newBucketIdResolver(table.getTotalBuckets());
  bucketId=-1;
  outputFormat=createOutputFormat(table.getOutputFormatName(),configuration);
}
