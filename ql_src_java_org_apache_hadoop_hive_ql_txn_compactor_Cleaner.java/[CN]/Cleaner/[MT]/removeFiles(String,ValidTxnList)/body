{
  AcidUtils.Directory dir=AcidUtils.getAcidState(new Path(location),conf,txnList);
  List<FileStatus> obsoleteDirs=dir.getObsolete();
  List<Path> filesToDelete=new ArrayList<Path>(obsoleteDirs.size());
  for (  FileStatus stat : obsoleteDirs) {
    filesToDelete.add(stat.getPath());
  }
  if (filesToDelete.size() < 1) {
    LOG.warn("Hmm, nothing to delete in the cleaner for directory " + location + ", that hardly seems right.");
    return;
  }
  LOG.info("About to remove " + filesToDelete.size() + " obsolete directories from "+ location);
  FileSystem fs=filesToDelete.get(0).getFileSystem(conf);
  for (  Path dead : filesToDelete) {
    LOG.debug("Doing to delete path " + dead.toString());
    fs.delete(dead,true);
  }
}
