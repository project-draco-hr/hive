{
  ASTNode pSpecAst=null;
  ASTNode dByAst=null;
  if (window.partitionKeys != null && !window.partitionKeys.isEmpty()) {
    dByAst=ASTBuilder.createAST(HiveParser.TOK_DISTRIBUTEBY,"TOK_DISTRIBUTEBY");
    for (    RexNode pk : window.partitionKeys) {
      ASTNode astCol=pk.accept(this);
      dByAst.addChild(astCol);
    }
  }
  ASTNode oByAst=null;
  if (window.orderKeys != null && !window.orderKeys.isEmpty()) {
    oByAst=ASTBuilder.createAST(HiveParser.TOK_ORDERBY,"TOK_ORDERBY");
    for (    RexFieldCollation ok : window.orderKeys) {
      ASTNode astNode=ok.getDirection() == RelFieldCollation.Direction.ASCENDING ? ASTBuilder.createAST(HiveParser.TOK_TABSORTCOLNAMEASC,"TOK_TABSORTCOLNAMEASC") : ASTBuilder.createAST(HiveParser.TOK_TABSORTCOLNAMEDESC,"TOK_TABSORTCOLNAMEDESC");
      ASTNode astCol=ok.left.accept(this);
      astNode.addChild(astCol);
      oByAst.addChild(astNode);
    }
  }
  if (dByAst != null || oByAst != null) {
    pSpecAst=ASTBuilder.createAST(HiveParser.TOK_PARTITIONINGSPEC,"TOK_PARTITIONINGSPEC");
    if (dByAst != null)     pSpecAst.addChild(dByAst);
    if (oByAst != null)     pSpecAst.addChild(oByAst);
  }
  return pSpecAst;
}
