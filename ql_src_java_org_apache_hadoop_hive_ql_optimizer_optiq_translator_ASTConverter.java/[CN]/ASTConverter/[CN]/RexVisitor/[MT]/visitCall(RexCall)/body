{
  if (!deep) {
    return null;
  }
  SqlOperator op=call.getOperator();
  List<ASTNode> astNodeLst=new LinkedList<ASTNode>();
  if (op.kind == SqlKind.CAST) {
    HiveToken ht=TypeConverter.hiveToken(call.getType());
    ASTBuilder astBldr=ASTBuilder.construct(ht.type,ht.text);
    if (ht.args != null) {
      for (      String castArg : ht.args)       astBldr.add(HiveParser.Identifier,castArg);
    }
    astNodeLst.add(astBldr.node());
  }
  for (  RexNode operand : call.operands) {
    astNodeLst.add(operand.accept(this));
  }
  if (isFlat(call))   return SqlFunctionConverter.buildAST(op,astNodeLst,0);
 else   return SqlFunctionConverter.buildAST(op,astNodeLst);
}
