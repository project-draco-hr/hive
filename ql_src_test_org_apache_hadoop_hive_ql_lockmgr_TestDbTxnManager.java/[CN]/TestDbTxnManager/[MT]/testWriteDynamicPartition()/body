{
  WriteEntity we=addDynamicPartitionedOutput(newTable(true),WriteEntity.WriteType.INSERT);
  QueryPlan qp=new MockQueryPlan(this);
  txnMgr.openTxn("fred");
  txnMgr.acquireLocks(qp,ctx,"fred");
  List<HiveLock> locks=ctx.getHiveLocks();
  Assert.assertEquals(1,locks.size());
  ShowLocksResponse rsp=((DbLockManager)txnMgr.getLockManager()).getLocks();
  List<ShowLocksResponseElement> elms=rsp.getLocks();
  Assert.assertEquals(1,elms.size());
  Assert.assertNotNull(elms.get(0).getTablename());
  Assert.assertNull(elms.get(0).getPartname());
  txnMgr.commitTxn();
  locks=txnMgr.getLockManager().getLocks(false,false);
  Assert.assertEquals(0,locks.size());
}
