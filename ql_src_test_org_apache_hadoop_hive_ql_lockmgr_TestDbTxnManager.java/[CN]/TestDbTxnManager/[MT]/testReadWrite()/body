{
  Table t=newTable(true);
  addPartitionInput(t);
  addPartitionInput(t);
  addPartitionInput(t);
  WriteEntity we=addTableOutput(WriteEntity.WriteType.INSERT);
  QueryPlan qp=new MockQueryPlan(this);
  txnMgr.openTxn("fred");
  txnMgr.acquireLocks(qp,ctx,"fred");
  List<HiveLock> locks=ctx.getHiveLocks();
  Assert.assertEquals(1,locks.size());
  Assert.assertEquals(4,TxnDbUtil.countLockComponents(((DbLockManager.DbHiveLock)locks.get(0)).lockId));
  txnMgr.commitTxn();
  locks=txnMgr.getLockManager().getLocks(false,false);
  Assert.assertEquals(0,locks.size());
}
