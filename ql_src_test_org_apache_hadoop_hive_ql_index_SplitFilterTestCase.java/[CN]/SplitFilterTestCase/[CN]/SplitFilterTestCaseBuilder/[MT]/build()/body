{
  List<HiveInputSplit> allSplits=new ArrayList<>();
  List<HiveInputSplit> selectedSplits=new ArrayList<>();
  Set<String> seenPaths=new HashSet<String>();
  for (  MockInputFile inputFile : inputFiles) {
    if (seenPaths.add(inputFile.getPath())) {
      allSplits.addAll(inputFile.getSplits());
      selectedSplits.addAll(inputFile.getSelectedSplits());
    }
 else {
      fail(String.format("Cannot add 2 input files with the same path to a test case. " + "The duplicated path is '%s'.",inputFile.getPath()));
    }
  }
  return new SplitFilterTestCase(allSplits,selectedSplits,expectedSplits,maxInputSize);
}
