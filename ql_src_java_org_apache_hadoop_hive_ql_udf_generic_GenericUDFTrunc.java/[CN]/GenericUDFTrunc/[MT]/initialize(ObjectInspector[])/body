{
  if (arguments.length != 2) {
    throw new UDFArgumentLengthException("trunc() requires 2 argument, got " + arguments.length);
  }
  if (arguments[0].getCategory() != ObjectInspector.Category.PRIMITIVE) {
    throw new UDFArgumentTypeException(0,"Only primitive type arguments are accepted but " + arguments[0].getTypeName() + " is passed. as first arguments");
  }
  if (arguments[1].getCategory() != ObjectInspector.Category.PRIMITIVE) {
    throw new UDFArgumentTypeException(1,"Only primitive type arguments are accepted but " + arguments[1].getTypeName() + " is passed. as second arguments");
  }
  ObjectInspector outputOI=PrimitiveObjectInspectorFactory.writableStringObjectInspector;
  inputType1=((PrimitiveObjectInspector)arguments[0]).getPrimitiveCategory();
switch (inputType1) {
case STRING:
case VARCHAR:
case CHAR:
case VOID:
    inputType1=PrimitiveCategory.STRING;
  textConverter1=ObjectInspectorConverters.getConverter(arguments[0],PrimitiveObjectInspectorFactory.writableStringObjectInspector);
break;
case TIMESTAMP:
timestampConverter=new TimestampConverter((PrimitiveObjectInspector)arguments[0],PrimitiveObjectInspectorFactory.writableTimestampObjectInspector);
break;
case DATE:
dateWritableConverter=ObjectInspectorConverters.getConverter(arguments[0],PrimitiveObjectInspectorFactory.writableDateObjectInspector);
break;
default :
throw new UDFArgumentTypeException(0,"TRUNC() only takes STRING/TIMESTAMP/DATEWRITABLE types as first argument, got " + inputType1);
}
inputType2=((PrimitiveObjectInspector)arguments[1]).getPrimitiveCategory();
if (PrimitiveObjectInspectorUtils.getPrimitiveGrouping(inputType2) != PrimitiveGrouping.STRING_GROUP && PrimitiveObjectInspectorUtils.getPrimitiveGrouping(inputType2) != PrimitiveGrouping.VOID_GROUP) {
throw new UDFArgumentTypeException(1,"trunk() only takes STRING/CHAR/VARCHAR types as second argument, got " + inputType2);
}
inputType2=PrimitiveCategory.STRING;
if (arguments[1] instanceof ConstantObjectInspector) {
Object obj=((ConstantObjectInspector)arguments[1]).getWritableConstantValue();
fmtInput=obj != null ? obj.toString() : null;
}
 else {
textConverter2=ObjectInspectorConverters.getConverter(arguments[1],PrimitiveObjectInspectorFactory.writableStringObjectInspector);
}
return outputOI;
}
