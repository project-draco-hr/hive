{
  if (arguments.length != 2) {
    throw new UDFArgumentLengthException("trunc() requires 2 argument, got " + arguments.length);
  }
  if (arguments[0].get() == null || arguments[1].get() == null) {
    return null;
  }
  if (textConverter2 != null) {
    fmtInput=textConverter2.convert(arguments[1].get()).toString();
  }
  Date date;
switch (inputType1) {
case STRING:
    String dateString=textConverter1.convert(arguments[0].get()).toString();
  try {
    date=formatter.parse(dateString.toString());
  }
 catch (  ParseException e) {
    return null;
  }
break;
case TIMESTAMP:
Timestamp ts=((TimestampWritable)timestampConverter.convert(arguments[0].get())).getTimestamp();
date=ts;
break;
case DATE:
DateWritable dw=(DateWritable)dateWritableConverter.convert(arguments[0].get());
date=dw.get();
break;
default :
throw new UDFArgumentTypeException(0,"TRUNC() only takes STRING/TIMESTAMP/DATEWRITABLE types, got " + inputType1);
}
if (evalDate(date) == null) {
return null;
}
Date newDate=calendar.getTime();
output.set(formatter.format(newDate));
return output;
}
