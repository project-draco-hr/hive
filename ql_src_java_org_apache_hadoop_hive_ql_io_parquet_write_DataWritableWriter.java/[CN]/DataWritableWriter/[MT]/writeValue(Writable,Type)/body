{
  if (type.isPrimitive()) {
    writePrimitive(value);
  }
 else   if (value instanceof ArrayWritable) {
    GroupType groupType=type.asGroupType();
    OriginalType originalType=type.getOriginalType();
    if (originalType != null && originalType.equals(OriginalType.LIST)) {
      writeArray((ArrayWritable)value,groupType);
    }
 else     if (originalType != null && originalType.equals(OriginalType.MAP)) {
      writeMap((ArrayWritable)value,groupType);
    }
 else {
      writeGroup((ArrayWritable)value,groupType);
    }
  }
 else {
    throw new RuntimeException("Field value is not an ArrayWritable object: " + type);
  }
}
