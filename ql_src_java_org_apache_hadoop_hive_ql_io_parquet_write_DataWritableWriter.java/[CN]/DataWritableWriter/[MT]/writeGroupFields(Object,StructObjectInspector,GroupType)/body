{
  if (value != null) {
    List<? extends StructField> fields=inspector.getAllStructFieldRefs();
    List<Object> fieldValuesList=inspector.getStructFieldsDataAsList(value);
    for (int i=0; i < type.getFieldCount(); i++) {
      Type fieldType=type.getType(i);
      String fieldName=fieldType.getName();
      Object fieldValue=fieldValuesList.get(i);
      if (fieldValue != null) {
        ObjectInspector fieldInspector=fields.get(i).getFieldObjectInspector();
        recordConsumer.startField(fieldName,i);
        writeValue(fieldValue,fieldInspector,fieldType);
        recordConsumer.endField(fieldName,i);
      }
    }
  }
}
