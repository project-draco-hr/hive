{
  if (record != null) {
    if (messageWriter == null) {
      try {
        messageWriter=createMessageWriter(record.getObjectInspector(),schema);
      }
 catch (      RuntimeException e) {
        String errorMessage="Parquet record is malformed: " + e.getMessage();
        LOG.error(errorMessage,e);
        throw new RuntimeException(errorMessage,e);
      }
    }
    messageWriter.write(record.getObject());
  }
}
