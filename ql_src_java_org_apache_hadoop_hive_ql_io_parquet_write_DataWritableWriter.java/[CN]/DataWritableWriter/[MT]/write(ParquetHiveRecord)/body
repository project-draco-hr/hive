{
  if (record != null) {
    recordConsumer.startMessage();
    try {
      writeGroupFields(record.getObject(),record.getObjectInspector(),schema);
    }
 catch (    RuntimeException e) {
      String errorMessage="Parquet record is malformed: " + e.getMessage();
      LOG.error(errorMessage,e);
      throw new RuntimeException(errorMessage,e);
    }
    recordConsumer.endMessage();
  }
}
