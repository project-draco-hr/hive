{
  AccumuloConnectionParameters cnxnParams=new AccumuloConnectionParameters(job);
  final String tableName=job.get(AccumuloSerDeParameters.TABLE_NAME);
  Preconditions.checkNotNull(tableName,"Expected Accumulo table name to be provided in job configuration");
  try {
    setAccumuloConnectorInfo(job,cnxnParams.getAccumuloUserName(),new PasswordToken(cnxnParams.getAccumuloPassword()));
    if (cnxnParams.useMockInstance()) {
      setAccumuloMockInstance(job,cnxnParams.getAccumuloInstanceName());
    }
 else {
      setAccumuloZooKeeperInstance(job,cnxnParams.getAccumuloInstanceName(),cnxnParams.getZooKeepers());
    }
    setDefaultAccumuloTableName(job,tableName);
  }
 catch (  AccumuloSecurityException e) {
    log.error("Could not connect to Accumulo with provided credentials",e);
    throw new IOException(e);
  }
}
