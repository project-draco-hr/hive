{
  boolean haveError=false;
  for (  RecordUpdater updater : updaters) {
    if (updater != null) {
      try {
        updater.close(false);
      }
 catch (      Exception ex) {
        haveError=true;
        LOG.error("Unable to close " + updater + " due to: "+ ex.getMessage(),ex);
      }
    }
  }
  updaters.clear();
  if (haveError) {
    throw new StreamingIOFailure("Encountered errors while closing (see logs) " + getWatermark());
  }
}
