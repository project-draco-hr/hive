{
  if (partial == null) {
    return;
  }
  PercentileAggBuf myagg=(PercentileAggBuf)agg;
  ArrayList<DoubleWritable> partialHistogram=(ArrayList<DoubleWritable>)loi.getList(partial);
  int nquantiles=(int)partialHistogram.get(0).get();
  if (nquantiles > 0) {
    myagg.quantiles=new double[nquantiles];
    for (int i=1; i <= nquantiles; i++) {
      myagg.quantiles[i - 1]=partialHistogram.get(i).get();
    }
    partialHistogram.subList(0,nquantiles + 1).clear();
  }
  myagg.histogram.merge(partialHistogram);
}
