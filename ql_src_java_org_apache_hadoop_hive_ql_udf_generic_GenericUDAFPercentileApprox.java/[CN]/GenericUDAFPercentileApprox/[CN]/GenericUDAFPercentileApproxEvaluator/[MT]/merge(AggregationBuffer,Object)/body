{
  if (partial == null) {
    return;
  }
  PercentileAggBuf myagg=(PercentileAggBuf)agg;
  List partialHistogram=(List)loi.getList(partial);
  DoubleObjectInspector doi=(DoubleObjectInspector)loi.getListElementObjectInspector();
  int nquantiles=(int)doi.get(partialHistogram.get(0));
  if (nquantiles > 0) {
    myagg.quantiles=new double[nquantiles];
    for (int i=1; i <= nquantiles; i++) {
      myagg.quantiles[i - 1]=doi.get(partialHistogram.get(i));
    }
    partialHistogram.subList(0,nquantiles + 1).clear();
  }
  myagg.histogram.merge(partialHistogram,doi);
}
