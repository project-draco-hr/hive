{
  if (work.getNumReduceTasks() > 0) {
    int maxReducers=conf.getIntVar(HiveConf.ConfVars.MAXREDUCERS);
    int reducers=(int)((totalSize + targetSize - 1) / targetSize);
    reducers=Math.max(1,reducers);
    reducers=Math.min(maxReducers,reducers);
    work.setNumReduceTasks(reducers);
  }
  work.setMinSplitSize(targetSize);
}
