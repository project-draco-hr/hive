{
  double tmpNDV;
  double maxNDV=1.0;
  InputReferencedVisitor irv;
  RelMetadataQuery mq=RelMetadataQuery.instance();
  for (  RexNode op : call.getOperands()) {
    if (op instanceof RexInputRef) {
      tmpNDV=HiveRelMdDistinctRowCount.getDistinctRowCount(this.childRel,mq,((RexInputRef)op).getIndex());
      if (tmpNDV > maxNDV)       maxNDV=tmpNDV;
    }
 else {
      irv=new InputReferencedVisitor();
      irv.apply(op);
      for (      Integer childProjIndx : irv.inputPosReferenced) {
        tmpNDV=HiveRelMdDistinctRowCount.getDistinctRowCount(this.childRel,mq,childProjIndx);
        if (tmpNDV > maxNDV)         maxNDV=tmpNDV;
      }
    }
  }
  return maxNDV;
}
