{
  Preconditions.checkArgument(numSchedulableTasksConf >= -1,"NumSchedulableTasks must be >=-1");
  this.serviceInstance=serviceInstance;
  this.blacklistConf=blacklistConf;
  this.clock=clock;
  this.metrics=metrics;
  if (numSchedulableTasksConf == 0) {
    int pendingQueueuCapacity=0;
    String pendingQueueCapacityString=serviceInstance.getProperties().get(ConfVars.LLAP_DAEMON_TASK_SCHEDULER_WAIT_QUEUE_SIZE.varname);
    if (LOG.isDebugEnabled()) {
      LOG.debug("Setting up node: " + serviceInstance + ", with available capacity="+ serviceInstance.getResource().getVirtualCores()+ ", pendingQueueCapacity="+ pendingQueueCapacityString);
    }
    if (pendingQueueCapacityString != null) {
      pendingQueueuCapacity=Integer.parseInt(pendingQueueCapacityString);
    }
    this.numSchedulableTasks=serviceInstance.getResource().getVirtualCores() + pendingQueueuCapacity;
  }
 else {
    this.numSchedulableTasks=numSchedulableTasksConf;
  }
  if (metrics != null) {
    metrics.incrSchedulableTasksCount(numSchedulableTasks);
  }
  LOG.info("Setting up node: " + serviceInstance + " with schedulableCapacity="+ this.numSchedulableTasks);
}
