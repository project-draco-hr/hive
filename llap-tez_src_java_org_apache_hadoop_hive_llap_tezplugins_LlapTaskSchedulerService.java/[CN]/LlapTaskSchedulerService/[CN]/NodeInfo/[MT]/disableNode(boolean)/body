{
  long duration=blacklistConf.minDelay;
  long currentTime=clock.getTime();
  this.hadCommFailure=commFailure;
  disabled=true;
  if (numSuccessfulTasksAtLastBlacklist == numSuccessfulTasks) {
    cumulativeBackoffFactor=cumulativeBackoffFactor * blacklistConf.backoffFactor;
  }
 else {
    cumulativeBackoffFactor=1.0f;
  }
  long delayTime=(long)(duration * cumulativeBackoffFactor);
  if (delayTime > blacklistConf.maxDelay) {
    delayTime=blacklistConf.maxDelay;
  }
  if (LOG.isInfoEnabled()) {
    LOG.info("Disabling instance {} for {} milli-seconds. commFailure={}",serviceInstance,delayTime,commFailure);
  }
  expireTimeMillis=currentTime + delayTime;
  numSuccessfulTasksAtLastBlacklist=numSuccessfulTasks;
}
