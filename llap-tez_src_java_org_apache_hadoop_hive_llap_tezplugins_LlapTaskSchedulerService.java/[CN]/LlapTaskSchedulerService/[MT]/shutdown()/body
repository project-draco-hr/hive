{
  writeLock.lock();
  try {
    if (!this.isStopped.getAndSet(true)) {
      nodeEnablerCallable.shutdown();
      if (nodeEnablerFuture != null) {
        nodeEnablerFuture.cancel(true);
      }
      nodeEnabledExecutor.shutdownNow();
      timeoutExecutor.shutdown();
      if (timeoutFuture != null) {
        timeoutFuture.cancel(true);
        timeoutFuture=null;
      }
      timeoutExecutor.shutdownNow();
      schedulerCallable.shutdown();
      if (schedulerFuture != null) {
        schedulerFuture.cancel(true);
      }
      schedulerExecutor.shutdownNow();
      if (registry != null) {
        registry.stop();
      }
    }
  }
  finally {
    writeLock.unlock();
  }
}
