{
  writeLock.lock();
  try {
    NodeInfo nodeInfo=instanceToNodeMap.get(instance.getWorkerIdentity());
    if (nodeInfo == null || nodeInfo.isDisabled()) {
      if (LOG.isDebugEnabled()) {
        LOG.debug("Node: " + instance + " already disabled, or invalid. Not doing anything.");
      }
    }
 else {
      nodeInfo.disableNode(isCommFailure);
      disabledNodesQueue.add(nodeInfo);
      if (metrics != null) {
        metrics.setDisabledNodeCount(disabledNodesQueue.size());
      }
    }
  }
  finally {
    writeLock.unlock();
  }
}
