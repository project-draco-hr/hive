{
  if (numPartitionFields == -1) {
    return random.nextInt();
  }
  if (topLevelFields == null) {
    try {
      if (ho.isPrimitive()) {
        topLevelFields=HiveObject.nlist;
        isPrimitive=true;
      }
 else {
        topLevelFields=ho.getFields();
        isPrimitive=false;
      }
    }
 catch (    HiveException e) {
      throw new RuntimeException("Cannot get Fields from HiveObject");
    }
  }
  int ret=0;
  try {
    if (isPrimitive) {
      return ho.getJavaObject().hashCode();
    }
    int numFields=0;
    for (    SerDeField onef : topLevelFields) {
      Object o=ho.get(onef).getJavaObject();
      ret=ret * 31 + (o == null ? 0 : o.hashCode());
      numFields++;
      if (numFields >= numPartitionFields)       break;
    }
  }
 catch (  HiveException e) {
    e.printStackTrace();
    throw new RuntimeException("HiveObject.get()/getJavaObject() failed");
  }
  return (ret);
}
