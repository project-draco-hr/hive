{
  Class<?> processEnvironmentClass=Class.forName("java.lang.ProcessEnvironment");
  Field theEnvironmentField=processEnvironmentClass.getDeclaredField("theEnvironment");
  theEnvironmentField.setAccessible(true);
  Map<String,String> env=(Map<String,String>)theEnvironmentField.get(null);
  if (value == null) {
    env.remove(key);
  }
 else {
    env.put(key,value);
  }
  Field theCaseInsensitiveEnvironmentField=processEnvironmentClass.getDeclaredField("theCaseInsensitiveEnvironment");
  theCaseInsensitiveEnvironmentField.setAccessible(true);
  Map<String,String> cienv=(Map<String,String>)theCaseInsensitiveEnvironmentField.get(null);
  if (value == null) {
    cienv.remove(key);
  }
 else {
    cienv.put(key,value);
  }
}
