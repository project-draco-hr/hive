{
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  int bufferSize=256 * 1024;
  String columns=getRandomColumnNames(25000);
  conf.set(IOConstants.COLUMNS,columns);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(bufferSize));
  final int newBufferSize;
  if (writer instanceof WriterImpl) {
    WriterImpl orcWriter=(WriterImpl)writer;
    newBufferSize=orcWriter.getEstimatedBufferSize(bufferSize);
    assertEquals(4 * 1024,newBufferSize);
  }
}
