{
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  int bufferSize=128 * 1024;
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(bufferSize));
  final int newBufferSize;
  if (writer instanceof WriterImpl) {
    WriterImpl orcWriter=(WriterImpl)writer;
    newBufferSize=orcWriter.getEstimatedBufferSize(bufferSize);
    assertEquals(bufferSize,newBufferSize);
  }
}
