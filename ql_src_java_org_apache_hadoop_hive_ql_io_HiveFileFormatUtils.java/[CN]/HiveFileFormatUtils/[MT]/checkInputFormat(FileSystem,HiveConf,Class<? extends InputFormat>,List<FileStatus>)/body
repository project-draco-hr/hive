{
  if (files.isEmpty())   return false;
  Class<? extends InputFormatChecker> checkerCls=getInputFormatChecker(inputFormatCls);
  if (checkerCls == null && inputFormatCls.isAssignableFrom(TextInputFormat.class)) {
    return checkTextInputFormat(fs,conf,files);
  }
  if (checkerCls != null) {
    InputFormatChecker checkerInstance=inputFormatCheckerInstanceCache.get(checkerCls);
    try {
      if (checkerInstance == null) {
        checkerInstance=checkerCls.newInstance();
        inputFormatCheckerInstanceCache.put(checkerCls,checkerInstance);
      }
      return checkerInstance.validateInput(fs,conf,files);
    }
 catch (    Exception e) {
      throw new HiveException(e);
    }
  }
  return true;
}
