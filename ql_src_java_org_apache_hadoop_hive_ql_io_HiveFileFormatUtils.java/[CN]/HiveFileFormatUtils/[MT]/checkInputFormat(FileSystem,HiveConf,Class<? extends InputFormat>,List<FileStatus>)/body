{
  if (files.isEmpty())   return false;
  Class<? extends InputFormatChecker> checkerCls=FileChecker.getInstance().getInputFormatCheckerClass(inputFormatCls);
  if (checkerCls == null && inputFormatCls.isAssignableFrom(TextInputFormat.class)) {
    return checkTextInputFormat(fs,conf,files);
  }
  if (checkerCls != null) {
    InputFormatChecker checkerInstance=FileChecker.getInstance().getInputFormatCheckerInstance(checkerCls);
    try {
      if (checkerInstance == null) {
        checkerInstance=checkerCls.newInstance();
        FileChecker.getInstance().putInputFormatCheckerInstance(checkerCls,checkerInstance);
      }
      return checkerInstance.validateInput(fs,conf,files);
    }
 catch (    Exception e) {
      throw new HiveException(e);
    }
  }
  return true;
}
