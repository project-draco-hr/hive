{
  String dirPath=dir.toUri().getPath();
  PartitionDesc part=pathToPartitionInfo.get(dir.toString());
  if (part == null) {
    part=pathToPartitionInfo.get(dirPath);
  }
  if (part == null) {
    Path curPath=new Path(dir.toUri().getPath()).getParent();
    dir=dir.getParent();
    while (dir != null) {
      part=pathToPartitionInfo.get(dir.toString());
      if (part == null) {
        part=pathToPartitionInfo.get(curPath.toString());
      }
      if (part != null) {
        break;
      }
      dir=dir.getParent();
      curPath=curPath.getParent();
    }
  }
  return part;
}
