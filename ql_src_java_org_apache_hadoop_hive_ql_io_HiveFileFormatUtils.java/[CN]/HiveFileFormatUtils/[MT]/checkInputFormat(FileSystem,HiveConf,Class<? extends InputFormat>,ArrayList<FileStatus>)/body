{
  if (files.size() > 0) {
    boolean tableIsSequenceFile=inputFormatCls.equals(SequenceFileInputFormat.class);
    int fileId=0;
    boolean fileIsSequenceFile=true;
    try {
      SequenceFile.Reader reader=new SequenceFile.Reader(fs,files.get(fileId).getPath(),conf);
      reader.close();
    }
 catch (    IOException e) {
      fileIsSequenceFile=false;
    }
    if (!fileIsSequenceFile && tableIsSequenceFile) {
      throw new HiveException("Cannot load text files into a table stored as SequenceFile.");
    }
    if (fileIsSequenceFile && !tableIsSequenceFile) {
      throw new HiveException("Cannot load SequenceFiles into a table stored as TextFile.");
    }
    return true;
  }
  return false;
}
