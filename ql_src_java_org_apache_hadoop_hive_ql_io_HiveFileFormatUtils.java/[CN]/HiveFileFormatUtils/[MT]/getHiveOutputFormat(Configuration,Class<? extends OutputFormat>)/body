{
  OutputFormat<?,?> outputFormat=ReflectionUtil.newInstance(outputClass,conf);
  if (!(outputFormat instanceof HiveOutputFormat)) {
    outputFormat=new HivePassThroughOutputFormat(outputFormat);
  }
  return (HiveOutputFormat<?,?>)outputFormat;
}
