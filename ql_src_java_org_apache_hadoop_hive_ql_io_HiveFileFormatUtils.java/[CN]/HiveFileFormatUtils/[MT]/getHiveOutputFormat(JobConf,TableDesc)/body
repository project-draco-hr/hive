{
  boolean storagehandlerofhivepassthru=false;
  HiveOutputFormat<?,?> hiveOutputFormat;
  try {
    if (tableInfo.getJobProperties() != null) {
      if (tableInfo.getJobProperties().get(HivePassThroughOutputFormat.HIVE_PASSTHROUGH_STORAGEHANDLER_OF_JOBCONFKEY) != null) {
        jc.set(HivePassThroughOutputFormat.HIVE_PASSTHROUGH_STORAGEHANDLER_OF_JOBCONFKEY,tableInfo.getJobProperties().get(HivePassThroughOutputFormat.HIVE_PASSTHROUGH_STORAGEHANDLER_OF_JOBCONFKEY));
        storagehandlerofhivepassthru=true;
      }
    }
    if (storagehandlerofhivepassthru) {
      return ReflectionUtils.newInstance(tableInfo.getOutputFileFormatClass(),jc);
    }
 else {
      return tableInfo.getOutputFileFormatClass().newInstance();
    }
  }
 catch (  Exception e) {
    throw new HiveException(e);
  }
}
