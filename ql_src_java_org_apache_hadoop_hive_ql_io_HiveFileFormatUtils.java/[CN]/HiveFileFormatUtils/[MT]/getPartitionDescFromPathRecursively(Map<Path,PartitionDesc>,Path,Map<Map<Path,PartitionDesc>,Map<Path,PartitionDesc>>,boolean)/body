{
  PartitionDesc part=doGetPartitionDescFromPath(pathToPartitionInfo,dir);
  if (part == null && (ignoreSchema || (dir.toUri().getScheme() == null || dir.toUri().getScheme().trim().equals("")) || FileUtils.pathsContainNoScheme(pathToPartitionInfo.keySet()))) {
    Map<Path,PartitionDesc> newPathToPartitionInfo=null;
    if (cacheMap != null) {
      newPathToPartitionInfo=cacheMap.get(pathToPartitionInfo);
    }
    if (newPathToPartitionInfo == null) {
      newPathToPartitionInfo=populateNewPartitionDesc(pathToPartitionInfo);
      if (cacheMap != null) {
        cacheMap.put(pathToPartitionInfo,newPathToPartitionInfo);
      }
    }
    part=doGetPartitionDescFromPath(newPathToPartitionInfo,dir);
  }
  if (part != null) {
    return part;
  }
 else {
    throw new IOException("cannot find dir = " + dir.toString() + " in pathToPartitionInfo: "+ pathToPartitionInfo.keySet());
  }
}
