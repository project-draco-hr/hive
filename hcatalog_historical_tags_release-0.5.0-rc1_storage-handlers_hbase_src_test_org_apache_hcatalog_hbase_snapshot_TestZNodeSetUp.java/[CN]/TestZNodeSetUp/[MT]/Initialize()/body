{
  hcatConf=getHiveConf();
  hcatConf.set(ConfVars.SEMANTIC_ANALYZER_HOOK.varname,HCatSemanticAnalyzer.class.getName());
  URI fsuri=getFileSystem().getUri();
  Path whPath=new Path(fsuri.getScheme(),fsuri.getAuthority(),getTestDir());
  hcatConf.set(HiveConf.ConfVars.HADOOPFS.varname,fsuri.toString());
  hcatConf.set(ConfVars.METASTOREWAREHOUSE.varname,whPath.toString());
  for (  Map.Entry<String,String> el : getHbaseConf()) {
    if (el.getKey().startsWith("hbase.")) {
      hcatConf.set(el.getKey(),el.getValue());
    }
  }
  HBaseConfiguration.merge(hcatConf,RevisionManagerConfiguration.create());
  hcatConf.set(RMConstants.ZOOKEEPER_DATADIR,"/rm_base");
  SessionState.start(new CliSessionState(hcatConf));
  hcatDriver=new HCatDriver();
}
