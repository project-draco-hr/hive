{
  int[][] tableData={{1,2},{3,4},{5,6}};
  runStatementOnDriver("insert into " + Table.ACIDTBLPART + " partition(p=1) (a,b) "+ makeValuesClause(tableData));
  runStatementOnDriver("insert into " + Table.ACIDTBLPART + " partition(p=2) (a,b) "+ makeValuesClause(tableData));
  TxnStore txnHandler=TxnUtils.getTxnStore(hiveConf);
  txnHandler.compact(new CompactionRequest("default",Table.ACIDTBLPART.name(),CompactionType.MAJOR));
  runWorker(hiveConf);
  runCleaner(hiveConf);
  runStatementOnDriver("update " + Table.ACIDTBLPART + " set b = b + 1 where a = 3");
  txnHandler.compact(new CompactionRequest("default",Table.ACIDTBLPART.toString(),CompactionType.MAJOR));
  runWorker(hiveConf);
  runCleaner(hiveConf);
  List<String> rs=runStatementOnDriver("select p,a,b from " + Table.ACIDTBLPART + " order by p, a, b");
  int[][] expectedData={{1,1,2},{1,3,5},{1,5,6},{2,1,2},{2,3,5},{2,5,6}};
  Assert.assertEquals("Update " + Table.ACIDTBLPART + " didn't match:",stringifyValues(expectedData),rs);
}
