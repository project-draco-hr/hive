{
  open=false;
  transport=new TSocket(store.getHost(),store.getPort());
  ((TSocket)transport).setTimeout(20000);
  TProtocol protocol=new TBinaryProtocol(transport);
  client=new ThriftHiveMetastore.Client(protocol);
  for (int i=0; i < retries && !this.open; ++i) {
    try {
      transport.open();
      open=true;
    }
 catch (    TTransportException e) {
      LOG.warn("failed to connect to MetaStore, re-trying...");
      try {
        Thread.sleep(1000);
      }
 catch (      InterruptedException ignore) {
      }
    }
  }
  if (!open) {
    throw new MetaException("could not connect to meta store");
  }
}
