{
  Map<String,TableMeta> sources=new LinkedHashMap<>();
  Map<String,List<String>> dbTables=new LinkedHashMap<>();
  for (  TableMeta meta : metas) {
    sources.put(meta.getDbName() + "." + meta.getTableName(),meta);
    List<String> tables=dbTables.get(meta.getDbName());
    if (tables == null) {
      dbTables.put(meta.getDbName(),tables=new ArrayList<String>());
    }
    tables.add(meta.getTableName());
  }
  List<TableMeta> filtered=new ArrayList<>();
  for (  Map.Entry<String,List<String>> entry : dbTables.entrySet()) {
    for (    String table : filterHook.filterTableNames(entry.getKey(),entry.getValue())) {
      filtered.add(sources.get(entry.getKey() + "." + table));
    }
  }
  return filtered;
}
