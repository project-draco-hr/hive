{
  for (  URI store : metastoreUris) {
    LOG.info("Trying to connect to HiveMetaStore with URI " + store);
    try {
      openStore(store);
    }
 catch (    MetaException e) {
      LOG.error("Unable to connect to HiveMetaStore with URI " + store,e);
    }
    if (isConnected) {
      LOG.info("Connected to HiveMetaStore with URI " + store);
      break;
    }
  }
  if (!isConnected) {
    throw new MetaException("Could not connect to HiveMetaStore using any of the provided URIs: " + Arrays.asList(metastoreUris));
  }
}
