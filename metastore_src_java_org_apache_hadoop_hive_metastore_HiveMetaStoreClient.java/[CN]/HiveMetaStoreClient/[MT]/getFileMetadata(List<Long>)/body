{
  return new MetastoreMapIterable<Long,ByteBuffer>(){
    private int listIndex=0;
    @Override protected Map<Long,ByteBuffer> fetchNextBatch() throws TException {
      if (listIndex == fileIds.size())       return null;
      int endIndex=Math.min(listIndex + fileMetadataBatchSize,fileIds.size());
      List<Long> subList=fileIds.subList(listIndex,endIndex);
      GetFileMetadataRequest req=new GetFileMetadataRequest();
      req.setFileIds(subList);
      GetFileMetadataResult resp=client.get_file_metadata(req);
      listIndex=endIndex;
      return resp.getMetadata();
    }
  }
;
}
