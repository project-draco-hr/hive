{
  if (objInspector.getCategory() != Category.STRUCT) {
    throw new SerDeException(getClass().toString() + " can only serialize struct types, but we got: " + objInspector.getTypeName());
  }
  serializeByteStream.reset();
  nullMapKey=serializeStruct(serializeByteStream,obj,(StructObjectInspector)objInspector,nullMapKey);
  serializeBytesWritable.set(serializeByteStream.getData(),0,serializeByteStream.getCount());
  serializedSize=serializeByteStream.getCount();
  lastOperationSerialize=true;
  lastOperationDeserialize=false;
  return serializeBytesWritable;
}
