{
  if (heartbeatExecutorService != null && !heartbeatExecutorService.isShutdown() && !heartbeatExecutorService.isTerminated()) {
    return;
  }
  int threadPoolSize=conf.getIntVar(HiveConf.ConfVars.HIVE_TXN_HEARTBEAT_THREADPOOL_SIZE);
  heartbeatExecutorService=Executors.newScheduledThreadPool(threadPoolSize,new ThreadFactory(){
    private final AtomicInteger threadCounter=new AtomicInteger();
    @Override public Thread newThread(    Runnable r){
      return new Thread(r,"Heartbeater-" + threadCounter.getAndIncrement());
    }
  }
);
  ((ScheduledThreadPoolExecutor)heartbeatExecutorService).setRemoveOnCancelPolicy(true);
}
