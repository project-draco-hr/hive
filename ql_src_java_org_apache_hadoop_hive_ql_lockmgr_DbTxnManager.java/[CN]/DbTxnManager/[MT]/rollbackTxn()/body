{
  if (txnId == 0) {
    throw new RuntimeException("Attempt to rollback before opening a " + "transaction");
  }
  try {
    lockMgr.clearLocalLockRecords();
    LOG.debug("Rolling back txn " + txnId);
    client.rollbackTxn(txnId);
  }
 catch (  NoSuchTxnException e) {
    LOG.error("Metastore could not find txn " + txnId);
    throw new LockException(ErrorMsg.TXN_NO_SUCH_TRANSACTION.getMsg(),e);
  }
catch (  TException e) {
    throw new LockException(ErrorMsg.METASTORE_COMMUNICATION_FAILED.getMsg(),e);
  }
 finally {
    txnId=0;
    statementId=-1;
  }
}
