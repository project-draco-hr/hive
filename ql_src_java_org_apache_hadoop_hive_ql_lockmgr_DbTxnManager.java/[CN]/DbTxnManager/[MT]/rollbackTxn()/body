{
  if (!isTxnOpen()) {
    throw new RuntimeException("Attempt to rollback before opening a transaction");
  }
  try {
    lockMgr.clearLocalLockRecords();
    LOG.debug("Rolling back " + JavaUtils.txnIdToString(txnId));
    client.rollbackTxn(txnId);
  }
 catch (  NoSuchTxnException e) {
    LOG.error("Metastore could not find " + JavaUtils.txnIdToString(txnId));
    throw new LockException(e,ErrorMsg.TXN_NO_SUCH_TRANSACTION,JavaUtils.txnIdToString(txnId));
  }
catch (  TException e) {
    throw new LockException(ErrorMsg.METASTORE_COMMUNICATION_FAILED.getMsg(),e);
  }
 finally {
    txnId=0;
    statementId=-1;
  }
}
