{
  init();
  if (isTxnOpen()) {
    throw new LockException("Transaction already opened. " + JavaUtils.txnIdToString(txnId));
  }
  try {
    txnId=client.openTxn(user);
    statementId=0;
    LOG.debug("Opened " + JavaUtils.txnIdToString(txnId));
    return txnId;
  }
 catch (  TException e) {
    throw new LockException(e,ErrorMsg.METASTORE_COMMUNICATION_FAILED);
  }
}
