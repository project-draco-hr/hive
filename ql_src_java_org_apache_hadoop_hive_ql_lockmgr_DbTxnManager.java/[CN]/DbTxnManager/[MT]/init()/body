{
  if (client == null) {
    if (conf == null) {
      throw new RuntimeException("Must call setHiveConf before any other " + "methods.");
    }
    try {
      Hive db=Hive.get(conf);
      client=db.getMSC();
      initHeartbeatExecutorService();
    }
 catch (    MetaException e) {
      throw new LockException(ErrorMsg.METASTORE_COULD_NOT_INITIATE.getMsg(),e);
    }
catch (    HiveException e) {
      throw new LockException(ErrorMsg.METASTORE_COULD_NOT_INITIATE.getMsg(),e);
    }
  }
}
