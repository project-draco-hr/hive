{
  String dirPath=dir.toUri().getPath();
  PartitionDesc part=pathToPartitionInfo.get(dir.toString());
  if (part == null) {
    LOG.warn("exact match not found, try ripping input path's theme and authority");
    part=pathToPartitionInfo.get(dirPath);
  }
  if (part == null) {
    LOG.warn("still does not found just the path part: " + dirPath + " in pathToPartitionInfo."+ " Will try prefix matching");
    for (    Map.Entry<String,PartitionDesc> entry : pathToPartitionInfo.entrySet()) {
      String keyPath=entry.getKey();
      String dirStr=dir.toString();
      if (dirStr.startsWith(keyPath)) {
        part=entry.getValue();
        break;
      }
 else {
        Path p=new Path(entry.getKey());
        String newP=p.toUri().getPath().toString();
        if (dirStr.startsWith(newP)) {
          part=entry.getValue();
          break;
        }
      }
    }
  }
  if (part != null) {
    return part;
  }
 else {
    throw new IOException("cannot find dir = " + dir.toString() + " in partToPartitionInfo: "+ pathToPartitionInfo.keySet());
  }
}
