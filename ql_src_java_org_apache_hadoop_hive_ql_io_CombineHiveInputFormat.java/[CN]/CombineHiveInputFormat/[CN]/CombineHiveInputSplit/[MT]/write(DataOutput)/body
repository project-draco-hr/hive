{
  inputSplitShim.write(out);
  if (inputFormatClassName == null) {
    Map<String,PartitionDesc> pathToPartitionInfo=Utilities.getMapRedWork(getJob()).getPathToPartitionInfo();
    PartitionDesc part=getPartitionDescFromPath(pathToPartitionInfo,inputSplitShim.getPath(0));
    inputFormatClassName=part.getInputFileFormatClass().getName();
  }
  out.writeUTF(inputFormatClassName);
}
