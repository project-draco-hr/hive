{
  inputSplitShim.write(out);
  if (inputFormatClassName == null) {
    Map<String,PartitionDesc> pathToPartitionInfo=Utilities.getMapWork(getJob()).getPathToPartitionInfo();
    PartitionDesc part=HiveFileFormatUtils.getPartitionDescFromPathRecursively(pathToPartitionInfo,inputSplitShim.getPath(0),IOPrepareCache.get().getPartitionDescMap());
    inputFormatClassName=part.getInputFileFormatClass().getName();
  }
  out.writeUTF(inputFormatClassName);
}
