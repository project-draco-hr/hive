{
  inputSplitShim.write(out);
  if (inputFormatClassName == null) {
    Map<String,partitionDesc> pathToPartitionInfo=Utilities.getMapRedWork(getJob()).getPathToPartitionInfo();
    tableDesc table=null;
    try {
      table=getTableDescFromPath(pathToPartitionInfo,inputSplitShim.getPath(0).getParent());
    }
 catch (    IOException e) {
      table=null;
    }
    if (table == null)     table=getTableDescFromPath(pathToPartitionInfo,inputSplitShim.getPath(0));
    inputFormatClassName=table.getInputFileFormatClass().getName();
  }
  out.writeUTF(inputFormatClassName);
}
