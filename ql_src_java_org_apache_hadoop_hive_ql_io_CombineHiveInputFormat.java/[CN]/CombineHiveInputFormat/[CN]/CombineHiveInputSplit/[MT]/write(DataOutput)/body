{
  inputSplitShim.write(out);
  if (inputFormatClassName == null) {
    if (pathToPartitionInfo == null) {
      pathToPartitionInfo=Utilities.getMapWork(getJob()).getPathToPartitionInfo();
    }
    PartitionDesc part=HiveFileFormatUtils.getPartitionDescFromPathRecursively(pathToPartitionInfo,inputSplitShim.getPath(0),IOPrepareCache.get().getPartitionDescMap());
    inputFormatClassName=part.getInputFileFormatClass().getName();
  }
  out.writeUTF(inputFormatClassName);
}
