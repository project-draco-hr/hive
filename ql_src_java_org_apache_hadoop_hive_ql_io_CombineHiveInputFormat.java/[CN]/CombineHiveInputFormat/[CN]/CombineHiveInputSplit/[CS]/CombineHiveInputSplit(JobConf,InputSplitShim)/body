{
  this.inputSplitShim=inputSplitShim;
  if (job != null) {
    Map<String,PartitionDesc> pathToPartitionInfo=Utilities.getMapRedWork(job).getPathToPartitionInfo();
    Path[] ipaths=inputSplitShim.getPaths();
    if (ipaths.length > 0) {
      PartitionDesc part=getPartitionDescFromPath(pathToPartitionInfo,ipaths[0]);
      inputFormatClassName=part.getInputFileFormatClass().getName();
    }
  }
}
