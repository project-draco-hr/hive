{
  this.inputSplitShim=inputSplitShim;
  if (job != null) {
    Map<String,PartitionDesc> pathToPartitionInfo=Utilities.getMapWork(job).getPathToPartitionInfo();
    Path[] ipaths=inputSplitShim.getPaths();
    if (ipaths.length > 0) {
      PartitionDesc part=HiveFileFormatUtils.getPartitionDescFromPathRecursively(pathToPartitionInfo,ipaths[0],IOPrepareCache.get().getPartitionDescMap());
      inputFormatClassName=part.getInputFileFormatClass().getName();
    }
  }
}
