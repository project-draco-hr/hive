{
  HiveConf conf;
  try {
    conf=(HiveConf)context.getConf();
  }
 catch (  ClassCastException e) {
    return ast;
  }
  ConnectionUrlFactory urlFactory=HookUtils.getUrlFactory(conf,FBHiveConf.CONNECTION_FACTORY,FBHiveConf.STATS_CONNECTION_FACTORY,FBHiveConf.STATS_MYSQL_TIER_VAR_NAME,FBHiveConf.STATS_HOST_DATABASE_VAR_NAME);
  String databaseHostName;
  try {
    databaseHostName=urlFactory.getUrl();
  }
 catch (  Exception e) {
    return ast;
  }
  conf.setVar(HiveConf.ConfVars.HIVESTATSDBCONNECTIONSTRING,getUpdatedConnectionString(conf.getVar(HiveConf.ConfVars.HIVESTATSDBCONNECTIONSTRING),databaseHostName));
  return ast;
}
