{
  errorMessage=null;
  SQLState=null;
  int ret=compile(command);
  if (ret != 0) {
    releaseLocks(ctx.getHiveLocks());
    return new CommandProcessorResponse(ret,errorMessage,SQLState);
  }
  ret=acquireReadWriteLocks();
  if (ret != 0) {
    releaseLocks(ctx.getHiveLocks());
    return new CommandProcessorResponse(ret,errorMessage,SQLState);
  }
  ret=execute();
  if (ret != 0) {
    releaseLocks(ctx.getHiveLocks());
    return new CommandProcessorResponse(ret,errorMessage,SQLState);
  }
  releaseLocks(ctx.getHiveLocks());
  return new CommandProcessorResponse(ret);
}
