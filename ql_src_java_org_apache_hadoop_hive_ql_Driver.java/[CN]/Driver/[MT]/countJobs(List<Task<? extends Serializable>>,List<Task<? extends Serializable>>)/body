{
  if (tasks == null) {
    return 0;
  }
  int jobs=0;
  for (  Task<? extends Serializable> task : tasks) {
    if (!seenTasks.contains(task)) {
      seenTasks.add(task);
      if (task instanceof ConditionalTask) {
        jobs+=countJobs(((ConditionalTask)task).getListTasks(),seenTasks);
      }
 else       if (task.isMapRedTask()) {
        jobs++;
      }
      jobs+=countJobs(task.getChildTasks(),seenTasks);
    }
  }
  return jobs;
}
