{
  try {
    if (fetchTask != null) {
      try {
        fetchTask.clearFetch();
      }
 catch (      Exception e) {
        LOG.debug(" Exception while clearing the Fetch task ",e);
      }
      fetchTask=null;
    }
    if (ctx != null) {
      ctx.clear();
      if (ctx.getHiveLocks() != null) {
        hiveLocks.addAll(ctx.getHiveLocks());
        ctx.setHiveLocks(null);
      }
      ctx=null;
    }
    if (null != resStream) {
      try {
        ((FSDataInputStream)resStream).close();
      }
 catch (      Exception e) {
        LOG.debug(" Exception while closing the resStream ",e);
      }
    }
  }
 catch (  Exception e) {
    console.printError("FAILED: Hive Internal Error: " + Utilities.getNameMessage(e) + "\n"+ org.apache.hadoop.util.StringUtils.stringifyException(e));
    return 13;
  }
  return 0;
}
