{
  if (plan != null) {
    close();
    plan=null;
  }
  TaskFactory.resetId();
  try {
    ctx=new Context(conf);
    ParseDriver pd=new ParseDriver();
    ASTNode tree=pd.parse(command);
    while ((tree.getToken() == null) && (tree.getChildCount() > 0)) {
      tree=(ASTNode)tree.getChild(0);
    }
    BaseSemanticAnalyzer sem=SemanticAnalyzerFactory.get(conf,tree);
    sem.analyze(tree,ctx);
    LOG.info("Semantic Analysis Completed");
    sem.validate();
    plan=new QueryPlan(command,sem);
    return (0);
  }
 catch (  SemanticException e) {
    console.printError("FAILED: Error in semantic analysis: " + e.getMessage(),"\n" + org.apache.hadoop.util.StringUtils.stringifyException(e));
    return (10);
  }
catch (  ParseException e) {
    console.printError("FAILED: Parse Error: " + e.getMessage(),"\n" + org.apache.hadoop.util.StringUtils.stringifyException(e));
    return (11);
  }
catch (  Exception e) {
    console.printError("FAILED: Unknown exception : " + e.getMessage(),"\n" + org.apache.hadoop.util.StringUtils.stringifyException(e));
    return (12);
  }
}
