{
  PerfLogger perfLogger=PerfLogger.getPerfLogger();
  perfLogger.PerfLogBegin(CLASS_NAME,PerfLogger.ACQUIRE_READ_WRITE_LOCKS);
  try {
    txnMgr.acquireLocks(plan,ctx,userName);
    return 0;
  }
 catch (  LockException e) {
    errorMessage="FAILED: Error in acquiring locks: " + e.getMessage();
    SQLState=ErrorMsg.findSQLState(e.getMessage());
    downstreamError=e;
    console.printError(errorMessage,"\n" + org.apache.hadoop.util.StringUtils.stringifyException(e));
    return 10;
  }
 finally {
    perfLogger.PerfLogEnd(CLASS_NAME,PerfLogger.ACQUIRE_READ_WRITE_LOCKS);
  }
}
