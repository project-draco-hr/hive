{
  HiveAuthzContext.Builder authzContextBuilder=new HiveAuthzContext.Builder();
  authzContextBuilder.setClientType(ss.isHiveServerQuery() ? CLIENT_TYPE.HIVESERVER2 : CLIENT_TYPE.HIVECLI);
  authzContextBuilder.setUserIpAddress(ss.getUserIpAddress());
  authzContextBuilder.setSessionString(ss.getSessionId());
  authzContextBuilder.setCommandString(command);
  HiveOperationType hiveOpType=getHiveOperationType(op);
  List<HivePrivilegeObject> inputsHObjs=getHivePrivObjects(inputs);
  List<HivePrivilegeObject> outputHObjs=getHivePrivObjects(outputs);
  ss.getAuthorizerV2().checkPrivileges(hiveOpType,inputsHObjs,outputHObjs,authzContextBuilder.build());
  return;
}
