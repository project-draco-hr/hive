{
  String schema="";
  try {
    if (plan != null && plan.getPlan().getFetchTask() != null) {
      BaseSemanticAnalyzer sem=plan.getPlan();
      if (!sem.getFetchTaskInit()) {
        sem.setFetchTaskInit(true);
        sem.getFetchTask().initialize(conf);
      }
      FetchTask ft=(FetchTask)sem.getFetchTask();
      tableDesc td=ft.getTblDesc();
      String tableName="result";
      List<FieldSchema> lst=MetaStoreUtils.getFieldsFromDeserializer(tableName,td.getDeserializer());
      schema=MetaStoreUtils.getFullDDLFromFieldSchema(tableName,lst);
    }
 else {
      schema="struct result { string empty }";
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
    throw e;
  }
  LOG.info("Returning schema: " + schema);
  return schema;
}
