{
  HiveAuthzContext.Builder authzContextBuilder=new HiveAuthzContext.Builder();
  authzContextBuilder.setUserIpAddress(ss.getUserIpAddress());
  authzContextBuilder.setForwardedAddresses(ss.getForwardedAddresses());
  authzContextBuilder.setCommandString(command);
  HiveOperationType hiveOpType=getHiveOperationType(op);
  List<HivePrivilegeObject> inputsHObjs=getHivePrivObjects(inputs,tab2cols);
  List<HivePrivilegeObject> outputHObjs=getHivePrivObjects(outputs,updateTab2Cols);
  ss.getAuthorizerV2().checkPrivileges(hiveOpType,inputsHObjs,outputHObjs,authzContextBuilder.build());
}
