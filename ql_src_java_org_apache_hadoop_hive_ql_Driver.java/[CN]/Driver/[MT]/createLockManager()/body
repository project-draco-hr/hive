{
  if (hiveLockMgr != null) {
    return;
  }
  String lockMgr=conf.getVar(HiveConf.ConfVars.HIVE_LOCK_MANAGER);
  LOG.info("Creating lock manager of type " + lockMgr);
  if ((lockMgr == null) || (lockMgr.isEmpty())) {
    throw new SemanticException(ErrorMsg.LOCKMGR_NOT_SPECIFIED.getMsg());
  }
  try {
    hiveLockMgr=(HiveLockManager)ReflectionUtils.newInstance(conf.getClassByName(lockMgr),conf);
    hiveLockMgr.setContext(new HiveLockManagerCtx(conf));
  }
 catch (  Exception e1) {
    if (hiveLockMgr != null) {
      try {
        hiveLockMgr.close();
      }
 catch (      LockException e2) {
      }
      hiveLockMgr=null;
    }
    throw new SemanticException(ErrorMsg.LOCKMGR_NOT_INITIALIZED.getMsg() + e1.getMessage(),e1);
  }
}
