{
  if (destroyed) {
    return;
  }
  destroyed=true;
  if (ctx != null) {
    try {
      releaseLocksAndCommitOrRollback(ctx.getHiveLocks(),false);
    }
 catch (    LockException e) {
      LOG.warn("Exception when releasing locking in destroy: " + e.getMessage());
    }
  }
}
