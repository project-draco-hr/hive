{
  try {
    ValidTxnList txns=SessionState.get().getTxnMgr().getValidTxns();
    String txnStr=txns.toString();
    conf.set(ValidTxnList.VALID_TXNS_KEY,txnStr);
    LOG.debug("Encoding valid txns info " + txnStr);
    return 0;
  }
 catch (  LockException e) {
    errorMessage="FAILED: Error in determing valid transactions: " + e.getMessage();
    SQLState=ErrorMsg.findSQLState(e.getMessage());
    downstreamError=e;
    console.printError(errorMessage,"\n" + org.apache.hadoop.util.StringUtils.stringifyException(e));
    return 10;
  }
}
