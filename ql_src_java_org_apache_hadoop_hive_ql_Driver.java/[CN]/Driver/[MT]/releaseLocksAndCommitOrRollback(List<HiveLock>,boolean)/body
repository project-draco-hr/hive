{
  PerfLogger perfLogger=PerfLogger.getPerfLogger();
  perfLogger.PerfLogBegin(CLASS_NAME,PerfLogger.RELEASE_LOCKS);
  SessionState ss=SessionState.get();
  HiveTxnManager txnMgr=ss.getTxnMgr();
  if (ss.getCurrentTxn() != SessionState.NO_CURRENT_TXN && ss.isAutoCommit()) {
    try {
      if (commit) {
        txnMgr.commitTxn();
      }
 else {
        txnMgr.rollbackTxn();
      }
    }
  finally {
      ss.setCurrentTxn(SessionState.NO_CURRENT_TXN);
    }
  }
 else {
    if (hiveLocks != null) {
      txnMgr.getLockManager().releaseLocks(hiveLocks);
    }
  }
  ctx.setHiveLocks(null);
  perfLogger.PerfLogEnd(CLASS_NAME,PerfLogger.RELEASE_LOCKS);
}
