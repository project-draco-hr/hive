{
  PerfLogger perfLogger=SessionState.getPerfLogger();
  perfLogger.PerfLogBegin(CLASS_NAME,PerfLogger.RELEASE_LOCKS);
  SessionState ss=SessionState.get();
  HiveTxnManager txnMgr=ss.getTxnMgr();
  if (txnMgr.isTxnOpen()) {
    if (commit) {
      txnMgr.commitTxn();
    }
 else {
      txnMgr.rollbackTxn();
    }
  }
 else {
    if (hiveLocks != null) {
      txnMgr.getLockManager().releaseLocks(hiveLocks);
    }
  }
  ctx.setHiveLocks(null);
  perfLogger.PerfLogEnd(CLASS_NAME,PerfLogger.RELEASE_LOCKS);
}
