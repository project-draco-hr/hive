{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Initializing HCatRecordSerDe");
    HCatUtil.logEntrySet(LOG,"props to serde",tbl.entrySet());
  }
  String columnNameProperty=tbl.getProperty(Constants.LIST_COLUMNS);
  String columnTypeProperty=tbl.getProperty(Constants.LIST_COLUMN_TYPES);
  if (columnNameProperty.length() == 0) {
    columnNames=new ArrayList<String>();
  }
 else {
    columnNames=Arrays.asList(columnNameProperty.split(","));
  }
  if (columnTypeProperty.length() == 0) {
    columnTypes=new ArrayList<TypeInfo>();
  }
 else {
    columnTypes=TypeInfoUtils.getTypeInfosFromTypeString(columnTypeProperty);
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("columns:" + columnNameProperty);
    for (    String s : columnNames) {
      LOG.debug("cn:" + s);
    }
    LOG.debug("types: " + columnTypeProperty);
    for (    TypeInfo t : columnTypes) {
      LOG.debug("ct:" + t.getTypeName() + ",type:"+ t.getCategory());
    }
  }
  assert(columnNames.size() == columnTypes.size());
  rowTypeInfo=(StructTypeInfo)TypeInfoFactory.getStructTypeInfo(columnNames,columnTypes);
  cachedObjectInspector=HCatRecordObjectInspectorFactory.getHCatRecordObjectInspector(rowTypeInfo);
}
