{
  assert(!inner);
  TMap map=new TMap();
  if (columns[index] == null || columns[index].equals(nullString)) {
    index++;
    if (returnNulls) {
      return null;
    }
  }
 else   if (columns[index].isEmpty()) {
    index++;
  }
 else {
    fields=mapPattern.split(columns[index++]);
    map=new TMap(ORDERED_TYPE,ORDERED_TYPE,fields.length / 2);
  }
  innerIndex=0;
  inner=true;
  isMap=true;
  return map;
}
