{
  assert(!inner);
  TMap map=new TMap();
  if (columns[index] == null || columns[index].equals(nullString)) {
    index++;
    if (returnNulls) {
      return null;
    }
    map.size=0;
  }
 else   if (columns[index].isEmpty()) {
    map.size=0;
    index++;
  }
 else {
    fields=mapPattern.split(columns[index++]);
    map.size=fields.length / 2;
  }
  innerIndex=0;
  inner=true;
  isMap=true;
  return map;
}
