{
  RequestManagerForTest requestManager=new RequestManagerForTest(1);
  LlapNodeId nodeId1=LlapNodeId.getInstance("host1",1025);
  LlapNodeId nodeId2=LlapNodeId.getInstance("host2",1025);
  Message mockMessage=mock(Message.class);
  LlapDaemonProtocolClientProxy.ExecuteRequestCallback mockExecuteRequestCallback=mock(LlapDaemonProtocolClientProxy.ExecuteRequestCallback.class);
  requestManager.queueRequest(new CallableRequestForTest(nodeId1,mockMessage,mockExecuteRequestCallback));
  requestManager.queueRequest(new CallableRequestForTest(nodeId2,mockMessage,mockExecuteRequestCallback));
  requestManager.process();
  assertEquals(2,requestManager.numSubmissionsCounters);
  assertNotNull(requestManager.numInvocationsPerNode.get(nodeId1));
  assertNotNull(requestManager.numInvocationsPerNode.get(nodeId2));
  assertEquals(1,requestManager.numInvocationsPerNode.get(nodeId1).getValue().intValue());
  assertEquals(1,requestManager.numInvocationsPerNode.get(nodeId2).getValue().intValue());
  assertEquals(0,requestManager.currentLoopSkippedRequests.size());
  assertEquals(0,requestManager.currentLoopSkippedRequests.size());
  assertEquals(0,requestManager.currentLoopDisabledNodes.size());
}
