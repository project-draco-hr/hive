{
  int size=mergeMapOpList.size() + 1;
  sources=new MapRecordSource[size];
  KeyValueReader reader=legacyMRInput.getReader();
  position=mapOp.getConf().getTag();
  sources[position]=new MapRecordSource();
  sources[position].init(jconf,mapOp,reader);
  for (  MapOperator mapOp : mergeMapOpList) {
    int tag=mapOp.getConf().getTag();
    sources[tag]=new MapRecordSource();
    String inputName=mapOp.getConf().getName();
    MultiMRInput multiMRInput=multiMRInputMap.get(inputName);
    Collection<KeyValueReader> kvReaders=multiMRInput.getKeyValueReaders();
    l4j.debug("There are " + kvReaders.size() + " key-value readers for input "+ inputName);
    List<KeyValueReader> kvReaderList=new ArrayList<KeyValueReader>(kvReaders);
    reader=new KeyValueInputMerger(kvReaderList);
    sources[tag].init(jconf,mapOp,reader);
  }
  ((TezContext)MapredContext.get()).setRecordSources(sources);
}
