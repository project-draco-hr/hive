{
  ObjectCache cache=ObjectCacheFactory.getCache(jconf);
  execContext=new ExecMapperContext(jconf);
  execContext.setJc(jconf);
  cacheKeys=new ArrayList<String>();
  String queryId=HiveConf.getVar(jconf,HiveConf.ConfVars.HIVEQUERYID);
  String key=queryId + MAP_PLAN_KEY;
  cacheKeys.add(key);
  mapWork=(MapWork)cache.retrieve(key,new Callable<Object>(){
    public Object call(){
      return Utilities.getMapWork(jconf);
    }
  }
);
  Utilities.setMapWork(jconf,mapWork);
  String prefixes=jconf.get(DagUtils.TEZ_MERGE_WORK_FILE_PREFIXES);
  if (prefixes != null) {
    mergeWorkList=new ArrayList<MapWork>();
    for (    final String prefix : prefixes.split(",")) {
      if (prefix == null || prefix.isEmpty()) {
        continue;
      }
      key=queryId + prefix;
      cacheKeys.add(key);
      mergeWorkList.add((MapWork)cache.retrieve(key,new Callable<Object>(){
        public Object call(){
          return Utilities.getMergeWork(jconf,prefix);
        }
      }
));
    }
  }
}
