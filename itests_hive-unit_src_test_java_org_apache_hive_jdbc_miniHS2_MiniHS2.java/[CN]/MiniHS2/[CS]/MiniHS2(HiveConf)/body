{
  super(hiveConf,"localhost",MetaStoreUtils.findFreePort(),MetaStoreUtils.findFreePort());
  baseDir=Files.createTempDir();
  setWareHouseDir("file://" + baseDir.getPath() + File.separator+ "warehouse");
  String metaStoreURL="jdbc:derby:" + baseDir.getAbsolutePath() + File.separator+ "test_metastore-"+ hs2Counter.incrementAndGet()+ ";create=true";
  System.setProperty(HiveConf.ConfVars.METASTORECONNECTURLKEY.varname,metaStoreURL);
  hiveConf.setVar(HiveConf.ConfVars.METASTORECONNECTURLKEY,metaStoreURL);
  hiveConf.setVar(ConfVars.HIVE_SERVER2_TRANSPORT_MODE,HS2_BINARY_MODE);
  hiveConf.setVar(ConfVars.HIVE_SERVER2_THRIFT_BIND_HOST,getHost());
  hiveConf.setIntVar(ConfVars.HIVE_SERVER2_THRIFT_PORT,getBinaryPort());
  hiveConf.setIntVar(ConfVars.HIVE_SERVER2_THRIFT_HTTP_PORT,getHttpPort());
  HiveMetaStore.HMSHandler.resetDefaultDBFlag();
}
