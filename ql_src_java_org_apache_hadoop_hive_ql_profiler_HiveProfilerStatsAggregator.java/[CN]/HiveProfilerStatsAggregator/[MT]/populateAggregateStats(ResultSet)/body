{
  try {
    while (result.next()) {
      String levelAnnoName=result.getString(HiveProfilerStats.Columns.LEVEL_ANNO_NAME);
      Long curInclTime=result.getLong(HiveProfilerStats.Columns.INCL_TIME) / 1000;
      Long curCallCount=result.getLong(HiveProfilerStats.Columns.CALL_COUNT);
      totalTime+=curInclTime;
      if (curInclTime != null && curCallCount != null) {
        HiveProfilerAggregateStat curStat;
        if (stats.containsKey(levelAnnoName)) {
          curStat=stats.get(levelAnnoName);
          curStat.update(curInclTime,curCallCount);
        }
 else {
          curStat=new HiveProfilerAggregateStat(curInclTime,curCallCount);
        }
        stats.put(levelAnnoName,curStat);
      }
    }
  }
 catch (  Exception e) {
    LOG.error("Error Aggregating Stats",e);
  }
}
