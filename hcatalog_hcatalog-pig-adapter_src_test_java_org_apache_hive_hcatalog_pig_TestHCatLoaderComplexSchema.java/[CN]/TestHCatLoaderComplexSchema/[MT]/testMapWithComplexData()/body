{
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  String pigSchema="a: long, b: map[]";
  String tableSchema="a bigint, b map<string, struct<aa:bigint, ab:string>>";
  List<Tuple> data=new ArrayList<Tuple>();
  for (int i=0; i < 10; i++) {
    Tuple t=t((long)i,new HashMap<String,Object>(){
{
        put("b test 1",t(1l,"test 1"));
        put("b test 2",t(2l,"test 2"));
      }
    }
);
    data.add(t);
  }
  verifyWriteRead("testMapWithComplexData",pigSchema,tableSchema,data,true);
  verifyWriteRead("testMapWithComplexData2",pigSchema,tableSchema,data,false);
}
