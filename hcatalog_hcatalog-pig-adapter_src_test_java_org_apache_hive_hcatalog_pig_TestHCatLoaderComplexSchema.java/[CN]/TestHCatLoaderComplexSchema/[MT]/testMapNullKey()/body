{
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  String pigSchema="m:map[]";
  String tableSchema="m map<string, string>";
  List<Tuple> data=new ArrayList<Tuple>();
  Tuple t=t(new HashMap<String,String>(){
{
      put("ac test1","test 1");
      put("ac test2","test 2");
      put(null,"test 3");
    }
  }
);
  data.add(t);
  List<Tuple> result=new ArrayList<Tuple>();
  t=t(new HashMap<String,String>(){
{
      put("ac test1","test 1");
      put("ac test2","test 2");
    }
  }
);
  result.add(t);
  verifyWriteRead("testSyntheticComplexSchema",pigSchema,tableSchema,data,result,true);
  verifyWriteRead("testSyntheticComplexSchema",pigSchema,tableSchema,data,result,false);
}
