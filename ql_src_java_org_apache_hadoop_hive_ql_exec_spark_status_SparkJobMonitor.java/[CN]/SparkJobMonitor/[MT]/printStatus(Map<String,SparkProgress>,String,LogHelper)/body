{
  StringBuffer reportBuffer=new StringBuffer();
  SortedSet<String> keys=new TreeSet<String>(progressMap.keySet());
  for (  String s : keys) {
    SparkProgress progress=progressMap.get(s);
    final int complete=progress.getSucceededTaskCount();
    final int total=progress.getTotalTaskCount();
    final int running=progress.getRunningTaskCount();
    final int failed=progress.getFailedTaskCount();
    if (total <= 0) {
      reportBuffer.append(String.format("%s: -/-\t",s,complete,total));
    }
 else {
      if (complete == total && !completed.contains(s)) {
        completed.add(s);
      }
      if (complete < total && (complete > 0 || running > 0 || failed > 0)) {
        if (failed > 0) {
          reportBuffer.append(String.format("%s: %d(+%d,-%d)/%d\t",s,complete,running,failed,total));
        }
 else {
          reportBuffer.append(String.format("%s: %d(+%d)/%d\t",s,complete,running,total));
        }
      }
 else {
        if (failed > 0) {
          reportBuffer.append(String.format("%s: %d(-%d)/%d\t",s,complete,failed,total));
        }
 else {
          reportBuffer.append(String.format("%s: %d/%d\t",s,complete,total));
        }
      }
    }
  }
  String report=reportBuffer.toString();
  if (!report.equals(lastReport) || System.currentTimeMillis() >= lastPrintTime + printInterval) {
    console.printInfo(report);
    lastPrintTime=System.currentTimeMillis();
  }
  return report;
}
