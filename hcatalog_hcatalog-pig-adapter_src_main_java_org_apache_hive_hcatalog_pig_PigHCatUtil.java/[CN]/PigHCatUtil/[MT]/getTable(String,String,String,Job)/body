{
  Pair<String,String> loc_server=new Pair<String,String>(location,hcatServerUri);
  Table hcatTable=hcatTableCache.get(loc_server);
  if (hcatTable != null) {
    return hcatTable;
  }
  Pair<String,String> dbTablePair=PigHCatUtil.getDBTableNames(location);
  String dbName=dbTablePair.first;
  String tableName=dbTablePair.second;
  Table table=null;
  IMetaStoreClient client=null;
  try {
    client=getHiveMetaClient(hcatServerUri,hcatServerPrincipal,PigHCatUtil.class,job);
    table=HCatUtil.getTable(client,dbName,tableName);
  }
 catch (  NoSuchObjectException nsoe) {
    throw new PigException("Table not found : " + nsoe.getMessage(),PIG_EXCEPTION_CODE);
  }
catch (  Exception e) {
    throw new IOException(e);
  }
 finally {
    HCatUtil.closeHiveClientQuietly(client);
  }
  hcatTableCache.put(loc_server,table);
  return table;
}
