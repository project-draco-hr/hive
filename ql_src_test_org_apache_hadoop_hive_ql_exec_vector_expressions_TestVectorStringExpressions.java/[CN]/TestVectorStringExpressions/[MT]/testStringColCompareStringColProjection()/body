{
  VectorizedRowBatch batch;
  VectorExpression expr;
  long[] outVector;
  batch=makeStringBatchForColColCompare();
  expr=new StringGroupColLessStringGroupColumn(0,1,3);
  expr.evaluate(batch);
  Assert.assertEquals(4,batch.size);
  outVector=((LongColumnVector)batch.cols[3]).vector;
  Assert.assertFalse(batch.cols[3].isNull[0]);
  Assert.assertEquals(1,outVector[0]);
  Assert.assertFalse(batch.cols[3].isNull[1]);
  Assert.assertEquals(0,outVector[1]);
  Assert.assertFalse(batch.cols[3].isNull[2]);
  Assert.assertEquals(0,outVector[2]);
  Assert.assertTrue(batch.cols[3].isNull[3]);
  batch=makeStringBatchForColColCompare();
  batch.cols[0].noNulls=true;
  batch.cols[1].noNulls=true;
  expr.evaluate(batch);
  Assert.assertEquals(4,batch.size);
  outVector=((LongColumnVector)batch.cols[3]).vector;
  Assert.assertTrue(batch.cols[3].noNulls);
  Assert.assertFalse(batch.cols[3].isNull[0]);
  Assert.assertEquals(1,outVector[0]);
  Assert.assertFalse(batch.cols[3].isNull[1]);
  Assert.assertEquals(0,outVector[1]);
  Assert.assertFalse(batch.cols[3].isNull[2]);
  Assert.assertEquals(0,outVector[2]);
  Assert.assertFalse(batch.cols[3].isNull[3]);
  Assert.assertEquals(1,outVector[3]);
  batch=makeStringBatchForColColCompare();
  batch.cols[1].noNulls=true;
  expr.evaluate(batch);
  Assert.assertEquals(4,batch.size);
  outVector=((LongColumnVector)batch.cols[3]).vector;
  Assert.assertFalse(batch.cols[3].isNull[0]);
  Assert.assertEquals(1,outVector[0]);
  Assert.assertFalse(batch.cols[3].isNull[1]);
  Assert.assertEquals(0,outVector[1]);
  Assert.assertFalse(batch.cols[3].isNull[2]);
  Assert.assertEquals(0,outVector[2]);
  Assert.assertTrue(batch.cols[3].isNull[3]);
  batch=makeStringBatchForColColCompare();
  batch.cols[0].noNulls=true;
  batch.cols[1].isNull[3]=true;
  expr.evaluate(batch);
  Assert.assertEquals(4,batch.size);
  outVector=((LongColumnVector)batch.cols[3]).vector;
  Assert.assertFalse(batch.cols[3].noNulls);
  Assert.assertFalse(batch.cols[3].isNull[0]);
  Assert.assertEquals(1,outVector[0]);
  Assert.assertFalse(batch.cols[3].isNull[1]);
  Assert.assertEquals(0,outVector[1]);
  Assert.assertFalse(batch.cols[3].isNull[2]);
  Assert.assertEquals(0,outVector[2]);
  Assert.assertTrue(batch.cols[3].isNull[3]);
  batch=makeStringBatchForColColCompare();
  batch.cols[0].isRepeating=true;
  expr.evaluate(batch);
  Assert.assertEquals(4,batch.size);
  outVector=((LongColumnVector)batch.cols[3]).vector;
  Assert.assertFalse(batch.cols[3].isNull[0]);
  Assert.assertEquals(1,outVector[0]);
  Assert.assertFalse(batch.cols[3].isNull[1]);
  Assert.assertEquals(1,outVector[1]);
  Assert.assertFalse(batch.cols[3].isNull[2]);
  Assert.assertEquals(0,outVector[2]);
  Assert.assertFalse(batch.cols[3].isNull[3]);
  Assert.assertEquals(1,outVector[3]);
  batch=makeStringBatchForColColCompare();
  batch.cols[1].isRepeating=true;
  expr.evaluate(batch);
  Assert.assertEquals(4,batch.size);
  outVector=((LongColumnVector)batch.cols[3]).vector;
  Assert.assertFalse(batch.cols[3].noNulls);
  Assert.assertFalse(batch.cols[3].isNull[0]);
  Assert.assertEquals(1,outVector[0]);
  Assert.assertFalse(batch.cols[3].isNull[1]);
  Assert.assertEquals(1,outVector[1]);
  Assert.assertFalse(batch.cols[3].isNull[2]);
  Assert.assertEquals(0,outVector[2]);
  Assert.assertTrue(batch.cols[3].isNull[3]);
  batch=makeStringBatchForColColCompare();
  batch.cols[0].isRepeating=true;
  batch.cols[1].isRepeating=true;
  expr.evaluate(batch);
  Assert.assertEquals(4,batch.size);
  outVector=((LongColumnVector)batch.cols[3]).vector;
  Assert.assertTrue(batch.cols[3].isRepeating);
  Assert.assertFalse(batch.cols[3].isNull[0]);
  Assert.assertEquals(1,outVector[0]);
  batch=makeStringBatchForColColCompare();
  batch.cols[0].isRepeating=true;
  batch.cols[1].noNulls=true;
  expr.evaluate(batch);
  outVector=((LongColumnVector)batch.cols[3]).vector;
  Assert.assertEquals(4,batch.size);
  Assert.assertFalse(batch.cols[3].noNulls);
  Assert.assertFalse(batch.cols[3].isNull[0]);
  Assert.assertEquals(1,outVector[0]);
  Assert.assertFalse(batch.cols[3].isNull[1]);
  Assert.assertEquals(1,outVector[1]);
  Assert.assertFalse(batch.cols[3].isNull[2]);
  Assert.assertEquals(0,outVector[2]);
  Assert.assertFalse(batch.cols[3].isNull[3]);
  Assert.assertEquals(1,outVector[3]);
  batch=makeStringBatchForColColCompare();
  batch.cols[0].isRepeating=true;
  batch.cols[1].noNulls=true;
  batch.cols[0].isNull[0]=true;
  expr.evaluate(batch);
  Assert.assertEquals(4,batch.size);
  Assert.assertFalse(batch.cols[3].noNulls);
  Assert.assertTrue(batch.cols[3].isRepeating);
  Assert.assertTrue(batch.cols[3].isNull[0]);
  batch=makeStringBatchForColColCompare();
  batch.cols[1].isRepeating=true;
  batch.cols[1].noNulls=true;
  expr.evaluate(batch);
  outVector=((LongColumnVector)batch.cols[3]).vector;
  Assert.assertEquals(4,batch.size);
  Assert.assertFalse(batch.cols[3].noNulls);
  Assert.assertFalse(batch.cols[3].isNull[0]);
  Assert.assertEquals(1,outVector[0]);
  Assert.assertFalse(batch.cols[3].isNull[1]);
  Assert.assertEquals(1,outVector[1]);
  Assert.assertFalse(batch.cols[3].isNull[2]);
  Assert.assertEquals(0,outVector[2]);
  Assert.assertTrue(batch.cols[3].isNull[3]);
  batch=makeStringBatchForColColCompare();
  batch.cols[0].isRepeating=true;
  batch.cols[1].isRepeating=true;
  batch.cols[1].noNulls=true;
  expr.evaluate(batch);
  Assert.assertEquals(4,batch.size);
  outVector=((LongColumnVector)batch.cols[3]).vector;
  Assert.assertTrue(batch.cols[3].isRepeating);
  Assert.assertFalse(batch.cols[3].isNull[0]);
  Assert.assertEquals(1,outVector[0]);
  batch=makeStringBatchForColColCompare();
  batch.cols[0].isRepeating=true;
  batch.cols[0].noNulls=true;
  batch.cols[1].isNull[0]=true;
  expr.evaluate(batch);
  outVector=((LongColumnVector)batch.cols[3]).vector;
  Assert.assertEquals(4,batch.size);
  Assert.assertFalse(batch.cols[3].noNulls);
  Assert.assertTrue(batch.cols[3].isNull[0]);
  Assert.assertFalse(batch.cols[3].isNull[1]);
  Assert.assertEquals(1,outVector[1]);
  Assert.assertFalse(batch.cols[3].isNull[2]);
  Assert.assertEquals(0,outVector[2]);
  Assert.assertFalse(batch.cols[3].isNull[3]);
  Assert.assertEquals(1,outVector[3]);
  batch=makeStringBatchForColColCompare();
  batch.cols[1].isRepeating=true;
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outVector=((LongColumnVector)batch.cols[3]).vector;
  Assert.assertEquals(4,batch.size);
  Assert.assertFalse(batch.cols[3].noNulls);
  Assert.assertFalse(batch.cols[3].isNull[0]);
  Assert.assertEquals(1,outVector[0]);
  Assert.assertFalse(batch.cols[3].isNull[1]);
  Assert.assertEquals(1,outVector[1]);
  Assert.assertFalse(batch.cols[3].isNull[2]);
  Assert.assertEquals(0,outVector[2]);
  Assert.assertFalse(batch.cols[3].isNull[3]);
  Assert.assertEquals(1,outVector[3]);
  batch=makeStringBatchForColColCompare();
  batch.cols[1].isRepeating=true;
  batch.cols[0].noNulls=true;
  batch.cols[1].isNull[0]=true;
  expr.evaluate(batch);
  Assert.assertEquals(4,batch.size);
  Assert.assertFalse(batch.cols[3].noNulls);
  Assert.assertTrue(batch.cols[3].isRepeating);
  Assert.assertTrue(batch.cols[3].isNull[0]);
  batch=makeStringBatchForColColCompare();
  batch.cols[0].isRepeating=true;
  batch.cols[1].isRepeating=true;
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  Assert.assertEquals(4,batch.size);
  outVector=((LongColumnVector)batch.cols[3]).vector;
  Assert.assertTrue(batch.cols[3].isRepeating);
  Assert.assertFalse(batch.cols[3].isNull[0]);
  Assert.assertEquals(1,outVector[0]);
  batch=makeStringBatchForColColCompare();
  batch.cols[0].isRepeating=true;
  batch.cols[1].isRepeating=true;
  batch.cols[0].noNulls=true;
  batch.cols[1].isNull[0]=true;
  expr.evaluate(batch);
  Assert.assertEquals(4,batch.size);
  Assert.assertFalse(batch.cols[3].noNulls);
  Assert.assertTrue(batch.cols[3].isRepeating);
  Assert.assertTrue(batch.cols[3].isNull[0]);
}
