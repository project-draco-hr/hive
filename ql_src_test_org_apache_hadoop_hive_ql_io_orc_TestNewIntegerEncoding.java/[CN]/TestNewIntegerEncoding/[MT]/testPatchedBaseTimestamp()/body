{
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(TSRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000));
  List<Timestamp> tslist=Lists.newArrayList();
  tslist.add(Timestamp.valueOf("9999-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2003-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("1999-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("1995-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2002-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2010-03-02 00:00:00"));
  tslist.add(Timestamp.valueOf("2005-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2006-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2003-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("1996-08-02 00:00:00"));
  tslist.add(Timestamp.valueOf("1998-11-02 00:00:00"));
  tslist.add(Timestamp.valueOf("2008-10-02 00:00:00"));
  tslist.add(Timestamp.valueOf("1993-08-02 00:00:00"));
  tslist.add(Timestamp.valueOf("2008-01-02 00:00:00"));
  tslist.add(Timestamp.valueOf("2007-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2004-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2008-10-02 00:00:00"));
  tslist.add(Timestamp.valueOf("2003-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2004-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2008-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2005-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("1994-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2006-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2004-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2001-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2000-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2000-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2002-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2006-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2011-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2002-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2005-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("1974-01-01 00:00:00"));
  for (  Timestamp ts : tslist) {
    writer.addRow(new TSRow(ts));
  }
  writer.close();
  Reader reader=OrcFile.createReader(fs,testFilePath,conf);
  RecordReader rows=reader.rows(null);
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(tslist.get(idx++).getNanos(),((Timestamp)((OrcStruct)row).getFieldValue(0)).getNanos());
  }
}
