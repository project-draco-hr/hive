{
  try {
    TaskAttemptID taskAttemptID=TaskAttemptID.forName(jobConf.get("mapred.task.id"));
    if (taskAttemptID == null) {
      taskAttemptID=new TaskAttemptID();
    }
    taskContext=ContextUtil.newTaskAttemptContext(jobConf,taskAttemptID);
    LOG.info("creating real writer to write at " + name);
    String compressionName=tableProperties.getProperty(ParquetOutputFormat.COMPRESSION);
    if (compressionName != null && !compressionName.isEmpty()) {
      LOG.debug("get override compression properties via tblproperties");
      ContextUtil.getConfiguration(taskContext);
      CompressionCodecName codecName=CompressionCodecName.fromConf(compressionName);
      realWriter=((ParquetOutputFormat)realOutputFormat).getRecordWriter(jobConf,new Path(name),codecName);
    }
 else {
      realWriter=((ParquetOutputFormat)realOutputFormat).getRecordWriter(taskContext,new Path(name));
    }
    LOG.info("real writer: " + realWriter);
  }
 catch (  final InterruptedException e) {
    throw new IOException(e);
  }
}
