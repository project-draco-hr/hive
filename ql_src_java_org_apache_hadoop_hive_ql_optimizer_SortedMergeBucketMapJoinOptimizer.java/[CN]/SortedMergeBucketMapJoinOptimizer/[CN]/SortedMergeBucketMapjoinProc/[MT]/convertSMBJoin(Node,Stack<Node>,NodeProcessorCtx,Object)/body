{
  if (nd instanceof SMBMapJoinOperator) {
    return false;
  }
  MapJoinOperator mapJoinOp=(MapJoinOperator)nd;
  if (mapJoinOp.getConf().getAliasBucketFileNameMapping() == null || mapJoinOp.getConf().getAliasBucketFileNameMapping().size() == 0) {
    return false;
  }
  boolean tableSorted=true;
  QBJoinTree joinCxt=this.pGraphContext.getMapJoinContext().get(mapJoinOp);
  if (joinCxt == null) {
    return false;
  }
  String[] srcs=joinCxt.getBaseSrc();
  int pos=0;
  List<Order> sortColumnsFirstTable=new ArrayList<Order>();
  for (  String src : srcs) {
    tableSorted=tableSorted && isTableSorted(this.pGraphContext,mapJoinOp,joinCxt,src,pos,sortColumnsFirstTable);
    pos++;
  }
  if (!tableSorted) {
    MapJoinProcessor.checkMapJoin(((MapJoinOperator)nd).getConf().getPosBigTable(),((MapJoinOperator)nd).getConf().getConds());
    return false;
  }
  convertToSMBJoin(mapJoinOp,srcs);
  return true;
}
