{
  if (nd instanceof SMBMapJoinOperator) {
    return false;
  }
  MapJoinOperator mapJoinOp=(MapJoinOperator)nd;
  if (mapJoinOp.getConf().getAliasBucketFileNameMapping() == null || mapJoinOp.getConf().getAliasBucketFileNameMapping().size() == 0) {
    return false;
  }
  boolean tableSorted=true;
  QBJoinTree joinCxt=this.pGraphContext.getMapJoinContext().get(mapJoinOp);
  if (joinCxt == null) {
    return false;
  }
  String[] srcs=joinCxt.getBaseSrc();
  for (int srcPos=0; srcPos < srcs.length; srcPos++) {
    srcs[srcPos]=QB.getAppendedAliasFromId(joinCxt.getId(),srcs[srcPos]);
  }
  List<Order> sortColumnsFirstTable=new ArrayList<Order>();
  for (int pos=0; pos < srcs.length; pos++) {
    tableSorted=tableSorted && isTableSorted(this.pGraphContext,mapJoinOp,joinCxt,pos,sortColumnsFirstTable,srcs);
  }
  if (!tableSorted) {
    MapJoinProcessor.checkMapJoin(((MapJoinOperator)nd).getConf().getPosBigTable(),((MapJoinOperator)nd).getConf().getConds());
    return false;
  }
  convertToSMBJoin(mapJoinOp,srcs);
  return true;
}
