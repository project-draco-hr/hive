{
  if (ShimLoader.getHadoopShims().isLocalMode(hconf)) {
    return localWork.getTmpPath();
  }
  Path[] localArchives=DistributedCache.getLocalCacheArchives(hconf);
  if (localArchives != null) {
    String stageID=localWork.getStageID();
    String suffix=Utilities.generateTarFileName(stageID);
    FileSystem localFs=FileSystem.getLocal(hconf);
    for (int j=0; j < localArchives.length; j++) {
      Path archive=localArchives[j];
      if (!archive.getName().endsWith(suffix)) {
        continue;
      }
      return archive.makeQualified(localFs);
    }
  }
  return null;
}
