{
  final Writable[] a1Arr=a1.get();
  final Writable[] a2Arr=a2.get();
  if (a1Arr.length != a2Arr.length) {
    return false;
  }
  for (int i=0; i < a1Arr.length; ++i) {
    if (a1Arr[i] instanceof ArrayWritable) {
      if (!(a2Arr[i] instanceof ArrayWritable)) {
        return false;
      }
      if (!arrayWritableEquals((ArrayWritable)a1Arr[i],(ArrayWritable)a2Arr[i])) {
        return false;
      }
    }
 else {
      if (!a1Arr[i].equals(a2Arr[i])) {
        return false;
      }
    }
  }
  return true;
}
