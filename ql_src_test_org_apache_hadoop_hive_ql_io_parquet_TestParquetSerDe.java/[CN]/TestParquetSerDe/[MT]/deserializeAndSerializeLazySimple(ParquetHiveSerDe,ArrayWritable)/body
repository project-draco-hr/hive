{
  final StructObjectInspector oi=(StructObjectInspector)serDe.getObjectInspector();
  final Object row=serDe.deserialize(t);
  assertEquals("deserialization gives the wrong object class",row.getClass(),ArrayWritable.class);
  assertEquals("size correct after deserialization",serDe.getSerDeStats().getRawDataSize(),t.get().length);
  assertEquals("deserialization gives the wrong object",t,row);
  final ParquetHiveRecord serializedArr=(ParquetHiveRecord)serDe.serialize(row,oi);
  assertEquals("size correct after serialization",serDe.getSerDeStats().getRawDataSize(),((ArrayWritable)serializedArr.getObject()).get().length);
  assertTrue("serialized object should be equal to starting object",arrayWritableEquals(t,(ArrayWritable)serializedArr.getObject()));
}
