{
  LlapDaemonCacheMetrics metricsMock=mock(LlapDaemonCacheMetrics.class);
  final AtomicLong cacheUsed=new AtomicLong(0);
  doAnswer(new Answer<Object>(){
    public Object answer(    InvocationOnMock invocation) throws Throwable {
      cacheUsed.addAndGet((Long)invocation.getArguments()[0]);
      return null;
    }
  }
).when(metricsMock).incrCacheCapacityUsed(anyLong());
  return new MetricsMock(cacheUsed,metricsMock);
}
