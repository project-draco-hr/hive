{
  ExprNodeColumnDesc col1Expr=new ExprNodeColumnDesc(Long.class,"col1","table",false);
  ExprNodeColumnDesc col2Expr=new ExprNodeColumnDesc(Long.class,"col2","table",false);
  ExprNodeColumnDesc col3Expr=new ExprNodeColumnDesc(Long.class,"col3","table",false);
  ExprNodeConstantDesc constDesc2=new ExprNodeConstantDesc(new Integer(1));
  ExprNodeConstantDesc constDesc3=new ExprNodeConstantDesc(new Integer(2));
  GenericUDFIf udf=new GenericUDFIf();
  List<ExprNodeDesc> children1=new ArrayList<ExprNodeDesc>();
  children1.add(col1Expr);
  children1.add(col2Expr);
  children1.add(col3Expr);
  ExprNodeGenericFuncDesc exprDesc=new ExprNodeGenericFuncDesc(TypeInfoFactory.booleanTypeInfo,udf,children1);
  Map<String,Integer> columnMap=new HashMap<String,Integer>();
  columnMap.put("col1",1);
  columnMap.put("col2",2);
  columnMap.put("col3",3);
  VectorizationContext vc=new VectorizationContext(columnMap,3);
  VectorExpression ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprLongColumnLongColumn);
  children1.set(2,new ExprNodeConstantDesc(1L));
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprLongColumnLongScalar);
  children1.set(1,new ExprNodeConstantDesc(1L));
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprLongScalarLongScalar);
  children1.set(2,col3Expr);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprLongScalarLongColumn);
  col2Expr=new ExprNodeColumnDesc(Double.class,"col2","table",false);
  col3Expr=new ExprNodeColumnDesc(Double.class,"col3","table",false);
  children1.set(1,col2Expr);
  children1.set(2,col3Expr);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprDoubleColumnDoubleColumn);
  children1.set(2,new ExprNodeConstantDesc(1D));
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprDoubleColumnDoubleScalar);
  children1.set(1,new ExprNodeConstantDesc(1D));
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprDoubleScalarDoubleScalar);
  children1.set(2,col3Expr);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprDoubleScalarDoubleColumn);
  children1.set(2,new ExprNodeColumnDesc(Long.class,"col3","table",false));
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprDoubleScalarLongColumn);
  col2Expr=new ExprNodeColumnDesc(Timestamp.class,"col2","table",false);
  col3Expr=new ExprNodeColumnDesc(Timestamp.class,"col3","table",false);
  children1.set(1,col2Expr);
  children1.set(2,col3Expr);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprLongColumnLongColumn);
  ExprNodeGenericFuncDesc f=new ExprNodeGenericFuncDesc();
  f.setGenericUDF(new GenericUDFTimestamp());
  f.setTypeInfo(TypeInfoFactory.timestampTypeInfo);
  List<ExprNodeDesc> children2=new ArrayList<ExprNodeDesc>();
  f.setChildren(children2);
  children2.add(new ExprNodeConstantDesc("2013-11-05 00:00:00.000"));
  children1.set(2,f);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(IfExprLongColumnLongColumn.class == ve.getClass() || IfExprLongColumnLongScalar.class == ve.getClass());
  children1.set(1,f);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(IfExprLongColumnLongColumn.class == ve.getClass() || IfExprLongScalarLongScalar.class == ve.getClass());
  children1.set(2,col3Expr);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(IfExprLongColumnLongColumn.class == ve.getClass() || IfExprLongScalarLongColumn.class == ve.getClass());
  col2Expr=new ExprNodeColumnDesc(Boolean.class,"col2","table",false);
  col3Expr=new ExprNodeColumnDesc(Boolean.class,"col3","table",false);
  children1.set(1,col2Expr);
  children1.set(2,col3Expr);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprLongColumnLongColumn);
  children1.set(2,new ExprNodeConstantDesc(true));
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprLongColumnLongScalar);
  children1.set(1,new ExprNodeConstantDesc(true));
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprLongScalarLongScalar);
  children1.set(2,col3Expr);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprLongScalarLongColumn);
  constDesc2=new ExprNodeConstantDesc("Alpha");
  constDesc3=new ExprNodeConstantDesc("Bravo");
  col2Expr=new ExprNodeColumnDesc(String.class,"col2","table",false);
  col3Expr=new ExprNodeColumnDesc(String.class,"col3","table",false);
  children1.set(1,col2Expr);
  children1.set(2,col3Expr);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprStringColumnStringColumn);
  children1.set(2,constDesc3);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprStringColumnStringScalar);
  children1.set(1,constDesc2);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprStringScalarStringScalar);
  children1.set(2,col3Expr);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprStringScalarStringColumn);
}
