{
  String apiKey=Preconditions.checkNotNull(context.getString(API_KEY),API_KEY + " is required");
  String accessKey=Preconditions.checkNotNull(context.getString(ACCESS_KEY),ACCESS_KEY + " is required");
  String imageId=Preconditions.checkNotNull(context.getString(IMAGE_ID),IMAGE_ID + " is required");
  String keyPair=Preconditions.checkNotNull(context.getString(KEY_PAIR),KEY_PAIR + " is required");
  String securityGroup=Preconditions.checkNotNull(context.getString(SECURITY_GROUP),SECURITY_GROUP + " is required");
  Float maxBid=context.getFloat(MAX_BID);
  Preconditions.checkArgument(maxBid == null || maxBid > 0,MAX_BID + " must be null or greater than zero");
  String instanceType=context.getString(INSTANCE_TYPE,"c1.xlarge");
  String groupName=context.getString(GROUP_NAME,"hive-ptest-slaves");
  CloudComputeService.CloudComputeConfig config=new CloudComputeService.CloudComputeConfig(CloudComputeService.CloudComputeConfig.CloudComputeProvider.AWS);
  config.setCredentials(apiKey,accessKey);
  config.setInstanceType(instanceType);
  config.setGroupName(groupName);
  config.setImageId(imageId);
  config.setmKeyPairName(keyPair);
  config.setSecurityGroup(securityGroup);
  config.setMaxBid(maxBid);
  config.setUserMetaData(context.getSubProperties(USER_METADATA + "."));
  return new CloudComputeService(config);
}
