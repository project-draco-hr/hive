{
  Set<Integer> bigTableCandidateSet=MapJoinProcessor.getBigTableCandidates(joinOp.getConf().getConds());
  long maxSize=context.getConf().getLongVar(HiveConf.ConfVars.HIVECONVERTJOINNOCONDITIONALTASKTHRESHOLD);
  int bigTablePosition=-1;
  Statistics bigInputStat=null;
  long totalSize=0;
  int pos=0;
  boolean bigTableFound=false;
  for (  Operator<? extends OperatorDesc> parentOp : joinOp.getParentOperators()) {
    Statistics currInputStat=parentOp.getStatistics();
    if (currInputStat == null) {
      LOG.warn("Couldn't get statistics from: " + parentOp);
      return new long[]{-1,0,0};
    }
    if (containUnionWithoutRS(parentOp.getParentOperators().get(0))) {
      return new long[]{-1,0,0};
    }
    long inputSize=currInputStat.getDataSize();
    if ((bigInputStat == null) || ((bigInputStat != null) && (inputSize > bigInputStat.getDataSize()))) {
      if (bigTableFound) {
        return new long[]{-1,0,0};
      }
      if (inputSize > maxSize) {
        if (!bigTableCandidateSet.contains(pos)) {
          return new long[]{-1,0,0};
        }
        bigTableFound=true;
      }
      if (bigInputStat != null) {
        totalSize+=bigInputStat.getDataSize();
      }
      if (totalSize > maxSize) {
        return new long[]{-1,0,0};
      }
      if (bigTableCandidateSet.contains(pos)) {
        bigTablePosition=pos;
        bigInputStat=currInputStat;
      }
    }
 else {
      totalSize+=currInputStat.getDataSize();
      if (totalSize > maxSize) {
        return new long[]{-1,0,0};
      }
    }
    pos++;
  }
  if (bigTablePosition == -1) {
    return new long[]{-1,0,0};
  }
  long connectedMapJoinSize=getConnectedMapJoinSize(joinOp.getParentOperators().get(bigTablePosition),joinOp,context);
  if ((connectedMapJoinSize + totalSize) > maxSize) {
    return new long[]{-1,0,0};
  }
  return new long[]{bigTablePosition,connectedMapJoinSize,totalSize};
}
