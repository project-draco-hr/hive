{
  String provider;
  Class clazz;
  RecordManagerProvider factory;
  provider=options.getProperty(RecordManagerOptions.PROVIDER_FACTORY,"org.apache.hadoop.hive.ql.util.jdbm.recman.Provider");
  try {
    clazz=Class.forName(provider);
    factory=(RecordManagerProvider)clazz.newInstance();
  }
 catch (  Exception except) {
    throw new IllegalArgumentException("Invalid record manager provider: " + provider + "\n["+ except.getClass().getName()+ ": "+ except.getMessage()+ "]");
  }
  return factory;
}
