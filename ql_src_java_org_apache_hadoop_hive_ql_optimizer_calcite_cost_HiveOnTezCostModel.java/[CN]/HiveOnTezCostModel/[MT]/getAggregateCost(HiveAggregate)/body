{
  if (aggregate.isBucketedInput()) {
    return HiveCost.FACTORY.makeZeroCost();
  }
 else {
    RelMetadataQuery mq=RelMetadataQuery.instance();
    final Double rCount=mq.getRowCount(aggregate.getInput());
    if (rCount == null) {
      return null;
    }
    final double cpuCost=algoUtils.computeSortCPUCost(rCount);
    final Double rAverageSize=mq.getAverageRowSize(aggregate.getInput());
    if (rAverageSize == null) {
      return null;
    }
    final double ioCost=algoUtils.computeSortIOCost(new Pair<Double,Double>(rCount,rAverageSize));
    return HiveCost.FACTORY.makeCost(rCount,cpuCost,ioCost);
  }
}
