{
  RelNode inMemoryInput;
  if (join.getStreamingSide() == MapJoinStreamingRelation.LEFT_RELATION) {
    inMemoryInput=join.getRight();
  }
 else   if (join.getStreamingSide() == MapJoinStreamingRelation.RIGHT_RELATION) {
    inMemoryInput=join.getLeft();
  }
 else {
    return null;
  }
  final Double memoryInput=RelMetadataQuery.instance().cumulativeMemoryWithinPhase(inMemoryInput);
  final Integer splitCount=RelMetadataQuery.instance().splitCount(inMemoryInput);
  if (memoryInput == null || splitCount == null) {
    return null;
  }
  return memoryInput / splitCount;
}
