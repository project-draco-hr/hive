{
  RelMetadataQuery mq=RelMetadataQuery.instance();
  JoinAlgorithm oldAlgo=join.getJoinAlgorithm();
  join.setJoinAlgorithm(TezSMBJoinAlgorithm.INSTANCE);
  final Double memoryWithinPhase=mq.cumulativeMemoryWithinPhase(join);
  final Integer splitCount=mq.splitCount(join);
  join.setJoinAlgorithm(oldAlgo);
  if (memoryWithinPhase == null || splitCount == null) {
    return null;
  }
  return memoryWithinPhase / splitCount;
}
