{
  setup(conf);
  if (existingSession != null) {
    if (!existingSession.isOpen() && doOpen) {
      existingSession.open(conf);
    }
    return existingSession;
  }
  SparkSession sparkSession=new SparkSessionImpl();
  if (doOpen) {
    sparkSession.open(conf);
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug(String.format("New session (%s) is created.",sparkSession.getSessionId()));
  }
  createdSessions.add(sparkSession);
  return sparkSession;
}
