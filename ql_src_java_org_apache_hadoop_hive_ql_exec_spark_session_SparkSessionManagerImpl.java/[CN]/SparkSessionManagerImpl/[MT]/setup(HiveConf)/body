{
  if (inited.compareAndSet(false,true)) {
    LOG.info("Setting up the session manager.");
    createdSessions=Collections.synchronizedSet(new HashSet<SparkSession>());
    Map<String,String> conf=HiveSparkClientFactory.initiateSparkConf(hiveConf);
    try {
      SparkClientFactory.initialize(conf);
    }
 catch (    IOException e) {
      throw new HiveException("Error initializing SparkClientFactory",e);
    }
  }
}
