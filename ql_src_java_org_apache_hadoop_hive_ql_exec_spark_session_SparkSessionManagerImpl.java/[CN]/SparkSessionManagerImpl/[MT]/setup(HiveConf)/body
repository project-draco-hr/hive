{
  if (!inited) {
synchronized (this) {
      if (!inited) {
        LOG.info("Setting up the session manager.");
        Map<String,String> conf=HiveSparkClientFactory.initiateSparkConf(hiveConf);
        try {
          SparkClientFactory.initialize(conf);
          inited=true;
        }
 catch (        IOException e) {
          throw new HiveException("Error initializing SparkClientFactory",e);
        }
      }
    }
  }
}
