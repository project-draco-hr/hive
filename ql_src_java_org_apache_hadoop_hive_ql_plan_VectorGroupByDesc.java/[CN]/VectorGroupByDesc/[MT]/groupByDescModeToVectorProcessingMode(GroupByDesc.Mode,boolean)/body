{
switch (mode) {
case COMPLETE:
    return (hasKeys ? ProcessingMode.STREAMING : ProcessingMode.GLOBAL);
case HASH:
  return ProcessingMode.HASH;
case MERGEPARTIAL:
return (hasKeys ? ProcessingMode.MERGE_PARTIAL : ProcessingMode.GLOBAL);
case PARTIAL1:
case PARTIAL2:
case PARTIALS:
case FINAL:
return ProcessingMode.STREAMING;
default :
throw new RuntimeException("Unexpected GROUP BY mode " + mode.name());
}
}
