{
  UserGroupInformation ugi=UgiFactory.getUgi(user);
  WebHCatJTShim tracker=null;
  try {
    tracker=ShimLoader.getHadoopShims().getWebHCatShim(appConf,ugi);
    ArrayList<String> ids=new ArrayList<String>();
    JobStatus[] jobs=tracker.getAllJobs();
    if (jobs != null) {
      for (      JobStatus job : jobs) {
        String id=job.getJobID().toString();
        if (showall || user.equals(job.getUsername()))         ids.add(id);
      }
    }
    return ids;
  }
 catch (  IllegalStateException e) {
    throw new BadParam(e.getMessage());
  }
 finally {
    if (tracker != null)     tracker.close();
  }
}
