{
  Database database=StreamingTestUtils.databaseBuilder(new File("/tmp")).name("db_1").build();
  Table table=StreamingTestUtils.tableBuilder(database).name("table_1").addColumn("one","string").addColumn("two","integer").partitionKeys("partition").addPartition("p1").buckets(10).build();
  AcidTable acidTable=new AcidTable("db_1","table_1",true,TableType.SINK);
  acidTable.setTable(table);
  acidTable.setTransactionId(42L);
  String encoded=AcidTableSerializer.encode(acidTable);
  System.out.println(encoded);
  AcidTable decoded=AcidTableSerializer.decode(encoded);
  assertThat(decoded.getDatabaseName(),is("db_1"));
  assertThat(decoded.getTableName(),is("table_1"));
  assertThat(decoded.createPartitions(),is(true));
  assertThat(decoded.getOutputFormatName(),is("org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat"));
  assertThat(decoded.getTotalBuckets(),is(10));
  assertThat(decoded.getQualifiedName(),is("DB_1.TABLE_1"));
  assertThat(decoded.getTransactionId(),is(42L));
  assertThat(decoded.getTableType(),is(TableType.SINK));
  assertThat(decoded.getTable(),is(table));
}
