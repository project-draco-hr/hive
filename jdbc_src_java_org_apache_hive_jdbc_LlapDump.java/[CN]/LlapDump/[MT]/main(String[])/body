{
  Options opts=createOptions();
  CommandLine cli=new GnuParser().parse(opts,args);
  if (cli.hasOption('h')) {
    HelpFormatter formatter=new HelpFormatter();
    formatter.printHelp("orcfiledump",opts);
    return;
  }
  if (cli.hasOption('l')) {
    url=cli.getOptionValue("l");
  }
  if (cli.hasOption('u')) {
    user=cli.getOptionValue("u");
  }
  if (cli.hasOption('p')) {
    pwd=cli.getOptionValue("p");
  }
  if (cli.getArgs().length > 0) {
    query=cli.getArgs()[0];
  }
  System.out.println("url: " + url);
  System.out.println("user: " + user);
  System.out.println("query: " + query);
  LlapInputFormat format=new LlapInputFormat(url,user,pwd,query);
  JobConf job=new JobConf();
  InputSplit[] splits=format.getSplits(job,1);
  RecordReader<NullWritable,Text> reader=format.getRecordReader(splits[0],job,null);
  if (reader instanceof LlapRecordReader) {
    Schema schema=((LlapRecordReader)reader).getSchema();
    System.out.println("" + schema);
  }
  System.out.println("Results: ");
  System.out.println("");
  Text value=reader.createValue();
  while (reader.next(NullWritable.get(),value)) {
    System.out.println(value);
  }
}
