{
  long value=taskValue(1,1,1L);
  Metrics metrics=new Metrics(value,value,value,value,value,value,value,null,null,null);
  MetricsCollection collection=new MetricsCollection();
  for (  int i : Arrays.asList(1,2)) {
    collection.addMetrics(i,1,1,metrics);
  }
  Metrics global=collection.getAllMetrics();
  assertNull(global.inputMetrics);
  assertNull(global.shuffleReadMetrics);
  assertNull(global.shuffleWriteMetrics);
  collection.addMetrics(3,1,1,makeMetrics(3,1,1));
  Metrics global2=collection.getAllMetrics();
  assertNotNull(global2.inputMetrics);
  assertEquals(taskValue(3,1,1),global2.inputMetrics.bytesRead);
  assertNotNull(global2.shuffleReadMetrics);
  assertNotNull(global2.shuffleWriteMetrics);
}
