{
  MetricsCollection collection=new MetricsCollection();
  for (  int i : Arrays.asList(1,2)) {
    for (    int j : Arrays.asList(1,2)) {
      for (      long k : Arrays.asList(1L,2L)) {
        collection.addMetrics(i,j,k,makeMetrics(i,j,k));
      }
    }
  }
  assertEquals(ImmutableSet.of(1,2),collection.getJobIds());
  assertEquals(ImmutableSet.of(1,2),collection.getStageIds(1));
  assertEquals(ImmutableSet.of(1L,2L),collection.getTaskIds(1,1));
  Metrics task112=collection.getTaskMetrics(1,1,2);
  checkMetrics(task112,taskValue(1,1,2));
  Metrics stage21=collection.getStageMetrics(2,1);
  checkMetrics(stage21,stageValue(2,1,2));
  Metrics job1=collection.getJobMetrics(1);
  checkMetrics(job1,jobValue(1,2,2));
  Metrics global=collection.getAllMetrics();
  checkMetrics(global,globalValue(2,2,2));
}
