{
  MetricsCollection collection=new MetricsCollection();
  long value=taskValue(1,1,1);
  Metrics metrics1=new Metrics(value,value,value,value,value,value,value,Optional.fromNullable(new InputMetrics(DataReadMethod.Memory,value)),Optional.<ShuffleReadMetrics>absent(),Optional.<ShuffleWriteMetrics>absent());
  Metrics metrics2=new Metrics(value,value,value,value,value,value,value,Optional.fromNullable(new InputMetrics(DataReadMethod.Disk,value)),Optional.<ShuffleReadMetrics>absent(),Optional.<ShuffleWriteMetrics>absent());
  collection.addMetrics(1,1,1,metrics1);
  collection.addMetrics(1,1,2,metrics2);
  Metrics global=collection.getAllMetrics();
  assertTrue(global.inputMetrics.isPresent());
  assertEquals(DataReadMethod.Multiple,global.inputMetrics.get().readMethod);
}
