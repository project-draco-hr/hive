{
  final Aggregate aggregate=call.rel(0);
  final DruidQuery query=call.rel(1);
  if (!DruidQuery.isValidSignature(query.signature() + 'a')) {
    return;
  }
  if (aggregate.indicator || aggregate.getGroupSets().size() != 1 || Iterables.any(aggregate.getAggCallList(),BAD_AGG) || !validAggregate(aggregate,query)) {
    return;
  }
  final RelNode newAggregate=aggregate.copy(aggregate.getTraitSet(),ImmutableList.of(Util.last(query.rels)));
  call.transformTo(DruidQuery.extendQuery(query,newAggregate));
}
