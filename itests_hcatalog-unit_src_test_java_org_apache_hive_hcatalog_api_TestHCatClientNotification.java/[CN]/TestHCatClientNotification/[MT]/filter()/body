{
  hCatClient.createDatabase(HCatCreateDBDesc.create("hcatf1").build());
  hCatClient.createDatabase(HCatCreateDBDesc.create("hcatf2").build());
  hCatClient.dropDatabase("hcatf2",false,HCatClient.DropDBMode.RESTRICT);
  IMetaStoreClient.NotificationFilter filter=new IMetaStoreClient.NotificationFilter(){
    @Override public boolean accept(    NotificationEvent event){
      return event.getEventType().equals(HCatConstants.HCAT_DROP_DATABASE_EVENT);
    }
  }
;
  List<HCatNotificationEvent> events=hCatClient.getNextNotification(firstEventId,0,filter);
  assertEquals(1,events.size());
  assertEquals(firstEventId + 3,events.get(0).getEventId());
}
