{
  if (work.getLoadFileDesc() != null) {
    return null;
  }
  Table table;
  List<Map<String,String>> partitionSpecs=new ArrayList<Map<String,String>>();
  if (work.getTableSpecs() != null) {
    BaseSemanticAnalyzer.tableSpec tblSpec=work.getTableSpecs();
    table=tblSpec.tableHandle;
    if (!table.isPartitioned()) {
      return null;
    }
    List<Partition> partitions=tblSpec.partitions;
    if (partitions != null) {
      for (      Partition partition : partitions) {
        partitionSpecs.add(partition.getSpec());
      }
    }
  }
 else   if (work.getLoadTableDesc() != null) {
    LoadTableDesc tbd=work.getLoadTableDesc();
    table=db.getTable(tbd.getTable().getTableName());
    if (!table.isPartitioned()) {
      return null;
    }
    DynamicPartitionCtx dpCtx=tbd.getDPCtx();
    if (dpCtx != null && dpCtx.getNumDPCols() > 0) {
    }
 else {
      partitionSpecs.add(tbd.getPartitionSpec());
    }
  }
  return partitionSpecs;
}
