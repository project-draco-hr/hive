{
  if (isCookieEnabled) {
    httpContext.setAttribute(ClientContext.COOKIE_STORE,cookieStore);
  }
  if (!isCookieEnabled || ((httpContext.getAttribute(Utils.HIVE_SERVER2_RETRY_KEY) == null && (cookieStore == null || (cookieStore != null && Utils.needToSendCredentials(cookieStore,cookieName,isSSL)))) || (httpContext.getAttribute(Utils.HIVE_SERVER2_RETRY_KEY) != null && httpContext.getAttribute(Utils.HIVE_SERVER2_RETRY_KEY).equals(Utils.HIVE_SERVER2_RETRY_TRUE)))) {
    Header basicAuthHeader=authScheme.authenticate(credentials,httpRequest,httpContext);
    httpRequest.addHeader(basicAuthHeader);
  }
  if (isCookieEnabled) {
    httpContext.setAttribute(Utils.HIVE_SERVER2_RETRY_KEY,Utils.HIVE_SERVER2_RETRY_FALSE);
  }
}
