{
  try {
    if (name.equals("default") || MetaStoreUtils.validateName(name) == false) {
      throw new MetaException("invalid db name: " + name + " - allowed characters are \\w and _ and default is reserved");
    }
    new FileStore(conf).createDatabase(name);
    Path whRoot=new Path(HiveConf.getVar(conf,HiveConf.ConfVars.METASTOREWAREHOUSE),name + ".db");
    FileSystem fs=FileSystem.get(whRoot.toUri(),conf);
    fs.mkdirs(whRoot);
    return new DB(name,conf);
  }
 catch (  Exception e) {
    throw new MetaException(e.getMessage());
  }
}
