{
  String whRootString=HiveConf.getVar(conf,HiveConf.ConfVars.METASTOREWAREHOUSE);
  if (whRootString == null) {
    throw new MetaException(HiveConf.ConfVars.METASTOREWAREHOUSE.varname + " is not set in the config");
  }
  whRoot_=new Path(whRootString);
  conf_=conf;
  dbName_=dbName;
  whPath_=dbName.equals("default") ? whRoot_ : new Path(whRoot_,dbName + ".db");
  store_=new FileStore(conf);
  try {
    FileSystem fs=whPath_.getFileSystem(conf);
    if (fs.exists(whPath_) == false || store_.dbExists(dbName) == false) {
      throw new UnknownDBException("name=" + dbName + ",whPath="+ whPath_+ " "+ fs.exists(whPath_)+ ","+ store_.dbExists(dbName));
    }
  }
 catch (  IOException e) {
    throw new MetaException(e.getMessage());
  }
}
