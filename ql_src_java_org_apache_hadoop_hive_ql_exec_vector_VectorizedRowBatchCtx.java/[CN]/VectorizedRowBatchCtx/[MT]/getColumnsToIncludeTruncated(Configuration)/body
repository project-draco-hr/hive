{
  boolean[] columnsToIncludeTruncated=null;
  List<Integer> columnsToIncludeTruncatedList=ColumnProjectionUtils.getReadColumnIDs(conf);
  if (columnsToIncludeTruncatedList != null && columnsToIncludeTruncatedList.size() > 0) {
    boolean[] columnsToInclude=new boolean[dataColumnCount];
    Arrays.fill(columnsToInclude,false);
    for (    int columnNum : columnsToIncludeTruncatedList) {
      if (columnNum < dataColumnCount) {
        columnsToInclude[columnNum]=true;
      }
    }
    int highestWantedColumnNum=-1;
    for (int i=dataColumnCount - 1; i >= 0; i--) {
      if (columnsToInclude[i]) {
        highestWantedColumnNum=i;
        break;
      }
    }
    if (highestWantedColumnNum == -1) {
      throw new RuntimeException("No columns to include?");
    }
    int newColumnCount=highestWantedColumnNum + 1;
    if (newColumnCount == dataColumnCount) {
      columnsToIncludeTruncated=columnsToInclude;
    }
 else {
      columnsToIncludeTruncated=Arrays.copyOf(columnsToInclude,newColumnCount);
    }
  }
  return columnsToIncludeTruncated;
}
