{
  if (columnTypeMap != null && !columnTypeMap.isEmpty()) {
    int origNumCols=vrb.numCols;
    int newNumCols=vrb.cols.length + columnTypeMap.keySet().size();
    vrb.cols=Arrays.copyOf(vrb.cols,newNumCols);
    for (int i=origNumCols; i < newNumCols; i++) {
      String typeName=columnTypeMap.get(i);
      if (typeName == null) {
        throw new HiveException("No type found for column type entry " + i);
      }
      vrb.cols[i]=allocateColumnVector(typeName,VectorizedRowBatch.DEFAULT_SIZE);
    }
    vrb.numCols=vrb.cols.length;
  }
}
