{
  if (scratchColumnTypeMap != null && !scratchColumnTypeMap.isEmpty()) {
    int origNumCols=vrb.numCols;
    int newNumCols=vrb.cols.length + scratchColumnTypeMap.keySet().size();
    vrb.cols=Arrays.copyOf(vrb.cols,newNumCols);
    for (int i=origNumCols; i < newNumCols; i++) {
      String typeName=scratchColumnTypeMap.get(i);
      if (typeName == null) {
        throw new HiveException("No type entry found for column " + i + " in map "+ scratchColumnTypeMap.toString());
      }
      vrb.cols[i]=allocateColumnVector(typeName,VectorizedRowBatch.DEFAULT_SIZE);
    }
    vrb.numCols=vrb.cols.length;
  }
}
