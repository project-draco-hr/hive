{
  LinkedHashMap<String,String> partSpec=partDesc.getPartSpec();
  for (int i=0; i < vrbCtx.partitionColumnCount; i++) {
    Object objectValue;
    if (partSpec == null) {
      objectValue=null;
    }
 else {
      String key=vrbCtx.rowColumnNames[vrbCtx.dataColumnCount + i];
      TypeInfo partColTypeInfo=vrbCtx.rowColumnTypeInfos[vrbCtx.dataColumnCount + i];
      ObjectInspector objectInspector=TypeInfoUtils.getStandardJavaObjectInspectorFromTypeInfo(partColTypeInfo);
      objectValue=ObjectInspectorConverters.getConverter(PrimitiveObjectInspectorFactory.javaStringObjectInspector,objectInspector).convert(partSpec.get(key));
      if (partColTypeInfo instanceof CharTypeInfo) {
        objectValue=((HiveChar)objectValue).getStrippedValue();
      }
    }
    partitionValues[i]=objectValue;
  }
}
