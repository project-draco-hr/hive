{
  List<? extends StructField> fieldRefs=rowOI.getAllStructFieldRefs();
  VectorizedRowBatch result=new VectorizedRowBatch(fieldRefs.size());
  for (int j=0; j < fieldRefs.size(); j++) {
    if ((colsToInclude == null) || colsToInclude.contains(j) || ((partitionValues != null) && partitionValues.containsKey(fieldRefs.get(j).getFieldName()))) {
      ObjectInspector foi=fieldRefs.get(j).getFieldObjectInspector();
      result.cols[j]=VectorizedBatchUtil.createColumnVector(foi);
    }
  }
  result.numCols=fieldRefs.size();
  this.addScratchColumnsToBatch(result);
  result.reset();
  return result;
}
