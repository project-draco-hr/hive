{
  RelNode parent=null;
  RelNode input=optimizedOptiqPlan;
  RelNode newRoot=optimizedOptiqPlan;
  while (!(input instanceof Project) && (input instanceof Sort)) {
    parent=input;
    input=input.getInput(0);
  }
  if (!(input instanceof Project)) {
    HiveProject hpRel=HiveProject.create(input,HiveCalciteUtil.getProjsFromBelowAsInputRef(input),input.getRowType().getFieldNames());
    if (input == optimizedOptiqPlan) {
      newRoot=hpRel;
    }
 else {
      parent.replaceInput(0,hpRel);
    }
  }
  return newRoot;
}
