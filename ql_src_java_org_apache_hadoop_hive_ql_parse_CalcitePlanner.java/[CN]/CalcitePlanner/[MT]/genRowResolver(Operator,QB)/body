{
  RowResolver rr=new RowResolver();
  String subqAlias=(qb.getAliases().size() == 1 && qb.getSubqAliases().size() == 1) ? qb.getAliases().get(0) : null;
  for (  ColumnInfo ci : op.getSchema().getSignature()) {
    try {
      rr.putWithCheck((subqAlias != null) ? subqAlias : ci.getTabAlias(),ci.getAlias() != null ? ci.getAlias() : ci.getInternalName(),ci.getInternalName(),new ColumnInfo(ci));
    }
 catch (    SemanticException e) {
      throw new RuntimeException(e);
    }
  }
  return rr;
}
