{
  boolean isInTest=conf.getBoolVar(ConfVars.HIVE_IN_TEST);
  boolean isStrictTest=isInTest && !conf.getVar(ConfVars.HIVEMAPREDMODE).equalsIgnoreCase("nonstrict");
  boolean hasEnoughJoins=!topLevelQB || (queryProperties.getJoinCount() > 1) || isInTest|| distinctExprsExists(qb);
  if (!isStrictTest && hasEnoughJoins && !queryProperties.hasClusterBy()&& !queryProperties.hasDistributeBy()&& !queryProperties.hasSortBy()&& !queryProperties.hasPTF()&& !queryProperties.usesScript()&& !queryProperties.hasMultiDestQuery()&& !queryProperties.hasLateralViews()) {
    return null;
  }
  String msg="";
  if (verbose) {
    if (isStrictTest)     msg+="is in test running in mode other than nonstrict; ";
    if (!hasEnoughJoins)     msg+="has too few joins; ";
    if (queryProperties.hasClusterBy())     msg+="has cluster by; ";
    if (queryProperties.hasDistributeBy())     msg+="has distribute by; ";
    if (queryProperties.hasSortBy())     msg+="has sort by; ";
    if (queryProperties.hasPTF())     msg+="has PTF; ";
    if (queryProperties.usesScript())     msg+="uses scripts; ";
    if (queryProperties.hasMultiDestQuery())     msg+="is a multi-destination query; ";
    if (queryProperties.hasLateralViews())     msg+="has lateral views; ";
    if (msg.isEmpty())     msg+="has some unspecified limitations; ";
  }
  return msg;
}
