{
  Table tbl=hiveDB.getTable(tableName);
  if (tbl == null) {
    throw new HiveException("Table " + tableName + " does not exist ");
  }
  HiveLockObject obj=null;
  if (partSpec == null) {
    obj=new HiveLockObject(tbl,null);
  }
 else {
    Partition par=hiveDB.getPartition(tbl,partSpec,false);
    if (par == null) {
      throw new HiveException("Partition " + partSpec + " for table "+ tableName+ " does not exist");
    }
    obj=new HiveLockObject(par,null);
  }
  return obj;
}
