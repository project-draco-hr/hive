{
  int mapsize1=moi1.getMapSize(o1);
  int mapsize2=moi2.getMapSize(o2);
  if (mapsize1 != mapsize2) {
    return mapsize1 - mapsize2;
  }
  ObjectInspector mkoi1=moi1.getMapKeyObjectInspector();
  ObjectInspector mkoi2=moi2.getMapKeyObjectInspector();
  ObjectInspector mvoi1=moi1.getMapValueObjectInspector();
  ObjectInspector mvoi2=moi2.getMapValueObjectInspector();
  Map<?,?> map1=moi1.getMap(o1);
  Map<?,?> map2=moi2.getMap(o2);
  for (  Object mk1 : map1.keySet()) {
    boolean notFound=true;
    for (    Object mk2 : map2.keySet()) {
      int rc=ObjectInspectorUtils.compare(mk1,mkoi1,mk2,mkoi2,this);
      if (rc != 0) {
        continue;
      }
      notFound=false;
      Object mv1=map1.get(mk1);
      Object mv2=map2.get(mk2);
      rc=ObjectInspectorUtils.compare(mv1,mvoi1,mv2,mvoi2,this);
      if (rc != 0) {
        return rc;
      }
 else {
        break;
      }
    }
    if (notFound) {
      return 1;
    }
  }
  return 0;
}
