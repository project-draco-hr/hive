{
  if (condn[0].getType() == JoinDesc.UNIQUE_JOIN) {
    boolean preserve=false;
    boolean hasNulls=false;
    boolean allOne=true;
    for (int i=0; i < numAliases; i++) {
      Byte alias=order[i];
      AbstractRowContainer<List<Object>> alw=storage[alias];
      if (alw.rowCount() != 1) {
        allOne=false;
      }
      if (alw.rowCount() == 0) {
        alw.addRow(dummyObj[i]);
        hasNulls=true;
      }
 else       if (condn[i].getPreserved()) {
        preserve=true;
      }
    }
    if (hasNulls && !preserve) {
      return;
    }
    if (allOne) {
      genAllOneUniqueJoinObject();
    }
 else {
      genUniqueJoinObject(0,0);
    }
  }
 else {
    boolean mayHasMoreThanOne=false;
    boolean hasEmpty=false;
    for (int i=0; i < numAliases; i++) {
      Byte alias=order[i];
      AbstractRowContainer<List<Object>> alw=storage[alias];
      if (noOuterJoin) {
        if (alw.rowCount() == 0) {
          return;
        }
 else         if (alw.rowCount() > 1) {
          mayHasMoreThanOne=true;
        }
      }
 else {
        if (alw.rowCount() == 0) {
          hasEmpty=true;
          alw.addRow(dummyObj[i]);
        }
 else         if (!hasEmpty && alw.rowCount() == 1) {
          if (hasAnyFiltered(alias,alw.rowIter().first())) {
            hasEmpty=true;
          }
        }
 else {
          mayHasMoreThanOne=true;
          if (!hasEmpty) {
            AbstractRowContainer.RowIterator<List<Object>> iter=alw.rowIter();
            for (List<Object> row=iter.first(); row != null; row=iter.next()) {
              reportProgress();
              if (hasAnyFiltered(alias,row)) {
                hasEmpty=true;
                break;
              }
            }
          }
        }
      }
    }
    if (!hasEmpty && !mayHasMoreThanOne) {
      genAllOneUniqueJoinObject();
    }
 else     if (!hasEmpty && !hasLeftSemiJoin) {
      genUniqueJoinObject(0,0);
    }
 else {
      genJoinObject();
    }
  }
  Arrays.fill(aliasFilterTags,(byte)0xff);
}
