{
  this.handleSkewJoin=conf.getHandleSkewJoin();
  this.hconf=hconf;
  heartbeatInterval=HiveConf.getIntVar(hconf,HiveConf.ConfVars.HIVESENDHEARTBEAT);
  countAfterReport=0;
  totalSz=0;
  storage=new HashMap<Byte,AbstractRowContainer<ArrayList<Object>>>();
  numAliases=conf.getExprs().size();
  joinValues=new HashMap<Byte,List<ExprNodeEvaluator>>();
  joinFilters=new HashMap<Byte,List<ExprNodeEvaluator>>();
  order=conf.getTagOrder();
  condn=conf.getConds();
  nullsafes=conf.getNullSafes();
  noOuterJoin=conf.isNoOuterJoin();
  totalSz=JoinUtil.populateJoinKeyValue(joinValues,conf.getExprs(),order,NOTSKIPBIGTABLE);
  joinFilters=new HashMap<Byte,List<ExprNodeEvaluator>>();
  JoinUtil.populateJoinKeyValue(joinFilters,conf.getFilters(),order,NOTSKIPBIGTABLE);
  joinValuesObjectInspectors=JoinUtil.getObjectInspectorsFromEvaluators(joinValues,inputObjInspectors,NOTSKIPBIGTABLE);
  joinFilterObjectInspectors=JoinUtil.getObjectInspectorsFromEvaluators(joinFilters,inputObjInspectors,NOTSKIPBIGTABLE);
  joinValuesStandardObjectInspectors=JoinUtil.getStandardObjectInspectors(joinValuesObjectInspectors,NOTSKIPBIGTABLE);
  filterMap=conf.getFilterMap();
  if (noOuterJoin) {
    rowContainerStandardObjectInspectors=joinValuesStandardObjectInspectors;
  }
 else {
    Map<Byte,List<ObjectInspector>> rowContainerObjectInspectors=new HashMap<Byte,List<ObjectInspector>>();
    for (    Byte alias : order) {
      ArrayList<ObjectInspector> rcOIs=new ArrayList<ObjectInspector>();
      rcOIs.addAll(joinValuesObjectInspectors.get(alias));
      rcOIs.add(PrimitiveObjectInspectorFactory.writableByteObjectInspector);
      rowContainerObjectInspectors.put(alias,rcOIs);
    }
    rowContainerStandardObjectInspectors=JoinUtil.getStandardObjectInspectors(rowContainerObjectInspectors,NOTSKIPBIGTABLE);
  }
  dummyObj=new Object[numAliases];
  dummyObjVectors=new RowContainer[numAliases];
  joinEmitInterval=HiveConf.getIntVar(hconf,HiveConf.ConfVars.HIVEJOINEMITINTERVAL);
  joinCacheSize=HiveConf.getIntVar(hconf,HiveConf.ConfVars.HIVEJOINCACHESIZE);
  byte pos=0;
  for (  Byte alias : order) {
    int sz=conf.getExprs().get(alias).size();
    ArrayList<Object> nr=new ArrayList<Object>(sz);
    for (int j=0; j < sz; j++) {
      nr.add(null);
    }
    if (!noOuterJoin) {
      nr.add(new ByteWritable());
    }
    dummyObj[pos]=nr;
    RowContainer<ArrayList<Object>> values=JoinUtil.getRowContainer(hconf,rowContainerStandardObjectInspectors.get((byte)pos),alias,1,spillTableDesc,conf,!hasFilter(pos));
    values.add((ArrayList<Object>)dummyObj[pos]);
    dummyObjVectors[pos]=values;
    RowContainer rc=JoinUtil.getRowContainer(hconf,rowContainerStandardObjectInspectors.get((byte)pos),alias,joinCacheSize,spillTableDesc,conf,!hasFilter(pos));
    storage.put(pos,rc);
    pos++;
  }
  forwardCache=new Object[totalSz];
  outputObjInspector=getJoinOutputObjectInspector(order,joinValuesStandardObjectInspectors,conf);
  for (int i=0; i < condn.length; i++) {
    if (condn[i].getType() == JoinDesc.LEFT_SEMI_JOIN) {
      hasLeftSemiJoin=true;
    }
  }
  LOG.info("JOIN " + ((StructObjectInspector)outputObjInspector).getTypeName() + " totalsz = "+ totalSz);
}
