{
  conf.getUDTF().setCollector(new UDTFCollector(this));
  List<? extends StructField> inputFields=((StandardStructObjectInspector)inputObjInspectors[0]).getAllStructFieldRefs();
  udtfInputOIs=new ObjectInspector[inputFields.size()];
  for (int i=0; i < inputFields.size(); i++) {
    udtfInputOIs[i]=inputFields.get(0).getFieldObjectInspector();
  }
  objToSendToUDTF=new Object[inputFields.size()];
  ObjectInspector udtfOutputOI=conf.getUDTF().initialize(udtfInputOIs);
  ArrayList<String> colNames=new ArrayList<String>();
  ArrayList<ObjectInspector> colOIs=new ArrayList<ObjectInspector>();
  colNames.add(conf.getOutputColName());
  colOIs.add(udtfOutputOI);
  outputObjInspector=ObjectInspectorFactory.getStandardStructObjectInspector(colNames,colOIs);
  if (HiveConf.getBoolVar(hconf,HiveConf.ConfVars.HIVEUDTFAUTOPROGRESS)) {
    autoProgressor=new AutoProgressor(this.getClass().getName(),reporter,Utilities.getDefaultNotificationInterval(hconf));
    autoProgressor.go();
  }
  super.initializeOp(hconf);
}
