{
  genericUDTF=conf.getGenericUDTF();
  collector=new UDTFCollector(this);
  genericUDTF.setCollector(collector);
  List<? extends StructField> inputFields=((StandardStructObjectInspector)inputObjInspectors[0]).getAllStructFieldRefs();
  udtfInputOIs=new ObjectInspector[inputFields.size()];
  for (int i=0; i < inputFields.size(); i++) {
    udtfInputOIs[i]=inputFields.get(i).getFieldObjectInspector();
  }
  objToSendToUDTF=new Object[inputFields.size()];
  MapredContext context=MapredContext.get();
  if (context != null) {
    context.setup(genericUDTF);
  }
  StructObjectInspector udtfOutputOI=genericUDTF.initialize(udtfInputOIs);
  if (conf.isOuterLV()) {
    outerObj=Arrays.asList(new Object[udtfOutputOI.getAllStructFieldRefs().size()]);
  }
  outputObjInspector=udtfOutputOI;
  if (HiveConf.getBoolVar(hconf,HiveConf.ConfVars.HIVEUDTFAUTOPROGRESS)) {
    autoProgressor=new AutoProgressor(this.getClass().getName(),reporter,Utilities.getDefaultNotificationInterval(hconf),HiveConf.getIntVar(hconf,HiveConf.ConfVars.HIVES_AUTO_PROGRESS_TIMEOUT) * 1000);
    autoProgressor.go();
  }
  super.initializeOp(hconf);
}
