{
  conf.getGenericUDTF().setCollector(new UDTFCollector(this));
  List<? extends StructField> inputFields=((StandardStructObjectInspector)inputObjInspectors[0]).getAllStructFieldRefs();
  udtfInputOIs=new ObjectInspector[inputFields.size()];
  for (int i=0; i < inputFields.size(); i++) {
    udtfInputOIs[i]=inputFields.get(i).getFieldObjectInspector();
  }
  objToSendToUDTF=new Object[inputFields.size()];
  StructObjectInspector udtfOutputOI=conf.getGenericUDTF().initialize(udtfInputOIs);
  outputObjInspector=udtfOutputOI;
  if (HiveConf.getBoolVar(hconf,HiveConf.ConfVars.HIVEUDTFAUTOPROGRESS)) {
    autoProgressor=new AutoProgressor(this.getClass().getName(),reporter,Utilities.getDefaultNotificationInterval(hconf));
    autoProgressor.go();
  }
  super.initializeOp(hconf);
}
