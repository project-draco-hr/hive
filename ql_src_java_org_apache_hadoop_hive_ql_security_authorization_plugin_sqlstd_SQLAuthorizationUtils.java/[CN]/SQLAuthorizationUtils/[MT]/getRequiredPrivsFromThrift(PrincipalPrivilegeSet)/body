{
  RequiredPrivileges reqPrivs=new RequiredPrivileges();
  Map<String,List<PrivilegeGrantInfo>> userPrivs=thrifPrivs.getUserPrivileges();
  if (userPrivs != null && userPrivs.size() != 1) {
    throw new HiveAuthzPluginException("Invalid number of user privilege objects: " + userPrivs.size());
  }
  addRequiredPrivs(reqPrivs,userPrivs);
  Map<String,List<PrivilegeGrantInfo>> rolePrivs=thrifPrivs.getRolePrivileges();
  addRequiredPrivs(reqPrivs,rolePrivs);
  return reqPrivs;
}
