{
  PerfLogger perfLogger=SessionState.getPerfLogger();
  perfLogger.PerfLogBegin(this.getClass().getName(),PerfLogger.TEZ_COMPILER);
  PhysicalContext physicalCtx=new PhysicalContext(conf,pCtx,pCtx.getContext(),rootTasks,pCtx.getFetchTask());
  if (conf.getBoolVar(HiveConf.ConfVars.HIVENULLSCANOPTIMIZE)) {
    physicalCtx=new NullScanOptimizer().resolve(physicalCtx);
  }
 else {
    LOG.debug("Skipping null scan query optimization");
  }
  if (conf.getBoolVar(HiveConf.ConfVars.HIVEMETADATAONLYQUERIES)) {
    physicalCtx=new MetadataOnlyOptimizer().resolve(physicalCtx);
  }
 else {
    LOG.debug("Skipping metadata only query optimization");
  }
  if (conf.getBoolVar(HiveConf.ConfVars.HIVE_CHECK_CROSS_PRODUCT)) {
    physicalCtx=new CrossProductCheck().resolve(physicalCtx);
  }
 else {
    LOG.debug("Skipping cross product analysis");
  }
  if (conf.getBoolVar(HiveConf.ConfVars.HIVE_VECTORIZATION_ENABLED)) {
    physicalCtx=new Vectorizer().resolve(physicalCtx);
  }
 else {
    LOG.debug("Skipping vectorization");
  }
  if (!"none".equalsIgnoreCase(conf.getVar(HiveConf.ConfVars.HIVESTAGEIDREARRANGE))) {
    physicalCtx=new StageIDsRearranger().resolve(physicalCtx);
  }
 else {
    LOG.debug("Skipping stage id rearranger");
  }
  if ((conf.getBoolVar(HiveConf.ConfVars.HIVE_TEZ_ENABLE_MEMORY_MANAGER)) && (conf.getBoolVar(HiveConf.ConfVars.HIVEUSEHYBRIDGRACEHASHJOIN))) {
    physicalCtx=new MemoryDecider().resolve(physicalCtx);
  }
  if ("llap".equalsIgnoreCase(conf.getVar(HiveConf.ConfVars.HIVE_EXECUTION_MODE))) {
    physicalCtx=new LlapDecider().resolve(physicalCtx);
  }
 else {
    LOG.debug("Skipping llap decider");
  }
  physicalCtx=new SerializeFilter().resolve(physicalCtx);
  perfLogger.PerfLogEnd(this.getClass().getName(),PerfLogger.TEZ_COMPILER,"optimizeTaskPlan");
  return;
}
