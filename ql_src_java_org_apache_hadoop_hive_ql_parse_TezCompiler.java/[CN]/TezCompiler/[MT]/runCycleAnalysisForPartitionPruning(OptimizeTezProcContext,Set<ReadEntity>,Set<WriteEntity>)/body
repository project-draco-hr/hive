{
  if (!procCtx.conf.getBoolVar(ConfVars.TEZ_DYNAMIC_PARTITION_PRUNING)) {
    return;
  }
  boolean cycleFree=false;
  while (!cycleFree) {
    cycleFree=true;
    Set<Set<Operator<?>>> components=getComponents(procCtx);
    for (    Set<Operator<?>> component : components) {
      if (LOG.isDebugEnabled()) {
        LOG.debug("Component: ");
        for (        Operator<?> co : component) {
          LOG.debug("Operator: " + co.getName() + ", "+ co.getIdentifier());
        }
      }
      if (component.size() != 1) {
        LOG.info("Found cycle in operator plan...");
        cycleFree=false;
        removeEventOperator(component);
      }
    }
    LOG.info("Cycle free: " + cycleFree);
  }
}
