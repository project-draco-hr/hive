{
  try {
    if (tmpFile != null) {
      return;
    }
    String suffix=".tmp";
    if (this.keyObject != null) {
      suffix="." + this.keyObject.toString() + suffix;
    }
    parentDir=FileUtils.createLocalDirsTempFile(spillFileDirs,"hive-rowcontainer","",true);
    tmpFile=File.createTempFile("RowContainer",suffix,parentDir);
    LOG.info("RowContainer created temp file " + tmpFile.getAbsolutePath());
    parentDir.deleteOnExit();
    tmpFile.deleteOnExit();
    HiveOutputFormat<?,?> hiveOutputFormat=HiveFileFormatUtils.getHiveOutputFormat(jc,tblDesc);
    tempOutPath=new Path(tmpFile.toString());
    JobConf localJc=getLocalFSJobConfClone(jc);
    rw=HiveFileFormatUtils.getRecordWriter(this.jobCloneUsingLocalFs,hiveOutputFormat,serde.getSerializedClass(),false,tblDesc.getProperties(),tempOutPath,reporter);
  }
 catch (  Exception e) {
    clearRows();
    LOG.error(e.toString(),e);
    throw new HiveException(e);
  }
}
