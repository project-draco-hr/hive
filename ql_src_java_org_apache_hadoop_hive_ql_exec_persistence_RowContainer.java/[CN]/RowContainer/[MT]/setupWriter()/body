{
  try {
    if (tmpFile != null) {
      return;
    }
    String suffix=".tmp";
    if (this.keyObject != null) {
      suffix="." + this.keyObject.toString() + suffix;
    }
    while (true) {
      parentFile=File.createTempFile("hive-rowcontainer","");
      boolean success=parentFile.delete() && parentFile.mkdir();
      if (success) {
        break;
      }
      LOG.debug("retry creating tmp row-container directory...");
    }
    tmpFile=File.createTempFile("RowContainer",suffix,parentFile);
    LOG.info("RowContainer created temp file " + tmpFile.getAbsolutePath());
    parentFile.deleteOnExit();
    tmpFile.deleteOnExit();
    HiveOutputFormat<?,?> hiveOutputFormat=HiveFileFormatUtils.getHiveOutputFormat(jc,tblDesc);
    tempOutPath=new Path(tmpFile.toString());
    JobConf localJc=getLocalFSJobConfClone(jc);
    rw=HiveFileFormatUtils.getRecordWriter(this.jobCloneUsingLocalFs,hiveOutputFormat,serde.getSerializedClass(),false,tblDesc.getProperties(),tempOutPath,reporter);
  }
 catch (  Exception e) {
    clearRows();
    LOG.error(e.toString(),e);
    throw new HiveException(e);
  }
}
