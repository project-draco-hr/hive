{
  assert(serde != null && standardOI != null);
  ByteArrayOutputStream baos;
  DataOutputStream oos;
  try {
    baos=new ByteArrayOutputStream();
    oos=new DataOutputStream(baos);
    oos.writeInt(obj.length);
    if (serde != null && standardOI != null) {
      for (int i=0; i < obj.length; ++i) {
        Writable outVal=serde.serialize(obj[i],standardOI);
        outVal.write(oos);
      }
    }
    oos.close();
  }
 catch (  Exception e) {
    e.printStackTrace();
    throw new HiveException(e);
  }
  return baos.toByteArray();
}
