{
  assert(serde != null && standardOI != null);
  ByteArrayOutputStream baos;
  ObjectOutputStream oos;
  try {
    baos=new ByteArrayOutputStream();
    oos=new ObjectOutputStream(baos);
    oos.writeInt(obj.length);
    for (int i=0; i < obj.length; ++i) {
      Writable outVal=serde.serialize(obj[i],standardOI);
      outVal.write(oos);
    }
    oos.close();
  }
 catch (  Exception e) {
    e.printStackTrace();
    throw new HiveException(e);
  }
  return baos.toByteArray();
}
