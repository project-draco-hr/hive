{
  if (size == 0) {
    return null;
  }
  try {
    firstCalled=true;
    this.itrCursor=0;
    closeWriter();
    closeReader();
    if (tblDesc == null) {
      this.itrCursor++;
      return dummyRow;
    }
    this.currentReadBlock=this.firstReadBlockPointer;
    if (this.numFlushedBlocks == 0) {
      this.readBlockSize=this.addCursor;
      this.currentReadBlock=this.currentWriteBlock;
    }
 else {
      JobConf localJc=getLocalFSJobConfClone(jc);
      if (inputSplits == null) {
        if (this.inputFormat == null) {
          inputFormat=(InputFormat<WritableComparable,Writable>)ReflectionUtils.newInstance(tblDesc.getInputFileFormatClass(),localJc);
        }
        HiveConf.setVar(localJc,HiveConf.ConfVars.HADOOPMAPREDINPUTDIR,org.apache.hadoop.util.StringUtils.escapeString(parentFile.getAbsolutePath()));
        inputSplits=inputFormat.getSplits(localJc,1);
        acutalSplitNum=inputSplits.length;
      }
      currentSplitPointer=0;
      rr=inputFormat.getRecordReader(inputSplits[currentSplitPointer],localJc,Reporter.NULL);
      currentSplitPointer++;
      nextBlock();
    }
    Row ret=currentReadBlock[itrCursor++];
    removeKeys(ret);
    return ret;
  }
 catch (  Exception e) {
    throw new HiveException(e);
  }
}
