{
  if (size == 0) {
    return null;
  }
  try {
    firstCalled=true;
    this.itrCursor=0;
    closeWriter();
    closeReader();
    if (tblDesc == null) {
      this.itrCursor++;
      return dummyRow;
    }
    this.currentReadBlock=this.firstReadBlockPointer;
    if (this.numFlushedBlocks == 0) {
      this.readBlockSize=this.addCursor;
      this.currentReadBlock=this.currentWriteBlock;
    }
 else {
      JobConf localJc=getLocalFSJobConfClone(jc);
      if (inputSplits == null) {
        if (this.inputFormat == null) {
          inputFormat=ReflectionUtil.newInstance(tblDesc.getInputFileFormatClass(),localJc);
        }
        localJc.set(FileInputFormat.INPUT_DIR,org.apache.hadoop.util.StringUtils.escapeString(parentFile.getAbsolutePath()));
        inputSplits=inputFormat.getSplits(localJc,1);
        actualSplitNum=inputSplits.length;
      }
      currentSplitPointer=0;
      rr=inputFormat.getRecordReader(inputSplits[currentSplitPointer],localJc,reporter);
      currentSplitPointer++;
      nextBlock(0);
    }
    ROW ret=currentReadBlock[itrCursor++];
    removeKeys(ret);
    return ret;
  }
 catch (  Exception e) {
    throw new HiveException(e);
  }
}
