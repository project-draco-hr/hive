{
  MapJoinResolver.LocalMapJoinProcCtx context=new MapJoinResolver.LocalMapJoinProcCtx(task,parseContext);
  try {
    new LocalMapJoinProcFactory.LocalMapJoinProcessor().hasGroupBy(mapJoinOp,context);
  }
 catch (  Exception e) {
    LOG.warn("Error setting memory usage.",e);
    return;
  }
  MapJoinDesc mapJoinDesc=mapJoinOp.getConf();
  HiveConf conf=context.getParseCtx().getConf();
  float hashtableMemoryUsage;
  if (context.isFollowedByGroupBy()) {
    hashtableMemoryUsage=conf.getFloatVar(HiveConf.ConfVars.HIVEHASHTABLEFOLLOWBYGBYMAXMEMORYUSAGE);
  }
 else {
    hashtableMemoryUsage=conf.getFloatVar(HiveConf.ConfVars.HIVEHASHTABLEMAXMEMORYUSAGE);
  }
  mapJoinDesc.setHashTableMemoryUsage(hashtableMemoryUsage);
}
