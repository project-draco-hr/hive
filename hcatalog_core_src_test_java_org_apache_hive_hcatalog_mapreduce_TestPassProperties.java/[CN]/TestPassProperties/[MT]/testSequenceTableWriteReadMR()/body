{
  Initialize();
  String createTable="CREATE TABLE bad_props_table(a0 int, a1 String, a2 String) STORED AS SEQUENCEFILE";
  driver.run("drop table bad_props_table");
  int retCode1=driver.run(createTable).getResponseCode();
  assertTrue(retCode1 == 0);
  boolean caughtException=false;
  try {
    Configuration conf=new Configuration();
    conf.set("hive.metastore.uris","thrift://no.such.machine:10888");
    Job job=new Job(conf,"Write-hcat-seq-table");
    job.setJarByClass(TestPassProperties.class);
    job.setMapperClass(Map.class);
    job.setOutputKeyClass(NullWritable.class);
    job.setOutputValueClass(DefaultHCatRecord.class);
    job.setInputFormatClass(TextInputFormat.class);
    TextInputFormat.setInputPaths(job,INPUT_FILE_NAME);
    HCatOutputFormat.setOutput(job,OutputJobInfo.create(MetaStoreUtils.DEFAULT_DATABASE_NAME,"bad_props_table",null));
    job.setOutputFormatClass(HCatOutputFormat.class);
    HCatOutputFormat.setSchema(job,getSchema());
    job.setNumReduceTasks(0);
    assertTrue(job.waitForCompletion(true));
    new FileOutputCommitterContainer(job,null).cleanupJob(job);
  }
 catch (  Exception e) {
    caughtException=true;
    assertTrue(e.getCause().getMessage().contains("Could not connect to meta store using any of the URIs provided"));
  }
  assertTrue(caughtException);
}
