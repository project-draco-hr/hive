{
  List<String> hiveColumns=Arrays.asList("rowid","col1","col2","col3");
  List<TypeInfo> columnTypes=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.getMapTypeInfo(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo),TypeInfoFactory.getMapTypeInfo(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo),TypeInfoFactory.stringTypeInfo);
  List<String> rawMappings=Arrays.asList(AccumuloHiveConstants.ROWID,"cf1:*","cf2:2*","cq3:bar\\*");
  ColumnMapper mapper=new ColumnMapper(Joiner.on(AccumuloHiveConstants.COMMA).join(rawMappings),ColumnEncoding.BINARY.getName(),hiveColumns,columnTypes);
  List<ColumnMapping> mappings=mapper.getColumnMappings();
  Assert.assertEquals(4,mappings.size());
  Assert.assertEquals(HiveAccumuloRowIdColumnMapping.class,mappings.get(0).getClass());
  Assert.assertEquals(HiveAccumuloMapColumnMapping.class,mappings.get(1).getClass());
  Assert.assertEquals(HiveAccumuloMapColumnMapping.class,mappings.get(2).getClass());
  Assert.assertEquals(HiveAccumuloColumnMapping.class,mappings.get(3).getClass());
  HiveAccumuloRowIdColumnMapping row=(HiveAccumuloRowIdColumnMapping)mappings.get(0);
  Assert.assertEquals(ColumnEncoding.BINARY,row.getEncoding());
  Assert.assertEquals(hiveColumns.get(0),row.getColumnName());
  Assert.assertEquals(columnTypes.get(0).toString(),row.getColumnType());
  HiveAccumuloMapColumnMapping map=(HiveAccumuloMapColumnMapping)mappings.get(1);
  Assert.assertEquals("cf1",map.getColumnFamily());
  Assert.assertEquals("",map.getColumnQualifierPrefix());
  Assert.assertEquals(ColumnEncoding.BINARY,map.getEncoding());
  Assert.assertEquals(hiveColumns.get(1),map.getColumnName());
  Assert.assertEquals(columnTypes.get(1).toString(),map.getColumnType());
  map=(HiveAccumuloMapColumnMapping)mappings.get(2);
  Assert.assertEquals("cf2",map.getColumnFamily());
  Assert.assertEquals("2",map.getColumnQualifierPrefix());
  Assert.assertEquals(ColumnEncoding.BINARY,map.getEncoding());
  Assert.assertEquals(hiveColumns.get(2),map.getColumnName());
  Assert.assertEquals(columnTypes.get(2).toString(),map.getColumnType());
  HiveAccumuloColumnMapping column=(HiveAccumuloColumnMapping)mappings.get(3);
  Assert.assertEquals("cq3",column.getColumnFamily());
  Assert.assertEquals("bar*",column.getColumnQualifier());
  Assert.assertEquals(ColumnEncoding.BINARY,column.getEncoding());
  Assert.assertEquals(hiveColumns.get(3),column.getColumnName());
  Assert.assertEquals(columnTypes.get(3).toString(),column.getColumnType());
}
