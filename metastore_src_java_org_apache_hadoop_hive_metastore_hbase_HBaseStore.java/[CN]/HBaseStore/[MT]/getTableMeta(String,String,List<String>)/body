{
  boolean commit=false;
  openTransaction();
  try {
    List<TableMeta> metas=new ArrayList<>();
    for (    String dbName : getDatabases(dbNames)) {
      for (      Table table : getTableObjectsByName(dbName,getTableNamesInTx(dbName,tableNames))) {
        if (tableTypes == null || tableTypes.contains(table.getTableType())) {
          TableMeta metaData=new TableMeta(table.getDbName(),table.getTableName(),table.getTableType());
          metaData.setComments(table.getParameters().get("comment"));
          metas.add(metaData);
        }
      }
    }
    commit=true;
    return metas;
  }
 catch (  Exception e) {
    LOG.error("Unable to get tables ",e);
    throw new MetaException("Unable to get tables, " + e.getMessage());
  }
 finally {
    commitOrRoleBack(commit);
  }
}
