{
  final ExpressionTree exprTree=(filter != null && !filter.isEmpty()) ? PartFilterExprUtil.getFilterParser(filter).tree : ExpressionTree.EMPTY_TREE;
  List<Partition> result=new ArrayList<Partition>();
  boolean commit=false;
  openTransaction();
  try {
    return getPartitionsByFilter(dbName,tblName,filter,Short.MAX_VALUE).size();
  }
  finally {
    commitOrRoleBack(commit);
  }
}
