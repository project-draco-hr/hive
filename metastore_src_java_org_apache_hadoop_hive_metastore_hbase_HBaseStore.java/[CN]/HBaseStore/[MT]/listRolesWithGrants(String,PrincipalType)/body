{
  try {
    List<Role> roles=listRoles(principalName,principalType);
    List<RolePrincipalGrant> rpgs=new ArrayList<RolePrincipalGrant>(roles.size());
    for (    Role role : roles) {
      HbaseMetastoreProto.RoleGrantInfoList grants=getHBase().getRolePrincipals(role.getRoleName());
      for (      HbaseMetastoreProto.RoleGrantInfo grant : grants.getGrantInfoList()) {
        if (grant.getPrincipalType().equals(principalType) && grant.getPrincipalName().equals(principalName)) {
          rpgs.add(new RolePrincipalGrant(role.getRoleName(),principalName,principalType,grant.getGrantOption(),(int)grant.getAddTime(),grant.getGrantor(),HBaseUtils.convertPrincipalTypes(grant.getGrantorType())));
        }
      }
    }
    return rpgs;
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
