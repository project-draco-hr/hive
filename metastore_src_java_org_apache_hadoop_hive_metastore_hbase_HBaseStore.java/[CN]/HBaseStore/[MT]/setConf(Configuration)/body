{
  Configuration oldConf=conf;
  conf=configuration;
  if (expressionProxy != null && conf != oldConf) {
    LOG.warn("Unexpected setConf when we were already configured");
  }
  if (expressionProxy == null || conf != oldConf) {
    expressionProxy=PartFilterExprUtil.createExpressionProxy(conf);
  }
  if (conf != oldConf) {
    fmHandlers=HiveMetaStore.createHandlerMap();
    configureFileMetadataHandlers(fmHandlers.values());
  }
}
