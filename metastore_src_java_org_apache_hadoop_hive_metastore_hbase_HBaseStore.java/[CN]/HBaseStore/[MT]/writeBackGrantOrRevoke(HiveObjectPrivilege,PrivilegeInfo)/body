{
switch (priv.getHiveObject().getObjectType()) {
case GLOBAL:
    try {
      getHBase().putGlobalPrivs(pi.privSet);
    }
 catch (    IOException e) {
      LOG.error("Unable to write global privileges",e);
      throw new MetaException("Unable to write global privileges, " + e.getMessage());
    }
  break;
case DATABASE:
pi.db.setPrivileges(pi.privSet);
alterDatabase(pi.db.getName(),pi.db);
break;
case TABLE:
pi.table.setPrivileges(pi.privSet);
alterTable(pi.table.getDbName(),pi.table.getTableName(),pi.table);
break;
default :
throw new RuntimeException("Dude, you missed the second switch!");
}
}
