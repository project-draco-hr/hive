{
  List<PrivilegeGrantInfo> grants;
  try {
    Table table=getHBase().getTable(dbName,tableName);
switch (principalType) {
case USER:
      grants=table.getPrivileges().getUserPrivileges().get(principalName);
    break;
case ROLE:
  grants=table.getPrivileges().getRolePrivileges().get(principalName);
break;
default :
throw new RuntimeException("Unknown or unsupported principal type " + principalType.toString());
}
if (grants == null || grants.size() == 0) return null;
MTable mtable=null;
List<MTablePrivilege> privileges=new ArrayList<MTablePrivilege>(grants.size());
for (PrivilegeGrantInfo pgi : grants) {
privileges.add(new MTablePrivilege(principalName,principalType.toString(),mtable,pgi.getPrivilege(),pgi.getCreateTime(),pgi.getGrantor(),pgi.getGrantorType().toString(),pgi.isGrantOption()));
}
return privileges;
}
 catch (IOException e) {
throw new RuntimeException(e);
}
}
