{
  openTransaction();
  boolean commit=false;
  try {
    getHBase().storeFileMetadata(fileIds,metadata);
    commit=true;
  }
 catch (  IOException|InterruptedException e) {
    LOG.error("Unable to store file metadata",e);
    throw new MetaException("Error storing file metadata " + e.getMessage());
  }
 finally {
    commitOrRoleBack(commit);
  }
}
