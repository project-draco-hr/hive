{
  List<PrivilegeGrantInfo> grants;
  try {
    Database db=getHBase().getDb(dbName);
switch (principalType) {
case USER:
      grants=db.getPrivileges().getUserPrivileges().get(principalName);
    break;
case ROLE:
  grants=db.getPrivileges().getRolePrivileges().get(principalName);
break;
default :
throw new RuntimeException("Unknown or unsupported principal type " + principalType.toString());
}
if (grants == null || grants.size() == 0) return null;
MDatabase mdb=new MDatabase(db.getName(),db.getLocationUri(),db.getDescription(),db.getParameters());
List<MDBPrivilege> privileges=new ArrayList<MDBPrivilege>(grants.size());
for (PrivilegeGrantInfo pgi : grants) {
privileges.add(new MDBPrivilege(principalName,principalType.toString(),mdb,pgi.getPrivilege(),pgi.getCreateTime(),pgi.getGrantor(),pgi.getGrantorType().toString(),pgi.isGrantOption()));
}
return privileges;
}
 catch (IOException e) {
throw new RuntimeException(e);
}
}
