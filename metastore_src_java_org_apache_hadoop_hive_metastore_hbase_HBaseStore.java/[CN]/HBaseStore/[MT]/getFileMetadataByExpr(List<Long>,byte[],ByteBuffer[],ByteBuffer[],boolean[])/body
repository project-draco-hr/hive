{
  SearchArgument sarg=expressionProxy.createSarg(expr);
  boolean commit=true;
  try {
    getHBase().getFileMetadata(fileIds,metadatas);
    for (int i=0; i < metadatas.length; ++i) {
      if (metadatas[i] == null)       continue;
      ByteBuffer result=expressionProxy.applySargToFileMetadata(sarg,metadatas[i]);
      eliminated[i]=(result == null);
      if (!eliminated[i]) {
        results[i]=result;
      }
    }
  }
 catch (  IOException e) {
    commit=false;
    LOG.error("Unable to get file metadata",e);
    throw new MetaException("Error reading file metadata " + e.getMessage());
  }
 finally {
    commitOrRoleBack(commit);
  }
}
