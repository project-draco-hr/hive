{
  List<PrivilegeGrantInfo> grants;
  try {
switch (principalType) {
case USER:
      grants=getHBase().getGlobalPrivs().getUserPrivileges().get(principalName);
    break;
case ROLE:
  grants=getHBase().getGlobalPrivs().getRolePrivileges().get(principalName);
break;
default :
throw new RuntimeException("Unknown or unsupported principal type " + principalType.toString());
}
if (grants == null || grants.size() == 0) return null;
List<MGlobalPrivilege> privileges=new ArrayList<MGlobalPrivilege>(grants.size());
for (PrivilegeGrantInfo pgi : grants) {
privileges.add(new MGlobalPrivilege(principalName,principalType.toString(),pgi.getPrivilege(),pgi.getCreateTime(),pgi.getGrantor(),pgi.getGrantorType().toString(),pgi.isGrantOption()));
}
return privileges;
}
 catch (IOException e) {
throw new RuntimeException(e);
}
}
