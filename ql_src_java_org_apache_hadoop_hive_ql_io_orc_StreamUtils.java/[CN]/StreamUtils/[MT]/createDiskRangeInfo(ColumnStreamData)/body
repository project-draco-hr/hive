{
  DiskRangeInfo diskRangeInfo=new DiskRangeInfo(streamBuffer.getIndexBaseOffset());
  long offset=diskRangeInfo.getTotalLength();
  for (  MemoryBuffer memoryBuffer : streamBuffer.getCacheBuffers()) {
    ByteBuffer buffer=memoryBuffer.getByteBufferDup();
    diskRangeInfo.addDiskRange(new RecordReaderImpl.BufferChunk(buffer,offset));
    offset+=buffer.remaining();
  }
  return diskRangeInfo;
}
