{
  int strLen=20;
  int[] lengths={15,20,25};
  for (int idx1=0; idx1 < lengths.length; ++idx1) {
    StringBuffer sb=new StringBuffer();
    int curLen=lengths[idx1];
    for (int idx2=0; idx2 < curLen; ++idx2) {
      sb.appendCodePoint(getRandomCodePoint(' '));
    }
    String testString=sb.toString();
    assertEquals(curLen,testString.codePointCount(0,testString.length()));
    String enforcedString=HiveBaseChar.enforceMaxLength(testString,strLen);
    if (curLen <= strLen) {
      assertEquals(testString,enforcedString);
    }
 else {
      assertEquals(strLen,enforcedString.codePointCount(0,enforcedString.length()));
    }
  }
  String[] testStrings={"abcdefg","abcdefghijklmnopqrst","abcdefghijklmnopqrstuvwxyz"};
  for (  String testString : testStrings) {
    int curLen=testString.length();
    assertEquals(curLen,testString.codePointCount(0,testString.length()));
    String enforcedString=HiveBaseChar.enforceMaxLength(testString,strLen);
    if (curLen <= strLen) {
      assertEquals(testString,enforcedString);
    }
 else {
      assertEquals(strLen,enforcedString.codePointCount(0,enforcedString.length()));
    }
  }
  HiveVarchar vc1=new HiveVarchar("0123456789",10);
  assertEquals(10,vc1.getCharacterLength());
  vc1.setValue("012345678901234");
  assertEquals(15,vc1.getCharacterLength());
  vc1.setValue("01234",-1);
  assertEquals(5,vc1.getCharacterLength());
  vc1.setValue(new HiveVarchar("0123456789",-1));
  assertEquals(10,vc1.getCharacterLength());
  vc1.setValue(new HiveVarchar("01234",-1),-1);
  assertEquals(5,vc1.getCharacterLength());
}
