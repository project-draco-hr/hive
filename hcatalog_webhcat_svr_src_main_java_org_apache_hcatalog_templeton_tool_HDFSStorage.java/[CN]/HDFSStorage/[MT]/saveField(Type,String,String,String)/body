{
  if (val == null) {
    return;
  }
  PrintWriter out=null;
  Path keyfile=new Path(getPath(type) + "/" + id+ "/"+ key);
  try {
    out=new PrintWriter(new OutputStreamWriter(fs.create(keyfile)));
    out.write(val);
    out.flush();
  }
 catch (  Exception e) {
    String errMsg="Couldn't write to " + keyfile + ": "+ e.getMessage();
    LOG.error(errMsg,e);
    throw new NotFoundException(errMsg,e);
  }
 finally {
    close(out);
  }
}
