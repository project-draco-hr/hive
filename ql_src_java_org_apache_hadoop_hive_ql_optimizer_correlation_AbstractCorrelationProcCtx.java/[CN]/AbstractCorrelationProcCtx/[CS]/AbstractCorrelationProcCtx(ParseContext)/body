{
  removedOps=new HashSet<Operator<?>>();
  trustScript=pctx.getConf().getBoolVar(HIVESCRIPTOPERATORTRUST);
  if (pctx.hasAcidWrite()) {
    StringBuilder tblNames=new StringBuilder();
    for (    FileSinkDesc fsd : pctx.getAcidSinks()) {
      if (fsd.getTable() != null) {
        tblNames.append(fsd.getTable().getDbName()).append('.').append(fsd.getTable().getTableName()).append(',');
      }
    }
    if (tblNames.length() > 0) {
      tblNames.setLength(tblNames.length() - 1);
    }
    LOG.info("Overriding " + HIVEOPTREDUCEDEDUPLICATIONMINREDUCER + " to 1 due to a write to transactional table(s) "+ tblNames);
    minReducer=1;
  }
 else {
    minReducer=pctx.getConf().getIntVar(HIVEOPTREDUCEDEDUPLICATIONMINREDUCER);
  }
  isMapAggr=pctx.getConf().getBoolVar(HIVEMAPSIDEAGGREGATE);
  this.pctx=pctx;
}
