{
  HiveConf c=new HiveConf();
  final HiveMetaStoreClient client=new HiveMetaStoreClient(c);
  LOG.info("user: " + user + " loginUser: "+ UserGroupInformation.getLoginUser().getUserName());
  final TokenWrapper twrapper=new TokenWrapper();
  final UserGroupInformation ugi=UgiFactory.getUgi(user);
  String s=ugi.doAs(new PrivilegedExceptionAction<String>(){
    public String run() throws IOException, MetaException, TException {
      String u=ugi.getUserName();
      return client.getDelegationToken(u);
    }
  }
);
  return s;
}
