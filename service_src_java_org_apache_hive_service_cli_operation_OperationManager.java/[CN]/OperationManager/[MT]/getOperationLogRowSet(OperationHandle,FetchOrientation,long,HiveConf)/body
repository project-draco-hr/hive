{
  TableSchema tableSchema=new TableSchema(getLogSchema());
  RowSet rowSet=RowSetFactory.create(tableSchema,getOperation(opHandle).getProtocolVersion());
  if (hConf.getBoolVar(ConfVars.HIVE_SERVER2_LOGGING_OPERATION_ENABLED) == false) {
    LOG.warn("Try to get operation log when hive.server2.logging.operation.enabled is false, no log will be returned. ");
    return rowSet;
  }
  OperationLog operationLog=getOperation(opHandle).getOperationLog();
  if (operationLog == null) {
    throw new HiveSQLException("Couldn't find log associated with operation handle: " + opHandle);
  }
  List<String> logs;
  try {
    logs=operationLog.readOperationLog(isFetchFirst(orientation),maxRows);
  }
 catch (  SQLException e) {
    throw new HiveSQLException(e.getMessage(),e.getCause());
  }
  for (  String log : logs) {
    rowSet.addRow(new String[]{log});
  }
  return rowSet;
}
