{
  Logger root=Logger.getRootLogger();
  Layout layout=null;
  Enumeration<?> appenders=root.getAllAppenders();
  while (appenders.hasMoreElements()) {
    Appender ap=(Appender)appenders.nextElement();
    if (ap.getClass().equals(ConsoleAppender.class)) {
      layout=ap.getLayout();
      break;
    }
  }
  final String VERBOSE_PATTERN="%d{yy/MM/dd HH:mm:ss} %p %c{2}: %m%n";
  final String NONVERBOSE_PATTERN="%-5p : %m%n";
  if (isVerbose) {
    if (layout == null) {
      layout=new PatternLayout(VERBOSE_PATTERN);
      LOG.info("Cannot find a Layout from a ConsoleAppender. Using default Layout pattern.");
    }
  }
 else {
    layout=new PatternLayout(NONVERBOSE_PATTERN);
  }
  Appender ap=new LogDivertAppender(layout,this,isVerbose);
  root.addAppender(ap);
}
