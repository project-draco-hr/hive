{
  boolean testMode=conf.getBoolVar(HiveConf.ConfVars.HIVETESTMODE);
  if (testMode) {
    URI uri=new Path(location).toUri();
    String scheme=uri.getScheme();
    String authority=uri.getAuthority();
    String path=uri.getPath();
    if (!path.startsWith("/")) {
      path=new Path(System.getProperty("build.dir.hive"),path).toString();
    }
    if (StringUtils.isEmpty(scheme)) {
      scheme="pfile";
    }
    try {
      uri=new URI(scheme,authority,path,null,null);
    }
 catch (    URISyntaxException e) {
      throw new SemanticException(ErrorMsg.INVALID_PATH.getMsg(),e);
    }
    return uri.toString();
  }
 else {
    return location;
  }
}
