{
  OutputStream out=fs.create(metadataPath);
  JsonGenerator jgen=(new JsonFactory()).createJsonGenerator(out);
  jgen.writeStartObject();
  jgen.writeStringField("version",METADATA_FORMAT_VERSION);
  if (METADATA_FORMAT_FORWARD_COMPATIBLE_VERSION != null) {
    jgen.writeStringField("fcversion",METADATA_FORMAT_FORWARD_COMPATIBLE_VERSION);
  }
  TSerializer serializer=new TSerializer(new TJSONProtocol.Factory());
  try {
    jgen.writeStringField("table",serializer.toString(tableHandle.getTTable(),"UTF-8"));
    jgen.writeFieldName("partitions");
    jgen.writeStartArray();
    if (partitions != null) {
      for (      org.apache.hadoop.hive.ql.metadata.Partition partition : partitions) {
        jgen.writeString(serializer.toString(partition.getTPartition(),"UTF-8"));
        jgen.flush();
      }
    }
    jgen.writeEndArray();
  }
 catch (  TException e) {
    throw new SemanticException(ErrorMsg.GENERIC_ERROR.getMsg("Exception while serializing the metastore objects"),e);
  }
  jgen.writeEndObject();
  jgen.close();
}
