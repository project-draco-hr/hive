{
  Type type=hcatFS.getType();
switch (type) {
case BINARY:
    ByteArrayRef ba=new ByteArrayRef();
  byte[] bytes=(null == pigObj) ? new byte[0] : ((DataByteArray)pigObj).get();
ba.setData(bytes);
return ba;
case STRUCT:
return ((Tuple)pigObj).getAll();
case ARRAY:
DataBag pigBag=(DataBag)pigObj;
HCatFieldSchema tupFS=hcatFS.getArrayElementSchema().get(0);
boolean needTuple=tupFS.getType() == Type.STRUCT;
List<Object> bagContents=new ArrayList<Object>((int)pigBag.size());
Iterator<Tuple> bagItr=pigBag.iterator();
while (bagItr.hasNext()) {
bagContents.add(needTuple ? getJavaObj(bagItr.next(),tupFS) : bagItr.next().get(0));
}
return bagContents;
default :
return pigObj;
}
}
