{
  if (type == null) {
    return null;
  }
switch (type) {
case USER:
    return HivePrincipalType.USER;
case ROLE:
  return HivePrincipalType.ROLE;
case GROUP:
if (SessionState.get().getAuthorizationMode() == SessionState.AuthorizationMode.V2) {
  throw new HiveException(ErrorMsg.UNSUPPORTED_AUTHORIZATION_PRINCIPAL_TYPE_GROUP);
}
return HivePrincipalType.GROUP;
default :
throw new AssertionError("Unsupported authorization type specified");
}
}
