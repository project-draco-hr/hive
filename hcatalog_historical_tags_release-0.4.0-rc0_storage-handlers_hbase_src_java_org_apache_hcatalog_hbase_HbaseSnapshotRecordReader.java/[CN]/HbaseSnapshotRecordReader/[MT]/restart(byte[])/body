{
  allAbortedTransactions=getAbortedTransactions(Bytes.toString(htable.getTableName()),scan);
  long maxValidRevision=snapshot.getLatestRevision();
  while (allAbortedTransactions.contains(maxValidRevision)) {
    maxValidRevision--;
  }
  long minValidRevision=getMinimumRevision(scan,snapshot);
  while (allAbortedTransactions.contains(minValidRevision)) {
    minValidRevision--;
  }
  Scan newScan=new Scan(scan);
  newScan.setStartRow(firstRow);
  newScan.setTimeRange(minValidRevision,maxValidRevision + 1);
  newScan.setMaxVersions();
  this.scanner=this.htable.getScanner(newScan);
  resultItr=this.scanner.iterator();
}
