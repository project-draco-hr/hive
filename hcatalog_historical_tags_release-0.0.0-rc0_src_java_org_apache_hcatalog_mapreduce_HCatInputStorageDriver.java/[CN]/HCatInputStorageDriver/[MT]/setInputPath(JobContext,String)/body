{
  int length=location.length();
  int curlyOpen=0;
  int pathStart=0;
  boolean globPattern=false;
  List<String> pathStrings=new ArrayList<String>();
  for (int i=0; i < length; i++) {
    char ch=location.charAt(i);
switch (ch) {
case '{':
{
        curlyOpen++;
        if (!globPattern) {
          globPattern=true;
        }
        break;
      }
case '}':
{
      curlyOpen--;
      if (curlyOpen == 0 && globPattern) {
        globPattern=false;
      }
      break;
    }
case ',':
{
    if (!globPattern) {
      pathStrings.add(location.substring(pathStart,i));
      pathStart=i + 1;
    }
    break;
  }
}
}
pathStrings.add(location.substring(pathStart,length));
Path[] paths=StringUtils.stringToPath(pathStrings.toArray(new String[0]));
Configuration conf=jobContext.getConfiguration();
FileSystem fs=FileSystem.get(conf);
Path path=paths[0].makeQualified(fs);
StringBuilder str=new StringBuilder(StringUtils.escapeString(path.toString()));
for (int i=1; i < paths.length; i++) {
str.append(StringUtils.COMMA_STR);
path=paths[i].makeQualified(fs);
str.append(StringUtils.escapeString(path.toString()));
}
conf.set("mapred.input.dir",str.toString());
}
