{
  int i;
  for (i=0; i < outputFromPivotFunctions.length; i++) {
    if (outputFromPivotFunctions[i] != null) {
      output.set(i,outputFromPivotFunctions[i].get(currIdx));
    }
  }
  try {
    for (    int j : wFnsToProcess) {
      WindowFunctionDef wFn=wTFnDef.getWindowFunctions().get(j);
      if (wFn.getWFnEval() instanceof ISupportStreamingModeForWindowing) {
        Object iRow=iPart.getAt(currIdx);
        int a=0;
        if (wFn.getArgs() != null) {
          for (          PTFExpressionDef arg : wFn.getArgs()) {
            args[j][a++]=arg.getExprEvaluator().evaluate(iRow);
          }
        }
        wFn.getWFnEval().aggregate(aggBuffers[j],args[j]);
        Object out=((ISupportStreamingModeForWindowing)wFn.getWFnEval()).getNextResult(aggBuffers[j]);
        out=ObjectInspectorUtils.copyToStandardObject(out,wFn.getOI());
        output.set(j,out);
      }
 else {
        Range rng=getRange(wFn,currIdx,iPart,order);
        PTFPartitionIterator<Object> rItr=rng.iterator();
        PTFOperator.connectLeadLagFunctionsToPartition(ptfDesc,rItr);
        output.set(j,evaluateWindowFunction(wFn,rItr));
      }
    }
    Object iRow=iPart.getAt(currIdx);
    i=wTFnDef.getWindowFunctions().size();
    for (    StructField f : inputOI.getAllStructFieldRefs()) {
      output.set(i++,inputOI.getStructFieldData(iRow,f));
    }
  }
 catch (  HiveException he) {
    throw new RuntimeException(he);
  }
  currIdx++;
  return output;
}
