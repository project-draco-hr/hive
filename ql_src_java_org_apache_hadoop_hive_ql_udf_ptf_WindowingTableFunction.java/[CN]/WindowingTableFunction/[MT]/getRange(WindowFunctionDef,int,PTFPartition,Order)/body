{
  BoundaryDef startB=wFnDef.getWindowFrame().getStart();
  BoundaryDef endB=wFnDef.getWindowFrame().getEnd();
  boolean rowFrame=true;
  if (startB instanceof ValueBoundaryDef || endB instanceof ValueBoundaryDef) {
    rowFrame=false;
  }
  int start, end;
  if (rowFrame) {
    start=getRowBoundaryStart(startB,currRow);
    end=getRowBoundaryEnd(endB,currRow,p);
  }
 else {
    ValueBoundaryScanner vbs;
    if (startB instanceof ValueBoundaryDef) {
      vbs=ValueBoundaryScanner.getScanner((ValueBoundaryDef)startB,order);
    }
 else {
      vbs=ValueBoundaryScanner.getScanner((ValueBoundaryDef)endB,order);
    }
    vbs.reset(startB);
    start=vbs.computeStart(currRow,p);
    vbs.reset(endB);
    end=vbs.computeEnd(currRow,p);
  }
  start=start < 0 ? 0 : start;
  end=end > p.size() ? p.size() : end;
  return new Range(start,end,p);
}
