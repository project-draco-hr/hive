{
  Direction d=b.getDirection();
  int amt=b.getAmt();
switch (d) {
case PRECEDING:
    if (amt == 0) {
      return currRow + 1;
    }
  return currRow - amt + 1;
case CURRENT:
return currRow + 1;
case FOLLOWING:
if (amt == BoundarySpec.UNBOUNDED_AMOUNT) {
return p.size();
}
 else {
return currRow + amt + 1;
}
}
throw new HiveException("Unknown End Boundary Direction: " + d);
}
