{
  BoundaryDef startB=wFnDef.getWindowFrame().getStart();
  BoundaryDef endB=wFnDef.getWindowFrame().getEnd();
  boolean rowFrame=true;
  if (startB instanceof ValueBoundaryDef || endB instanceof ValueBoundaryDef) {
    rowFrame=false;
  }
  int start, end;
  if (rowFrame) {
    start=getRowBoundaryStart(startB,currRow);
    end=getRowBoundaryEnd(endB,currRow,p);
  }
 else {
    ValueBoundaryScanner vbs;
    if (startB instanceof ValueBoundaryDef) {
      ValueBoundaryDef startValueBoundaryDef=(ValueBoundaryDef)startB;
      if (startValueBoundaryDef.getOrderDef().getExpressions().size() != 1) {
        vbs=MultiValueBoundaryScanner.getScanner(startValueBoundaryDef);
      }
 else {
        vbs=SingleValueBoundaryScanner.getScanner(startValueBoundaryDef);
      }
    }
 else {
      ValueBoundaryDef endValueBoundaryDef=(ValueBoundaryDef)endB;
      if (endValueBoundaryDef.getOrderDef().getExpressions().size() != 1) {
        vbs=MultiValueBoundaryScanner.getScanner(endValueBoundaryDef);
      }
 else {
        vbs=SingleValueBoundaryScanner.getScanner(endValueBoundaryDef);
      }
    }
    vbs.reset(startB);
    start=vbs.computeStart(currRow,p);
    vbs.reset(endB);
    end=vbs.computeEnd(currRow,p);
  }
  start=start < 0 ? 0 : start;
  end=end > p.size() ? p.size() : end;
  return new Range(start,end,p);
}
