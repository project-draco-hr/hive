{
  int numFields=arguments.length;
  if (numFields % 2 == 1) {
    throw new UDFArgumentLengthException("NAMED_STRUCT expects an even number of arguments.");
  }
  ret=new Object[numFields / 2];
  ArrayList<String> fname=new ArrayList<String>(numFields / 2);
  ArrayList<ObjectInspector> retOIs=new ArrayList<ObjectInspector>(numFields / 2);
  for (int f=0; f < numFields; f+=2) {
    if (!(arguments[f] instanceof ConstantObjectInspector)) {
      throw new UDFArgumentTypeException(f,"Even arguments" + " to NAMED_STRUCT must be a constant STRING." + arguments[f].toString());
    }
    ConstantObjectInspector constantOI=(ConstantObjectInspector)arguments[f];
    fname.add(constantOI.getWritableConstantValue().toString());
    retOIs.add(arguments[f + 1]);
  }
  StructObjectInspector soi=ObjectInspectorFactory.getStandardStructObjectInspector(fname,retOIs);
  return soi;
}
