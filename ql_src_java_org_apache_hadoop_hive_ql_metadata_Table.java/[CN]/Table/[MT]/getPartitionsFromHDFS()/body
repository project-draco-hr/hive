{
  ArrayList<Partition> ret=new ArrayList<Partition>();
  FileSystem fs=null;
  Vector<String> partPaths=new Vector<String>();
  try {
    fs=FileSystem.get(getDataLocation(),Hive.get().getConf());
    getPartPaths(fs,new Path(getDataLocation().getPath()),partPaths);
    for (    String partPath : partPaths) {
      Path tmpPath=new Path(partPath);
      if (!fs.getFileStatus(tmpPath).isDir()) {
        throw new HiveException("Data in hdfs is messed up. Table " + getName() + " has a partition "+ partPath+ " that is not a directory");
      }
      ret.add(new Partition(this,tmpPath));
    }
  }
 catch (  IOException e) {
    LOG.error(StringUtils.stringifyException(e));
    throw new HiveException("DB Error: Table " + getDataLocation() + " message: "+ e.getMessage());
  }
  return ret;
}
