{
  List<FieldSchema> partCols=getTTable().getPartitionKeys();
  if (partCols == null || (partCols.size() == 0)) {
    if (spec != null) {
      throw new HiveException("table is not partitioned but partition spec exists: " + spec);
    }
 else {
      return true;
    }
  }
  if ((spec == null) || (spec.size() != partCols.size())) {
    throw new HiveException("table is partitioned but partition spec is not specified or tab: " + spec);
  }
  for (  FieldSchema field : partCols) {
    if (spec.get(field.getName()) == null) {
      throw new HiveException(field.getName() + " not found in table's partition spec: " + spec);
    }
  }
  return true;
}
