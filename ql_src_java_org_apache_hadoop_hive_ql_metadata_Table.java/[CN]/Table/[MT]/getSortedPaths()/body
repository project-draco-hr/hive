{
  try {
    FileSystem fs=FileSystem.get(getPath().toUri(),Hive.get().getConf());
    String pathPattern=getPath().toString();
    if (getNumBuckets() > 0) {
      pathPattern=pathPattern + "/*";
    }
    LOG.info("Path pattern = " + pathPattern);
    FileStatus srcs[]=fs.globStatus(new Path(pathPattern));
    Arrays.sort(srcs);
    for (    FileStatus src : srcs) {
      LOG.info("Got file: " + src.getPath());
    }
    if (srcs.length == 0) {
      return null;
    }
    return srcs;
  }
 catch (  Exception e) {
    throw new RuntimeException("Cannot get path ",e);
  }
}
