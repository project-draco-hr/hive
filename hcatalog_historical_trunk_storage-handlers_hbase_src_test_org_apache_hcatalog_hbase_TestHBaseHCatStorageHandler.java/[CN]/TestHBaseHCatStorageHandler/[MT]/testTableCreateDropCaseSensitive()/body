{
  Initialize();
  hcatDriver.run("drop table test_Table");
  CommandProcessorResponse response=hcatDriver.run("create table test_Table(key int, value string) STORED BY " + "'org.apache.hcatalog.hbase.HBaseHCatStorageHandler'" + "TBLPROPERTIES ('hbase.columns.mapping'=':key,cf1:val',"+ " 'hbase.table.name'='CaseSensitiveTable')");
  assertEquals(0,response.getResponseCode());
  HBaseAdmin hAdmin=new HBaseAdmin(getHbaseConf());
  boolean doesTableExist=hAdmin.tableExists("CaseSensitiveTable");
  assertTrue(doesTableExist);
  RevisionManager rm=HBaseRevisionManagerUtil.getOpenedRevisionManager(hcatConf);
  rm.open();
  rm.getAbortedWriteTransactions("CaseSensitiveTable","cf1");
  hcatDriver.run("drop table test_table");
  doesTableExist=hAdmin.tableExists("CaseSensitiveTable");
  assertTrue(doesTableExist == false);
  try {
    rm.getAbortedWriteTransactions("CaseSensitiveTable","cf1");
  }
 catch (  Exception e) {
    assertTrue(e.getCause() instanceof NoNodeException);
  }
  rm.close();
}
