{
  driver.run("drop table if exists employee");
  String createTable="CREATE TABLE employee (emp_id INT, emp_name STRING, emp_start_date STRING , emp_gender STRING ) " + " PARTITIONED BY (emp_country STRING , emp_state STRING ) STORED AS RCFILE";
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  String[] inputData={"111237\tKrishna\t01/01/1990\tM\tIN\tTN","111238\tKalpana\t01/01/2000\tF\tIN\tKA","111239\tSatya\t01/01/2001\tM\tIN\tKL","111240\tKavya\t01/01/2002\tF\tIN\tAP"};
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,inputData);
  PigServer pig=new PigServer(ExecType.LOCAL);
  pig.setBatchOn();
  pig.registerQuery("A = LOAD '" + INPUT_FILE_NAME + "' USING PigStorage() AS (emp_id:int,emp_name:chararray,emp_start_date:chararray,"+ "emp_gender:chararray,emp_country:chararray,emp_state:chararray);");
  pig.registerQuery("IN = FILTER A BY emp_country == 'IN';");
  pig.registerQuery("STORE IN INTO 'employee' USING " + HCatStorer.class.getName() + "('emp_country=IN');");
  pig.executeBatch();
  driver.run("select * from employee");
  ArrayList<String> results=new ArrayList<String>();
  driver.getResults(results);
  assertEquals(4,results.size());
  Collections.sort(results);
  assertEquals(inputData[0],results.get(0));
  assertEquals(inputData[1],results.get(1));
  assertEquals(inputData[2],results.get(2));
  assertEquals(inputData[3],results.get(3));
  driver.run("drop table employee");
}
