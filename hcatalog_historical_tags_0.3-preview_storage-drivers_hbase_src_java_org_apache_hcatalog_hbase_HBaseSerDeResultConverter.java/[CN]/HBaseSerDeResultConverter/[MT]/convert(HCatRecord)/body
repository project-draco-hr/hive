{
  try {
    Put put=(Put)serDe.serialize(record.getAll(),hCatRecordOI);
    Put res;
    if (outputVersion == null) {
      res=put;
    }
 else {
      res=new Put(put.getRow(),outputVersion.longValue());
      for (      List<KeyValue> row : put.getFamilyMap().values()) {
        for (        KeyValue el : row) {
          res.add(el.getFamily(),el.getQualifier(),el.getValue());
        }
      }
    }
    return res;
  }
 catch (  SerDeException e) {
    throw new IOException("serialization failed",e);
  }
}
