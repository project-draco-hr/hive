{
  ExprWalkerInfo exprContext=new ExprWalkerInfo(op,opContext.getRowResolver(op));
  Map<Rule,NodeProcessor> exprRules=new LinkedHashMap<Rule,NodeProcessor>();
  exprRules.put(new RuleRegExp("R1",exprNodeColumnDesc.class.getName() + "%"),getColumnProcessor());
  exprRules.put(new RuleRegExp("R2",exprNodeFieldDesc.class.getName() + "%"),getFuncProcessor());
  exprRules.put(new RuleRegExp("R3",exprNodeFuncDesc.class.getName() + "%"),getFuncProcessor());
  exprRules.put(new RuleRegExp("R4",exprNodeIndexDesc.class.getName() + "%"),getIndexProcessor());
  Dispatcher disp=new DefaultRuleDispatcher(getDefaultExprProcessor(),exprRules,exprContext);
  GraphWalker egw=new DefaultGraphWalker(disp);
  List<Node> startNodes=new ArrayList<Node>();
  List<exprNodeFuncDesc> clonedPreds=new ArrayList<exprNodeFuncDesc>();
  for (  exprNodeFuncDesc node : preds) {
    clonedPreds.add((exprNodeFuncDesc)node.clone());
  }
  startNodes.addAll(clonedPreds);
  egw.startWalking(startNodes,null);
  for (  exprNodeFuncDesc pred : clonedPreds) {
    extractFinalCandidates(pred,exprContext);
  }
  return exprContext;
}
