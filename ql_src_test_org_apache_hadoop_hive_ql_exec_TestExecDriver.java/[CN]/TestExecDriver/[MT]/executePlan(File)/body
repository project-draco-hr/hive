{
  String testName=new Exception().getStackTrace()[1].getMethodName();
  String cmdLine=conf.getVar(HiveConf.ConfVars.HADOOPBIN) + " jar " + conf.getJar()+ " org.apache.hadoop.hive.ql.exec.ExecDriver -plan "+ planFile.toString()+ " "+ ExecDriver.generateCmdLine(conf);
  System.out.println("Executing: " + cmdLine);
  Process executor=Runtime.getRuntime().exec(cmdLine);
  StreamPrinter outPrinter=new StreamPrinter(executor.getInputStream(),null,System.out);
  StreamPrinter errPrinter=new StreamPrinter(executor.getErrorStream(),null,System.err);
  outPrinter.start();
  errPrinter.start();
  int exitVal=executor.waitFor();
  if (exitVal != 0) {
    System.out.println(testName + " execution failed with exit status: " + exitVal);
    assertEquals(true,false);
  }
  System.out.println(testName + " execution completed successfully");
}
