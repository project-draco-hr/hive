{
  String testFileDir=conf.get("test.data.files");
  System.out.println(testFileDir);
  FileInputStream fi_gold=new FileInputStream(new File(testFileDir,datafile));
  Path di_test=new Path(tmppath,testdir);
  if (!fs.exists(di_test)) {
    throw new RuntimeException(tmpdir + testdir + " does not exist");
  }
  if (!fs.getFileStatus(di_test).isDir()) {
    throw new RuntimeException(tmpdir + testdir + " is not a directory");
  }
  FSDataInputStream fi_test=fs.open((fs.listStatus(di_test))[0].getPath());
  if (!Utilities.contentsEqual(fi_gold,fi_test,false)) {
    System.out.println(di_test.toString() + " does not match " + datafile);
    assertEquals(false,true);
  }
}
