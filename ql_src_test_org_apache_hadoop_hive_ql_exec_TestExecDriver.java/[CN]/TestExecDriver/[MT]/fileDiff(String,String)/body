{
  String testFileDir=conf.get("test.data.files");
  FileInputStream fi_gold=new FileInputStream(new File(testFileDir,datafile));
  Path di_test=new Path(tmppath,testdir);
  if (!fs.exists(di_test)) {
    throw new RuntimeException(tmpdir + File.separator + testdir+ " does not exist");
  }
  if (!fs.getFileStatus(di_test).isDir()) {
    throw new RuntimeException(tmpdir + File.separator + testdir+ " is not a directory");
  }
  FSDataInputStream fi_test=fs.open((fs.listStatus(di_test))[0].getPath());
  boolean ignoreWhitespace=Shell.WINDOWS;
  if (!Utilities.contentsEqual(fi_gold,fi_test,ignoreWhitespace)) {
    LOG.error(di_test.toString() + " does not match " + datafile);
    assertEquals(false,true);
  }
}
