{
  conf=new JobConf();
  resetIOContext();
  rcfReader=mock(RCFileRecordReader.class);
  when(rcfReader.next((LongWritable)anyObject(),(BytesRefArrayWritable)anyObject())).thenReturn(true);
  when(rcfReader.getPos()).thenReturn(50L);
  conf.setBoolean("hive.input.format.sorted",true);
  TableDesc tblDesc=Utilities.defaultTd;
  PartitionDesc partDesc=new PartitionDesc(tblDesc,null);
  LinkedHashMap<Path,PartitionDesc> pt=new LinkedHashMap<>();
  pt.put(new Path("/tmp/testfolder"),partDesc);
  MapredWork mrwork=new MapredWork();
  mrwork.getMapWork().setPathToPartitionInfo(pt);
  Utilities.setMapRedWork(conf,mrwork,new Path("/tmp/" + System.getProperty("user.name"),"hive"));
  hiveSplit=new TestHiveInputSplit();
  hbsReader=new TestHiveRecordReader(rcfReader,conf);
  hbsReader.initIOContext(hiveSplit,conf,Class.class,rcfReader);
}
