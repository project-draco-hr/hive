{
  Map<TableDesc,StructObjectInspector> tableDescOI=new HashMap<TableDesc,StructObjectInspector>();
  Set<TableDesc> identityConverterTableDesc=new HashSet<TableDesc>();
  try {
    Map<ObjectInspector,Boolean> oiSettableProperties=new HashMap<ObjectInspector,Boolean>();
    for (    String onefile : conf.getPathToAliases().keySet()) {
      PartitionDesc pd=conf.getPathToPartitionInfo().get(onefile);
      TableDesc tableDesc=pd.getTableDesc();
      Deserializer partDeserializer=pd.getDeserializer(hconf);
      StructObjectInspector partRawRowObjectInspector=(StructObjectInspector)partDeserializer.getObjectInspector();
      StructObjectInspector tblRawRowObjectInspector=tableDescOI.get(tableDesc);
      if ((tblRawRowObjectInspector == null) || (identityConverterTableDesc.contains(tableDesc))) {
        Deserializer tblDeserializer=tableDesc.getDeserializer(hconf);
        tblRawRowObjectInspector=(StructObjectInspector)ObjectInspectorConverters.getConvertedOI(partRawRowObjectInspector,tblDeserializer.getObjectInspector(),oiSettableProperties);
        if (identityConverterTableDesc.contains(tableDesc)) {
          if (!partRawRowObjectInspector.equals(tblRawRowObjectInspector)) {
            identityConverterTableDesc.remove(tableDesc);
          }
        }
 else         if (partRawRowObjectInspector.equals(tblRawRowObjectInspector)) {
          identityConverterTableDesc.add(tableDesc);
        }
        tableDescOI.put(tableDesc,tblRawRowObjectInspector);
      }
    }
  }
 catch (  Exception e) {
    throw new HiveException(e);
  }
  return tableDescOI;
}
