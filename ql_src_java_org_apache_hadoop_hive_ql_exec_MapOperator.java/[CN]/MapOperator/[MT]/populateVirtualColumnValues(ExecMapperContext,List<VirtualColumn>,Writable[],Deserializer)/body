{
  if (vcs == null) {
    return vcValues;
  }
  if (vcValues == null) {
    vcValues=new Writable[vcs.size()];
  }
  for (int i=0; i < vcs.size(); i++) {
    VirtualColumn vc=vcs.get(i);
    if (vc.equals(VirtualColumn.FILENAME)) {
      if (ctx.inputFileChanged()) {
        vcValues[i]=new Text(ctx.getCurrentInputPath().toString());
      }
    }
 else     if (vc.equals(VirtualColumn.BLOCKOFFSET)) {
      long current=ctx.getIoCxt().getCurrentBlockStart();
      LongWritable old=(LongWritable)vcValues[i];
      if (old == null) {
        old=new LongWritable(current);
        vcValues[i]=old;
        continue;
      }
      if (current != old.get()) {
        old.set(current);
      }
    }
 else     if (vc.equals(VirtualColumn.ROWOFFSET)) {
      long current=ctx.getIoCxt().getCurrentRow();
      LongWritable old=(LongWritable)vcValues[i];
      if (old == null) {
        old=new LongWritable(current);
        vcValues[i]=old;
        continue;
      }
      if (current != old.get()) {
        old.set(current);
      }
    }
 else     if (vc.equals(VirtualColumn.RAWDATASIZE)) {
      long current=0L;
      SerDeStats stats=deserializer.getSerDeStats();
      if (stats != null) {
        current=stats.getRawDataSize();
      }
      LongWritable old=(LongWritable)vcValues[i];
      if (old == null) {
        old=new LongWritable(current);
        vcValues[i]=old;
        continue;
      }
      if (current != old.get()) {
        old.set(current);
      }
    }
  }
  return vcValues;
}
