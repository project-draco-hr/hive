{
  String nominal=null;
  boolean schemaless=fpath.toUri().getScheme() == null;
  for (  String onefile : conf.getPathToAliases().keySet()) {
    Path onepath=normalizePath(onefile,schemaless);
    if (onepath.toUri().relativize(fpath.toUri()).equals(fpath.toUri())) {
      continue;
    }
    if (nominal != null) {
      throw new IllegalStateException("Ambiguous input path " + fpath);
    }
    nominal=onefile;
  }
  if (nominal == null) {
    throw new IllegalStateException("Invalid input path " + fpath);
  }
  return nominal;
}
