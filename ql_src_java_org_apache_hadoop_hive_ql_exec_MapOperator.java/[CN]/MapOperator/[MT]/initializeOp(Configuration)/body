{
  state=State.INIT;
  List<Operator<? extends Serializable>> children=getChildOperators();
  for (  Entry<MapInputPath,MapOpCtx> entry : opCtxMap.entrySet()) {
    HiveConf.setVar(hconf,HiveConf.ConfVars.HIVETABLENAME,entry.getValue().tableName);
    HiveConf.setVar(hconf,HiveConf.ConfVars.HIVEPARTITIONNAME,entry.getValue().partName);
    Operator<? extends Serializable> op=entry.getKey().op;
    if (children.indexOf(op) == -1) {
      if (extraChildrenToClose == null) {
        extraChildrenToClose=new ArrayList<Operator<? extends Serializable>>();
      }
      extraChildrenToClose.add(op);
    }
    op.initialize(hconf,new ObjectInspector[]{entry.getValue().getRowObjectInspector()});
  }
}
