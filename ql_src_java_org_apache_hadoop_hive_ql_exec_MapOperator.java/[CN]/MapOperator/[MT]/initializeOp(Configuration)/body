{
  state=State.INIT;
  statsMap.put(Counter.DESERIALIZE_ERRORS.toString(),deserialize_error_count);
  String context=hconf.get(Operator.CONTEXT_NAME_KEY,"");
  if (context != null && !context.isEmpty()) {
    context="_" + context.replace(" ","_");
  }
  statsMap.put(Counter.RECORDS_IN + context,recordCounter);
  List<Operator<? extends OperatorDesc>> children=getChildOperators();
  for (  Entry<Operator<? extends OperatorDesc>,MapOpCtx> entry : childrenOpToOpCtxMap.entrySet()) {
    Operator<? extends OperatorDesc> child=entry.getKey();
    MapOpCtx mapOpCtx=entry.getValue();
    HiveConf.setVar(hconf,HiveConf.ConfVars.HIVETABLENAME,mapOpCtx.tableName);
    HiveConf.setVar(hconf,HiveConf.ConfVars.HIVEPARTITIONNAME,mapOpCtx.partName);
    child.initialize(hconf,new ObjectInspector[]{mapOpCtx.rowObjectInspector});
  }
  for (  Entry<MapInputPath,MapOpCtx> entry : opCtxMap.entrySet()) {
    MapInputPath input=entry.getKey();
    MapOpCtx mapOpCtx=entry.getValue();
    HiveConf.setVar(hconf,HiveConf.ConfVars.HIVETABLENAME,mapOpCtx.tableName);
    HiveConf.setVar(hconf,HiveConf.ConfVars.HIVEPARTITIONNAME,mapOpCtx.partName);
    Operator<? extends OperatorDesc> op=input.op;
    if (children.indexOf(op) == -1) {
      if (extraChildrenToClose == null) {
        extraChildrenToClose=new ArrayList<Operator<? extends OperatorDesc>>();
      }
      extraChildrenToClose.add(op);
      op.initialize(hconf,new ObjectInspector[]{entry.getValue().rowObjectInspector});
    }
  }
}
