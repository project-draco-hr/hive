{
  this.metaStoreClient=metaStoreClient;
  this.tables=Collections.unmodifiableList(new ArrayList<>(tables));
  lockOptions=new Lock.Options().configuration(configuration).lockFailureListener(lockFailureListener == null ? LockFailureListener.NULL_LISTENER : lockFailureListener).user(user);
  for (  AcidTable table : tables) {
    lockOptions.addTable(table.getDatabaseName(),table.getTableName());
  }
}
