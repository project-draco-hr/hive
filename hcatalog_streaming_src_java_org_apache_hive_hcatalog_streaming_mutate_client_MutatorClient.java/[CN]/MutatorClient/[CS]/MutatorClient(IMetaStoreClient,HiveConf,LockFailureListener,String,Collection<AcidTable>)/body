{
  this.metaStoreClient=metaStoreClient;
  this.tables=Collections.unmodifiableList(new ArrayList<>(tables));
  lockOptions=new Lock.Options().configuration(configuration).lockFailureListener(lockFailureListener == null ? LockFailureListener.NULL_LISTENER : lockFailureListener).user(user);
  for (  AcidTable table : tables) {
switch (table.getTableType()) {
case SOURCE:
      lockOptions.addSourceTable(table.getDatabaseName(),table.getTableName());
    break;
case SINK:
  lockOptions.addSinkTable(table.getDatabaseName(),table.getTableName());
break;
default :
throw new IllegalArgumentException("Unknown TableType: " + table.getTableType());
}
}
}
