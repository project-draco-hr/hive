{
  Class.forName(driverName);
  Connection con1=getConnection("default");
  System.setProperty(ConfVars.HIVE_SERVER2_LOGGING_OPERATION_LEVEL.varname,"verbose");
  System.setProperty(ConfVars.HIVEMAPREDMODE.varname,"nonstrict");
  System.setProperty(ConfVars.HIVE_AUTHORIZATION_MANAGER.varname,"org.apache.hadoop.hive.ql.security.authorization.DefaultHiveAuthorizationProvider");
  Statement stmt1=con1.createStatement();
  assertNotNull("Statement is null",stmt1);
  stmt1.execute("set hive.support.concurrency = false");
  DatabaseMetaData metadata=con1.getMetaData();
  ResultSet databaseRes=metadata.getSchemas();
  while (databaseRes.next()) {
    String db=databaseRes.getString(1);
    if (!db.equals("default")) {
      System.err.println("Dropping database " + db);
      stmt1.execute("DROP DATABASE " + db + " CASCADE");
    }
  }
  stmt1.execute("create database testdb");
  stmt1.close();
  con1.close();
}
