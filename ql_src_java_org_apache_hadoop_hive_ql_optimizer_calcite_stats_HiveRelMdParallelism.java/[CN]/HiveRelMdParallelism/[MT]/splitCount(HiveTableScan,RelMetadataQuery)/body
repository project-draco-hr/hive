{
  Integer splitCount;
  RelOptHiveTable table=(RelOptHiveTable)scan.getTable();
  List<String> bucketCols=table.getHiveTableMD().getBucketCols();
  if (bucketCols != null && !bucketCols.isEmpty()) {
    splitCount=table.getHiveTableMD().getNumBuckets();
  }
 else {
    splitCount=splitCountRepartition(scan,mq);
    if (splitCount == null) {
      throw new RuntimeException("Could not get split count for table: " + scan.getTable().getQualifiedName());
    }
  }
  return splitCount;
}
