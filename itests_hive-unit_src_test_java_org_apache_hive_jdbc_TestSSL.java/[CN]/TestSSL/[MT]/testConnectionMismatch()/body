{
  setSslConfOverlay(confOverlay);
  setBinaryConfOverlay(confOverlay);
  miniHS2.start(confOverlay);
  try {
    hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL(),System.getProperty("user.name"),"bar");
    fail("NON SSL connection should fail with SSL server");
  }
 catch (  SQLException e) {
    assertEquals("08S01",e.getSQLState().trim());
  }
  try {
    hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL() + ";ssl=false",System.getProperty("user.name"),"bar");
    fail("NON SSL connection should fail with SSL server");
  }
 catch (  SQLException e) {
    assertEquals("08S01",e.getSQLState().trim());
  }
  miniHS2.stop();
  setHttpConfOverlay(confOverlay);
  miniHS2.start(confOverlay);
  try {
    hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL() + ";ssl=false;sslTrustStore=" + dataFileDir+ File.separator+ TRUST_STORE_NAME+ ";trustStorePassword="+ KEY_STORE_PASSWORD+ "?hive.server2.transport.mode="+ HS2_HTTP_MODE+ ";hive.server2.thrift.http.path="+ HS2_HTTP_ENDPOINT,System.getProperty("user.name"),"bar");
    fail("NON SSL connection should fail with SSL server");
  }
 catch (  SQLException e) {
    assertEquals("08S01",e.getSQLState().trim());
  }
}
