{
  String columnNameProperty=conf.get(serdeConstants.LIST_COLUMNS);
  String columnTypeProperty=conf.get(serdeConstants.LIST_COLUMN_TYPES);
  ArrayList<String> columnNames=new ArrayList<String>();
  Deque<Integer> virtualColumns=new ArrayDeque<Integer>();
  if (columnNameProperty != null && columnNameProperty.length() > 0) {
    String[] colNames=columnNameProperty.split(",");
    for (int i=0; i < colNames.length; i++) {
      if (VirtualColumn.VIRTUAL_COLUMN_NAMES.contains(colNames[i])) {
        virtualColumns.addLast(i);
      }
 else {
        columnNames.add(colNames[i]);
      }
    }
  }
  if (columnTypeProperty == null) {
    StringBuilder sb=new StringBuilder();
    for (int i=0; i < columnNames.size(); i++) {
      if (i > 0) {
        sb.append(":");
      }
      sb.append("string");
    }
    columnTypeProperty=sb.toString();
  }
  ArrayList<TypeInfo> fieldTypes=TypeInfoUtils.getTypeInfosFromTypeString(columnTypeProperty);
  while (virtualColumns.size() > 0) {
    fieldTypes.remove(virtualColumns.removeLast());
  }
  StructTypeInfo rowType=new StructTypeInfo();
  rowType.setAllStructFieldNames(columnNames);
  rowType.setAllStructFieldTypeInfos(fieldTypes);
  return OrcRecordUpdater.createEventSchema(OrcStruct.createObjectInspector(rowType));
}
