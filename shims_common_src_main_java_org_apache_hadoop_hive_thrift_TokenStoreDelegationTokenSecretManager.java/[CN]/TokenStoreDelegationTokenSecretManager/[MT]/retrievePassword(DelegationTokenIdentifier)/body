{
  DelegationTokenInformation info=this.tokenStore.getToken(identifier);
  if (info == null) {
    throw new InvalidToken("token expired or does not exist: " + identifier);
  }
synchronized (this) {
    try {
      super.currentTokens.put(identifier,info);
      return super.retrievePassword(identifier);
    }
  finally {
      super.currentTokens.remove(identifier);
    }
  }
}
