{
  long now=System.currentTimeMillis();
  Iterator<DelegationTokenIdentifier> i=tokenStore.getAllDelegationTokenIdentifiers().iterator();
  while (i.hasNext()) {
    DelegationTokenIdentifier id=i.next();
    if (now > id.getMaxDate()) {
      this.tokenStore.removeToken(id);
    }
 else {
      DelegationTokenInformation tokenInfo=tokenStore.getToken(id);
      if (tokenInfo != null) {
        if (now > tokenInfo.getRenewDate()) {
          this.tokenStore.removeToken(id);
        }
      }
    }
  }
}
