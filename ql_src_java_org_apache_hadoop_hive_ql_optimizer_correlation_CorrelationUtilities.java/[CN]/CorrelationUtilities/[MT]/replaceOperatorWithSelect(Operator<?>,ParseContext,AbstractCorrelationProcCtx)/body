{
  RowSchema inputRS=operator.getSchema();
  SelectDesc select=new SelectDesc(null,null);
  Operator<?> parent=getSingleParent(operator);
  Operator<?> child=getSingleChild(operator);
  parent.getChildOperators().clear();
  SelectOperator sel=(SelectOperator)OperatorFactory.getAndMakeChild(select,new RowSchema(inputRS.getSignature()),parent);
  sel.setColumnExprMap(operator.getColumnExprMap());
  sel.setChildOperators(operator.getChildOperators());
  for (  Operator<? extends Serializable> ch : operator.getChildOperators()) {
    ch.replaceParent(operator,sel);
  }
  if (child instanceof ExtractOperator) {
    removeOperator(child,getSingleChild(child),sel,context);
    procCtx.addRemovedOperator(child);
  }
  operator.setChildOperators(null);
  operator.setParentOperators(null);
  procCtx.addRemovedOperator(operator);
  return sel;
}
