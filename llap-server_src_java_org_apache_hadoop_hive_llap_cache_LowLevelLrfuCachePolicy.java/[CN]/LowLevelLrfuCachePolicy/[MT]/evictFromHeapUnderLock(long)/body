{
  while (true) {
    if (heapSize == 0)     return null;
    LlapCacheableBuffer result=heap[0];
    if (DebugUtils.isTraceCachingEnabled()) {
      LlapIoImpl.LOG.info("Evicting " + result + " at "+ time);
    }
    result.indexInHeap=LlapCacheableBuffer.NOT_IN_CACHE;
    --heapSize;
    boolean canEvict=result.invalidate();
    if (heapSize > 0) {
      LlapCacheableBuffer newRoot=heap[heapSize];
      newRoot.indexInHeap=0;
      if (newRoot.lastUpdate != time) {
        newRoot.priority=expirePriority(time,newRoot.lastUpdate,newRoot.priority);
        newRoot.lastUpdate=time;
      }
      heapifyDownUnderLock(newRoot,time);
    }
    if (canEvict)     return result;
  }
}
