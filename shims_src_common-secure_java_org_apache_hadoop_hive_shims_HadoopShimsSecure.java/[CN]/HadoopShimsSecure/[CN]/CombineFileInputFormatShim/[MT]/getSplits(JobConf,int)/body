{
  long minSize=job.getLong("mapred.min.split.size",0);
  if (job.getLong("mapred.min.split.size.per.node",0) == 0) {
    super.setMinSplitSizeNode(minSize);
  }
  if (job.getLong("mapred.min.split.size.per.rack",0) == 0) {
    super.setMinSplitSizeRack(minSize);
  }
  if (job.getLong("mapred.max.split.size",0) == 0) {
    super.setMaxSplitSize(minSize);
  }
  InputSplit[] splits=(InputSplit[])super.getSplits(job,numSplits);
  InputSplitShim[] isplits=new InputSplitShim[splits.length];
  for (int pos=0; pos < splits.length; pos++) {
    isplits[pos]=new InputSplitShim((CombineFileSplit)splits[pos]);
  }
  return isplits;
}
