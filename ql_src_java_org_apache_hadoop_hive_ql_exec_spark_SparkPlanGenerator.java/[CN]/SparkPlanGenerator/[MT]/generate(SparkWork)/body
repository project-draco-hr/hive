{
  SparkPlan plan=new SparkPlan();
  List<SparkTran> trans=new ArrayList<SparkTran>();
  Set<BaseWork> roots=sparkWork.getRoots();
  assert(roots != null && roots.size() == 1);
  BaseWork w=roots.iterator().next();
  MapWork mapWork=(MapWork)w;
  trans.add(generate(w));
  while (sparkWork.getChildren(w).size() > 0) {
    ReduceWork child=(ReduceWork)sparkWork.getChildren(w).get(0);
    SparkEdgeProperty edge=sparkWork.getEdgeProperty(w,child);
    SparkShuffler st=generate(edge);
    ReduceTran rt=generate(child);
    rt.setShuffler(st);
    trans.add(rt);
    w=child;
  }
  ChainedTran chainedTran=new ChainedTran(trans);
  plan.setTran(chainedTran);
  JavaPairRDD<BytesWritable,BytesWritable> input=generateRDD(mapWork);
  plan.setInput(input);
  return plan;
}
