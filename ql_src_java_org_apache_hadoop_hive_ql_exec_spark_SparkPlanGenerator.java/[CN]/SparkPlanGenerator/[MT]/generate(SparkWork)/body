{
  SparkPlan sparkPlan=new SparkPlan();
  cloneToWork=sparkWork.getCloneToWork();
  workToTranMap.clear();
  workToParentWorkTranMap.clear();
  for (  BaseWork work : sparkWork.getAllWork()) {
    SparkTran tran;
    SparkTran parentTran=generateParentTran(sparkPlan,sparkWork,work);
    tran=generate(work);
    sparkPlan.addTran(tran);
    sparkPlan.connect(parentTran,tran);
    workToTranMap.put(work,tran);
  }
  return sparkPlan;
}
