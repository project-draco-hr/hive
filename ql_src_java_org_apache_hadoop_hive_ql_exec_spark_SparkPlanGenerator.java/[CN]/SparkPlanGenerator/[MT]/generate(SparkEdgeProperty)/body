{
  Preconditions.checkArgument(!edge.isShuffleNone(),"AssertionError: SHUFFLE_NONE should only be used for UnionWork.");
  SparkShuffler shuffler;
  if (edge.isMRShuffle()) {
    shuffler=new SortByShuffler(false);
  }
 else   if (edge.isShuffleSort()) {
    shuffler=new SortByShuffler(true);
  }
 else {
    shuffler=new GroupByShuffler();
  }
  return new ShuffleTran(shuffler,edge.getNumPartitions());
}
