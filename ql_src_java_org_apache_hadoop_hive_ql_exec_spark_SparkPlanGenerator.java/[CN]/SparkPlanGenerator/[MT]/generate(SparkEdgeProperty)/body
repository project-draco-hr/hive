{
  Preconditions.checkArgument(!edge.isShuffleNone(),"AssertionError: SHUFFLE_NONE should only be used for UnionWork.");
  if (edge.isMRShuffle()) {
    return new SortByShuffler(false);
  }
 else   if (edge.isShuffleSort()) {
    return new SortByShuffler(true);
  }
  return new GroupByShuffler();
}
