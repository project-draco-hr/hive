{
  if (work instanceof MapWork) {
    MapWork mw=(MapWork)work;
    return generate(mw);
  }
 else   if (work instanceof ReduceWork) {
    ReduceWork rw=(ReduceWork)work;
    ReduceTran tran=generate(rw);
    SparkShuffler shuffler=generate(edge);
    tran.setShuffler(shuffler);
    tran.setNumPartitions(edge.getNumPartitions());
    return tran;
  }
 else   if (work instanceof UnionWork) {
    return new IdentityTran();
  }
 else {
    throw new HiveException("Unexpected work: " + work.getName());
  }
}
