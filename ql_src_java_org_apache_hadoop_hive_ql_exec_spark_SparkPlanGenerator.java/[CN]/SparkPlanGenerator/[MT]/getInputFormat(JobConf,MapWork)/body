{
  if (mWork.getInputformat() != null) {
    HiveConf.setVar(jobConf,HiveConf.ConfVars.HIVEINPUTFORMAT,mWork.getInputformat());
  }
  String inpFormat=HiveConf.getVar(jobConf,HiveConf.ConfVars.HIVEINPUTFORMAT);
  if ((inpFormat == null) || (StringUtils.isBlank(inpFormat))) {
    inpFormat=ShimLoader.getHadoopShims().getInputFormatClassName();
  }
  if (mWork.isUseBucketizedHiveInputFormat()) {
    inpFormat=BucketizedHiveInputFormat.class.getName();
  }
  Class inputFormatClass;
  try {
    inputFormatClass=Class.forName(inpFormat);
  }
 catch (  ClassNotFoundException e) {
    String message="Failed to load specified input format class:" + inpFormat;
    LOG.error(message,e);
    throw new HiveException(message,e);
  }
  return inputFormatClass;
}
