{
  if (mw instanceof MergeFileWork) {
    Path outputPath=((MergeFileWork)mw).getOutputDir();
    Path tempOutPath=Utilities.toTempPath(outputPath);
    FileSystem fs=outputPath.getFileSystem(jobConf);
    try {
      if (!fs.exists(tempOutPath)) {
        fs.mkdirs(tempOutPath);
      }
    }
 catch (    IOException e) {
      throw new RuntimeException("Can't make path " + outputPath + " : "+ e.getMessage());
    }
  }
  initStatsPublisher(mw);
  MapTran result=new MapTran();
  byte[] confBytes=KryoSerializer.serializeJobConf(jobConf);
  HiveMapFunction mapFunc=new HiveMapFunction(confBytes);
  result.setMapFunction(mapFunc);
  return result;
}
