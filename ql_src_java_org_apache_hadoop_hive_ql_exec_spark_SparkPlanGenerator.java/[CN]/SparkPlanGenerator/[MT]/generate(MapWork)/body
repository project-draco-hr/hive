{
  MapTran result=new MapTran();
  Utilities.setMapWork(jobConf,mw,scratchDir,false);
  Utilities.createTmpDirs(jobConf,mw);
  jobConf.set("mapred.mapper.class",ExecMapper.class.getName());
  byte[] confBytes=KryoSerializer.serializeJobConf(jobConf);
  HiveMapFunction mapFunc=new HiveMapFunction(confBytes);
  result.setMapFunction(mapFunc);
  return result;
}
