{
  JobConf newJobConf=new JobConf(jobConf);
  MapTran result=new MapTran();
  List<Path> inputPaths=Utilities.getInputPaths(newJobConf,mw,scratchDir,context,false);
  Utilities.setInputPaths(newJobConf,inputPaths);
  Utilities.setMapWork(newJobConf,mw,scratchDir,true);
  Utilities.createTmpDirs(newJobConf,mw);
  newJobConf.set("mapred.mapper.class",ExecMapper.class.getName());
  byte[] confBytes=KryoSerializer.serializeJobConf(newJobConf);
  HiveMapFunction mapFunc=new HiveMapFunction(confBytes);
  result.setMapFunction(mapFunc);
  return result;
}
