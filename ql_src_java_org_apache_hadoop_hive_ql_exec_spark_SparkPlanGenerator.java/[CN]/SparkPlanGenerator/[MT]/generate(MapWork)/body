{
  initStatsPublisher(mw);
  MapTran result=new MapTran();
  JobConf newJobConf=cloneJobConf(mw);
  byte[] confBytes=KryoSerializer.serializeJobConf(newJobConf);
  HiveMapFunction mapFunc=new HiveMapFunction(confBytes,sparkReporter);
  result.setMapFunction(mapFunc);
  return result;
}
