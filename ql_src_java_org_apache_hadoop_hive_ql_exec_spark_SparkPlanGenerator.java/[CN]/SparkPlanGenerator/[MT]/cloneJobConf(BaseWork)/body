{
  JobConf cloned=new JobConf(jobConf);
  HiveConf.setVar(cloned,HiveConf.ConfVars.PLAN,"");
  if (work instanceof MapWork) {
    List<Path> inputPaths=Utilities.getInputPaths(cloned,(MapWork)work,scratchDir,context,false);
    Utilities.setInputPaths(cloned,inputPaths);
    Utilities.setMapWork(cloned,(MapWork)work,scratchDir,false);
    Utilities.createTmpDirs(cloned,(MapWork)work);
    cloned.set("mapred.mapper.class",ExecMapper.class.getName());
  }
 else   if (work instanceof ReduceWork) {
    Utilities.setReduceWork(cloned,(ReduceWork)work,scratchDir,false);
    Utilities.createTmpDirs(cloned,(ReduceWork)work);
    cloned.set("mapred.reducer.class",ExecReducer.class.getName());
  }
  return cloned;
}
