{
  HiveConf conf=new HiveConf();
  conf.addResource("hive-site.xml");
  ArrayList<String> results=new ArrayList<String>();
  ArrayList<String> temp=new ArrayList<String>();
  Hive hive=Hive.get(conf);
  org.apache.hadoop.hive.ql.metadata.Table tbl=hive.getTable(database,table);
  FetchWork work;
  if (!tbl.getPartCols().isEmpty()) {
    List<Partition> partitions=hive.getPartitions(tbl);
    List<PartitionDesc> partDesc=new ArrayList<PartitionDesc>();
    List<Path> partLocs=new ArrayList<Path>();
    TableDesc tableDesc=Utilities.getTableDesc(tbl);
    for (    Partition part : partitions) {
      partLocs.add(part.getDataLocation());
      partDesc.add(Utilities.getPartitionDescFromTableDesc(tableDesc,part,true));
    }
    work=new FetchWork(partLocs,partDesc,tableDesc);
    work.setLimit(100);
  }
 else {
    work=new FetchWork(tbl.getDataLocation(),Utilities.getTableDesc(tbl));
  }
  FetchTask task=new FetchTask();
  task.setWork(work);
  task.initialize(conf,null,null,new CompilationOpContext());
  task.fetch(temp);
  for (  String str : temp) {
    results.add(str.replace("\t",","));
  }
  return results;
}
