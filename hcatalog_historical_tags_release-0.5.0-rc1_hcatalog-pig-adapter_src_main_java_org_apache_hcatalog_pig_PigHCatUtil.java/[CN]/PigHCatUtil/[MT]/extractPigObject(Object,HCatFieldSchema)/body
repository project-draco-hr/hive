{
  Object result;
  Type itemType=hfs.getType();
switch (itemType) {
case BINARY:
    result=(o == null) ? null : new DataByteArray((byte[])o);
  break;
case STRUCT:
result=transformToTuple((List<Object>)o,hfs);
break;
case ARRAY:
result=transformToBag((List<? extends Object>)o,hfs);
break;
case MAP:
result=transformToPigMap((Map<Object,Object>)o,hfs);
break;
default :
result=o;
break;
}
return result;
}
