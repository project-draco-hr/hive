{
  Object ret=null;
  boolean gotNewConnectUrl=false;
  boolean reloadConf=HiveConf.getBoolVar(hiveConf,HiveConf.ConfVars.HMSHANDLERFORCERELOADCONF);
  int retryInterval=HiveConf.getIntVar(hiveConf,HiveConf.ConfVars.HMSHANDLERINTERVAL);
  int retryLimit=HiveConf.getIntVar(hiveConf,HiveConf.ConfVars.HMSHANDLERATTEMPTS);
  if (reloadConf) {
    MetaStoreInit.updateConnectionURL(hiveConf,getConf(),null,metaStoreInitData);
  }
  int retryCount=0;
  Throwable caughtException=null;
  while (true) {
    try {
      if (reloadConf || gotNewConnectUrl) {
        initMS();
      }
      ret=method.invoke(base,args);
      break;
    }
 catch (    javax.jdo.JDOException e) {
      caughtException=e;
    }
catch (    UndeclaredThrowableException e) {
      if (e.getCause() != null) {
        if (e.getCause() instanceof javax.jdo.JDOException) {
          caughtException=e.getCause();
        }
 else {
          throw e.getCause();
        }
      }
 else {
        throw e;
      }
    }
catch (    InvocationTargetException e) {
      if (e.getCause() instanceof javax.jdo.JDOException) {
        caughtException=e.getCause();
      }
 else {
        throw e.getCause();
      }
    }
    if (retryCount >= retryLimit) {
      throw caughtException;
    }
    assert(retryInterval >= 0);
    retryCount++;
    LOG.error(String.format("JDO datastore error. Retrying HMSHandler " + "after %d ms (attempt %d of %d)",retryInterval,retryCount,retryLimit));
    Thread.sleep(retryInterval);
    String lastUrl=MetaStoreInit.getConnectionURL(getConf());
    gotNewConnectUrl=MetaStoreInit.updateConnectionURL(hiveConf,getConf(),lastUrl,metaStoreInitData);
  }
  return ret;
}
