{
  boolean gotNewConnectUrl=false;
  boolean reloadConf=HiveConf.getBoolVar(hiveConf,HiveConf.ConfVars.HMSHANDLERFORCERELOADCONF);
  int retryInterval=HiveConf.getIntVar(hiveConf,HiveConf.ConfVars.HMSHANDLERINTERVAL);
  int retryLimit=HiveConf.getIntVar(hiveConf,HiveConf.ConfVars.HMSHANDLERATTEMPTS);
  if (reloadConf) {
    MetaStoreInit.updateConnectionURL(hiveConf,getConf(),null,metaStoreInitData);
  }
  int retryCount=0;
  Throwable caughtException=null;
  while (true) {
    try {
      if (reloadConf || gotNewConnectUrl) {
        base.setConf(getConf());
      }
      return method.invoke(base,args);
    }
 catch (    javax.jdo.JDOException e) {
      caughtException=e;
    }
catch (    UndeclaredThrowableException e) {
      if (e.getCause() != null) {
        if (e.getCause() instanceof javax.jdo.JDOException) {
          caughtException=e.getCause();
        }
 else         if (e.getCause() instanceof MetaException && e.getCause().getCause() != null && e.getCause().getCause() instanceof javax.jdo.JDOException) {
          caughtException=e.getCause().getCause();
        }
 else {
          LOG.error(ExceptionUtils.getStackTrace(e.getCause()));
          throw e.getCause();
        }
      }
 else {
        LOG.error(ExceptionUtils.getStackTrace(e));
        throw e;
      }
    }
catch (    InvocationTargetException e) {
      if (e.getCause() instanceof javax.jdo.JDOException) {
        caughtException=e.getCause();
      }
 else       if (e.getCause() instanceof NoSuchObjectException || e.getTargetException().getCause() instanceof NoSuchObjectException) {
        String methodName=method.getName();
        if (!methodName.startsWith("get_table") && !methodName.startsWith("get_partition") && !methodName.startsWith("get_function")) {
          LOG.error(ExceptionUtils.getStackTrace(e.getCause()));
        }
        throw e.getCause();
      }
 else       if (e.getCause() instanceof MetaException && e.getCause().getCause() != null && e.getCause().getCause() instanceof javax.jdo.JDOException) {
        caughtException=e.getCause().getCause();
      }
 else {
        LOG.error(ExceptionUtils.getStackTrace(e.getCause()));
        throw e.getCause();
      }
    }
    if (retryCount >= retryLimit) {
      LOG.error("HMSHandler Fatal error: " + ExceptionUtils.getStackTrace(caughtException));
      throw new MetaException(ExceptionUtils.getStackTrace(caughtException));
    }
    assert(retryInterval >= 0);
    retryCount++;
    LOG.error(String.format("Retrying HMSHandler after %d ms (attempt %d of %d)",retryInterval,retryCount,retryLimit) + " with error: " + ExceptionUtils.getStackTrace(caughtException));
    Thread.sleep(retryInterval);
    String lastUrl=MetaStoreInit.getConnectionURL(getConf());
    gotNewConnectUrl=MetaStoreInit.updateConnectionURL(hiveConf,getConf(),lastUrl,metaStoreInitData);
  }
}
