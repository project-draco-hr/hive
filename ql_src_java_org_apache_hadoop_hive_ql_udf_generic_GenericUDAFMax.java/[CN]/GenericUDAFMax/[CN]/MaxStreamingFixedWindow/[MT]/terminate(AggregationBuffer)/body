{
  State s=(State)agg;
  Object[] r=s.maxChain.getFirst();
  for (int i=0; i < s.numFollowing; i++) {
    s.results.add(r[0]);
    s.numRows++;
    int fIdx=(Integer)r[1];
    if (s.numPreceding != BoundarySpec.UNBOUNDED_AMOUNT && s.numRows - s.numFollowing + i > fIdx + s.numPreceding && !s.maxChain.isEmpty()) {
      s.maxChain.removeFirst();
      r=!s.maxChain.isEmpty() ? s.maxChain.getFirst() : r;
    }
  }
  return null;
}
