{
  FilterPredicate p=null;
switch (root.getOperator()) {
case OR:
    for (    ExpressionTree child : root.getChildren()) {
      if (p == null) {
        p=translate(child,leaves,columns);
      }
 else {
        FilterPredicate right=translate(child,leaves,columns);
        if (right != null) {
          p=FilterApi.or(p,right);
        }
      }
    }
  return p;
case AND:
for (ExpressionTree child : root.getChildren()) {
  if (p == null) {
    p=translate(child,leaves,columns);
  }
 else {
    FilterPredicate right=translate(child,leaves,columns);
    if (right != null) {
      p=FilterApi.and(p,right);
    }
  }
}
return p;
case NOT:
FilterPredicate op=translate(root.getChildren().get(0),leaves,columns);
if (op != null) {
return FilterApi.not(op);
}
 else {
return null;
}
case LEAF:
PredicateLeaf leaf=leaves.get(root.getLeaf());
if (columns == null || columns.contains(leaf.getColumnName())) {
return buildFilterPredicateFromPredicateLeaf(leaf);
}
 else {
return null;
}
case CONSTANT:
return null;
default :
throw new IllegalStateException("Unknown operator: " + root.getOperator());
}
}
