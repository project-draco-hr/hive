{
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream dos=new DataOutputStream(baos);
  writeFieldSchemaList(dos,sd.getCols());
  writeStr(dos,sd.getInputFormat());
  writeStr(dos,sd.getOutputFormat());
  dos.writeBoolean(sd.isCompressed());
  dos.writeInt(sd.getNumBuckets());
  writeStr(dos,sd.getSerdeInfo().getName());
  writeStr(dos,sd.getSerdeInfo().getSerializationLib());
  writeStrStrMap(dos,sd.getSerdeInfo().getParameters());
  writeStrList(dos,sd.getBucketCols());
  writeOrderList(dos,sd.getSortCols());
  writeSkewedInfo(dos,sd.getSkewedInfo());
  dos.writeBoolean(sd.isStoredAsSubDirectories());
  return baos.toByteArray();
}
