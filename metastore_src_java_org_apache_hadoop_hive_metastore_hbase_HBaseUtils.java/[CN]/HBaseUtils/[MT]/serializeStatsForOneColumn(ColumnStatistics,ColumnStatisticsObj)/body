{
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream dos=new DataOutputStream(baos);
  dos.writeLong(stats.getStatsDesc().getLastAnalyzed());
  HBaseUtils.writeStr(dos,obj.getColType());
  ColumnStatisticsData colData=obj.getStatsData();
  HBaseUtils.writeStr(dos,colData.getSetField().toString());
switch (colData.getSetField()) {
case BOOLEAN_STATS:
    BooleanColumnStatsData boolData=colData.getBooleanStats();
  dos.writeLong(boolData.getNumTrues());
dos.writeLong(boolData.getNumFalses());
dos.writeLong(boolData.getNumNulls());
break;
case LONG_STATS:
LongColumnStatsData longData=colData.getLongStats();
dos.writeLong(longData.getLowValue());
dos.writeLong(longData.getHighValue());
dos.writeLong(longData.getNumNulls());
dos.writeLong(longData.getNumDVs());
break;
case DOUBLE_STATS:
DoubleColumnStatsData doubleData=colData.getDoubleStats();
dos.writeDouble(doubleData.getLowValue());
dos.writeDouble(doubleData.getHighValue());
dos.writeLong(doubleData.getNumNulls());
dos.writeLong(doubleData.getNumDVs());
break;
case STRING_STATS:
StringColumnStatsData stringData=colData.getStringStats();
dos.writeLong(stringData.getMaxColLen());
dos.writeDouble(stringData.getAvgColLen());
dos.writeLong(stringData.getNumNulls());
dos.writeLong(stringData.getNumDVs());
break;
case BINARY_STATS:
BinaryColumnStatsData binaryData=colData.getBinaryStats();
dos.writeLong(binaryData.getMaxColLen());
dos.writeDouble(binaryData.getAvgColLen());
dos.writeLong(binaryData.getNumNulls());
break;
case DECIMAL_STATS:
DecimalColumnStatsData decimalData=colData.getDecimalStats();
writeDecimal(dos,decimalData.getHighValue());
writeDecimal(dos,decimalData.getLowValue());
dos.writeLong(decimalData.getNumNulls());
dos.writeLong(decimalData.getNumDVs());
break;
default :
throw new RuntimeException("Woh, bad.  Unknown stats type!");
}
return baos.toByteArray();
}
