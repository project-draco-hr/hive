{
  int sz=in.readInt();
  if (sz == 0) {
    return new HashMap<String,List<PrivilegeGrantInfo>>();
  }
 else {
    Map<String,List<PrivilegeGrantInfo>> priv=new HashMap<String,List<PrivilegeGrantInfo>>(sz);
    for (int i=0; i < sz; i++) {
      String key=readStr(in);
      int numGrants=in.readInt();
      List<PrivilegeGrantInfo> grants=new ArrayList<PrivilegeGrantInfo>(numGrants);
      priv.put(key,grants);
      for (int j=0; j < numGrants; j++) {
        PrivilegeGrantInfo pgi=new PrivilegeGrantInfo();
        pgi.setPrivilege(readStr(in));
        pgi.setCreateTime(in.readInt());
        pgi.setGrantor(readStr(in));
        pgi.setGrantorType(PrincipalType.findByValue(in.readInt()));
        pgi.setGrantOption(in.readBoolean());
        grants.add(pgi);
      }
    }
    return priv;
  }
}
