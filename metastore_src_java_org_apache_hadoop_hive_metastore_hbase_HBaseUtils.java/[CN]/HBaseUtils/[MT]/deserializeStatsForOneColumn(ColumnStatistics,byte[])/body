{
  DataInput in=new DataInputStream(new ByteArrayInputStream(bytes));
  ColumnStatisticsObj obj=new ColumnStatisticsObj();
  long lastAnalyzed=in.readLong();
  stats.getStatsDesc().setLastAnalyzed(Math.max(lastAnalyzed,stats.getStatsDesc().getLastAnalyzed()));
  obj.setColType(HBaseUtils.readStr(in));
  ColumnStatisticsData._Fields type=ColumnStatisticsData._Fields.valueOf(HBaseUtils.readStr(in));
  ColumnStatisticsData colData=new ColumnStatisticsData();
switch (type) {
case BOOLEAN_STATS:
    BooleanColumnStatsData boolData=new BooleanColumnStatsData();
  boolData.setNumTrues(in.readLong());
boolData.setNumFalses(in.readLong());
boolData.setNumNulls(in.readLong());
colData.setBooleanStats(boolData);
break;
case LONG_STATS:
LongColumnStatsData longData=new LongColumnStatsData();
longData.setLowValue(in.readLong());
longData.setHighValue(in.readLong());
longData.setNumNulls(in.readLong());
longData.setNumDVs(in.readLong());
colData.setLongStats(longData);
break;
case DOUBLE_STATS:
DoubleColumnStatsData doubleData=new DoubleColumnStatsData();
doubleData.setLowValue(in.readDouble());
doubleData.setHighValue(in.readDouble());
doubleData.setNumNulls(in.readLong());
doubleData.setNumDVs(in.readLong());
colData.setDoubleStats(doubleData);
break;
case STRING_STATS:
StringColumnStatsData stringData=new StringColumnStatsData();
stringData.setMaxColLen(in.readLong());
stringData.setAvgColLen(in.readDouble());
stringData.setNumNulls(in.readLong());
stringData.setNumDVs(in.readLong());
colData.setStringStats(stringData);
break;
case BINARY_STATS:
BinaryColumnStatsData binaryData=new BinaryColumnStatsData();
binaryData.setMaxColLen(in.readLong());
binaryData.setAvgColLen(in.readDouble());
binaryData.setNumNulls(in.readLong());
colData.setBinaryStats(binaryData);
break;
case DECIMAL_STATS:
DecimalColumnStatsData decimalData=new DecimalColumnStatsData();
decimalData.setHighValue(readDecimal(in));
decimalData.setLowValue(readDecimal(in));
decimalData.setNumNulls(in.readLong());
decimalData.setNumDVs(in.readLong());
colData.setDecimalStats(decimalData);
break;
default :
throw new RuntimeException("Woh, bad.  Unknown stats type!");
}
obj.setStatsData(colData);
return obj;
}
