{
  HbaseMetastoreProto.ColumnStats proto=HbaseMetastoreProto.ColumnStats.parseFrom(bytes);
  ColumnStatisticsObj obj=new ColumnStatisticsObj();
  long lastAnalyzed=proto.getLastAnalyzed();
  stats.getStatsDesc().setLastAnalyzed(Math.max(lastAnalyzed,stats.getStatsDesc().getLastAnalyzed()));
  obj.setColType(proto.getColumnType());
  ColumnStatisticsData colData=new ColumnStatisticsData();
  if (proto.hasBoolStats()) {
    BooleanColumnStatsData boolData=new BooleanColumnStatsData();
    boolData.setNumTrues(proto.getBoolStats().getNumTrues());
    boolData.setNumFalses(proto.getBoolStats().getNumFalses());
    boolData.setNumNulls(proto.getNumNulls());
    colData.setBooleanStats(boolData);
  }
 else   if (proto.hasLongStats()) {
    LongColumnStatsData longData=new LongColumnStatsData();
    longData.setLowValue(proto.getLongStats().getLowValue());
    longData.setHighValue(proto.getLongStats().getHighValue());
    longData.setNumNulls(proto.getNumNulls());
    longData.setNumDVs(proto.getNumDistinctValues());
    colData.setLongStats(longData);
  }
 else   if (proto.hasDoubleStats()) {
    DoubleColumnStatsData doubleData=new DoubleColumnStatsData();
    doubleData.setLowValue(proto.getDoubleStats().getLowValue());
    doubleData.setHighValue(proto.getDoubleStats().getHighValue());
    doubleData.setNumNulls(proto.getNumNulls());
    doubleData.setNumDVs(proto.getNumDistinctValues());
    colData.setDoubleStats(doubleData);
  }
 else   if (proto.hasStringStats()) {
    StringColumnStatsData stringData=new StringColumnStatsData();
    stringData.setMaxColLen(proto.getStringStats().getMaxColLength());
    stringData.setAvgColLen(proto.getStringStats().getAvgColLength());
    stringData.setNumNulls(proto.getNumNulls());
    stringData.setNumDVs(proto.getNumDistinctValues());
    colData.setStringStats(stringData);
  }
 else   if (proto.hasBinaryStats()) {
    BinaryColumnStatsData binaryData=new BinaryColumnStatsData();
    binaryData.setMaxColLen(proto.getBinaryStats().getMaxColLength());
    binaryData.setAvgColLen(proto.getBinaryStats().getAvgColLength());
    binaryData.setNumNulls(proto.getNumNulls());
    colData.setBinaryStats(binaryData);
  }
 else   if (proto.hasDecimalStats()) {
    DecimalColumnStatsData decimalData=new DecimalColumnStatsData();
    Decimal hiVal=new Decimal();
    hiVal.setUnscaled(proto.getDecimalStats().getHighValue().getUnscaled().toByteArray());
    hiVal.setScale((short)proto.getDecimalStats().getHighValue().getScale());
    decimalData.setHighValue(hiVal);
    Decimal loVal=new Decimal();
    loVal.setUnscaled(proto.getDecimalStats().getLowValue().getUnscaled().toByteArray());
    loVal.setScale((short)proto.getDecimalStats().getLowValue().getScale());
    decimalData.setLowValue(loVal);
    decimalData.setNumNulls(proto.getNumNulls());
    decimalData.setNumDVs(proto.getNumDistinctValues());
    colData.setDecimalStats(decimalData);
  }
 else {
    throw new RuntimeException("Woh, bad.  Unknown stats type!");
  }
  obj.setStatsData(colData);
  return obj;
}
