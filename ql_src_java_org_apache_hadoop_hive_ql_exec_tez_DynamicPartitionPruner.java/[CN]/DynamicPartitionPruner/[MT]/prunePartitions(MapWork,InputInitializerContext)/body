{
  int expectedEvents=0;
  for (  String source : this.sourceInfoMap.keySet()) {
    for (    SourceInfo si : this.sourceInfoMap.get(source)) {
      int taskNum=context.getVertexNumTasks(source);
      LOG.info("Expecting " + taskNum + " events for vertex "+ source);
      expectedEvents+=taskNum;
      prunePartitionSingleSource(source,si,work);
    }
  }
  if (expectedEvents != totalEventCount) {
    LOG.error("Expecting: " + expectedEvents + ", received: "+ totalEventCount);
    throw new HiveException("Incorrect event count in dynamic parition pruning");
  }
}
