{
  int expectedEvents=numExpectedEventsPerSource.get(name).getValue();
  if (expectedEvents < 0) {
    return;
  }
 else {
    int processedEvents=numEventsSeenPerSource.get(name).getValue();
    if (processedEvents == expectedEvents) {
      sourcesWaitingForEvents.remove(name);
      if (sourcesWaitingForEvents.isEmpty()) {
        if (!queue.offer(endOfEvents)) {
          throw new IllegalStateException("Queue full");
        }
      }
 else {
        LOG.info("Waiting for " + sourcesWaitingForEvents.size() + " sources.");
      }
    }
 else     if (processedEvents > expectedEvents) {
      throw new IllegalStateException("Received too many events for " + name + ", Expected="+ expectedEvents+ ", Received="+ processedEvents);
    }
    return;
  }
}
