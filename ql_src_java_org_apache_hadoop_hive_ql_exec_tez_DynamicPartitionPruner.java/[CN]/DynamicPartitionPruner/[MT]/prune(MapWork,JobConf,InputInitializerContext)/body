{
synchronized (sourcesWaitingForEvents) {
    initialize(work,jobConf);
    if (sourcesWaitingForEvents.isEmpty()) {
      return;
    }
    Set<VertexState> states=Collections.singleton(VertexState.SUCCEEDED);
    for (    String source : sourcesWaitingForEvents) {
      context.registerForVertexStateUpdates(source,states);
    }
  }
  LOG.info("Waiting for events (" + sourceInfoCount + " items) ...");
  this.processEvents();
  this.prunePartitions(work);
  LOG.info("Ok to proceed.");
}
