{
  Map<String,String> partKeyToVal=new HashMap<String,String>();
  partKeyToVal.put(keyName,value);
  String escapedNameFragment=Warehouse.makePartName(partKeyToVal,false);
  StringBuilder fltr=new StringBuilder();
  if (keyCount == 1) {
    params.put(paramName,escapedNameFragment);
    fltr.append("partitionName == ").append(paramName);
  }
 else   if (keyPos + 1 == keyCount) {
    params.put(paramName,"/" + escapedNameFragment);
    fltr.append("partitionName.endsWith(").append(paramName).append(')');
  }
 else   if (keyPos == 0) {
    params.put(paramName,escapedNameFragment + "/");
    fltr.append("partitionName.startsWith(").append(paramName).append(')');
  }
 else {
    params.put(paramName,"/" + escapedNameFragment + "/");
    fltr.append("partitionName.indexOf(").append(paramName).append(") >= 0");
  }
  return fltr.toString();
}
