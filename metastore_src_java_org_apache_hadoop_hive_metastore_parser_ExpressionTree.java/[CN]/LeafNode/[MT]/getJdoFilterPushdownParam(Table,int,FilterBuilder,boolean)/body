{
  boolean isIntegralSupported=canPushDownIntegral && canJdoUseStringsWithIntegral();
  String colType=table.getPartitionKeys().get(partColIndex).getType();
  if (!colType.equals(serdeConstants.STRING_TYPE_NAME) && (!isIntegralSupported || !serdeConstants.IntegralTypes.contains(colType))) {
    filterBuilder.setError("Filtering is supported only on partition keys of type " + "string" + (isIntegralSupported ? ", or integral types" : ""));
    return null;
  }
  Object val=value;
  if (value instanceof Date) {
    val=HiveMetaStore.PARTITION_DATE_FORMAT.format((Date)value);
  }
  boolean isStringValue=val instanceof String;
  if (!isStringValue && (!isIntegralSupported || !(val instanceof Long))) {
    filterBuilder.setError("Filtering is supported only on partition keys of type " + "string" + (isIntegralSupported ? ", or integral types" : ""));
    return null;
  }
  return isStringValue ? (String)val : Long.toString((Long)val);
}
