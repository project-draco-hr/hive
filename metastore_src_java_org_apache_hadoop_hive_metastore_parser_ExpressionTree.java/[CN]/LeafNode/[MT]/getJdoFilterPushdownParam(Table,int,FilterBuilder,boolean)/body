{
  boolean isIntegralSupported=canPushDownIntegral && canJdoUseStringsWithIntegral();
  String colType=table.getPartitionKeys().get(partColIndex).getType();
  if (!colType.equals(serdeConstants.STRING_TYPE_NAME) && (!isIntegralSupported || !serdeConstants.IntegralTypes.contains(colType))) {
    filterBuilder.setError("Filtering is supported only on partition keys of type " + "string" + (isIntegralSupported ? ", or integral types" : ""));
    return null;
  }
  boolean isStringValue=value instanceof String;
  if (!isStringValue && (!isIntegralSupported || !(value instanceof Long))) {
    filterBuilder.setError("Filtering is supported only on partition keys of type " + "string" + (isIntegralSupported ? ", or integral types" : ""));
    return null;
  }
  return isStringValue ? (String)value : Long.toString((Long)value);
}
