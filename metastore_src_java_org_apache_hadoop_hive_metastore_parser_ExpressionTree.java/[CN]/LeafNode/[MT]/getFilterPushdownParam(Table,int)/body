{
  boolean isIntegralSupported=doesOperatorSupportIntegral(operator);
  String colType=table.getPartitionKeys().get(partColIndex).getType();
  if (!colType.equals(serdeConstants.STRING_TYPE_NAME) && (!isIntegralSupported || !isIntegralType(colType))) {
    throw new MetaException("Filtering is supported only on partition keys of type " + "string" + (isIntegralSupported ? ", or integral types" : ""));
  }
  boolean isStringValue=value instanceof String;
  if (!isStringValue && (!isIntegralSupported || !(value instanceof Long))) {
    throw new MetaException("Filtering is supported only on partition keys of type " + "string" + (isIntegralSupported ? ", or integral types" : ""));
  }
  return isStringValue ? (String)value : Long.toString((Long)value);
}
