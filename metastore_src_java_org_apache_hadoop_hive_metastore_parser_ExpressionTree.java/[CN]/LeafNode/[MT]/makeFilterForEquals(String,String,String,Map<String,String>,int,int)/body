{
  Map<String,String> partKeyToVal=new HashMap<String,String>();
  partKeyToVal.put(keyName,value);
  String escapedNameFragment=Warehouse.makePartName(partKeyToVal,false);
  if (keyCount == 1) {
    params.put(paramName,escapedNameFragment);
  }
 else   if (keyPos + 1 == keyCount) {
    params.put(paramName,".*/" + escapedNameFragment);
  }
 else {
    params.put(paramName,".*" + escapedNameFragment + "/.*");
  }
  return "partitionName.matches(" + paramName + ")";
}
