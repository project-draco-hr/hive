{
  if (keyName.equals(Constants.HIVE_FILTER_FIELD_OWNER)) {
    keyName="this.owner";
  }
 else   if (keyName.equals(Constants.HIVE_FILTER_FIELD_LAST_ACCESS)) {
    if (operator == Operator.LIKE) {
      throw new MetaException("Like is not supported for HIVE_FILTER_FIELD_LAST_ACCESS");
    }
    keyName="this.lastAccessTime";
  }
 else   if (keyName.startsWith(Constants.HIVE_FILTER_FIELD_PARAMS)) {
    if (!(operator == Operator.EQUALS || operator == Operator.NOTEQUALS)) {
      throw new MetaException("Only = and <> are supported " + "opreators for HIVE_FILTER_FIELD_PARAMS");
    }
    String paramKeyName=keyName.substring(Constants.HIVE_FILTER_FIELD_PARAMS.length());
    keyName="this.parameters.get(\"" + paramKeyName + "\")";
    value=value.toString();
  }
 else {
    throw new MetaException("Invalid key name in filter.  " + "Use constants from org.apache.hadoop.hive.metastore.api");
  }
  return generateJDOFilterGeneral(params);
}
