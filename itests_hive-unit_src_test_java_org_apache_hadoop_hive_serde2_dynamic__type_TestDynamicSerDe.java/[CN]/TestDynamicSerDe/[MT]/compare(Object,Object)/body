{
  if (a == null && b == null) {
    return 0;
  }
  if (a == null) {
    return -1;
  }
  if (b == null) {
    return 1;
  }
  if (a instanceof List) {
    List la=(List)a;
    List lb=(List)b;
    assert(la.size() == lb.size());
    for (int i=0; i < la.size(); i++) {
      int r=compare(la.get(i),lb.get(i));
      if (r != 0) {
        return r;
      }
    }
    return 0;
  }
 else   if (a instanceof Number) {
    Number na=(Number)a;
    Number nb=(Number)b;
    if (na.doubleValue() < nb.doubleValue()) {
      return -1;
    }
    if (na.doubleValue() > nb.doubleValue()) {
      return 1;
    }
    return 0;
  }
 else   if (a instanceof String) {
    String sa=(String)a;
    String sb=(String)b;
    return sa.compareTo(sb);
  }
  return 0;
}
