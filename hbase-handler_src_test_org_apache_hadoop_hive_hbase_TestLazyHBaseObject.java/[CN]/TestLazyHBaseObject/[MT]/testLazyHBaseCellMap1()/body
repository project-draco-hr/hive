{
  Text nullSequence=new Text("\\N");
  ObjectInspector oi=LazyFactory.createLazyObjectInspector(TypeInfoUtils.getTypeInfosFromTypeString("map<int,string>").get(0),new byte[]{(byte)1,(byte)2},0,nullSequence,false,(byte)0);
  LazyHBaseCellMap b=new LazyHBaseCellMap((LazyMapObjectInspector)oi);
  HbaseMapWritable<byte[],Cell> cells=new HbaseMapWritable<byte[],Cell>();
  cells.put("cfa:col1".getBytes(),new Cell("cfacol1".getBytes(),0));
  cells.put("cfa:col2".getBytes(),new Cell("cfacol2".getBytes(),0));
  cells.put("cfb:2".getBytes(),new Cell("def".getBytes(),0));
  cells.put("cfb:-1".getBytes(),new Cell("".getBytes(),0));
  cells.put("cfb:0".getBytes(),new Cell("0".getBytes(),0));
  cells.put("cfb:8".getBytes(),new Cell("abc".getBytes(),0));
  cells.put("cfc:col3".getBytes(),new Cell("cfccol3".getBytes(),0));
  RowResult rr=new RowResult("test-row".getBytes(),cells);
  b.init(rr,"cfb:");
  assertEquals(new Text("def"),((LazyString)b.getMapValueElement(new IntWritable(2))).getWritableObject());
  assertNull(b.getMapValueElement(new IntWritable(-1)));
  assertEquals(new Text("0"),((LazyString)b.getMapValueElement(new IntWritable(0))).getWritableObject());
  assertEquals(new Text("abc"),((LazyString)b.getMapValueElement(new IntWritable(8))).getWritableObject());
  assertNull(b.getMapValueElement(new IntWritable(12345)));
  assertEquals("{0:'0',2:'def',8:'abc'}".replace('\'','\"'),SerDeUtils.getJSONString(b,oi));
}
