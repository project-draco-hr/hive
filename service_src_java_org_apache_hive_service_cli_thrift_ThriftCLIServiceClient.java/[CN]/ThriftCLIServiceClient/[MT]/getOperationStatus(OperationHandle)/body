{
  try {
    TGetOperationStatusReq req=new TGetOperationStatusReq(opHandle.toTOperationHandle());
    TGetOperationStatusResp resp=cliService.GetOperationStatus(req);
    checkStatus(resp.getStatus());
    OperationState opState=OperationState.getOperationState(resp.getOperationState());
    HiveSQLException opException=null;
    if (opState == OperationState.ERROR) {
      opException=new HiveSQLException(resp.getErrorMessage(),resp.getSqlState(),resp.getErrorCode());
    }
    return new OperationStatus(opState,resp.getTaskStatus(),resp.getOperationStarted(),resp.getOperationCompleted(),opException);
  }
 catch (  HiveSQLException e) {
    throw e;
  }
catch (  Exception e) {
    throw new HiveSQLException(e);
  }
}
