{
  Set<String> aliases=new HashSet<String>();
  JoinCondDesc[] conds=op.getConf().getConds();
  Map<Integer,Set<String>> posToAliasMap=op.getPosToAliasMap();
  int i;
  for (i=conds.length - 1; i >= 0; i--) {
    if (conds[i].getType() == JoinDesc.INNER_JOIN) {
      aliases.addAll(posToAliasMap.get(i + 1));
    }
 else     if (conds[i].getType() == JoinDesc.FULL_OUTER_JOIN) {
      break;
    }
 else     if (conds[i].getType() == JoinDesc.RIGHT_OUTER_JOIN) {
      aliases.addAll(posToAliasMap.get(i + 1));
      break;
    }
 else     if (conds[i].getType() == JoinDesc.LEFT_OUTER_JOIN) {
      continue;
    }
  }
  if (i == -1) {
    aliases.addAll(posToAliasMap.get(0));
  }
  Set<String> aliases2=rr.getTableNames();
  aliases.retainAll(aliases2);
  return aliases;
}
