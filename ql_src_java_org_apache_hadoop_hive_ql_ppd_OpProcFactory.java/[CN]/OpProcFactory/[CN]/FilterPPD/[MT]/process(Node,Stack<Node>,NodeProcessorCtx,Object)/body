{
  LOG.info("Processing for " + nd.getName() + "("+ ((Operator)nd).getIdentifier()+ ")");
  OpWalkerInfo owi=(OpWalkerInfo)procCtx;
  Operator<? extends OperatorDesc> op=(Operator<? extends OperatorDesc>)nd;
  ExprWalkerInfo ewi=owi.getPrunedPreds(op);
  if (ewi == null && !((FilterOperator)op).getConf().getIsSamplingPred()) {
    ExprNodeDesc predicate=(((FilterOperator)nd).getConf()).getPredicate();
    ewi=ExprWalkerProcFactory.extractPushdownPreds(owi,op,predicate);
    if (!ewi.isDeterministic()) {
      if (op.getChildren() != null && op.getChildren().size() == 1) {
        createFilter(op,owi.getPrunedPreds((Operator<? extends OperatorDesc>)(op.getChildren().get(0))),owi);
      }
      return null;
    }
    logExpr(nd,ewi);
    owi.putPrunedPreds((Operator<? extends OperatorDesc>)nd,ewi);
    if (HiveConf.getBoolVar(owi.getParseContext().getConf(),HiveConf.ConfVars.HIVEPPDREMOVEDUPLICATEFILTERS)) {
      owi.addCandidateFilterOp((FilterOperator)op);
      Map<String,List<ExprNodeDesc>> residual=ewi.getResidualPredicates(true);
      createFilter(op,residual,owi);
    }
  }
  boolean hasUnpushedPredicates=mergeWithChildrenPred(nd,owi,ewi,null);
  if (HiveConf.getBoolVar(owi.getParseContext().getConf(),HiveConf.ConfVars.HIVEPPDREMOVEDUPLICATEFILTERS)) {
    if (hasUnpushedPredicates) {
      ExprWalkerInfo unpushedPreds=mergeChildrenPred(nd,owi,null,false);
      return createFilter((Operator)nd,unpushedPreds,owi);
    }
  }
  return null;
}
