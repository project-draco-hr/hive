{
  Operator<? extends OperatorDesc> parent=ptfOp.getParentOperators().get(0);
  Operator<? extends OperatorDesc> gP=parent == null ? null : parent.getParentOperators().get(0);
  if (gP == null || !(gP instanceof ReduceSinkOperator)) {
    return;
  }
  float threshold=conf.getFloatVar(HiveConf.ConfVars.HIVELIMITPUSHDOWNMEMORYUSAGE);
  ReduceSinkOperator rSink=(ReduceSinkOperator)gP;
  ReduceSinkDesc rDesc=rSink.getConf();
  rDesc.setTopN(rLimit);
  rDesc.setTopNMemoryUsage(threshold);
  rDesc.setMapGroupBy(true);
  rDesc.setPTFReduceSink(true);
}
