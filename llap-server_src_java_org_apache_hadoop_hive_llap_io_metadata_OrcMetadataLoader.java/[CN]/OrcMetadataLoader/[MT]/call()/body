{
  Reader reader=OrcFile.createLLAPReader(path,readerOptions(conf).filesystem(fs));
  OrcMetadata orcMetadata=new OrcMetadata();
  orcMetadata.setCompressionKind(reader.getCompression());
  orcMetadata.setCompressionBufferSize(reader.getCompressionSize());
  List<StripeInformation> stripes=reader.getStripes();
  orcMetadata.setStripes(stripes);
  Map<Integer,List<OrcProto.ColumnEncoding>> stripeColEnc=new HashMap<Integer,List<OrcProto.ColumnEncoding>>();
  Map<Integer,OrcProto.RowIndex[]> stripeRowIndices=new HashMap<Integer,OrcProto.RowIndex[]>();
  RecordReader rows=reader.rows();
  for (int i=0; i < stripes.size(); i++) {
    stripeColEnc.put(i,rows.getColumnEncodings(i));
    stripeRowIndices.put(i,rows.getRowIndexEntries(i));
  }
  orcMetadata.setStripeToColEncodings(stripeColEnc);
  orcMetadata.setStripeToRowIndexEntries(stripeRowIndices);
  return orcMetadata;
}
