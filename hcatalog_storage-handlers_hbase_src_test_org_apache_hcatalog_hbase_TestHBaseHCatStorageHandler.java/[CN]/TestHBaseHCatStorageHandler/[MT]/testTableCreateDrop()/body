{
  Initialize();
  hcatDriver.run("drop table test_table");
  CommandProcessorResponse response=hcatDriver.run("create table test_table(key int, value string) STORED BY " + "'org.apache.hive.hcatalog.hbase.HBaseHCatStorageHandler'" + "TBLPROPERTIES ('hbase.columns.mapping'=':key,cf1:val')");
  assertEquals(0,response.getResponseCode());
  HBaseAdmin hAdmin=new HBaseAdmin(getHbaseConf());
  boolean doesTableExist=hAdmin.tableExists("test_table");
  assertTrue(doesTableExist);
  RevisionManager rm=HBaseRevisionManagerUtil.getOpenedRevisionManager(hcatConf);
  rm.open();
  rm.getAbortedWriteTransactions("test_table","cf1");
  hcatDriver.run("drop table test_table");
  doesTableExist=hAdmin.tableExists("test_table");
  assertTrue(doesTableExist == false);
  try {
    rm.getAbortedWriteTransactions("test_table","cf1");
  }
 catch (  Exception e) {
    assertTrue(e.getCause() instanceof NoNodeException);
  }
  rm.close();
}
