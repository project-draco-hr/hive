{
  String tableName="testTable";
  HBaseAdmin hAdmin=new HBaseAdmin(getHbaseConf());
  HTableDescriptor tableDesc=new HTableDescriptor(tableName);
  tableDesc.addFamily(new HColumnDescriptor(Bytes.toBytes("key")));
  tableDesc.addFamily(new HColumnDescriptor(Bytes.toBytes("familyone")));
  tableDesc.addFamily(new HColumnDescriptor(Bytes.toBytes("familytwo")));
  hAdmin.createTable(tableDesc);
  boolean doesTableExist=hAdmin.tableExists(tableName);
  assertTrue(doesTableExist);
  hcatDriver.run("drop table mytabletwo");
  CommandProcessorResponse response=hcatDriver.run("create external table mytabletwo(key int, valueone string, valuetwo string) STORED BY " + "'org.apache.hcatalog.hbase.HBaseHCatStorageHandler'" + "TBLPROPERTIES ('hbase.columns.mapping'=':key,familyone:val,familytwo:val',"+ "'hbase.table.name'='testTable')");
  assertEquals(0,response.getResponseCode());
}
