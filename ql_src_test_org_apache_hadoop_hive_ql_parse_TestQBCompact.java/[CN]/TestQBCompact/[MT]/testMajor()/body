{
  AlterTableSimpleDesc desc=parseAndAnalyze("alter table foo partition(ds = 'today') compact 'major'");
  Assert.assertEquals("major",desc.getCompactionType());
  Assert.assertEquals("foo",desc.getTableName());
  Assert.assertEquals("default",desc.getDbName());
  HashMap<String,String> parts=desc.getPartSpec();
  Assert.assertEquals(1,parts.size());
  Assert.assertEquals("today",parts.get("ds"));
}
