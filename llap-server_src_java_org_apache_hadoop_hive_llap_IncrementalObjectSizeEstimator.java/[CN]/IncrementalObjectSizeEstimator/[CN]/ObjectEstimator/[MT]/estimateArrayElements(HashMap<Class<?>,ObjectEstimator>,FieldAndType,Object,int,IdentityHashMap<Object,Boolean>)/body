{
  int result=0;
  Class<?> lastClass=e.field.getType().getComponentType();
  ObjectEstimator lastEstimator=parent.get(lastClass);
  for (int i=0; i < len; ++i) {
    Object element=Array.get(fieldObj,i);
    if (element == null)     continue;
    if (null != uniqueObjects.put(element,Boolean.TRUE))     continue;
    Class<?> elementClass=element.getClass();
    if (lastClass != elementClass) {
      lastClass=elementClass;
      lastEstimator=parent.get(lastClass);
      if (lastEstimator == null) {
        throw new AssertionError("Don't know how to measure element " + lastClass.getName() + " from "+ e.field);
      }
    }
    result+=lastEstimator.estimate(element,parent,uniqueObjects);
  }
  return result;
}
