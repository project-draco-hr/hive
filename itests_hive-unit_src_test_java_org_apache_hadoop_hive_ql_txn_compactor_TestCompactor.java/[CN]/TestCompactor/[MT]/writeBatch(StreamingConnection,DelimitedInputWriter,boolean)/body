{
  TransactionBatch txnBatch=connection.fetchTransactionBatch(2,writer);
  txnBatch.beginNextTransaction();
  txnBatch.write("50,Kiev".getBytes());
  txnBatch.write("51,St. Petersburg".getBytes());
  txnBatch.write("44,Boston".getBytes());
  txnBatch.commit();
  if (!closeEarly) {
    txnBatch.beginNextTransaction();
    txnBatch.write("52,Tel Aviv".getBytes());
    txnBatch.write("53,Atlantis".getBytes());
    txnBatch.write("53,Boston".getBytes());
    txnBatch.commit();
    txnBatch.close();
  }
}
