{
  VectorizedRowBatch b=getBatchTimestampDecimal();
  VectorExpression expr=new CastTimestampToDecimal(0,1);
  TimestampColumnVector inT=(TimestampColumnVector)b.cols[0];
  inT.set(1,new PisaTimestamp(0,-1990000000L));
  expr.evaluate(b);
  DecimalColumnVector r=(DecimalColumnVector)b.cols[1];
  assertTrue(r.vector[0].getHiveDecimal().equals(HiveDecimal.create("0.00")));
  assertTrue(r.vector[1].getHiveDecimal().equals(HiveDecimal.create("-1.99")));
  assertTrue(r.vector[2].getHiveDecimal().equals(HiveDecimal.create("100000.00")));
  b=getBatchTimestampDecimalPrec5Scale2();
  expr.evaluate(b);
  r=(DecimalColumnVector)b.cols[1];
  assertFalse(r.noNulls);
  assertFalse(r.isNull[0]);
  assertFalse(r.isNull[1]);
  assertTrue(r.isNull[2]);
}
