{
  VectorizedRowBatch b=getBatchLongDecimal();
  VectorExpression expr=new CastTimestampToDecimal(0,1);
  LongColumnVector inL=(LongColumnVector)b.cols[0];
  inL.vector[1]=-1990000000L;
  expr.evaluate(b);
  DecimalColumnVector r=(DecimalColumnVector)b.cols[1];
  assertTrue(r.vector[0].getHiveDecimal().equals(HiveDecimal.create("0.00")));
  assertTrue(r.vector[1].getHiveDecimal().equals(HiveDecimal.create("-1.99")));
  assertTrue(r.vector[2].getHiveDecimal().equals(HiveDecimal.create("100000.00")));
  b=getBatchLongDecimalPrec5Scale2();
  expr.evaluate(b);
  r=(DecimalColumnVector)b.cols[1];
  assertFalse(r.noNulls);
  assertFalse(r.isNull[0]);
  assertFalse(r.isNull[1]);
  assertTrue(r.isNull[2]);
}
