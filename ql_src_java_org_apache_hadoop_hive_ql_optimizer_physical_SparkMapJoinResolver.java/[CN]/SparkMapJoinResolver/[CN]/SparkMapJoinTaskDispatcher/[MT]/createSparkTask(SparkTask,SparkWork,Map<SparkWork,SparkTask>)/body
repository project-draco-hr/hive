{
  if (createdTaskMap.containsKey(sparkWork)) {
    return createdTaskMap.get(sparkWork);
  }
  SparkTask resultTask=originalTask.getWork() == sparkWork ? originalTask : (SparkTask)TaskFactory.get(sparkWork,physicalContext.conf);
  if (!dependencyGraph.get(sparkWork).isEmpty()) {
    for (    SparkWork parentWork : dependencyGraph.get(sparkWork)) {
      SparkTask parentTask=createSparkTask(originalTask,parentWork,createdTaskMap);
      parentTask.addDependentTask(resultTask);
    }
  }
 else {
    List<Task<? extends Serializable>> parentTasks=originalTask.getParentTasks();
    if (parentTasks != null && parentTasks.size() > 0) {
      for (      Task<? extends Serializable> parentTask : parentTasks) {
        parentTask.addDependentTask(resultTask);
      }
    }
 else {
      physicalContext.addToRootTask(resultTask);
      physicalContext.removeFromRootTask(originalTask);
    }
  }
  createdTaskMap.put(sparkWork,resultTask);
  return resultTask;
}
