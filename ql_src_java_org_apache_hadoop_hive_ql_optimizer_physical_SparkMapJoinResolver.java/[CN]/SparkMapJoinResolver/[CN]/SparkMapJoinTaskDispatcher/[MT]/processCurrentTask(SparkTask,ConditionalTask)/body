{
  dependencyGraph.clear();
  sparkWorkMap.clear();
  SparkWork sparkWork=sparkTask.getWork();
  generateLocalWork(sparkTask);
  dependencyGraph.put(sparkWork,new ArrayList<SparkWork>());
  Set<BaseWork> leaves=sparkWork.getLeaves();
  for (  BaseWork leaf : leaves) {
    moveWork(sparkWork,leaf,sparkWork);
  }
  for (  SparkWork newSparkWork : sparkWorkMap.values()) {
    for (    BaseWork work : newSparkWork.getAllWorkUnsorted()) {
      sparkWork.remove(work);
    }
  }
  Map<SparkWork,SparkTask> createdTaskMap=new LinkedHashMap<SparkWork,SparkTask>();
  for (  SparkWork work : dependencyGraph.keySet()) {
    createSparkTask(sparkTask,work,createdTaskMap,conditionalTask);
  }
}
