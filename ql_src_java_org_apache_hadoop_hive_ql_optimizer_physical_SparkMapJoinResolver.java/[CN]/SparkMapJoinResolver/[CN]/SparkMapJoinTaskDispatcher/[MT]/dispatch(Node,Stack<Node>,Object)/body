{
  Task<? extends Serializable> currentTask=(Task<? extends Serializable>)nd;
  if (currentTask instanceof SparkTask) {
    SparkWork sparkWork=((SparkTask)currentTask).getWork();
    Set<BaseWork> leaves=sparkWork.getLeaves();
    for (    BaseWork leaf : leaves) {
      moveWork(sparkWork,leaf,sparkWork);
    }
    for (    SparkWork newSparkWork : sparkWorkMap.values()) {
      for (      BaseWork work : newSparkWork.getAllWorkUnsorted()) {
        sparkWork.remove(work);
      }
    }
    Map<SparkWork,SparkTask> createdTaskMap=new HashMap<SparkWork,SparkTask>();
    for (    SparkWork work : dependencyGraph.keySet()) {
      createSparkTask(currentTask,work,createdTaskMap);
    }
  }
  return null;
}
