{
  createTestTable("testtab1");
  String url=miniHS2.getJdbcURL();
  String user=System.getProperty("user.name");
  String pwd=user;
  String query="select * from testtab1 where under_col = 0";
  LlapInputFormat inputFormat=new LlapInputFormat(url,user,pwd,query);
  JobConf job=new JobConf();
  int numSplits=1;
  InputSplit[] splits=inputFormat.getSplits(job,numSplits);
  assert(splits.length > 0);
  boolean first=true;
  int rowCount=0;
  for (  InputSplit split : splits) {
    System.out.println("Processing split " + split.getLocations());
    RecordReader<NullWritable,Text> reader=inputFormat.getRecordReader(split,job,null);
    if (reader instanceof LlapRecordReader && first) {
      Schema schema=((LlapRecordReader)reader).getSchema();
      System.out.println("" + schema);
    }
    if (first) {
      System.out.println("Results: ");
      System.out.println("");
      first=false;
    }
    Text value=reader.createValue();
    while (reader.next(NullWritable.get(),value)) {
      System.out.println(value);
      ++rowCount;
    }
  }
  assertEquals(3,rowCount);
}
