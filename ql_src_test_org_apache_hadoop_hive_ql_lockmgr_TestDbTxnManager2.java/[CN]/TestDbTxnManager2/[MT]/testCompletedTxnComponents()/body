{
  CommandProcessorResponse cpr=driver.run("create table if not exists tab1 (a int, b int) partitioned by (p string) " + "clustered by (a) into 2  buckets stored as orc TBLPROPERTIES ('transactional'='true')");
  checkCmdOnDriver(cpr);
  cpr=driver.run("create table if not exists tab_not_acid2 (a int, b int)");
  checkCmdOnDriver(cpr);
  checkCmdOnDriver(driver.run("insert into tab_not_acid2 values(1,1),(2,2)"));
  checkCmdOnDriver(driver.run("from tab_not_acid2 insert into tab1 partition(p='two')(a,b) select a,b insert into tab_not_acid2(a,b) select a,b "));
  Assert.assertEquals(TxnDbUtil.queryToString("select * from COMPLETED_TXN_COMPONENTS"),1,TxnDbUtil.countQueryAgent("select count(*) from COMPLETED_TXN_COMPONENTS"));
  Assert.assertEquals(TxnDbUtil.queryToString("select * from COMPLETED_TXN_COMPONENTS"),1,TxnDbUtil.countQueryAgent("select count(*) from COMPLETED_TXN_COMPONENTS where ctc_txnid=1 and ctc_table='tab1'"));
}
