{
  CommandProcessorResponse cpr=driver.run("create table T10 (a int, b int) clustered by(b) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')");
  checkCmdOnDriver(cpr);
  cpr=driver.run("create table T11 (a int, b int) clustered by(b) into 2 buckets stored as orc");
  checkCmdOnDriver(cpr);
  useDummyTxnManagerTemporarily(conf);
  cpr=driver.compileAndRespond("select * from T10");
  Assert.assertEquals(ErrorMsg.TXNMGR_NOT_ACID.getErrorCode(),cpr.getResponseCode());
  Assert.assertTrue(cpr.getErrorMessage().contains("This command is not allowed on an ACID table"));
  useDummyTxnManagerTemporarily(conf);
  cpr=driver.compileAndRespond("insert into table T10 values (1, 2)");
  Assert.assertEquals(ErrorMsg.TXNMGR_NOT_ACID.getErrorCode(),cpr.getResponseCode());
  Assert.assertTrue(cpr.getErrorMessage().contains("This command is not allowed on an ACID table"));
  useDummyTxnManagerTemporarily(conf);
  cpr=driver.compileAndRespond("insert overwrite table T10 select a, b from T11");
  Assert.assertEquals(ErrorMsg.NO_INSERT_OVERWRITE_WITH_ACID.getErrorCode(),cpr.getResponseCode());
  Assert.assertTrue(cpr.getErrorMessage().contains("INSERT OVERWRITE not allowed on table with OutputFormat" + " that implements AcidOutputFormat while transaction manager that supports ACID is in use"));
  useDummyTxnManagerTemporarily(conf);
  cpr=driver.compileAndRespond("update T10 set a=0 where b=1");
  Assert.assertEquals(ErrorMsg.ACID_OP_ON_NONACID_TXNMGR.getErrorCode(),cpr.getResponseCode());
  Assert.assertTrue(cpr.getErrorMessage().contains("Attempt to do update or delete using transaction manager that does not support these operations."));
  useDummyTxnManagerTemporarily(conf);
  cpr=driver.compileAndRespond("delete from T10");
  Assert.assertEquals(ErrorMsg.ACID_OP_ON_NONACID_TXNMGR.getErrorCode(),cpr.getResponseCode());
  Assert.assertTrue(cpr.getErrorMessage().contains("Attempt to do update or delete using transaction manager that does not support these operations."));
}
