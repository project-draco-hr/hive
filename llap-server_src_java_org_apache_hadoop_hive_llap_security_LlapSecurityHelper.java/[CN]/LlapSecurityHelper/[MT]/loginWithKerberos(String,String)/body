{
  if (!UserGroupInformation.isSecurityEnabled())   return null;
  if (principal.isEmpty() || keytabFile.isEmpty()) {
    throw new RuntimeException("Kerberos principal and/or keytab are empty");
  }
  LOG.info("Logging in as " + principal + " via "+ keytabFile);
  UserGroupInformation.loginUserFromKeytab(SecurityUtil.getServerPrincipal(principal,"0.0.0.0"),keytabFile);
  return UserGroupInformation.getLoginUser();
}
