{
  return llapUgi.doAs(new PrivilegedExceptionAction<ByteString>(){
    @Override public ByteString run() throws Exception {
      if (client == null) {
        client=new LlapManagementProtocolClientImpl(conf,si.getHost(),si.getManagementPort(),retryPolicy,socketFactory);
      }
      GetTokenRequestProto req=GetTokenRequestProto.newBuilder().build();
      return client.getDelegationToken(null,req).getToken();
    }
  }
);
}
