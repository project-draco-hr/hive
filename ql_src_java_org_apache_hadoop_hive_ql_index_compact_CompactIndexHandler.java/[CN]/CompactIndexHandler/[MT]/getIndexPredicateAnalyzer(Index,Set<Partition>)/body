{
  IndexPredicateAnalyzer analyzer=new IndexPredicateAnalyzer();
  analyzer.addComparisonOp(GenericUDFOPEqual.class.getName());
  analyzer.addComparisonOp(GenericUDFOPLessThan.class.getName());
  analyzer.addComparisonOp(GenericUDFOPEqualOrLessThan.class.getName());
  analyzer.addComparisonOp(GenericUDFOPGreaterThan.class.getName());
  analyzer.addComparisonOp(GenericUDFOPEqualOrGreaterThan.class.getName());
  List<FieldSchema> columnSchemas=index.getSd().getCols();
  for (  FieldSchema column : columnSchemas) {
    analyzer.allowColumnName(column.getName());
  }
  for (  Partition part : queryPartitions) {
    if (part.getSpec().isEmpty()) {
      continue;
    }
    List<FieldSchema> partitionColumns=part.getCols();
    for (    FieldSchema column : partitionColumns) {
      analyzer.allowColumnName(column.getName());
    }
  }
  return analyzer;
}
