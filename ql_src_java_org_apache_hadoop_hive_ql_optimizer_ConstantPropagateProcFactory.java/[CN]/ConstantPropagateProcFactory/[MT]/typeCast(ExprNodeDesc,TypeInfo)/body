{
  if (desc instanceof ExprNodeConstantDesc && null == ((ExprNodeConstantDesc)desc).getValue()) {
    return null;
  }
  if (!(ti instanceof PrimitiveTypeInfo) || !(desc.getTypeInfo() instanceof PrimitiveTypeInfo)) {
    return null;
  }
  PrimitiveTypeInfo priti=(PrimitiveTypeInfo)ti;
  PrimitiveTypeInfo descti=(PrimitiveTypeInfo)desc.getTypeInfo();
  if (unSupportedTypes.contains(priti.getPrimitiveCategory()) || unSupportedTypes.contains(descti.getPrimitiveCategory())) {
    return null;
  }
  LOG.debug("Casting " + desc + " to type "+ ti);
  ExprNodeConstantDesc c=(ExprNodeConstantDesc)desc;
  if (null != c.getFoldedFromVal() && priti.getTypeName().equals(serdeConstants.STRING_TYPE_NAME)) {
    return new ExprNodeConstantDesc(c.getFoldedFromVal());
  }
  ObjectInspector origOI=TypeInfoUtils.getStandardJavaObjectInspectorFromTypeInfo(desc.getTypeInfo());
  ObjectInspector oi=TypeInfoUtils.getStandardJavaObjectInspectorFromTypeInfo(ti);
  Converter converter=ObjectInspectorConverters.getConverter(origOI,oi);
  Object convObj=converter.convert(c.getValue());
  if (convObj instanceof Integer) {
switch (priti.getPrimitiveCategory()) {
case BYTE:
      convObj=new Byte((byte)(((Integer)convObj).intValue()));
    break;
case SHORT:
  convObj=new Short((short)((Integer)convObj).intValue());
break;
case LONG:
convObj=new Long(((Integer)convObj).intValue());
default :
}
}
return new ExprNodeConstantDesc(ti,convObj);
}
