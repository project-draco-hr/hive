{
  VectorFilterOperator vfo=getAVectorFilterOperator();
  VectorExpression ve1=new FilterLongColGreaterLongColumn(0,1);
  VectorExpression ve2=new FilterLongColEqualDoubleScalar(2,0);
  VectorExpression ve3=new FilterExprAndExpr();
  ve3.setChildExpressions(new VectorExpression[]{ve1,ve2});
  vfo.setFilterCondition(ve3);
  FakeDataReader fdr=new FakeDataReader(1024 * 1,3);
  VectorizedRowBatch vrg=fdr.getNext();
  vfo.processOp(vrg,0);
  int rows=0;
  for (int i=0; i < 1024; i++) {
    LongColumnVector l1=(LongColumnVector)vrg.cols[0];
    LongColumnVector l2=(LongColumnVector)vrg.cols[1];
    LongColumnVector l3=(LongColumnVector)vrg.cols[2];
    if ((l1.vector[i] > l2.vector[i]) && (l3.vector[i] == 0)) {
      rows++;
    }
  }
  Assert.assertEquals(rows,vrg.size);
}
