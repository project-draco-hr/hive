{
  Connection hs2Conn=getConnection("user1");
  Statement stmt=hs2Conn.createStatement();
  final String cmd="show tables";
  stmt.execute(cmd);
  stmt.close();
  hs2Conn.close();
  ArgumentCaptor<HiveAuthzContext> contextCapturer=ArgumentCaptor.forClass(HiveAuthzContext.class);
  verify(mockedAuthorizer).checkPrivileges(any(HiveOperationType.class),Matchers.anyListOf(HivePrivilegeObject.class),Matchers.anyListOf(HivePrivilegeObject.class),contextCapturer.capture());
  HiveAuthzContext context=contextCapturer.getValue();
  assertEquals("Command ",cmd,context.getCommandString());
  assertTrue("ip address pattern check",context.getIpAddress().contains("."));
  assertTrue("ip address size check",context.getIpAddress().length() > 7);
  assertTrue("session string size check",context.getSessionString().length() > 10);
  assertEquals("Client type ",HiveAuthzContext.CLIENT_TYPE.HIVESERVER2,context.getClientType());
}
