{
  Connection hs2Conn=getConnection("user1");
  Statement stmt=hs2Conn.createStatement();
  stmt.execute(cmd);
  stmt.close();
  hs2Conn.close();
  ArgumentCaptor<QueryContext> contextCapturer=ArgumentCaptor.forClass(QueryContext.class);
  verify(mockedAuthorizer).checkPrivileges(any(HiveOperationType.class),Matchers.anyListOf(HivePrivilegeObject.class),Matchers.anyListOf(HivePrivilegeObject.class),contextCapturer.capture());
  QueryContext context=contextCapturer.getValue();
  assertEquals("Command ",ctxCmd,context.getCommandString());
  assertTrue("ip address pattern check",authenticator.getUserIpAddress().matches("[.:a-fA-F0-9]+"));
  assertTrue("ip address size check",authenticator.getUserIpAddress().length() > 7);
}
