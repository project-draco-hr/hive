{
  Schema runtimeSchema=Schema.getPigSchema(resourceSchema);
  if (pigSchema != null) {
    if (!Schema.equals(runtimeSchema,pigSchema,false,true)) {
      throw new FrontendException("Schema provided in store statement doesn't match with the Schema" + "returned by Pig run-time. Schema provided in HCatStorer: " + pigSchema.toString() + " Schema received from Pig runtime: "+ runtimeSchema.toString(),PigHCatUtil.PIG_EXCEPTION_CODE);
    }
  }
 else {
    pigSchema=runtimeSchema;
  }
  UDFContext.getUDFContext().getUDFProperties(this.getClass(),new String[]{sign}).setProperty(PIG_SCHEMA,ObjectSerializer.serialize(pigSchema));
}
