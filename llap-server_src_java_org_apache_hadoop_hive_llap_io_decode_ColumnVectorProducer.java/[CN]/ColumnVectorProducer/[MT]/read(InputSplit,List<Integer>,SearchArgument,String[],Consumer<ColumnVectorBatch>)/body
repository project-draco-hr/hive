{
  final EncodedDataConsumer edc=new EncodedDataConsumer(consumer,columnIds.size());
  EncodedDataProducer<BatchKey> edp=getEncodedDataProducer();
  EncodedDataReader<BatchKey> reader=edp.createReader(split,columnIds,sarg,columnNames,edc);
  edc.init(reader);
  UncaughtErrorHandler errorHandler=new UncaughtErrorHandler(edc);
  ListenableFuture<Void> future=executor.submit(reader);
  Futures.addCallback(future,errorHandler);
  return edc;
}
