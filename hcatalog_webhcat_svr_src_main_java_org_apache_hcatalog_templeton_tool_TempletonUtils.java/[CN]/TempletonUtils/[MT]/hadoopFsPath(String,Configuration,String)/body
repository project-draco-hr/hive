{
  if (fname == null || conf == null) {
    return null;
  }
  UserGroupInformation ugi=UgiFactory.getUgi(user);
  final FileSystem defaultFs=ugi.doAs(new PrivilegedExceptionAction<FileSystem>(){
    public FileSystem run() throws URISyntaxException, IOException, InterruptedException {
      return FileSystem.get(new URI(fname),conf);
    }
  }
);
  URI u=new URI(fname);
  Path p=new Path(u).makeQualified(defaultFs);
  if (hadoopFsIsMissing(defaultFs,p))   throw new FileNotFoundException("File " + fname + " does not exist.");
  return p;
}
