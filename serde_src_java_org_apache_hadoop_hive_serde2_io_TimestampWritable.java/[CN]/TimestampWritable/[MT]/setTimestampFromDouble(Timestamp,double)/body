{
  if (Double.isNaN(f)) {
    timestamp.setTime(0);
    return;
  }
  long seconds=(long)f;
  BigDecimal bd=new BigDecimal(String.valueOf(f));
  bd=bd.subtract(new BigDecimal(seconds)).multiply(new BigDecimal(1000000000));
  int nanos=bd.intValue();
  long millis=seconds * 1000;
  if (nanos < 0) {
    millis-=1000;
    nanos+=1000000000;
  }
  timestamp.setTime(millis);
  timestamp.setNanos(nanos);
}
