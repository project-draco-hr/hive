{
  if (jobConf == null) {
    jobConf=KryoSerializer.deserializeJobConf(this.buffer);
    SparkUtilities.setTaskInfoInJobConf(jobConf,TaskContext.get());
  }
  SparkRecordHandler mapRecordHandler;
  if (MergeFileMapper.class.getName().equals(jobConf.get(Utilities.MAPRED_MAPPER_CLASS))) {
    mapRecordHandler=new SparkMergeFileRecordHandler();
  }
 else {
    mapRecordHandler=new SparkMapRecordHandler();
  }
  HiveMapFunctionResultList result=new HiveMapFunctionResultList(jobConf,it,mapRecordHandler);
  mapRecordHandler.init(jobConf,result,Reporter.NULL);
  return result;
}
