{
  if (jobConf == null) {
    jobConf=KryoSerializer.deserializeJobConf(this.buffer);
    mapper=new ExecMapper();
    mapper.configure(jobConf);
    collector=new SparkCollector();
  }
  collector.clear();
  while (it.hasNext() && !ExecMapper.getDone()) {
    Tuple2<BytesWritable,BytesWritable> input=it.next();
    System.out.println("mapper input: " + input._1() + ", "+ input._2());
    mapper.map(input._1(),input._2(),collector,Reporter.NULL);
  }
  mapper.close();
  return collector.getResult();
}
