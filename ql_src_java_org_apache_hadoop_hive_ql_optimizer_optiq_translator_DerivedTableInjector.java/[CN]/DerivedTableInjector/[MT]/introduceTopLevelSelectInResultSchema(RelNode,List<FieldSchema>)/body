{
  RelNode curNode=rootRel;
  HiveProjectRel rootProjRel=null;
  while (curNode != null) {
    if (curNode instanceof HiveProjectRel) {
      rootProjRel=(HiveProjectRel)curNode;
      break;
    }
    curNode=curNode.getInput(0);
  }
  List<RexNode> rootChildExps=rootProjRel.getChildExps();
  if (resultSchema.size() != rootChildExps.size()) {
    throw new RuntimeException("Result Schema didn't match Optiq Optimized Op Tree Schema");
  }
  List<RexNode> newSelExps=new ArrayList<RexNode>();
  List<String> newSelAliases=new ArrayList<String>();
  for (int i=0; i < rootChildExps.size(); i++) {
    newSelExps.add(new RexInputRef(i,rootChildExps.get(i).getType()));
    newSelAliases.add(resultSchema.get(i).getName());
  }
  return HiveProjectRel.create(rootRel,newSelExps,newSelAliases);
}
