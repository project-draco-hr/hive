{
  RelNode newTopNode=rel;
  if (!(newTopNode instanceof ProjectRelBase) && !(newTopNode instanceof SortRel)) {
    newTopNode=introduceDerivedTable(newTopNode);
  }
  convertOpTree(newTopNode,(RelNode)null);
  newTopNode=renameTopLevelSelectInResultSchema(newTopNode,resultSchema);
  return newTopNode;
}
