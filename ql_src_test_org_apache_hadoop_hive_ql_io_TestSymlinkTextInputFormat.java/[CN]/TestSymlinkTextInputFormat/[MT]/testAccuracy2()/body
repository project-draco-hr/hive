{
  fileSystem.mkdirs(symlinkDir);
  FileInputFormat.setInputPaths(job,symlinkDir);
  SymlinkTextInputFormat inputFormat=new SymlinkTextInputFormat();
  ContentSummary cs=inputFormat.getContentSummary(symlinkDir,job);
  assertEquals(0,cs.getLength());
  assertEquals(0,cs.getFileCount());
  assertEquals(0,cs.getDirectoryCount());
  InputSplit[] splits=inputFormat.getSplits(job,2);
  log.info("Number of splits: " + splits.length);
  List<String> received=new ArrayList<String>();
  for (  InputSplit split : splits) {
    RecordReader<LongWritable,Text> reader=inputFormat.getRecordReader(split,job,reporter);
    LongWritable key=reader.createKey();
    Text value=reader.createValue();
    while (reader.next(key,value)) {
      received.add(value.toString());
    }
  }
  List<String> expected=new ArrayList<String>();
  assertEquals(expected,received);
}
