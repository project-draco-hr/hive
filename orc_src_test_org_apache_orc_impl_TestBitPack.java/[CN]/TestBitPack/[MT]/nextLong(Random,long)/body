{
  long bits, val;
  do {
    bits=(rng.nextLong() << 1) >>> 1;
    val=bits % n;
  }
 while (bits - val + (n - 1) < 0L);
  return val;
}
