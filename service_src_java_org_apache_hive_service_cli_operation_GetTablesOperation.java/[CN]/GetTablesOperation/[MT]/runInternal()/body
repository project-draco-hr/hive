{
  setState(OperationState.RUNNING);
  try {
    IMetaStoreClient metastoreClient=getParentSession().getMetaStoreClient();
    String schemaPattern=convertSchemaPattern(schemaName);
    List<String> matchingDbs=metastoreClient.getDatabases(schemaPattern);
    if (isAuthV2Enabled()) {
      List<HivePrivilegeObject> privObjs=HivePrivilegeObjectUtils.getHivePrivDbObjects(matchingDbs);
      String cmdStr="catalog : " + catalogName + ", schemaPattern : "+ schemaName;
      authorizeMetaGets(HiveOperationType.GET_TABLES,privObjs,cmdStr);
    }
    String tablePattern=convertIdentifierPattern(tableName,true);
    int maxBatchSize=SessionState.get().getConf().getIntVar(ConfVars.METASTORE_BATCH_RETRIEVE_MAX);
    for (    String dbName : metastoreClient.getDatabases(schemaPattern)) {
      List<String> tableNames=metastoreClient.getTables(dbName,tablePattern);
      for (      Table table : new TableIterable(metastoreClient,dbName,tableNames,maxBatchSize)) {
        Object[] rowData=new Object[]{DEFAULT_HIVE_CATALOG,table.getDbName(),table.getTableName(),tableTypeMapping.mapToClientType(table.getTableType()),table.getParameters().get("comment")};
        if (tableTypes.isEmpty() || tableTypes.contains(tableTypeMapping.mapToClientType(table.getTableType()))) {
          rowSet.addRow(rowData);
        }
      }
    }
    setState(OperationState.FINISHED);
  }
 catch (  Exception e) {
    setState(OperationState.ERROR);
    throw new HiveSQLException(e);
  }
}
