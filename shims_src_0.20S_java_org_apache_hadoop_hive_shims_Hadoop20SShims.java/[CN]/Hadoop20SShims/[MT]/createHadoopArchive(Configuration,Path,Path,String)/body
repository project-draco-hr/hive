{
  HadoopArchives har=new HadoopArchives(conf);
  List<String> args=new ArrayList<String>();
  if (conf.get("hive.archive.har.parentdir.settable") == null) {
    throw new RuntimeException("hive.archive.har.parentdir.settable is not set");
  }
  boolean parentSettable=conf.getBoolean("hive.archive.har.parentdir.settable",false);
  if (parentSettable) {
    args.add("-archiveName");
    args.add(archiveName);
    args.add("-p");
    args.add(sourceDir.toString());
    args.add(destDir.toString());
  }
 else {
    args.add("-archiveName");
    args.add(archiveName);
    args.add(sourceDir.toString());
    args.add(destDir.toString());
  }
  return ToolRunner.run(har,args.toArray(new String[0]));
}
