{
  if (running) {
    if (error == null) {
      LOG.info("Shutting down remote driver.");
    }
 else {
      LOG.error("Shutting down remote driver due to error: " + error,error);
    }
    running=false;
    for (    JobWrapper<?> job : activeJobs.values()) {
      cancelJob(job);
    }
    if (error != null) {
      protocol.sendError(error);
    }
    if (jc != null) {
      jc.stop();
    }
    clientRpc.close();
    egroup.shutdownGracefully();
synchronized (shutdownLock) {
      shutdownLock.notifyAll();
    }
  }
}
