{
  final String queryDirectory=cliConfig.getQueryDirectory();
  long startTime=System.currentTimeMillis();
  try {
    System.err.println("Begin query: " + fname);
    List<String> versionFiles=QTestUtil.getVersionFiles(queryDirectory,tname);
    if (versionFiles.size() < 2) {
      fail("Cannot run " + tname + " with only "+ versionFiles.size()+ " versions");
    }
    qt.addFile(fpath);
    for (    String versionFile : versionFiles) {
      qt.addFile(new File(queryDirectory,versionFile),true);
    }
    if (qt.shouldBeSkipped(fname)) {
      return;
    }
    int ecode=0;
    List<String> outputs=new ArrayList<>(versionFiles.size());
    for (    String versionFile : versionFiles) {
      String versionStr=versionFile.substring(tname.length() + 1,versionFile.length() - 3);
      outputs.add(qt.cliInit(tname + "." + versionStr,false));
      ecode=qt.executeClient(versionFile,fname);
      if (ecode != 0) {
        qt.failed(ecode,fname,debugHint);
      }
    }
    ecode=qt.checkCompareCliDriverResults(fname,outputs);
    if (ecode != 0) {
      qt.failedDiff(ecode,fname,debugHint);
    }
  }
 catch (  Throwable e) {
    qt.failed(e,fname,debugHint);
  }
  long elapsedTime=System.currentTimeMillis() - startTime;
  System.err.println("Done query: " + fname + " elapsedTime="+ elapsedTime / 1000 + "s");
}
