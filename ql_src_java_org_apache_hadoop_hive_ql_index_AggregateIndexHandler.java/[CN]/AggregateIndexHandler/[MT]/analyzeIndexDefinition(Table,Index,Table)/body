{
  index=idx;
  StorageDescriptor storageDesc=index.getSd();
  if (this.usesIndexTable() && indexTable != null) {
    StorageDescriptor indexTableSd=storageDesc.deepCopy();
    List<FieldSchema> indexTblCols=indexTableSd.getCols();
    FieldSchema bucketFileName=new FieldSchema("_bucketname","string","");
    indexTblCols.add(bucketFileName);
    FieldSchema offSets=new FieldSchema("_offsets","array<bigint>","");
    indexTblCols.add(offSets);
    Map<String,String> paraList=index.getParameters();
    if (paraList != null && paraList.containsKey("AGGREGATES")) {
      String propValue=paraList.get("AGGREGATES");
      if (propValue.contains(",")) {
        String[] aggFuncs=propValue.split(",");
        for (int i=0; i < aggFuncs.length; i++) {
          createAggregationFunction(indexTblCols,aggFuncs[i]);
        }
      }
 else {
        createAggregationFunction(indexTblCols,propValue);
      }
    }
    indexTable.setSd(indexTableSd);
  }
}
