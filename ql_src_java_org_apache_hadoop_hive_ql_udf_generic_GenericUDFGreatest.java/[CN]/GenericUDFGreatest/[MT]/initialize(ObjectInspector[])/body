{
  if (arguments.length < 2) {
    throw new UDFArgumentLengthException(getFuncName() + " requires at least 2 arguments, got " + arguments.length);
  }
  if (arguments[0].getCategory() != Category.PRIMITIVE) {
    throw new UDFArgumentException(getFuncName() + " only takes primitive types, got " + arguments[0].getTypeName());
  }
  argumentOIs=arguments;
  returnOIResolver=new GenericUDFUtils.ReturnObjectInspectorResolver(false);
  for (int i=0; i < arguments.length; i++) {
    if (!returnOIResolver.update(arguments[i])) {
      throw new UDFArgumentTypeException(i,"The expressions after " + getFuncName() + " should all have the same type: \""+ returnOIResolver.get().getTypeName()+ "\" is expected but \""+ arguments[i].getTypeName()+ "\" is found");
    }
  }
  return returnOIResolver.get();
}
