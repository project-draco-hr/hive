{
  try {
    Job job=new Job(conf);
    InputJobInfo jobInfo=InputJobInfo.create(re.getDbName(),re.getTableName(),re.getFilterString());
    HCatInputFormat.setInput(job,jobInfo);
    HCatInputFormat hcif=new HCatInputFormat();
    ReaderContext cntxt=new ReaderContext();
    cntxt.setInputSplits(hcif.getSplits(HCatHadoopShims.Instance.get().createJobContext(job.getConfiguration(),null)));
    cntxt.setConf(job.getConfiguration());
    return cntxt;
  }
 catch (  IOException e) {
    throw new HCatException(ErrorType.ERROR_NOT_INITIALIZED,e);
  }
catch (  InterruptedException e) {
    throw new HCatException(ErrorType.ERROR_NOT_INITIALIZED,e);
  }
}
