{
  String principal=hiveConf.getVar(ConfVars.HIVE_SERVER2_SPNEGO_PRINCIPAL);
  String keyTabFile=hiveConf.getVar(ConfVars.HIVE_SERVER2_SPNEGO_KEYTAB);
  if (!principal.isEmpty() && !keyTabFile.isEmpty()) {
    return ShimLoader.getHadoopShims().loginUserFromKeytabAndReturnUGI(principal,keyTabFile);
  }
 else {
    throw new IOException("HiveServer2 SPNego principal or keytab " + "is not correctly configured");
  }
}
