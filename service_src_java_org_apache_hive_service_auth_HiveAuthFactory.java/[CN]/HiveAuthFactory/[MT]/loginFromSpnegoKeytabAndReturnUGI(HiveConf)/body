{
  String principal=hiveConf.getVar(ConfVars.HIVE_SERVER2_SPNEGO_PRINCIPAL);
  String keyTabFile=hiveConf.getVar(ConfVars.HIVE_SERVER2_SPNEGO_KEYTAB);
  if (principal.isEmpty() || keyTabFile.isEmpty()) {
    throw new IOException("HiveServer2 SPNEGO principal or keytab is not correctly configured");
  }
 else {
    return ShimLoader.getHadoopShims().loginUserFromKeytabAndReturnUGI(principal,keyTabFile);
  }
}
