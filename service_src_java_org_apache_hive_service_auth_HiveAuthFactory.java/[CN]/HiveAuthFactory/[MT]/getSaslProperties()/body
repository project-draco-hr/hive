{
  Map<String,String> saslProps=new HashMap<String,String>();
  SaslQOP saslQOP=SaslQOP.fromString(conf.getVar(ConfVars.HIVE_SERVER2_THRIFT_SASL_QOP));
  Map<String,String> hadoopSaslProps=ShimLoader.getHadoopThriftAuthBridge().getHadoopSaslProperties(conf);
  SaslQOP hadoopSaslQOP=SaslQOP.fromString(hadoopSaslProps.get(Sasl.QOP));
  if (hadoopSaslQOP.ordinal() > saslQOP.ordinal()) {
    LOG.warn(MessageFormat.format("\"hadoop.rpc.protection\" is set to higher security level " + "{0} then {1} which is set to {2}",hadoopSaslQOP.toString(),ConfVars.HIVE_SERVER2_THRIFT_SASL_QOP.varname,saslQOP.toString()));
  }
  saslProps.put(Sasl.QOP,saslQOP.toString());
  saslProps.put(Sasl.SERVER_AUTH,"true");
  return saslProps;
}
