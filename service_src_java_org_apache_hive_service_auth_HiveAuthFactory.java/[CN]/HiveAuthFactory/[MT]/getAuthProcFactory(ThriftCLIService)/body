{
  if (transportMode.equalsIgnoreCase("http")) {
    return HttpAuthUtils.getAuthProcFactory(service);
  }
 else {
    if (authTypeStr.equalsIgnoreCase(AuthTypes.KERBEROS.getAuthName())) {
      return KerberosSaslHelper.getKerberosProcessorFactory(saslServer,service);
    }
 else {
      return PlainSaslHelper.getPlainProcessorFactory(service);
    }
  }
}
