{
  String principal=hiveConf.getVar(ConfVars.HIVE_SERVER2_KERBEROS_PRINCIPAL);
  String keyTabFile=hiveConf.getVar(ConfVars.HIVE_SERVER2_KERBEROS_KEYTAB);
  if (principal.isEmpty() && keyTabFile.isEmpty()) {
    return;
  }
 else   if (!principal.isEmpty() && !keyTabFile.isEmpty()) {
    ShimLoader.getHadoopShims().loginUserFromKeytab(principal,keyTabFile);
  }
 else {
    throw new IOException("HiveServer2 kerberos principal or keytab is not correctly configured");
  }
}
