{
  TTransportFactory transportFactory;
  if (authTypeStr.equalsIgnoreCase(AuthTypes.KERBEROS.getAuthName())) {
    try {
      int authMaxRetries=conf.getIntVar(ConfVars.HIVE_SERVER2_THRIFT_AUTH_MAX_RETRIES);
      transportFactory=saslServer.createTransportFactory(getSaslProperties(),authMaxRetries);
    }
 catch (    TTransportException e) {
      throw new LoginException(e.getMessage());
    }
  }
 else   if (authTypeStr.equalsIgnoreCase(AuthTypes.NONE.getAuthName())) {
    transportFactory=PlainSaslHelper.getPlainTransportFactory(authTypeStr);
  }
 else   if (authTypeStr.equalsIgnoreCase(AuthTypes.LDAP.getAuthName())) {
    transportFactory=PlainSaslHelper.getPlainTransportFactory(authTypeStr);
  }
 else   if (authTypeStr.equalsIgnoreCase(AuthTypes.PAM.getAuthName())) {
    transportFactory=PlainSaslHelper.getPlainTransportFactory(authTypeStr);
  }
 else   if (authTypeStr.equalsIgnoreCase(AuthTypes.NOSASL.getAuthName())) {
    transportFactory=new TTransportFactory();
  }
 else   if (authTypeStr.equalsIgnoreCase(AuthTypes.CUSTOM.getAuthName())) {
    transportFactory=PlainSaslHelper.getPlainTransportFactory(authTypeStr);
  }
 else {
    throw new LoginException("Unsupported authentication type " + authTypeStr);
  }
  return transportFactory;
}
