{
  LongColumnVector lcv=new LongColumnVector(size);
  lcv.noNulls=!nulls;
  lcv.isRepeating=repeating;
  long repeatingValue;
  do {
    repeatingValue=rand.nextLong();
  }
 while (repeatingValue == 0);
  int nullFrequency=generateNullFrequency(rand);
  for (int i=0; i < size; i++) {
    if (nulls && (repeating || i % nullFrequency == 0)) {
      lcv.isNull[i]=true;
      lcv.vector[i]=LONG_VECTOR_NULL_VALUE;
    }
 else {
      lcv.isNull[i]=false;
      lcv.vector[i]=repeating ? repeatingValue : rand.nextLong();
      if (lcv.vector[i] == 0) {
        i--;
      }
    }
  }
  return lcv;
}
