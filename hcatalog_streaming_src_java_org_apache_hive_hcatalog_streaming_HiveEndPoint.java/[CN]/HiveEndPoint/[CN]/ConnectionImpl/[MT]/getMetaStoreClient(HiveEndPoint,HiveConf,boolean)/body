{
  if (endPoint.metaStoreUri != null) {
    conf.setVar(HiveConf.ConfVars.METASTOREURIS,endPoint.metaStoreUri);
  }
  if (secureMode) {
    conf.setBoolVar(HiveConf.ConfVars.METASTORE_USE_THRIFT_SASL,true);
  }
  try {
    return HCatUtil.getHiveMetastoreClient(conf);
  }
 catch (  MetaException e) {
    throw new ConnectionError("Error connecting to Hive Metastore URI: " + endPoint.metaStoreUri + ". "+ e.getMessage(),e);
  }
catch (  IOException e) {
    throw new ConnectionError("Error connecting to Hive Metastore URI: " + endPoint.metaStoreUri + ". "+ e.getMessage(),e);
  }
}
