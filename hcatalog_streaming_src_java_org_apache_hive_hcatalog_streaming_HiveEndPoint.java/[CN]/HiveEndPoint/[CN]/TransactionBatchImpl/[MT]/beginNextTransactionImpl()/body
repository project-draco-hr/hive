{
  if (currentTxnIndex >= txnIds.size())   throw new InvalidTrasactionState("No more transactions available in" + " current batch for end point : " + endPt);
  ++currentTxnIndex;
  lockRequest=createLockRequest(endPt,partNameForLock,username,getCurrentTxnId());
  try {
    LockResponse res=msClient.lock(lockRequest);
    if (res.getState() != LockState.ACQUIRED) {
      throw new TransactionError("Unable to acquire lock on " + endPt);
    }
  }
 catch (  TException e) {
    throw new TransactionError("Unable to acquire lock on " + endPt,e);
  }
  state=TxnState.OPEN;
}
