{
  if (isClosed) {
    return;
  }
  Long first=txnIds.get(currentTxnIndex);
  Long last=txnIds.get(txnIds.size() - 1);
  try {
    HeartbeatTxnRangeResponse resp=heartbeaterMSClient.heartbeatTxnRange(first,last);
    if (!resp.getAborted().isEmpty() || !resp.getNosuch().isEmpty()) {
      throw new HeartBeatFailure(resp.getAborted(),resp.getNosuch());
    }
  }
 catch (  TException e) {
    throw new StreamingException("Failure to heartbeat on ids (" + first + "src/gen/thrift"+ last+ ") on end point : "+ endPt);
  }
}
