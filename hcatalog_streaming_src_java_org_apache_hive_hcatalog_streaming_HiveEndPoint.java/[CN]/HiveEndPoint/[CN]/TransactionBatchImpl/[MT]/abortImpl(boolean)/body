{
  try {
    if (abortAllRemaining) {
      int minOpenTxnIndex=Math.max(currentTxnIndex + (state == TxnState.ABORTED || state == TxnState.COMMITTED ? 1 : 0),0);
      for (currentTxnIndex=minOpenTxnIndex; currentTxnIndex < txnIds.size(); currentTxnIndex++) {
        msClient.rollbackTxn(txnIds.get(currentTxnIndex));
      }
    }
 else {
      if (getCurrentTxnId() > 0) {
        msClient.rollbackTxn(getCurrentTxnId());
      }
    }
    state=TxnState.ABORTED;
    recordWriter.clear();
  }
 catch (  NoSuchTxnException e) {
    throw new TransactionError("Unable to abort invalid transaction id : " + getCurrentTxnId(),e);
  }
catch (  TException e) {
    throw new TransactionError("Unable to abort transaction id : " + getCurrentTxnId(),e);
  }
}
