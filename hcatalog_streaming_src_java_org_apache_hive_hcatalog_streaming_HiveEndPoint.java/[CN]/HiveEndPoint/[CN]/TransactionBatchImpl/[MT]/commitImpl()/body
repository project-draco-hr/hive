{
  try {
    recordWriter.flush();
    msClient.commitTxn(txnIds.get(currentTxnIndex));
    state=TxnState.COMMITTED;
  }
 catch (  NoSuchTxnException e) {
    throw new TransactionError("Invalid transaction id : " + getCurrentTxnId(),e);
  }
catch (  TxnAbortedException e) {
    throw new TransactionError("Aborted transaction cannot be committed",e);
  }
catch (  TException e) {
    throw new TransactionError("Unable to commit transaction" + getCurrentTxnId(),e);
  }
}
