{
  conf.set("hive.exec.orc.default.compress","SNAPPY");
  Path inputPath=new Path(workDir,"TestOrcFile." + testCaseName.getMethodName() + ".txt");
  Path outputPath=new Path(workDir,"TestOrcFile." + testCaseName.getMethodName() + ".orc");
  localFs.delete(outputPath,true);
  PrintWriter pw=new PrintWriter(new OutputStreamWriter(localFs.create(inputPath)));
  pw.println("1,hello");
  pw.println("2,world");
  pw.close();
  Job job=new Job(conf,"orc test");
  job.setOutputFormatClass(OrcNewOutputFormat.class);
  job.setJarByClass(TestNewInputOutputFormat.class);
  job.setMapperClass(OrcTestMapper2.class);
  job.setNumReduceTasks(0);
  job.setOutputKeyClass(NullWritable.class);
  job.setOutputValueClass(OrcSerdeRow.class);
  FileInputFormat.addInputPath(job,inputPath);
  FileOutputFormat.setOutputPath(job,outputPath);
  boolean result=job.waitForCompletion(true);
  assertTrue(result);
  Path outputFilePath=new Path(outputPath,"part-m-00000");
  Reader reader=OrcFile.createReader(outputFilePath,OrcFile.readerOptions(conf).filesystem(localFs));
  assertEquals(reader.getCompression(),CompressionKind.SNAPPY);
  localFs.delete(outputPath,true);
}
