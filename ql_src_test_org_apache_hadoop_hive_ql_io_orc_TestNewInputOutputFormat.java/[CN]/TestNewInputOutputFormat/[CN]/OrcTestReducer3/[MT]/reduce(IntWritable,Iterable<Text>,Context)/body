{
  List<String> lastwords=new ArrayList<String>();
  Map<String,Integer> wordCounts=new HashMap<String,Integer>();
  int count=0;
  for (  Text val : values) {
    String[] items=val.toString().toLowerCase().split("\\s+");
    lastwords.add(items[items.length - 1]);
    for (    String item : items) {
      if (wordCounts.containsKey(item)) {
        wordCounts.put(item,wordCounts.get(item) + 1);
      }
 else {
        wordCounts.put(item,1);
      }
    }
    count++;
  }
  List<Object> struct=new ArrayList<Object>(4);
  struct.add(0,key.get());
  struct.add(1,count);
  List<List<Object>> lastWordInfoList=new ArrayList<List<Object>>();
  for (  String word : lastwords) {
    List<Object> info=new ArrayList<Object>(2);
    info.add(0,word);
    info.add(1,word.length());
    lastWordInfoList.add(info);
  }
  struct.add(2,lastWordInfoList);
  struct.add(3,wordCounts);
  row=serde.serialize(struct,oip);
  context.write(NullWritable.get(),row);
}
