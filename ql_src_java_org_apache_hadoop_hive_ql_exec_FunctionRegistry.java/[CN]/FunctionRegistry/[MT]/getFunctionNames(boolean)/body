{
  Set<String> functionNames=mFunctions.keySet();
  if (searchMetastore) {
    functionNames=new HashSet<String>(functionNames);
    try {
      Hive db=getHive();
      List<String> dbNames=db.getAllDatabases();
      for (      String dbName : dbNames) {
        List<String> funcNames=db.getFunctions(dbName,"*");
        for (        String funcName : funcNames) {
          functionNames.add(FunctionUtils.qualifyFunctionName(funcName,dbName));
        }
      }
    }
 catch (    Exception e) {
      LOG.error(e);
    }
  }
  return functionNames;
}
