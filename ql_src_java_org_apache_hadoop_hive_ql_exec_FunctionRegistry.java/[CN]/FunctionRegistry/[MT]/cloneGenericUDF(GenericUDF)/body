{
  if (null == genericUDF) {
    return null;
  }
  GenericUDF clonedUDF=null;
  if (genericUDF instanceof GenericUDFBridge) {
    GenericUDFBridge bridge=(GenericUDFBridge)genericUDF;
    clonedUDF=new GenericUDFBridge(bridge.getUdfName(),bridge.isOperator(),bridge.getUdfClassName());
  }
 else   if (genericUDF instanceof GenericUDFMacro) {
    GenericUDFMacro bridge=(GenericUDFMacro)genericUDF;
    clonedUDF=new GenericUDFMacro(bridge.getMacroName(),bridge.getBody(),bridge.getColNames(),bridge.getColTypes());
  }
 else {
    clonedUDF=(GenericUDF)ReflectionUtils.newInstance(genericUDF.getClass(),null);
  }
  if (clonedUDF != null) {
    if (genericUDF instanceof SettableUDF) {
      try {
        TypeInfo typeInfo=((SettableUDF)genericUDF).getTypeInfo();
        if (typeInfo != null) {
          ((SettableUDF)clonedUDF).setTypeInfo(typeInfo);
        }
      }
 catch (      UDFArgumentException err) {
        LOG.error("Unable to add settable data to UDF " + genericUDF.getClass());
        throw new IllegalArgumentException(err);
      }
    }
  }
  return clonedUDF;
}
