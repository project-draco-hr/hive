{
  FunctionInfo ret=null;
  try {
    String dbName;
    String fName;
    if (FunctionUtils.isQualifiedFunctionName(functionName)) {
      String[] parts=FunctionUtils.splitQualifiedFunctionName(functionName);
      dbName=parts[0];
      fName=parts[1];
    }
 else {
      dbName=SessionState.get().getCurrentDatabase().toLowerCase();
      fName=functionName;
    }
    HiveConf conf=SessionState.get().getConf();
    Function func=Hive.get(conf).getFunction(dbName,fName);
    if (func != null) {
      try {
        FunctionTask.addFunctionResources(func.getResourceUris());
      }
 catch (      Exception e) {
        LOG.error("Unable to load resources for " + dbName + "."+ fName+ ":"+ e.getMessage(),e);
        return null;
      }
      Class<?> udfClass=Class.forName(func.getClassName(),true,Utilities.getSessionSpecifiedClassLoader());
      if (registerTemporaryFunction(functionName,udfClass)) {
        ret=mFunctions.get(functionName);
      }
 else {
        LOG.error(func.getClassName() + " is not a valid UDF class and was not registered.");
      }
    }
  }
 catch (  HiveException e) {
    if (!((e.getCause() != null) && (e.getCause() instanceof MetaException)) && (e.getCause().getCause() != null) && (e.getCause().getCause() instanceof NoSuchObjectException)) {
      LOG.info("Unable to lookup UDF in metastore: " + e);
    }
  }
catch (  ClassNotFoundException e) {
    LOG.error("Unable to load UDF class: " + e);
  }
  return ret;
}
