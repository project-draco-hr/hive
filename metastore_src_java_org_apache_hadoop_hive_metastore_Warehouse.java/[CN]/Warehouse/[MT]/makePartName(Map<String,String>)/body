{
  StringBuffer suffixBuf=new StringBuffer();
  for (  Entry<String,String> e : spec.entrySet()) {
    if (e.getValue() == null || e.getValue().length() == 0) {
      throw new MetaException("Partition spec is incorrect. " + spec);
    }
    suffixBuf.append(escapePathName(e.getKey()));
    suffixBuf.append('=');
    suffixBuf.append(escapePathName(e.getValue()));
    suffixBuf.append(Path.SEPARATOR);
  }
  return suffixBuf.toString();
}
