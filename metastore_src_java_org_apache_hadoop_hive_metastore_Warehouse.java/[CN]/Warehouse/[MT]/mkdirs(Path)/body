{
  FileSystem fs=null;
  try {
    fs=getFs(f);
    LOG.debug("Creating directory if it doesn't exist: " + f);
    if (this.inheritPerms) {
      try {
        return fs.getFileStatus(f).isDir();
      }
 catch (      FileNotFoundException ignore) {
      }
    }
    boolean success=fs.mkdirs(f);
    if (this.inheritPerms && success) {
      fs.setPermission(f,fs.getFileStatus(f.getParent()).getPermission());
    }
    return success;
  }
 catch (  IOException e) {
    closeFs(fs);
    MetaStoreUtils.logAndThrowMetaException(e);
  }
  return false;
}
