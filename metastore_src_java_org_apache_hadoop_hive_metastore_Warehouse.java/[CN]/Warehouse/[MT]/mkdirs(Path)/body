{
  FileSystem fs=null;
  try {
    fs=getFs(f);
    LOG.debug("Creating directory if it doesn't exist: " + f);
    short umaskVal=(short)conf.getInt(HiveConf.ConfVars.HIVE_FILES_UMASK_VALUE.name(),0002);
    FsPermission fsPermission=new FsPermission(umaskVal);
    FsPermission.setUMask(conf,fsPermission);
    return (fs.mkdirs(f) || fs.getFileStatus(f).isDir());
  }
 catch (  IOException e) {
    closeFs(fs);
    MetaStoreUtils.logAndThrowMetaException(e);
  }
  return false;
}
