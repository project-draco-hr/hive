{
  this.conf=conf;
  String whRootString=HiveConf.getVar(conf,HiveConf.ConfVars.METASTOREWAREHOUSE);
  if (StringUtils.isBlank(whRootString)) {
    throw new MetaException(HiveConf.ConfVars.METASTOREWAREHOUSE.varname + " is not set in the config or blank");
  }
  whRoot=new Path(whRootString);
  URI uri=whRoot.toUri();
  try {
    if ((uri.getScheme() == null) && (uri.getAuthority() == null)) {
      FileSystem fs=FileSystem.get(conf);
      whRoot=new Path(fs.getUri().toString(),whRootString);
    }
  }
 catch (  IOException e) {
    MetaStoreUtils.logAndThrowMetaException(e);
  }
}
