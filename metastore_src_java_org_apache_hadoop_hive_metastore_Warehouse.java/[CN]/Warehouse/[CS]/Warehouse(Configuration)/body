{
  String whRootString=HiveConf.getVar(conf,HiveConf.ConfVars.METASTOREWAREHOUSE);
  if (StringUtils.isBlank(whRootString)) {
    throw new MetaException(HiveConf.ConfVars.METASTOREWAREHOUSE.varname + " is not set in the config or blank");
  }
  whRoot=new Path(whRootString);
  URI uri=whRoot.toUri();
  if ((uri.getScheme() == null) && (uri.getAuthority() == null)) {
    whRoot=new Path(HiveConf.getVar(conf,HiveConf.ConfVars.HADOOPFS),whRootString);
  }
  try {
    fs=whRoot.getFileSystem(conf);
  }
 catch (  IOException e) {
    MetaStoreUtils.logAndThrowMetaException(e);
  }
}
