{
  Table table=phutil.getTable(location,howlServerUri != null ? howlServerUri : PigHCatUtil.getHowlServerUri(job),PigHCatUtil.getHowlServerPrincipal(job));
  HCatSchema howlTableSchema=HCatUtil.getTableSchemaWithPtnCols(table);
  try {
    PigHCatUtil.validateHowlTableSchemaFollowsPigRules(howlTableSchema);
  }
 catch (  IOException e) {
    throw new PigException("Table schema incompatible for reading through HowlLoader :" + e.getMessage() + ";[Table schema was "+ howlTableSchema.toString()+ "]",PigHCatUtil.PIG_EXCEPTION_CODE,e);
  }
  storeInUDFContext(signature,HCatConstants.HCAT_TABLE_SCHEMA,howlTableSchema);
  outputSchema=howlTableSchema;
  return PigHCatUtil.getResourceSchema(howlTableSchema);
}
