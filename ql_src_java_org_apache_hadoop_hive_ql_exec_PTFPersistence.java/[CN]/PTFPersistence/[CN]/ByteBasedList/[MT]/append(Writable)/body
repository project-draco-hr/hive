{
  PTFPersistence.lock(lock.writeLock());
  try {
    write(obj);
  }
 catch (  IOException ie) {
    throw new HiveException(ie);
  }
 finally {
    lock.writeLock().unlock();
  }
}
