{
  try {
    if (partitions.size() > 0) {
      int idx=partitions.size() - 1;
      ByteBasedList bl=partitions.get(idx);
      File f;
      if (reusableFiles.size() > 0) {
        f=reusableFiles.remove(0);
      }
 else {
        f=File.createTempFile("wdw",null,dir);
      }
      PersistentByteBasedList.store(bl,f);
      partitions.set(idx,new PersistentByteBasedList(f,bl));
    }
    ByteBasedList bl=new ByteBasedList(currentSize,batchSize);
    partitions.add(bl);
    partitionOffsets.add(currentSize);
  }
 catch (  IOException ie) {
    throw new HiveException(ie);
  }
}
