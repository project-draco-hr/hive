{
  PTFPersistence.lock(lock.writeLock());
  try {
    currentSize=0;
    for (int i=0; i < partitions.size() - 1; i++) {
      PersistentByteBasedList p=(PersistentByteBasedList)partitions.remove(0);
      reusableFiles.add(p.getFile());
      partitionOffsets.remove(0);
    }
    partitions.get(0).reset(0);
    partitionOffsets.set(0,currentSize);
  }
  finally {
    lock.writeLock().unlock();
  }
}
