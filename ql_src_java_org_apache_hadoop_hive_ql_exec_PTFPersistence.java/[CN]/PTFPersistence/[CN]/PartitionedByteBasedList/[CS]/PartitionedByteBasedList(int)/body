{
  this.batchSize=batchSize;
  currentSize=0;
  dir=PartitionedByteBasedList.createTempDir();
  Runtime.getRuntime().addShutdownHook(new ShutdownHook(dir));
  partitions=new ArrayList<ByteBasedList>();
  partitionOffsets=new ArrayList<Integer>();
  reusableFiles=new ArrayList<File>();
  addPartition();
}
