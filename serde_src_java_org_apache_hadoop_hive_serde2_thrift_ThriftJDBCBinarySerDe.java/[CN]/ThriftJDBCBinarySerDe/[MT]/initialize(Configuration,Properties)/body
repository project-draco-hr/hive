{
  MAX_BUFFERED_ROWS=HiveConf.getIntVar(conf,HiveConf.ConfVars.HIVE_SERVER2_THRIFT_RESULTSET_MAX_FETCH_SIZE);
  String columnNameProperty=tbl.getProperty(serdeConstants.LIST_COLUMNS);
  String columnTypeProperty=tbl.getProperty(serdeConstants.LIST_COLUMN_TYPES);
  if (columnNameProperty.length() == 0) {
    columnNames=new ArrayList<String>();
  }
 else {
    columnNames=Arrays.asList(columnNameProperty.split(","));
  }
  if (columnTypeProperty.length() == 0) {
    columnTypes=new ArrayList<TypeInfo>();
  }
 else {
    columnTypes=TypeInfoUtils.getTypeInfosFromTypeString(columnTypeProperty);
  }
  rowTypeInfo=TypeInfoFactory.getStructTypeInfo(columnNames,columnTypes);
  rowObjectInspector=(StructObjectInspector)TypeInfoUtils.getStandardWritableObjectInspectorFromTypeInfo(rowTypeInfo);
  initializeRowAndColumns();
  try {
    thriftFormatter.initialize(conf,tbl);
  }
 catch (  Exception e) {
    new SerDeException(e);
  }
}
