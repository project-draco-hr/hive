{
  if (assigners != null) {
    assert(outputBatch.numCols == assigners.length);
  }
  outputBatch.reset();
  int maxSize=outputBatch.getMaxSize();
  try {
    while (outputBatch.size < maxSize) {
      if (false == internalReader.next(internalKey,internalValues)) {
        outputBatch.endOfFile=true;
        break;
      }
      Writable[] writables=internalValues.get();
      if (null == assigners) {
        assigners=VectorColumnAssignFactory.buildAssigners(outputBatch,writables);
      }
      for (int i=0; i < writables.length; ++i) {
        assigners[i].assignObjectValue(writables[i],outputBatch.size);
      }
      ++outputBatch.size;
    }
  }
 catch (  HiveException e) {
    throw new RuntimeException(e);
  }
  return outputBatch.size > 0;
}
