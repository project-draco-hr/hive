{
  String username=null;
  String password=null;
  AuthorizeCallback ac=null;
  for (  Callback callback : callbacks) {
    if (callback instanceof NameCallback) {
      NameCallback nc=(NameCallback)callback;
      username=nc.getName();
    }
 else     if (callback instanceof PasswordCallback) {
      PasswordCallback pc=(PasswordCallback)callback;
      password=new String(pc.getPassword());
    }
 else     if (callback instanceof AuthorizeCallback) {
      ac=(AuthorizeCallback)callback;
    }
 else {
      throw new UnsupportedCallbackException(callback);
    }
  }
  PasswdAuthenticationProvider provider=AuthenticationProviderFactory.getAuthenticationProvider(authMethod);
  provider.Authenticate(username,password);
  if (ac != null) {
    ac.setAuthorized(true);
  }
}
