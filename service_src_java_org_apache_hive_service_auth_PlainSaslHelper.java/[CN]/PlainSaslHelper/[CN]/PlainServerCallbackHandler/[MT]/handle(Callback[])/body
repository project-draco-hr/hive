{
  String userName=null;
  String passWord=null;
  AuthorizeCallback ac=null;
  for (int i=0; i < callbacks.length; i++) {
    if (callbacks[i] instanceof NameCallback) {
      NameCallback nc=(NameCallback)callbacks[i];
      userName=nc.getName();
    }
 else     if (callbacks[i] instanceof PasswordCallback) {
      PasswordCallback pc=(PasswordCallback)callbacks[i];
      passWord=new String(pc.getPassword());
    }
 else     if (callbacks[i] instanceof AuthorizeCallback) {
      ac=(AuthorizeCallback)callbacks[i];
    }
 else {
      throw new UnsupportedCallbackException(callbacks[i]);
    }
  }
  PasswdAuthenticationProvider provider=AuthenticationProviderFactory.getAuthenticationProvider(authMethod);
  provider.Authenticate(userName,passWord);
  if (ac != null) {
    ac.setAuthorized(true);
  }
}
