{
  final RelNode left=rel.getLeft();
  final RelNode right=rel.getRight();
  final List<Double> lefts=RelMetadataQuery.getAverageColumnSizes(left);
  List<Double> rights=null;
  if (!rel.isLeftSemiJoin()) {
    rights=RelMetadataQuery.getAverageColumnSizes(right);
  }
  if (lefts == null && rights == null) {
    return null;
  }
  final int fieldCount=rel.getRowType().getFieldCount();
  Double[] sizes=new Double[fieldCount];
  if (lefts != null) {
    lefts.toArray(sizes);
  }
  if (rights != null) {
    final int leftCount=left.getRowType().getFieldCount();
    for (int i=0; i < rights.size(); i++) {
      sizes[leftCount + i]=rights.get(i);
    }
  }
  return ImmutableNullableList.copyOf(sizes);
}
