{
  final int numCols=scan.getRowType().getFieldList().size();
  List<Integer> cols=ImmutableIntList.range(0,numCols);
  final RelOptHiveTable table=(RelOptHiveTable)scan.getTable();
  List<ColStatistics> columnStatistics=table.getColStat(cols);
  final ImmutableList.Builder<Double> list=ImmutableList.builder();
  for (int i=0; i < columnStatistics.size(); i++) {
    ColStatistics columnStatistic=columnStatistics.get(i);
    if (columnStatistic == null) {
      RelDataTypeField field=scan.getRowType().getFieldList().get(i);
      list.add(averageTypeValueSize(field.getType()));
    }
 else {
      list.add(columnStatistic.getAvgColLen());
    }
  }
  return list.build();
}
