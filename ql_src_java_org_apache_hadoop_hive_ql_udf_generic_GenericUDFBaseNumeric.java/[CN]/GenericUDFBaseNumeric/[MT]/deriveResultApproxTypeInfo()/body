{
  PrimitiveTypeInfo left=(PrimitiveTypeInfo)TypeInfoUtils.getTypeInfoFromObjectInspector(leftOI);
  PrimitiveTypeInfo right=(PrimitiveTypeInfo)TypeInfoUtils.getTypeInfoFromObjectInspector(rightOI);
  if (PrimitiveObjectInspectorUtils.getPrimitiveGrouping(left.getPrimitiveCategory()) == PrimitiveGrouping.STRING_GROUP) {
    left=TypeInfoFactory.doubleTypeInfo;
  }
  if (PrimitiveObjectInspectorUtils.getPrimitiveGrouping(right.getPrimitiveCategory()) == PrimitiveGrouping.STRING_GROUP) {
    right=TypeInfoFactory.doubleTypeInfo;
  }
  PrimitiveCategory commonCat=FunctionRegistry.getCommonCategory(left,right);
  if (commonCat == PrimitiveCategory.DECIMAL) {
    return TypeInfoFactory.doubleTypeInfo;
  }
 else   if (commonCat == null) {
    return TypeInfoFactory.doubleTypeInfo;
  }
 else {
    return left.getPrimitiveCategory() == commonCat ? left : right;
  }
}
