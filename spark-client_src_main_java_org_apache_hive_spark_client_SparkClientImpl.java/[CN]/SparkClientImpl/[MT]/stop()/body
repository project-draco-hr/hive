{
  if (remoteRef != null) {
    LOG.info("Sending EndSession to remote actor.");
    remoteRef.tell(new Protocol.EndSession(),clientRef);
  }
  unbind(clientRef);
  long endTime=System.currentTimeMillis() + DEFAULT_SHUTDOWN_TIMEOUT;
  try {
    driverThread.join(DEFAULT_SHUTDOWN_TIMEOUT);
  }
 catch (  InterruptedException ie) {
    LOG.debug("Interrupted before driver thread was finished.");
  }
  if (endTime - System.currentTimeMillis() <= 0) {
    LOG.debug("Shut down time out.");
    driverThread.interrupt();
  }
}
