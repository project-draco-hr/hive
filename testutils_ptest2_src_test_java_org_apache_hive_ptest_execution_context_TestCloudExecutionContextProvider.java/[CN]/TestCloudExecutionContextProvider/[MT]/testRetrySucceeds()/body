{
  when(cloudComputeService.createNodes(anyInt())).then(new Answer<Set<NodeMetadata>>(){
    int count=0;
    @Override public Set<NodeMetadata> answer(    InvocationOnMock invocation) throws Throwable {
      if (count++ == 0) {
        throw runNodesException;
      }
      return Collections.singleton(node3);
    }
  }
);
  CloudExecutionContextProvider provider=new CloudExecutionContextProvider(dataDir,NUM_NODES,cloudComputeService,sshCommandExecutor,workingDir,PRIVATE_KEY,USER,SLAVE_DIRS,1,1,0);
  ExecutionContext executionContext=provider.createExecutionContext();
  Set<String> hosts=Sets.newHashSet();
  for (  Host host : executionContext.getHosts()) {
    hosts.add(host.getName());
  }
  Assert.assertEquals(Sets.newHashSet("node1","node3"),hosts);
}
