{
  Object ret=null;
  boolean gotNewConnectUrl=false;
  boolean reloadConf=HiveConf.getBoolVar(hiveConf,HiveConf.ConfVars.METASTOREFORCERELOADCONF);
  if (reloadConf) {
    updateConnectionURL(getConf(),null);
  }
  int retryCount=0;
  Exception caughtException=null;
  while (true) {
    try {
      if (reloadConf || gotNewConnectUrl) {
        initMS();
      }
      ret=method.invoke(base,args);
      break;
    }
 catch (    javax.jdo.JDOException e) {
      caughtException=e;
    }
catch (    UndeclaredThrowableException e) {
      throw e.getCause();
    }
catch (    InvocationTargetException e) {
      if (e.getCause() instanceof javax.jdo.JDOException) {
        caughtException=e;
      }
 else {
        throw e.getCause();
      }
    }
    if (retryCount >= retryLimit) {
      throw caughtException;
    }
    assert(retryInterval >= 0);
    retryCount++;
    LOG.error(String.format("JDO datastore error. Retrying metastore command " + "after %d ms (attempt %d of %d)",retryInterval,retryCount,retryLimit));
    Thread.sleep(retryInterval);
    String lastUrl=getConnectionURL(getConf());
    gotNewConnectUrl=updateConnectionURL(getConf(),lastUrl);
  }
  return ret;
}
