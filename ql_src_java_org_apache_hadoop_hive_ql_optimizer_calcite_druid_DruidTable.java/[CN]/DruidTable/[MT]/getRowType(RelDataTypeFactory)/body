{
  final RelDataType thisRowType;
  if (rowType != null) {
    thisRowType=rowType;
  }
 else {
    thisRowType=protoRowType.apply(typeFactory);
  }
  final List<String> fieldNames=thisRowType.getFieldNames();
  Preconditions.checkArgument(fieldNames.contains(timestampFieldName));
  Preconditions.checkArgument(fieldNames.containsAll(metricFieldNames));
  return thisRowType;
}
