{
  assertTrue(GENERIC_DATA.validate(s,record));
  AvroGenericRecordWritable garw=Utils.serializeAndDeserializeRecord(record);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  AvroDeserializer de=new AvroDeserializer();
  ArrayList<Object> row=(ArrayList<Object>)de.deserialize(aoig.getColumnNames(),aoig.getColumnTypes(),garw,s);
  assertEquals(1,row.size());
  Object rowElement=row.get(0);
  StandardStructObjectInspector oi=(StandardStructObjectInspector)aoig.getObjectInspector();
  List<Object> fieldsDataAsList=oi.getStructFieldsDataAsList(row);
  assertEquals(1,fieldsDataAsList.size());
  StructField fieldRef=oi.getStructFieldRef(fieldName);
  ObjectInspector fieldObjectInspector=fieldRef.getFieldObjectInspector();
  StringObjectInspector soi=(StringObjectInspector)fieldObjectInspector;
  if (expected == null)   assertNull(soi.getPrimitiveJavaObject(rowElement));
 else   assertEquals(expected,soi.getPrimitiveJavaObject(rowElement));
}
