{
  Schema ws=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.UNION_SCHEMA_3);
  Schema rs=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.UNION_SCHEMA_4);
  GenericData.Record record=new GenericData.Record(ws);
  record.put("aUnion",90);
  ResultPair result=unionTester(ws,rs,record);
  assertTrue(result.value instanceof Integer);
  assertEquals(90,result.value);
  UnionObjectInspector uoi=(UnionObjectInspector)result.oi;
  assertEquals(0,uoi.getTag(result.unionObject));
  record=new GenericData.Record(ws);
  record.put("aUnion",99.9f);
  result=unionTester(ws,rs,record);
  assertTrue(result.value instanceof Float);
  assertEquals(99.9f,result.value);
  uoi=(UnionObjectInspector)result.oi;
  assertEquals(1,uoi.getTag(result.unionObject));
}
