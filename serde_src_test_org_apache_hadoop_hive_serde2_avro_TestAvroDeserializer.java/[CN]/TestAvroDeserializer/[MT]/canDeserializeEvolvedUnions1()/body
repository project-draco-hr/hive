{
  Schema ws=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.UNION_SCHEMA);
  Schema rs=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.UNION_SCHEMA_2);
  GenericData.Record record=new GenericData.Record(ws);
  record.put("aUnion","this is a string");
  ResultPair result=unionTester(ws,rs,record);
  assertTrue(result.value instanceof String);
  assertEquals("this is a string",result.value);
  UnionObjectInspector uoi=(UnionObjectInspector)result.oi;
  assertEquals(2,uoi.getTag(result.unionObject));
  record=new GenericData.Record(ws);
  record.put("aUnion",99);
  result=unionTester(ws,rs,record);
  assertTrue(result.value instanceof Integer);
  assertEquals(99,result.value);
  uoi=(UnionObjectInspector)result.oi;
  assertEquals(1,uoi.getTag(result.unionObject));
}
