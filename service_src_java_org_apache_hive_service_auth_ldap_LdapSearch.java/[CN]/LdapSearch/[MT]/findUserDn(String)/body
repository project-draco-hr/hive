{
  List<String> allLdapNames;
  if (LdapUtils.isDn(user)) {
    String userBaseDn=LdapUtils.extractBaseDn(user);
    String userRdn=LdapUtils.extractFirstRdn(user);
    allLdapNames=execute(Collections.singletonList(userBaseDn),queries.findUserDnByRdn(userRdn)).getAllLdapNames();
  }
 else {
    allLdapNames=findDnByPattern(userPatterns,user);
    if (allLdapNames.isEmpty()) {
      allLdapNames=execute(userBases,queries.findUserDnByName(user)).getAllLdapNames();
    }
  }
  if (allLdapNames.size() == 1) {
    return allLdapNames.get(0);
  }
 else {
    LOG.info("Expected exactly one user result for the user: {}, but got {}. Returning null",user,allLdapNames.size());
    LOG.debug("Matched users: {}",allLdapNames);
    return null;
  }
}
