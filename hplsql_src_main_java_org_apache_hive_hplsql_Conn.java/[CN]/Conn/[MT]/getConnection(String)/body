{
  Stack<Connection> connStack=connections.get(connName);
  String connStr=connStrings.get(connName);
  if (connStr == null) {
    throw new Exception("Unknown connection profile: " + connName);
  }
  if (connStack != null && !connStack.empty()) {
    return connStack.pop();
  }
  Connection c=openConnection(connStr);
  ArrayList<String> sqls=connInits.get(connName);
  if (sqls != null) {
    Statement s=c.createStatement();
    for (    String sql : sqls) {
      s.execute(sql);
    }
    s.close();
  }
  return c;
}
