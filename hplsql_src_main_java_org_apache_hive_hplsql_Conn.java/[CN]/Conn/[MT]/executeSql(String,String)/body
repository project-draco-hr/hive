{
  Query query=new Query(sql);
  try {
    Connection conn=getConnection(connName);
    runPreSql(connName,conn);
    Statement stmt=conn.createStatement();
    ResultSet rs=null;
    exec.info(null,"Starting SQL statement");
    timer.start();
    if (stmt.execute(sql)) {
      rs=stmt.getResultSet();
    }
    timer.stop();
    query.set(conn,stmt,rs);
    if (info) {
      exec.info(null,"SQL statement executed successfully (" + timer.format() + ")");
    }
  }
 catch (  Exception e) {
    query.setError(e);
  }
  return query;
}
