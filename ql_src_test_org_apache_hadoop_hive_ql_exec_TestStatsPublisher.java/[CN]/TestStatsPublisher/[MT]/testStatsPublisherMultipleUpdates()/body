{
  try {
    System.out.println("StatsPublisher - multiple updates");
    StatsPublisher statsPublisher=Utilities.getStatsPublisher((JobConf)conf);
    assertNotNull(statsPublisher);
    assertTrue(statsPublisher.init(conf));
    assertTrue(statsPublisher.connect(conf));
    StatsAggregator statsAggregator=StatsFactory.getStatsAggregator();
    assertNotNull(statsAggregator);
    assertTrue(statsAggregator.connect(conf));
    assertTrue(statsPublisher.publishStat("file_00000_a",StatsSetupConst.ROW_COUNT,"200"));
    assertTrue(statsPublisher.publishStat("file_00000_b",StatsSetupConst.ROW_COUNT,"300"));
    assertTrue(statsPublisher.publishStat("file_00001_a",StatsSetupConst.ROW_COUNT,"400"));
    assertTrue(statsPublisher.publishStat("file_00001_b",StatsSetupConst.ROW_COUNT,"500"));
    assertTrue(statsPublisher.publishStat("file_00000_a",StatsSetupConst.ROW_COUNT,"100"));
    assertTrue(statsPublisher.publishStat("file_00000_b",StatsSetupConst.ROW_COUNT,"150"));
    assertTrue(statsPublisher.publishStat("file_00001_a",StatsSetupConst.ROW_COUNT,"500"));
    assertTrue(statsPublisher.publishStat("file_00001_b",StatsSetupConst.ROW_COUNT,"600"));
    String rows0=statsAggregator.aggregateStats("file_00000",StatsSetupConst.ROW_COUNT);
    assertEquals("500",rows0);
    String rows1=statsAggregator.aggregateStats("file_00001",StatsSetupConst.ROW_COUNT);
    assertEquals("1100",rows1);
    assertTrue(statsPublisher.closeConnection());
    assertTrue(statsAggregator.closeConnection());
    System.out.println("StatsPublisher - multiple updates - OK");
  }
 catch (  Throwable e) {
    e.printStackTrace();
    throw e;
  }
}
