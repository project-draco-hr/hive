{
  setState(OperationState.RUNNING);
  try {
    String command=getStatement().trim();
    String[] tokens=statement.split("\\s");
    String commandArgs=command.substring(tokens[0].length()).trim();
    CommandProcessorResponse response=commandProcessor.run(commandArgs);
    int returnCode=response.getResponseCode();
    if (returnCode != 0) {
      throw toSQLException("Error while processing statement",response);
    }
    Schema schema=response.getSchema();
    if (schema != null) {
      setHasResultSet(true);
      resultSchema=new TableSchema(schema);
    }
 else {
      setHasResultSet(false);
      resultSchema=new TableSchema();
    }
    if (response.getConsoleMessages() != null) {
      OperationLog ol=OperationLog.getCurrentOperationLog();
      if (ol != null) {
        for (        String consoleMsg : response.getConsoleMessages()) {
          ol.writeOperationLog(LoggingLevel.EXECUTION,consoleMsg + "\n");
        }
      }
    }
  }
 catch (  HiveSQLException e) {
    setState(OperationState.ERROR);
    throw e;
  }
catch (  Exception e) {
    setState(OperationState.ERROR);
    throw new HiveSQLException("Error running query: " + e.toString(),e);
  }
  setState(OperationState.FINISHED);
}
