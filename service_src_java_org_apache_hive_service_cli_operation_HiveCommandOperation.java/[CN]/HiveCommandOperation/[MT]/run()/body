{
  setState(OperationState.RUNNING);
  try {
    String command=getStatement().trim();
    String[] tokens=statement.split("\\s");
    String commandArgs=command.substring(tokens[0].length()).trim();
    response=commandProcessor.run(commandArgs);
    int returnCode=response.getResponseCode();
    if (returnCode != 0) {
      throw new HiveSQLException("Error while processing statement: " + response.getErrorMessage(),response.getSQLState(),response.getResponseCode());
    }
    Schema schema=response.getSchema();
    if (schema != null) {
      setHasResultSet(true);
      resultSchema=new TableSchema(schema);
    }
 else {
      setHasResultSet(false);
      resultSchema=new TableSchema();
    }
  }
 catch (  HiveSQLException e) {
    setState(OperationState.ERROR);
    throw e;
  }
catch (  Exception e) {
    setState(OperationState.ERROR);
    throw new HiveSQLException("Error running query: " + e.toString(),e);
  }
  setState(OperationState.FINISHED);
}
