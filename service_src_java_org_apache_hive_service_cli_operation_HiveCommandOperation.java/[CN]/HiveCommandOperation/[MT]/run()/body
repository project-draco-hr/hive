{
  setState(OperationState.RUNNING);
  try {
    String command=getStatement().trim();
    String[] tokens=statement.split("\\s");
    String commandArgs=command.substring(tokens[0].length()).trim();
    response=getCommandProcessor().run(commandArgs);
    int returnCode=response.getResponseCode();
    String sqlState=response.getSQLState();
    String errorMessage=response.getErrorMessage();
    Schema schema=response.getSchema();
    if (schema != null) {
      setHasResultSet(true);
      resultSchema=new TableSchema(schema);
    }
 else {
      setHasResultSet(false);
      resultSchema=new TableSchema();
    }
  }
 catch (  Exception e) {
    setState(OperationState.ERROR);
    throw new HiveSQLException("Error running query: " + e.toString());
  }
  setState(OperationState.FINISHED);
}
