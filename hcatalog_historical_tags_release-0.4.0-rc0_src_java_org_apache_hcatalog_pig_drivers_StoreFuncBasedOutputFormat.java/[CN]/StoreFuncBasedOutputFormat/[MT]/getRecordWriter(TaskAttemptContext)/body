{
  RecordWriter<BytesWritable,Tuple> writer=storeFunc.getOutputFormat().getRecordWriter(ctx);
  String serializedJobInfo=ctx.getConfiguration().get(HCatConstants.HCAT_KEY_OUTPUT_INFO);
  OutputJobInfo outputJobInfo=(OutputJobInfo)HCatUtil.deserialize(serializedJobInfo);
  ResourceSchema rs=PigHCatUtil.getResourceSchema(outputJobInfo.getOutputSchema());
  String location=outputJobInfo.getLocation();
  return new StoreFuncBasedRecordWriter(writer,storeFunc,location,rs);
}
