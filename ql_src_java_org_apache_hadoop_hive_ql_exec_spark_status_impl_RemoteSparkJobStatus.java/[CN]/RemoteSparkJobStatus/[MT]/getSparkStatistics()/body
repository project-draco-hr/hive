{
  MetricsCollection metricsCollection=jobHandle.getMetrics();
  if (metricsCollection == null || getCounter() == null) {
    return null;
  }
  SparkStatisticsBuilder sparkStatisticsBuilder=new SparkStatisticsBuilder();
  sparkStatisticsBuilder.add(getCounter());
  String jobIdentifier="Spark Job[" + jobHandle.getClientJobId() + "] Metrics";
  Map<String,Long> flatJobMetric=extractMetrics(metricsCollection);
  for (  Map.Entry<String,Long> entry : flatJobMetric.entrySet()) {
    sparkStatisticsBuilder.add(jobIdentifier,entry.getKey(),Long.toString(entry.getValue()));
  }
  return sparkStatisticsBuilder.build();
}
