{
  this.delegationTokenStr=delegationTokenStr;
  if (delegationTokenStr != null) {
    getHiveConf().set("hive.metastore.token.signature",HS2TOKEN);
    try {
      ShimLoader.getHadoopShims().setTokenStr(sessionUgi,delegationTokenStr,HS2TOKEN);
    }
 catch (    IOException e) {
      throw new HiveSQLException("Couldn't setup delegation token in the ugi",e);
    }
    Hive.set(null);
    try {
      sessionHive=Hive.get(getHiveConf());
    }
 catch (    HiveException e) {
      throw new HiveSQLException("Failed to setup metastore connection",e);
    }
  }
}
