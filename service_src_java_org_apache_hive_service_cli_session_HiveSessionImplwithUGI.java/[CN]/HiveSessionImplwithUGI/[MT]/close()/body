{
  try {
    acquire(true,false);
    cancelDelegationToken();
  }
  finally {
    release(true,false);
    try {
      super.close();
    }
  finally {
      try {
        FileSystem.closeAllForUGI(sessionUgi);
      }
 catch (      IOException ioe) {
        throw new HiveSQLException("Could not clean up file-system handles for UGI: " + sessionUgi,ioe);
      }
    }
  }
}
