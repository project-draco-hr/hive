{
  ThreadLocalState state=threadLocalState.get();
  if (state.sessionHive == null) {
    try {
      state.sessionHive=createHive(getHiveConf());
    }
 catch (    HiveSQLException e) {
      throw new RuntimeException(e);
    }
  }
  return state.sessionHive;
}
