{
  String aggregationKey=tableScan.getConf().getStatsAggPrefix();
  StringBuilder aggregationKeyBuffer=new StringBuilder(aggregationKey);
  List<Path> inputPaths=GenMapRedUtils.getInputPathsForPartialScan(tableScan,aggregationKeyBuffer);
  aggregationKey=aggregationKeyBuffer.toString();
  PartialScanWork scanWork=new PartialScanWork(inputPaths);
  scanWork.setMapperCannotSpanPartns(true);
  scanWork.setAggKey(aggregationKey);
  scanWork.setStatsTmpDir(tableScan.getConf().getTmpStatsDir(),parseContext.getConf());
  statsWork.setPartialScanAnalyzeCommand(true);
  DriverContext driverCxt=new DriverContext();
  @SuppressWarnings("unchecked") Task<PartialScanWork> partialScanTask=TaskFactory.get(scanWork,parseContext.getConf());
  partialScanTask.initialize(parseContext.getConf(),null,driverCxt,tableScan.getCompilationOpContext());
  partialScanTask.setWork(scanWork);
  statsWork.setSourceTask(partialScanTask);
  context.rootTasks.remove(context.currentTask);
  context.rootTasks.add(partialScanTask);
  partialScanTask.addDependentTask(statsTask);
}
