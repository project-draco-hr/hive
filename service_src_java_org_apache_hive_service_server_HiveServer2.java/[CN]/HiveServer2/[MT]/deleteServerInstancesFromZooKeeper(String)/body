{
  HiveConf hiveConf=new HiveConf();
  int zooKeeperSessionTimeout=hiveConf.getIntVar(HiveConf.ConfVars.HIVE_ZOOKEEPER_SESSION_TIMEOUT);
  String zooKeeperEnsemble=ZooKeeperHiveHelper.getQuorumServers(hiveConf);
  String rootNamespace=hiveConf.getVar(HiveConf.ConfVars.HIVE_SERVER2_ZOOKEEPER_NAMESPACE);
  ZooKeeper zooKeeperClient=new ZooKeeper(zooKeeperEnsemble,zooKeeperSessionTimeout,new ZooKeeperHiveHelper.DummyWatcher());
  List<String> znodePaths=zooKeeperClient.getChildren(ZooKeeperHiveHelper.ZOOKEEPER_PATH_SEPARATOR + rootNamespace,false);
  for (  String znodePath : znodePaths) {
    if (znodePath.contains("version=" + versionNumber + ";")) {
      zooKeeperClient.delete(ZooKeeperHiveHelper.ZOOKEEPER_PATH_SEPARATOR + rootNamespace + ZooKeeperHiveHelper.ZOOKEEPER_PATH_SEPARATOR+ znodePath,-1);
    }
  }
}
