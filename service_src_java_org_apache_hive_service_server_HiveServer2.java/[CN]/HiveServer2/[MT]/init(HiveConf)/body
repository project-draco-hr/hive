{
  cliService=new CLIService(this);
  addService(cliService);
  final HiveServer2 hiveServer2=this;
  Runnable oomHook=new Runnable(){
    @Override public void run(){
      hiveServer2.stop();
    }
  }
;
  if (isHTTPTransportMode(hiveConf)) {
    thriftCLIService=new ThriftHttpCLIService(cliService,oomHook);
  }
 else {
    thriftCLIService=new ThriftBinaryCLIService(cliService,oomHook);
  }
  addService(thriftCLIService);
  super.init(hiveConf);
  try {
    hiveConf.set(HiveConf.ConfVars.HIVE_SERVER2_THRIFT_BIND_HOST.varname,getServerHost());
  }
 catch (  Throwable t) {
    throw new Error("Unable to intitialize HiveServer2",t);
  }
  Runtime.getRuntime().addShutdownHook(new Thread(){
    @Override public void run(){
      hiveServer2.stop();
    }
  }
);
}
