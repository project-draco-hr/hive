{
  if (event.getType().equals(Watcher.Event.EventType.NodeDeleted)) {
    HiveServer2.this.setRegisteredWithZooKeeper(false);
    if (cliService.getSessionManager().getOpenSessionCount() == 0) {
      LOG.warn("This instance of HiveServer2 has been removed from the list of server " + "instances available for dynamic service discovery. " + "The last client session has ended - will shutdown now.");
      HiveServer2.this.stop();
    }
    LOG.warn("This HiveServer2 instance is now de-registered from ZooKeeper. " + "The server will be shut down after the last client sesssion completes.");
  }
}
