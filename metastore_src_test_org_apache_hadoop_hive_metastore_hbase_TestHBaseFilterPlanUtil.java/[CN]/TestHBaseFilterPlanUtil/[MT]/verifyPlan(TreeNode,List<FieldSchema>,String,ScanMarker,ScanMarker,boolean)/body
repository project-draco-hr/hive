{
  ExpressionTree e=null;
  if (l != null) {
    e=new ExpressionTree();
    e.setRootForTest(l);
  }
  PlanResult planRes=HBaseFilterPlanUtil.getFilterPlan(e,parts);
  FilterPlan plan=planRes.plan;
  Assert.assertEquals("Has unsupported condition",hasUnsupportedCondition,planRes.hasUnsupportedCondition);
  Assert.assertEquals(1,plan.getPlans().size());
  ScanPlan splan=plan.getPlans().get(0);
  if (startMarker != null) {
    Assert.assertEquals(startMarker,splan.markers.get(keyName).startMarker);
  }
 else {
    Assert.assertTrue(splan.markers.get(keyName) == null || splan.markers.get(keyName).startMarker == null);
  }
  if (endMarker != null) {
    Assert.assertEquals(endMarker,splan.markers.get(keyName).endMarker);
  }
 else {
    Assert.assertTrue(splan.markers.get(keyName) == null || splan.markers.get(keyName).endMarker == null);
  }
}
