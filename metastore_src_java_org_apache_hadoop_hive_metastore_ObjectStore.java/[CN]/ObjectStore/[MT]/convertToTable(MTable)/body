{
  if (mtbl == null) {
    return null;
  }
  String tableType=mtbl.getTableType();
  if (tableType == null) {
    if (mtbl.getViewOriginalText() != null) {
      tableType=TableType.VIRTUAL_VIEW.toString();
    }
 else     if ("TRUE".equals(mtbl.getParameters().get("EXTERNAL"))) {
      tableType=TableType.EXTERNAL_TABLE.toString();
    }
 else {
      tableType=TableType.MANAGED_TABLE.toString();
    }
  }
  TableIdentifier linkTarget=extractTableIdentifier(mtbl.getLinkTarget());
  List<TableIdentifier> linkTables=new ArrayList<TableIdentifier>();
  Set<MTable> linkMTables=mtbl.getLinkTables();
  if (linkMTables != null) {
    for (    MTable linkMTable : linkMTables) {
      linkTables.add(extractTableIdentifier(linkMTable));
    }
  }
  Table tbl=new Table(mtbl.getTableName(),mtbl.getDatabase().getName(),mtbl.getOwner(),mtbl.getCreateTime(),mtbl.getLastAccessTime(),mtbl.getRetention(),convertToStorageDescriptor(mtbl.getSd()),convertToFieldSchemas(mtbl.getPartitionKeys()),mtbl.getParameters(),mtbl.getViewOriginalText(),mtbl.getViewExpandedText(),tableType);
  tbl.setLinkTarget(linkTarget);
  tbl.setLinkTables(linkTables);
  return tbl;
}
