{
  boolean success=false;
  try {
    openTransaction();
    MTable tbl=getMTable(dbName,tableName);
    pm.retrieve(tbl);
    if (tbl != null) {
      List<MTablePrivilege> tabGrants=listAllTableGrants(dbName,tableName);
      if (tabGrants != null && tabGrants.size() > 0) {
        pm.deletePersistentAll(tabGrants);
      }
      List<MTableColumnPrivilege> tblColGrants=listTableAllColumnGrants(dbName,tableName);
      if (tblColGrants != null && tblColGrants.size() > 0) {
        pm.deletePersistentAll(tblColGrants);
      }
      List<MPartitionPrivilege> partGrants=this.listTableAllPartitionGrants(dbName,tableName);
      if (partGrants != null && partGrants.size() > 0) {
        pm.deletePersistentAll(partGrants);
      }
      List<MPartitionColumnPrivilege> partColGrants=listTableAllPartitionColumnGrants(dbName,tableName);
      if (partColGrants != null && partColGrants.size() > 0) {
        pm.deletePersistentAll(partColGrants);
      }
      preDropStorageDescriptor(tbl.getSd());
      pm.deletePersistentAll(tbl);
    }
    success=commitTransaction();
  }
  finally {
    if (!success) {
      rollbackTransaction();
    }
  }
  return success;
}
