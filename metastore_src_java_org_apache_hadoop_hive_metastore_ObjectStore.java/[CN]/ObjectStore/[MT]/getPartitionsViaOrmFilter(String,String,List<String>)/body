{
  if (partNames.isEmpty()) {
    return new ArrayList<Partition>();
  }
  StringBuilder sb=new StringBuilder("table.tableName == t1 && table.database.name == t2 && (");
  int n=0;
  Map<String,String> params=new HashMap<String,String>();
  for (Iterator<String> itr=partNames.iterator(); itr.hasNext(); ) {
    String pn="p" + n;
    n++;
    String part=itr.next();
    params.put(pn,part);
    sb.append("partitionName == ").append(pn);
    sb.append(" || ");
  }
  sb.setLength(sb.length() - 4);
  sb.append(')');
  Query query=pm.newQuery(MPartition.class,sb.toString());
  LOG.debug(" JDOQL filter is " + sb.toString());
  params.put("t1",tblName.trim());
  params.put("t2",dbName.trim());
  String parameterDeclaration=makeParameterDeclarationString(params);
  query.declareParameters(parameterDeclaration);
  query.setOrdering("partitionName ascending");
  @SuppressWarnings("unchecked") List<MPartition> mparts=(List<MPartition>)query.executeWithMap(params);
  List<Partition> results=convertToParts(dbName,tblName,mparts);
  query.closeAll();
  return results;
}
