{
  boolean success=false;
  try {
    openTransaction();
    MRoleMap roleMember=getMSecurityUserRoleMap(userName,principalType,role.getRoleName());
    if (grantOption) {
      if (roleMember.getGrantOption()) {
        roleMember.setGrantOption(false);
      }
 else {
        throw new MetaException("User " + userName + " does not have grant option with role "+ role.getRoleName());
      }
    }
 else {
      pm.deletePersistent(roleMember);
    }
    success=commitTransaction();
  }
  finally {
    if (!success) {
      rollbackTransaction();
    }
  }
  return success;
}
