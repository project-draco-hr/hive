{
  boolean commited=false;
  List<String> tbls=null;
  try {
    openTransaction();
    dbName=dbName.toLowerCase();
    pattern="(?i)" + pattern;
    Query q=pm.newQuery("select tableName from org.apache.hadoop.hive.metastore.model.MTable where database.name == dbName && tableName.matches(pattern)");
    q.declareParameters("java.lang.String dbName, java.lang.String pattern");
    q.setResult("tableName");
    Collection names=(Collection)q.execute(dbName.trim(),pattern.trim());
    tbls=new ArrayList<String>();
    for (Iterator i=names.iterator(); i.hasNext(); ) {
      tbls.add((String)i.next());
    }
    commited=commitTransaction();
  }
  finally {
    if (!commited) {
      rollbackTransaction();
    }
  }
  return tbls;
}
