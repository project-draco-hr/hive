{
  boolean success=false;
  try {
    openTransaction();
    name=name.toLowerCase();
    dbname=dbname.toLowerCase();
    MTable newt=convertToMTable(newTable);
    if (newt == null) {
      throw new InvalidObjectException("new table is invalid");
    }
    MTable oldt=getMTable(dbname,name);
    if (oldt == null) {
      throw new MetaException("table " + name + " doesn't exist");
    }
    oldt.setTableName(newt.getTableName().toLowerCase());
    oldt.setParameters(newt.getParameters());
    oldt.setOwner(newt.getOwner());
    oldt.setSd(newt.getSd());
    oldt.setDatabase(newt.getDatabase());
    oldt.setRetention(newt.getRetention());
    oldt.setPartitionKeys(newt.getPartitionKeys());
    success=commitTransaction();
  }
  finally {
    if (!success) {
      rollbackTransaction();
    }
  }
}
