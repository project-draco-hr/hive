{
  dbName=dbName.toLowerCase();
  tblName=tblName.toLowerCase();
  GetPartsHelper ctx=new GetPartsHelper(dbName,tblName,allowSql,allowJdo);
  try {
    ctx.start(false);
    if (ctx.canUseDirectSql()) {
      try {
        Integer max=(maxParts < 0) ? null : maxParts;
        ctx.setResult(directSql.getPartitions(dbName,tblName,max));
      }
 catch (      Exception ex) {
        ctx.handleDirectSqlError(ex);
      }
    }
    if (!ctx.canUseDirectSql()) {
      ctx.setResult(convertToParts(listMPartitions(dbName,tblName,maxParts)));
    }
    return ctx.commit();
  }
 catch (  NoSuchObjectException ex) {
    throw new MetaException(ex.getMessage());
  }
 finally {
    ctx.close();
  }
}
