{
  final ExpressionTree tree=(filter != null && !filter.isEmpty()) ? PartFilterExprUtil.getFilterParser(filter).tree : ExpressionTree.EMPTY_TREE;
  return new GetHelper<Integer>(dbName,tblName,allowSql,allowJdo){
    @Override protected String describeResult(){
      return null;
    }
    @Override protected Integer getSqlResult(    GetHelper<Integer> ctx) throws MetaException {
      return directSql.getNumPartitionsViaSqlFilter(ctx.getTable(),tree);
    }
    @Override protected Integer getJdoResult(    GetHelper<Integer> ctx) throws MetaException, NoSuchObjectException {
      return getNumPartitionsViaOrmFilter(ctx.getTable(),tree,true);
    }
  }
.run(true);
}
