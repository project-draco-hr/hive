{
  boolean commited=false;
  Query query=null;
  try {
    openTransaction();
    query=pm.newQuery(MNotificationNextId.class);
    Collection<MNotificationNextId> ids=(Collection)query.execute();
    long id=0;
    if (ids != null && ids.size() > 0) {
      id=ids.iterator().next().getNextEventId() - 1;
    }
    commited=commitTransaction();
    return new CurrentNotificationEventId(id);
  }
  finally {
    if (!commited) {
      rollbackTransaction();
    }
    if (query != null) {
      query.closeAll();
    }
  }
}
