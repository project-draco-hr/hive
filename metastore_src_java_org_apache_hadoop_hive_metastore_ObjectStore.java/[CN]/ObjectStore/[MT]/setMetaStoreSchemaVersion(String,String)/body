{
  MVersionTable mSchemaVer;
  boolean commited=false;
  boolean recordVersion=HiveConf.getBoolVar(getConf(),HiveConf.ConfVars.METASTORE_SCHEMA_VERIFICATION_RECORD_VERSION);
  if (!recordVersion) {
    LOG.warn("setMetaStoreSchemaVersion called but recording version is disabled: " + "version = " + schemaVersion + ", comment = "+ comment);
    return;
  }
  try {
    mSchemaVer=getMSchemaVersion();
  }
 catch (  NoSuchObjectException e) {
    mSchemaVer=new MVersionTable();
  }
  mSchemaVer.setSchemaVersion(schemaVersion);
  mSchemaVer.setVersionComment(comment);
  try {
    openTransaction();
    pm.makePersistent(mSchemaVer);
    commited=commitTransaction();
  }
  finally {
    if (!commited) {
      rollbackTransaction();
    }
  }
}
