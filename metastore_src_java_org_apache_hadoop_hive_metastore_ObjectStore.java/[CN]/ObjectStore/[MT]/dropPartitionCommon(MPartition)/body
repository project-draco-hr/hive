{
  boolean success=false;
  try {
    openTransaction();
    if (part != null) {
      List<MFieldSchema> schemas=part.getTable().getPartitionKeys();
      List<String> colNames=new ArrayList<String>();
      for (      MFieldSchema col : schemas) {
        colNames.add(col.getName());
      }
      String partName=FileUtils.makePartName(colNames,part.getValues());
      List<MPartitionPrivilege> partGrants=listPartitionGrants(part.getTable().getDatabase().getName(),part.getTable().getTableName(),Lists.newArrayList(partName));
      if (partGrants != null && partGrants.size() > 0) {
        pm.deletePersistentAll(partGrants);
      }
      List<MPartitionColumnPrivilege> partColumnGrants=listPartitionAllColumnGrants(part.getTable().getDatabase().getName(),part.getTable().getTableName(),Lists.newArrayList(partName));
      if (partColumnGrants != null && partColumnGrants.size() > 0) {
        pm.deletePersistentAll(partColumnGrants);
      }
      String dbName=part.getTable().getDatabase().getName();
      String tableName=part.getTable().getTableName();
      try {
        deletePartitionColumnStatistics(dbName,tableName,partName,part.getValues(),null);
      }
 catch (      NoSuchObjectException e) {
        LOG.info("No column statistics records found to delete");
      }
      preDropStorageDescriptor(part.getSd());
      pm.deletePersistent(part);
    }
    success=commitTransaction();
  }
  finally {
    if (!success) {
      rollbackTransaction();
    }
  }
  return success;
}
