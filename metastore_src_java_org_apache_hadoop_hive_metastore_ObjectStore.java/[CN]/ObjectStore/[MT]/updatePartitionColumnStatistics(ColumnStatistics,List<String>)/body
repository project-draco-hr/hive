{
  boolean committed=false;
  try {
    openTransaction();
    List<ColumnStatisticsObj> statsObjs=colStats.getStatsObj();
    ColumnStatisticsDesc statsDesc=colStats.getStatsDesc();
    Table table=ensureGetTable(statsDesc.getDbName(),statsDesc.getTableName());
    Partition partition=convertToPart(getMPartition(statsDesc.getDbName(),statsDesc.getTableName(),partVals));
    for (    ColumnStatisticsObj statsObj : statsObjs) {
      MPartition mPartition=getMPartition(statsDesc.getDbName(),statsDesc.getTableName(),partVals);
      if (partition == null) {
        throw new NoSuchObjectException("Partition for which stats is gathered doesn't exist.");
      }
      MPartitionColumnStatistics mStatsObj=StatObjectConverter.convertToMPartitionColumnStatistics(mPartition,statsDesc,statsObj);
      writeMPartitionColumnStatistics(table,partition,mStatsObj);
    }
    committed=commitTransaction();
    return committed;
  }
  finally {
    if (!committed) {
      rollbackTransaction();
    }
  }
}
