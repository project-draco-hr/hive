{
  MDatabase db=null;
  boolean commited=false;
  try {
    openTransaction();
    name=name.toLowerCase();
    Query query=pm.newQuery(MDatabase.class,"name == dbname");
    query.declareParameters("java.lang.String dbname");
    query.setUnique(true);
    db=(MDatabase)query.execute(name.trim());
    pm.retrieve(db);
    commited=commitTransaction();
  }
  finally {
    if (!commited) {
      rollbackTransaction();
    }
  }
  if (db == null) {
    throw new NoSuchObjectException("There is no database named " + name);
  }
  return db;
}
