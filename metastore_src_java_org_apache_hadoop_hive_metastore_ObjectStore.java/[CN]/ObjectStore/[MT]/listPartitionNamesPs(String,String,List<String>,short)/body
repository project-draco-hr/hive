{
  List<String> partitionNames=new ArrayList<String>();
  boolean success=false;
  QueryWrapper queryWrapper=new QueryWrapper();
  try {
    openTransaction();
    LOG.debug("Executing listPartitionNamesPs");
    Collection<?> names=getPartitionPsQueryResults(dbName,tableName,part_vals,max_parts,"partitionName",queryWrapper);
    for (    Object o : names) {
      partitionNames.add((String)o);
    }
    success=commitTransaction();
  }
  finally {
    if (!success) {
      rollbackTransaction();
    }
    queryWrapper.close();
  }
  return partitionNames;
}
