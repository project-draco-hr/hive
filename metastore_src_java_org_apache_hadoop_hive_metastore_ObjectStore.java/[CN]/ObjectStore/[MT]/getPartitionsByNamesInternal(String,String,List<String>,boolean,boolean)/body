{
  dbName=dbName.toLowerCase();
  tblName=tblName.toLowerCase();
  GetPartsHelper ctx=new GetPartsHelper(dbName,tblName,allowSql,allowJdo);
  try {
    ctx.start(false);
    if (ctx.canUseDirectSql()) {
      try {
        ctx.setResult(directSql.getPartitionsViaSqlFilter(dbName,tblName,partNames,null));
      }
 catch (      Exception ex) {
        ctx.handleDirectSqlError(ex);
      }
    }
    if (!ctx.canUseDirectSql()) {
      ctx.setResult(getPartitionsViaOrmFilter(dbName,tblName,partNames));
    }
    return ctx.commit();
  }
  finally {
    ctx.close();
  }
}
