{
  int count=0;
  Query query=pm.newQuery(MSerDeInfo.class);
  List<MSerDeInfo> mSerdes=(List<MSerDeInfo>)query.execute();
  pm.retrieveAll(mSerdes);
  LOG.info("Looking for location in the value field of schema.url key in SERDES table...");
  for (  MSerDeInfo mSerde : mSerdes) {
    String key=new String("schema.url");
    String schemaLoc=mSerde.getParameters().get(key);
    if (schemaLoc != null) {
      URI schemaLocURI=null;
      try {
        schemaLocURI=new URI(schemaLoc);
      }
 catch (      URISyntaxException e) {
        LOG.error("Encountered error while validating location URI" + e.getLocalizedMessage());
      }
      if (schemaLocURI != null) {
        if (shouldUpdateURI(schemaLocURI,oldLoc)) {
          String newSchemaLoc=schemaLoc.replaceAll(oldLoc.toString(),newLoc.toString());
          if (dryRun) {
            updateLocations.put(schemaLocURI.toString(),newSchemaLoc);
          }
 else {
            mSerde.getParameters().put(key,newSchemaLoc);
          }
          count++;
        }
      }
    }
  }
  LOG.info("Found " + count + " records to update");
  return count;
}
