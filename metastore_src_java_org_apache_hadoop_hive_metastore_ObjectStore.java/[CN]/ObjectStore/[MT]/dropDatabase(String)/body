{
  boolean success=false;
  LOG.info("Dropping database " + dbname + " along with all tables");
  dbname=HiveStringUtils.normalizeIdentifier(dbname);
  QueryWrapper queryWrapper=new QueryWrapper();
  try {
    openTransaction();
    MDatabase db=getMDatabase(dbname);
    pm.retrieve(db);
    if (db != null) {
      List<MDBPrivilege> dbGrants=this.listDatabaseGrants(dbname,queryWrapper);
      if (dbGrants != null && dbGrants.size() > 0) {
        pm.deletePersistentAll(dbGrants);
      }
      pm.deletePersistent(db);
    }
    success=commitTransaction();
  }
  finally {
    if (!success) {
      rollbackTransaction();
    }
    queryWrapper.close();
  }
  return success;
}
