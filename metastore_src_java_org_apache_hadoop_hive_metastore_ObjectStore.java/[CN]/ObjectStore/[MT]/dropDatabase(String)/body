{
  boolean success=false;
  LOG.info("Dropping database " + dbname + " along with all tables");
  dbname=dbname.toLowerCase();
  try {
    openTransaction();
    for (    String tableName : getAllTables(dbname)) {
      dropTable(dbname,tableName);
    }
    MDatabase db=getMDatabase(dbname);
    pm.retrieve(db);
    if (db != null) {
      List<MDBPrivilege> dbGrants=this.listDatabaseGrants(dbname);
      if (dbGrants != null && dbGrants.size() > 0) {
        pm.deletePersistentAll(dbGrants);
      }
      pm.deletePersistent(db);
    }
    success=commitTransaction();
  }
  finally {
    if (!success) {
      rollbackTransaction();
    }
  }
  return success;
}
