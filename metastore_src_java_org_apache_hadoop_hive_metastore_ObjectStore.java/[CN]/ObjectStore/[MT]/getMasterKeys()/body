{
  LOG.debug("Begin executing getMasterKeys");
  boolean committed=false;
  Query query=null;
  List<MMasterKey> keys;
  try {
    openTransaction();
    query=pm.newQuery(MMasterKey.class);
    keys=(List<MMasterKey>)query.execute();
    pm.retrieveAll(keys);
    committed=commitTransaction();
    String[] masterKeys=new String[keys.size()];
    for (int i=0; i < keys.size(); i++) {
      masterKeys[i]=keys.get(i).getMasterKey();
    }
    return masterKeys;
  }
  finally {
    LOG.debug("Done executing getMasterKeys with status : " + committed);
    if (!committed) {
      rollbackTransaction();
    }
    if (query != null) {
      query.closeAll();
    }
  }
}
