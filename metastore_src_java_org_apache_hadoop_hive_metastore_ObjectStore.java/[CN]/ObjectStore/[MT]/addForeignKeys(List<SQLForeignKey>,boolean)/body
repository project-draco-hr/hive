{
  List<MConstraint> mpkfks=new ArrayList<MConstraint>();
  String currentConstraintName=null;
  for (int i=0; i < fks.size(); i++) {
    AttachedMTableInfo nParentTable=getMTable(fks.get(i).getPktable_db(),fks.get(i).getPktable_name(),retrieveCD);
    MTable parentTable=nParentTable.mtbl;
    if (parentTable == null) {
      throw new InvalidObjectException("Parent table not found: " + fks.get(i).getPktable_name());
    }
    AttachedMTableInfo nChildTable=getMTable(fks.get(i).getFktable_db(),fks.get(i).getFktable_name(),retrieveCD);
    MTable childTable=nChildTable.mtbl;
    if (childTable == null) {
      throw new InvalidObjectException("Child table not found: " + fks.get(i).getFktable_name());
    }
    MColumnDescriptor parentCD=retrieveCD ? nParentTable.mcd : parentTable.getSd().getCD();
    List<MFieldSchema> parentCols=parentCD.getCols();
    int parentIntegerIndex=getColumnIndexFromTableColumns(parentCols,fks.get(i).getPkcolumn_name());
    if (parentIntegerIndex == -1) {
      throw new InvalidObjectException("Parent column not found: " + fks.get(i).getPkcolumn_name());
    }
    MColumnDescriptor childCD=retrieveCD ? nChildTable.mcd : childTable.getSd().getCD();
    List<MFieldSchema> childCols=childCD.getCols();
    int childIntegerIndex=getColumnIndexFromTableColumns(childCols,fks.get(i).getFkcolumn_name());
    if (childIntegerIndex == -1) {
      throw new InvalidObjectException("Child column not found: " + fks.get(i).getFkcolumn_name());
    }
    if (fks.get(i).getFk_name() == null) {
      if (fks.get(i).getKey_seq() == 1) {
        currentConstraintName=generateConstraintName(fks.get(i).getFktable_db(),fks.get(i).getFktable_name(),fks.get(i).getPktable_db(),fks.get(i).getPktable_name(),fks.get(i).getPkcolumn_name(),fks.get(i).getFkcolumn_name(),"fk");
      }
    }
 else {
      currentConstraintName=fks.get(i).getFk_name();
    }
    Integer updateRule=fks.get(i).getUpdate_rule();
    Integer deleteRule=fks.get(i).getDelete_rule();
    int enableValidateRely=(fks.get(i).isEnable_cstr() ? 4 : 0) + (fks.get(i).isValidate_cstr() ? 2 : 0) + (fks.get(i).isRely_cstr() ? 1 : 0);
    MConstraint mpkfk=new MConstraint(currentConstraintName,MConstraint.FOREIGN_KEY_CONSTRAINT,fks.get(i).getKey_seq(),deleteRule,updateRule,enableValidateRely,parentTable,childTable,parentCD,childCD,childIntegerIndex,parentIntegerIndex);
    mpkfks.add(mpkfk);
  }
  pm.makePersistentAll(mpkfks);
}
