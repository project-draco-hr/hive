{
  List<MPartition> mparts=null;
  MPartition ret=null;
  boolean commited=false;
  Query query=null;
  try {
    openTransaction();
    dbName=HiveStringUtils.normalizeIdentifier(dbName);
    tableName=HiveStringUtils.normalizeIdentifier(tableName);
    MTable mtbl=getMTable(dbName,tableName);
    if (mtbl == null) {
      commited=commitTransaction();
      return null;
    }
    String name=Warehouse.makePartName(convertToFieldSchemas(mtbl.getPartitionKeys()),part_vals);
    query=pm.newQuery(MPartition.class,"table.tableName == t1 && table.database.name == t2 && partitionName == t3");
    query.declareParameters("java.lang.String t1, java.lang.String t2, java.lang.String t3");
    mparts=(List<MPartition>)query.execute(tableName,dbName,name);
    pm.retrieveAll(mparts);
    commited=commitTransaction();
    if (mparts != null && mparts.size() > 0) {
      if (mparts.size() > 1) {
        throw new MetaException("Expecting only one partition but more than one partitions are found.");
      }
 else {
        MPartition mpart=mparts.get(0);
        if (name.equals(mpart.getPartitionName())) {
          ret=mpart;
        }
 else {
          throw new MetaException("Expecting a partition with name " + name + ", but metastore is returning a partition with name "+ mpart.getPartitionName()+ ".");
        }
      }
    }
  }
  finally {
    if (!commited) {
      rollbackTransaction();
    }
    if (query != null) {
      query.closeAll();
    }
  }
  return ret;
}
