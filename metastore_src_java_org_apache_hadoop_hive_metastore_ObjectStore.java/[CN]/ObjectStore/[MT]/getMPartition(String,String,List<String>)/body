{
  MPartition mpart=null;
  boolean commited=false;
  Query query=null;
  try {
    openTransaction();
    dbName=HiveStringUtils.normalizeIdentifier(dbName);
    tableName=HiveStringUtils.normalizeIdentifier(tableName);
    MTable mtbl=getMTable(dbName,tableName);
    if (mtbl == null) {
      commited=commitTransaction();
      return null;
    }
    String name=Warehouse.makePartName(convertToFieldSchemas(mtbl.getPartitionKeys()),part_vals);
    query=pm.newQuery(MPartition.class,"table.tableName == t1 && table.database.name == t2 && partitionName == t3");
    query.declareParameters("java.lang.String t1, java.lang.String t2, java.lang.String t3");
    query.setUnique(true);
    mpart=(MPartition)query.execute(tableName,dbName,name);
    pm.retrieve(mpart);
    commited=commitTransaction();
  }
  finally {
    if (!commited) {
      rollbackTransaction();
    }
    if (query != null) {
      query.closeAll();
    }
  }
  return mpart;
}
