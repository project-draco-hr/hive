{
  if (pmf == null) {
    pmf=JDOHelper.getPersistenceManagerFactory(prop);
    DataStoreCache dsc=pmf.getDataStoreCache();
    if (dsc != null) {
      HiveConf conf=new HiveConf(ObjectStore.class);
      String objTypes=HiveConf.getVar(conf,HiveConf.ConfVars.METASTORE_CACHE_PINOBJTYPES);
      if (objTypes != null && objTypes.length() > 0) {
        objTypes=objTypes.toLowerCase();
        String[] typeTokens=objTypes.split(",");
        for (        String type : typeTokens) {
          type=type.trim();
          if (PINCLASSMAP.containsKey(type)) {
            dsc.pinAll(true,PINCLASSMAP.get(type));
          }
        }
      }
    }
  }
  return pmf;
}
