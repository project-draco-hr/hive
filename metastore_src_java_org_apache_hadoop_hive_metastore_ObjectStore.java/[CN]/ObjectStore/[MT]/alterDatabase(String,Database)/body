{
  MDatabase mdb=null;
  boolean committed=false;
  try {
    mdb=getMDatabase(dbName);
    mdb.setParameters(db.getParameters());
    mdb.setOwnerName(db.getOwnerName());
    if (db.getOwnerType() != null) {
      mdb.setOwnerType(db.getOwnerType().name());
    }
    openTransaction();
    pm.makePersistent(mdb);
    committed=commitTransaction();
  }
  finally {
    if (!committed) {
      rollbackTransaction();
      return false;
    }
  }
  return true;
}
