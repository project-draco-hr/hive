{
  AttachedMTableInfo nmtbl=new AttachedMTableInfo();
  MTable mtbl=null;
  boolean commited=false;
  Query query=null;
  try {
    openTransaction();
    db=HiveStringUtils.normalizeIdentifier(db);
    table=HiveStringUtils.normalizeIdentifier(table);
    query=pm.newQuery(MTable.class,"tableName == table && database.name == db");
    query.declareParameters("java.lang.String table, java.lang.String db");
    query.setUnique(true);
    mtbl=(MTable)query.execute(table,db);
    pm.retrieve(mtbl);
    if (mtbl != null && retrieveCD) {
      pm.retrieve(mtbl.getSd());
      pm.retrieveAll(mtbl.getSd().getCD());
      nmtbl.mcd=mtbl.getSd().getCD();
    }
    commited=commitTransaction();
  }
  finally {
    if (!commited) {
      rollbackTransaction();
    }
    if (query != null) {
      query.closeAll();
    }
  }
  nmtbl.mtbl=mtbl;
  return nmtbl;
}
