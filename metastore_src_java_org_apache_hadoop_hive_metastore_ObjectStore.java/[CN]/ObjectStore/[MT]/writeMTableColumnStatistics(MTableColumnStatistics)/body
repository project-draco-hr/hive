{
  String dbName=mStatsObj.getDbName();
  String tableName=mStatsObj.getTableName();
  String colName=mStatsObj.getColName();
  LOG.info("Updating table level column statistics for db=" + dbName + " tableName="+ tableName+ " colName="+ colName);
  MTable mTable=getMTable(mStatsObj.getDbName(),mStatsObj.getTableName());
  boolean foundCol=false;
  if (mTable == null) {
    throw new NoSuchObjectException("Table " + tableName + " for which stats gathering is requested doesn't exist.");
  }
  MStorageDescriptor mSDS=mTable.getSd();
  List<MFieldSchema> colList=mSDS.getCD().getCols();
  for (  MFieldSchema mCol : colList) {
    if (mCol.getName().equals(mStatsObj.getColName().trim())) {
      foundCol=true;
      break;
    }
  }
  if (!foundCol) {
    throw new NoSuchObjectException("Column " + colName + " for which stats gathering is requested doesn't exist.");
  }
  MTableColumnStatistics oldStatsObj=getMTableColumnStatistics(dbName,tableName,colName);
  if (oldStatsObj != null) {
    oldStatsObj.setAvgColLen(mStatsObj.getAvgColLen());
    oldStatsObj.setHighValue(mStatsObj.getHighValue());
    oldStatsObj.setLastAnalyzed(mStatsObj.getLastAnalyzed());
    oldStatsObj.setLowValue(mStatsObj.getLowValue());
    oldStatsObj.setMaxColLen(mStatsObj.getMaxColLen());
    oldStatsObj.setNumDVs(mStatsObj.getNumDVs());
    oldStatsObj.setNumFalses(mStatsObj.getNumFalses());
    oldStatsObj.setNumTrues(mStatsObj.getNumTrues());
    oldStatsObj.setNumNulls(mStatsObj.getNumNulls());
  }
 else {
    pm.makePersistent(mStatsObj);
  }
}
