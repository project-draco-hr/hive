{
  String dbName=mStatsObj.getDbName();
  String tableName=mStatsObj.getTableName();
  String partName=mStatsObj.getPartitionName();
  String colName=mStatsObj.getColName();
  LOG.info("Updating partition level column statistics for db=" + dbName + " tableName="+ tableName+ " partName="+ partName+ " colName="+ colName);
  MTable mTable=getMTable(mStatsObj.getDbName(),mStatsObj.getTableName());
  boolean foundCol=false;
  if (mTable == null) {
    throw new NoSuchObjectException("Table " + tableName + " for which stats gathering is requested doesn't exist.");
  }
  MPartition mPartition=getMPartition(mStatsObj.getDbName(),mStatsObj.getTableName(),partVal);
  if (mPartition == null) {
    throw new NoSuchObjectException("Partition " + partName + " for which stats gathering is requested doesn't exist");
  }
  MStorageDescriptor mSDS=mPartition.getSd();
  List<MFieldSchema> colList=mSDS.getCD().getCols();
  for (  MFieldSchema mCol : colList) {
    if (mCol.getName().equals(mStatsObj.getColName().trim())) {
      foundCol=true;
      break;
    }
  }
  if (!foundCol) {
    throw new NoSuchObjectException("Column " + colName + " for which stats gathering is requested doesn't exist.");
  }
  MPartitionColumnStatistics oldStatsObj=getMPartitionColumnStatistics(dbName,tableName,partName,partVal,colName);
  if (oldStatsObj != null) {
    oldStatsObj.setAvgColLen(mStatsObj.getAvgColLen());
    oldStatsObj.setLongHighValue(mStatsObj.getLongHighValue());
    oldStatsObj.setDoubleHighValue(mStatsObj.getDoubleHighValue());
    oldStatsObj.setLastAnalyzed(mStatsObj.getLastAnalyzed());
    oldStatsObj.setLongLowValue(mStatsObj.getLongLowValue());
    oldStatsObj.setDoubleLowValue(mStatsObj.getDoubleLowValue());
    oldStatsObj.setMaxColLen(mStatsObj.getMaxColLen());
    oldStatsObj.setNumDVs(mStatsObj.getNumDVs());
    oldStatsObj.setNumFalses(mStatsObj.getNumFalses());
    oldStatsObj.setNumTrues(mStatsObj.getNumTrues());
    oldStatsObj.setNumNulls(mStatsObj.getNumNulls());
  }
 else {
    pm.makePersistent(mStatsObj);
  }
}
