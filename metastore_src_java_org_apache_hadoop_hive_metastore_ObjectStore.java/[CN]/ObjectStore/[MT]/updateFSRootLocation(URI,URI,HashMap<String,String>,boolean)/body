{
  boolean committed=false;
  int count=0;
  int totalCount=0;
  LOG.info("Old FS root location: " + oldLoc.toString() + " New FS root location: "+ newLoc.toString());
  LOG.info("Updating FS root location...");
  try {
    openTransaction();
    count=updateMDatabaseURI(oldLoc,newLoc,updateLocations,dryRun);
    totalCount+=count;
    count=updateMStorageDescriptorURI(oldLoc,newLoc,updateLocations,dryRun);
    totalCount+=count;
    count=updateAvroSerdeURI(oldLoc,newLoc,updateLocations,dryRun);
    totalCount+=count;
    committed=commitTransaction();
  }
  finally {
    if (!committed) {
      rollbackTransaction();
      return -1;
    }
 else {
      return totalCount;
    }
  }
}
