{
  boolean isEnabled=!isActiveTransaction() && HiveConf.getBoolVar(getConf(),ConfVars.METASTORE_TRY_DIRECT_SQL);
  if (!allowJdo && isEnabled && !directSql.isCompatibleDatastore()) {
    throw new MetaException("SQL is not operational");
  }
  return allowSql && isEnabled && directSql.isCompatibleDatastore();
}
