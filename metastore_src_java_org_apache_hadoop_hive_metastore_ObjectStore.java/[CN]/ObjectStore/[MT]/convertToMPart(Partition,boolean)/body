{
  if (part == null) {
    return null;
  }
  MTable mt=getMTable(part.getDbName(),part.getTableName());
  if (mt == null) {
    throw new InvalidObjectException("Partition doesn't have a valid table or database name");
  }
  MStorageDescriptor msd;
  if (useTableCD && mt.getSd() != null && mt.getSd().getCD() != null && mt.getSd().getCD().getCols() != null && part.getSd() != null && convertToFieldSchemas(mt.getSd().getCD().getCols()).equals(part.getSd().getCols())) {
    msd=convertToMStorageDescriptor(part.getSd(),mt.getSd().getCD());
  }
 else {
    msd=convertToMStorageDescriptor(part.getSd());
  }
  return new MPartition(Warehouse.makePartName(convertToFieldSchemas(mt.getPartitionKeys()),part.getValues()),mt,part.getValues(),part.getCreateTime(),part.getLastAccessTime(),msd,part.getParameters());
}
