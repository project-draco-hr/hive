{
  boolean committed=false;
  long numUpdated=0;
  Query query=null;
  try {
    openTransaction();
    query=pm.newQuery(queryStr);
    numUpdated=(Long)query.execute();
    committed=commitTransaction();
    if (committed) {
      return numUpdated;
    }
 else {
      return -1;
    }
  }
  finally {
    if (!committed) {
      rollbackTransaction();
    }
    if (query != null) {
      query.closeAll();
    }
  }
}
