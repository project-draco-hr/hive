{
  boolean success=false;
  try {
    openTransaction();
    funcName=funcName.toLowerCase();
    dbName=dbName.toLowerCase();
    MFunction newf=convertToMFunction(newFunction);
    if (newf == null) {
      throw new InvalidObjectException("new function is invalid");
    }
    MFunction oldf=getMFunction(dbName,funcName);
    if (oldf == null) {
      throw new MetaException("function " + funcName + " doesn't exist");
    }
    oldf.setFunctionName(newf.getFunctionName().toLowerCase());
    oldf.setDatabase(newf.getDatabase());
    oldf.setOwnerName(newf.getOwnerName());
    oldf.setOwnerType(newf.getOwnerType());
    oldf.setClassName(newf.getClassName());
    oldf.setFunctionType(newf.getFunctionType());
    success=commitTransaction();
  }
  finally {
    if (!success) {
      rollbackTransaction();
    }
  }
}
