{
  StringBuilder sb=new StringBuilder("table.tableName == t1 && table.database.name == t2 && (");
  int n=0;
  Map<String,String> params=new HashMap<String,String>();
  for (Iterator<String> itr=partNames.iterator(); itr.hasNext(); ) {
    String pn="p" + n;
    n++;
    String part=itr.next();
    params.put(pn,part);
    sb.append("partitionName == ").append(pn);
    sb.append(" || ");
  }
  sb.setLength(sb.length() - 4);
  sb.append(')');
  Query query=pm.newQuery();
  query.setFilter(sb.toString());
  LOG.debug(" JDOQL filter is " + sb.toString());
  params.put("t1",HiveStringUtils.normalizeIdentifier(tblName));
  params.put("t2",HiveStringUtils.normalizeIdentifier(dbName));
  query.declareParameters(makeParameterDeclarationString(params));
  return new ObjectPair<Query,Map<String,String>>(query,params);
}
