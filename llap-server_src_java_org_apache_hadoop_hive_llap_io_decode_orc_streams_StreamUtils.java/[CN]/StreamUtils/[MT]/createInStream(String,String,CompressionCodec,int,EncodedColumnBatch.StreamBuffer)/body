{
  int numBuffers=streamBuffer.cacheBuffers.size();
  List<DiskRange> input=new ArrayList<>(numBuffers);
  int totalLength=0;
  for (int i=0; i < numBuffers; i++) {
    LlapMemoryBuffer lmb=streamBuffer.cacheBuffers.get(i);
    input.add(new RecordReaderImpl.CacheChunk(lmb,0,lmb.byteBuffer.limit()));
    totalLength+=lmb.byteBuffer.limit();
  }
  return InStream.create(fileName,streamName,input,totalLength,codec,bufferSize,null);
}
