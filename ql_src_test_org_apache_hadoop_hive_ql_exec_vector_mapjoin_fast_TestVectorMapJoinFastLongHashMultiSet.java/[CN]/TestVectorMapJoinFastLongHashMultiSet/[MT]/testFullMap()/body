{
  random=new Random(25000);
  VectorMapJoinFastLongHashMultiSet map=new VectorMapJoinFastLongHashMultiSet(false,false,HashTableKeyType.LONG,CAPACITY,1f,WB_SIZE);
  VerifyFastLongHashMultiSet verifyTable=new VerifyFastLongHashMultiSet();
  for (int i=0; i < CAPACITY; i++) {
    long key;
    while (true) {
      key=random.nextLong();
      if (!verifyTable.contains(key)) {
        break;
      }
    }
    map.testPutRow(key);
    verifyTable.add(key);
  }
  verifyTable.verify(map);
  long anotherKey;
  while (true) {
    anotherKey=random.nextLong();
    if (!verifyTable.contains(anotherKey)) {
      break;
    }
  }
  VectorMapJoinHashMultiSetResult hashMultiSetResult=map.createHashMultiSetResult();
  JoinUtil.JoinResult joinResult=map.contains(anotherKey,hashMultiSetResult);
  assertTrue(joinResult == JoinUtil.JoinResult.NOMATCH);
}
