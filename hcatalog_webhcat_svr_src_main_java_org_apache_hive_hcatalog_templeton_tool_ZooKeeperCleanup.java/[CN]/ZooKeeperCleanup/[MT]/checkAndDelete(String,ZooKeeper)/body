{
  JobState state=null;
  try {
    JobStateTracker tracker=new JobStateTracker(node,zk,true,appConf.get(TempletonStorage.STORAGE_ROOT + ZooKeeperStorage.TRACKINGDIR));
    long now=new Date().getTime();
    state=new JobState(tracker.getJobID(),appConf);
    long then=0;
    if (state.getCreated() != null) {
      then=state.getCreated();
    }
    if (now - then > maxage) {
      LOG.info("Deleting " + tracker.getJobID());
      state.delete();
      tracker.delete();
      return true;
    }
    return false;
  }
 catch (  Exception e) {
    LOG.info("checkAndDelete failed for " + node);
    return true;
  }
 finally {
    if (state != null) {
      try {
        state.close();
      }
 catch (      IOException e) {
        LOG.info("Couldn't close job state.");
      }
    }
  }
}
