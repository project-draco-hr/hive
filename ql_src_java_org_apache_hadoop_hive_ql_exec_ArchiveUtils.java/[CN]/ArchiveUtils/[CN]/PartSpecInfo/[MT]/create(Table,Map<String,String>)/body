{
  List<FieldSchema> prefixFields=new ArrayList<FieldSchema>();
  List<String> prefixValues=new ArrayList<String>();
  List<FieldSchema> partCols=tbl.getPartCols();
  Iterator<String> itrPsKeys=partSpec.keySet().iterator();
  for (  FieldSchema fs : partCols) {
    if (!itrPsKeys.hasNext()) {
      break;
    }
    if (!itrPsKeys.next().toLowerCase().equals(fs.getName().toLowerCase())) {
      throw new HiveException("Invalid partition specifiation: " + partSpec);
    }
    prefixFields.add(fs);
    prefixValues.add(partSpec.get(fs.getName()));
  }
  return new PartSpecInfo(prefixFields,prefixValues);
}
