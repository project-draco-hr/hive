{
  String prefixSubdir;
  try {
    prefixSubdir=Warehouse.makePartName(fields,values);
  }
 catch (  MetaException e) {
    throw new HiveException("Unable to get partitions directories prefix",e);
  }
  Path tableDir=tbl.getDataLocation();
  if (tableDir == null) {
    throw new HiveException("Table has no location set");
  }
  return new Path(tableDir,prefixSubdir);
}
