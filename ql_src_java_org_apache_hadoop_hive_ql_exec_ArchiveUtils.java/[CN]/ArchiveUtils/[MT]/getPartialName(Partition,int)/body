{
  List<FieldSchema> ffields=p.getTable().getPartCols();
  List<FieldSchema> fields=new ArrayList<FieldSchema>(level);
  List<String> fvalues=p.getValues();
  List<String> values=new ArrayList<String>(level);
  for (int i=0; i < level; i++) {
    FieldSchema fs=ffields.get(i);
    String s=fvalues.get(i);
    fields.add(fs);
    values.add(s);
  }
  try {
    return Warehouse.makePartName(fields,values);
  }
 catch (  MetaException e) {
    throw new HiveException("Wasn't able to generate name" + " for partial specification");
  }
}
