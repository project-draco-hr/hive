{
  if (!isArchived(p)) {
    throw new HiveException("Getting level of unarchived partition");
  }
  Map<String,String> params=p.getParameters();
  String lv=params.get(ArchiveUtils.ARCHIVING_LEVEL);
  if (lv != null) {
    return Integer.parseInt(lv);
  }
 else {
    return p.getValues().size();
  }
}
