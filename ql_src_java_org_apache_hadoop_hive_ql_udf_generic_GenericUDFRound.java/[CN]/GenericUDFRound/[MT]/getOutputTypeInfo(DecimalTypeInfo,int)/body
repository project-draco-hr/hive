{
  int prec=inputTypeInfo.precision();
  int scale=inputTypeInfo.scale();
  int intParts=prec - scale;
  int newIntParts=dec < scale ? intParts + 1 : intParts;
  int newScale=dec < 0 ? 0 : Math.min(dec,HiveDecimal.MAX_SCALE);
  int newPrec=Math.min(newIntParts + newScale,HiveDecimal.MAX_PRECISION);
  return TypeInfoFactory.getDecimalTypeInfo(newPrec,newScale);
}
