{
  String key=generateKey(context);
  if (!taskCommitters.containsKey(key)) {
    throw new IOException("No callback registered for TaskAttemptID:" + key);
  }
  try {
    LOG.info("Committing TaskAttempt:" + key);
    taskCommitters.get(key).commitTask(context);
  }
 catch (  Throwable t) {
    throw new IOException("Could not clean up TaskAttemptID:" + key,t);
  }
}
