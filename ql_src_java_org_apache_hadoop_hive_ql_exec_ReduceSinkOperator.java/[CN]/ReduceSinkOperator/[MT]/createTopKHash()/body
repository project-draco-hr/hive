{
  int limit=conf.getTopN();
  float percent=conf.getTopNMemoryUsage();
  if (limit < 0 || percent <= 0) {
    return null;
  }
  if (limit == 0) {
    return TopNHash.create0();
  }
  long threshold=(long)(percent * Runtime.getRuntime().maxMemory()) - limit * 64;
  if (threshold < 0) {
    return null;
  }
  return TopNHash.create(conf.isMapGroupBy(),limit,threshold,this);
}
