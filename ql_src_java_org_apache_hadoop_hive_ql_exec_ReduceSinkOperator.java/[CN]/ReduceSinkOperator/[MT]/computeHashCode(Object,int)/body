{
  int keyHashCode=0;
  if (partitionEval.length == 0) {
    if (conf.getWriteType() == AcidUtils.Operation.NOT_ACID) {
      if (random == null) {
        random=new Random(12345);
      }
      keyHashCode=random.nextInt();
    }
 else {
      keyHashCode=1;
    }
  }
 else {
    for (int i=0; i < partitionEval.length; i++) {
      Object o=partitionEval[i].evaluate(row);
      keyHashCode=keyHashCode * 31 + ObjectInspectorUtils.hashCode(o,partitionObjectInspectors[i]);
    }
  }
  int hashCode=buckNum < 0 ? keyHashCode : keyHashCode * 31 + buckNum;
  if (isLogTraceEnabled) {
    LOG.trace("Going to return hash code " + hashCode);
  }
  return hashCode;
}
