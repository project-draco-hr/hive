{
  int keyHashCode=0;
  if (partitionEval.length == 0) {
    if (conf.getWriteType() == AcidUtils.Operation.NOT_ACID) {
      if (random == null) {
        random=new Random(12345);
      }
      keyHashCode=random.nextInt();
    }
 else {
      keyHashCode=1;
    }
  }
 else {
    Object[] bucketFieldValues=new Object[partitionEval.length];
    for (int i=0; i < partitionEval.length; i++) {
      bucketFieldValues[i]=partitionEval[i].evaluate(row);
    }
    keyHashCode=ObjectInspectorUtils.getBucketHashCode(bucketFieldValues,partitionObjectInspectors);
  }
  int hashCode=buckNum < 0 ? keyHashCode : keyHashCode * 31 + buckNum;
  if (isLogTraceEnabled) {
    LOG.trace("Going to return hash code " + hashCode);
  }
  return hashCode;
}
