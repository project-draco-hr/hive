{
  BinaryComparable key=(BinaryComparable)keySerializer.serialize(obj,keyObjectInspector);
  int keyLength=key.getLength();
  if (tag == -1 || skipTag) {
    keyWritable.set(key.getBytes(),0,keyLength);
  }
 else {
    keyWritable.setSize(keyLength + 1);
    System.arraycopy(key.getBytes(),0,keyWritable.get(),0,keyLength);
    keyWritable.get()[keyLength]=tagByte[0];
  }
  keyWritable.setDistKeyLength((distLength == null) ? keyLength : distLength);
  return keyWritable;
}
