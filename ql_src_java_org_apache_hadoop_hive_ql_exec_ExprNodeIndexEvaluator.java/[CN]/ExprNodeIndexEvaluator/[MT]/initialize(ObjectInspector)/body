{
  mainInspector=mainEvaluator.initialize(rowInspector);
  indexInspector=(PrimitiveObjectInspector)indexEvaluator.initialize(rowInspector);
  if (mainInspector.getCategory() == Category.LIST) {
    return ((ListObjectInspector)mainInspector).getListElementObjectInspector();
  }
 else   if (mainInspector.getCategory() == Category.MAP) {
    return ((MapObjectInspector)mainInspector).getMapValueObjectInspector();
  }
 else {
    throw new RuntimeException("Hive 2 Internal error: cannot evaluate index expression on " + mainInspector.getTypeName());
  }
}
