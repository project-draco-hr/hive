{
  Object main=mainEvaluator.evaluate(row);
  Object index=indexEvaluator.evaluate(row);
  if (mainInspector.getCategory() == Category.LIST) {
    int intIndex=PrimitiveObjectInspectorUtils.getInt(index,indexInspector);
    ListObjectInspector loi=(ListObjectInspector)mainInspector;
    return loi.getListElement(main,intIndex);
  }
 else   if (mainInspector.getCategory() == Category.MAP) {
    MapObjectInspector moi=(MapObjectInspector)mainInspector;
    Object indexObject;
    if (((PrimitiveObjectInspector)moi.getMapKeyObjectInspector()).preferWritable()) {
      indexObject=indexInspector.getPrimitiveWritableObject(index);
    }
 else {
      indexObject=indexInspector.getPrimitiveJavaObject(index);
    }
    return moi.getMapValueElement(main,indexObject);
  }
 else {
    throw new RuntimeException("Hive 2 Internal error: cannot evaluate index expression on " + mainInspector.getTypeName());
  }
}
