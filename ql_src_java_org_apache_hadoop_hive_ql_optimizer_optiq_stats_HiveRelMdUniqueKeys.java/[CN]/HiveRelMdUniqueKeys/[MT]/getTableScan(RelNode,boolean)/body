{
  while (r != null && !(r instanceof HiveTableScanRel)) {
    if (r instanceof HepRelVertex) {
      r=((HepRelVertex)r).getCurrentRel();
    }
 else     if (r instanceof FilterRelBase) {
      r=((FilterRelBase)r).getChild();
    }
 else     if (traverseProject && r instanceof ProjectRelBase) {
      r=((ProjectRelBase)r).getChild();
    }
 else {
      r=null;
    }
  }
  return r == null ? null : (HiveTableScanRel)r;
}
