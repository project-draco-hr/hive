{
  String factoryClassName=tbl.getProperty(HBaseSerDe.HBASE_COMPOSITE_KEY_FACTORY);
  if (factoryClassName != null) {
    Class<?> factoryClazz=job.getClassByName(factoryClassName);
    return (HBaseKeyFactory)ReflectionUtils.newInstance(factoryClazz,job);
  }
  String keyClassName=tbl.getProperty(HBaseSerDe.HBASE_COMPOSITE_KEY_CLASS);
  if (keyClassName != null) {
    Class<?> keyClass=job.getClassByName(keyClassName);
    return new CompositeHBaseKeyFactory(keyClass);
  }
  return new DefaultHBaseKeyFactory();
}
