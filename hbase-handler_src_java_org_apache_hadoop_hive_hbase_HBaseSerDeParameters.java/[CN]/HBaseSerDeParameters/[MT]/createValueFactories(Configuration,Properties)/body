{
  List<HBaseValueFactory> valueFactories=new ArrayList<HBaseValueFactory>();
  try {
    for (int i=0; i < columnMappings.size(); i++) {
      String serType=getSerializationType(conf,tbl,columnMappings.getColumnsMapping()[i]);
      if (serType != null && serType.equals(AVRO_SERIALIZATION_TYPE)) {
        Schema schema=getSchema(conf,tbl,columnMappings.getColumnsMapping()[i]);
        valueFactories.add(new AvroHBaseValueFactory(schema));
      }
 else {
        valueFactories.add(new DefaultHBaseValueFactory());
      }
    }
  }
 catch (  Exception e) {
    throw new SerDeException(e);
  }
  return valueFactories;
}
