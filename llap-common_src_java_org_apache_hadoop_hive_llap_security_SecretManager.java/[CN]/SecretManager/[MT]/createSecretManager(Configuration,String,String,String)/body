{
  final LlapZkConf c=createLlapZkConf(conf,llapPrincipal,llapKeytab,clusterId);
  return c.zkUgi.doAs(new PrivilegedAction<SecretManager>(){
    @Override public SecretManager run(){
      SecretManager zkSecretManager=new SecretManager(c.zkConf,clusterId);
      try {
        zkSecretManager.startThreads();
      }
 catch (      IOException e) {
        throw new RuntimeException(e);
      }
      return zkSecretManager;
    }
  }
);
}
