{
  Text realUser=null, renewer=null;
  if (user == null) {
    UserGroupInformation ugi=UserGroupInformation.getCurrentUser();
    user=ugi.getUserName();
    if (ugi.getRealUser() != null) {
      realUser=new Text(ugi.getRealUser().getUserName());
    }
    renewer=new Text(ugi.getShortUserName());
  }
 else {
    renewer=new Text(user);
  }
  LlapTokenIdentifier llapId=new LlapTokenIdentifier(new Text(user),renewer,realUser,clusterId,appId,isSignatureRequired);
  Token<LlapTokenIdentifier> token=new Token<LlapTokenIdentifier>(llapId,this);
  if (LOG.isInfoEnabled()) {
    LOG.info("Created LLAP token {}",token);
  }
  return token;
}
