{
  Hive db=hiveDB.get();
  if (db == null || needsRefresh) {
    closeCurrent();
    c.set("fs.scheme.class","dfs");
    Hive newdb=new Hive(c);
    if (db != null && db.getCurrentDatabase() != null) {
      newdb.setCurrentDatabase(db.getCurrentDatabase());
    }
    hiveDB.set(newdb);
    return newdb;
  }
  return db;
}
