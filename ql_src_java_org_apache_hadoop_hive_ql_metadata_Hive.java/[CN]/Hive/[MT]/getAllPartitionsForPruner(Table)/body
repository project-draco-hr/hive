{
  if (!tbl.isPartitioned()) {
    return Sets.newHashSet(new Partition(tbl));
  }
  List<org.apache.hadoop.hive.metastore.api.Partition> tParts;
  try {
    tParts=getMSC().listPartitions(tbl.getDbName(),tbl.getTableName(),(short)-1);
  }
 catch (  Exception e) {
    LOG.error(StringUtils.stringifyException(e));
    throw new HiveException(e);
  }
  Set<Partition> parts=new LinkedHashSet<Partition>(tParts.size());
  for (  org.apache.hadoop.hive.metastore.api.Partition tpart : tParts) {
    parts.add(new Partition(tbl,tpart));
  }
  return parts;
}
