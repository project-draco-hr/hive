{
  org.apache.hadoop.hive.metastore.api.Partition partition=null;
  for (  FieldSchema field : tbl.getPartCols()) {
    String val=partSpec.get(field.getName());
    if (val == null || val.length() == 0) {
      throw new HiveException("add partition: Value for key " + field.getName() + " is null or empty");
    }
  }
  try {
    Partition tmpPart=new Partition(tbl,partSpec,location);
    partition=getMSC().add_partition(tmpPart.getTPartition());
  }
 catch (  Exception e) {
    LOG.error(StringUtils.stringifyException(e));
    throw new HiveException(e);
  }
  return new Partition(tbl,partition);
}
