{
  LOG.debug("Acid move looking for " + deltaFileType + " files in bucket "+ origBucketPath);
  FileStatus[] deltaStats=null;
  try {
    deltaStats=fs.listStatus(origBucketPath,pathFilter);
  }
 catch (  IOException e) {
    throw new HiveException("Unable to look for " + deltaFileType + " files in original bucket "+ origBucketPath.toUri().toString(),e);
  }
  LOG.debug("Acid move found " + deltaStats.length + " "+ deltaFileType+ " files");
  for (  FileStatus deltaStat : deltaStats) {
    Path deltaPath=deltaStat.getPath();
    Path deltaDest=new Path(dst,deltaPath.getName());
    try {
      if (!createdDeltaDirs.contains(deltaDest)) {
        try {
          fs.mkdirs(deltaDest);
          createdDeltaDirs.add(deltaDest);
        }
 catch (        IOException swallowIt) {
          LOG.info("Unable to create " + deltaFileType + " directory "+ deltaDest+ ", assuming it already exists: "+ swallowIt.getMessage());
        }
      }
      FileStatus[] bucketStats=fs.listStatus(deltaPath,AcidUtils.bucketFileFilter);
      LOG.debug("Acid move found " + bucketStats.length + " bucket files");
      for (      FileStatus bucketStat : bucketStats) {
        Path bucketSrc=bucketStat.getPath();
        Path bucketDest=new Path(deltaDest,bucketSrc.getName());
        LOG.info("Moving bucket " + bucketSrc.toUri().toString() + " to "+ bucketDest.toUri().toString());
        fs.rename(bucketSrc,bucketDest);
        if (newFiles != null)         newFiles.add(bucketDest);
      }
    }
 catch (    IOException e) {
      throw new HiveException("Error moving acid files " + e.getMessage(),e);
    }
  }
}
