{
  org.apache.hadoop.hive.metastore.api.Partition tpart=null;
  List<String> pvals=new ArrayList<String>();
  for (  FieldSchema field : tbl.getPartCols()) {
    pvals.add(partSpec.get(field.getName()));
  }
  try {
    tpart=msc.appendPartition(MetaStoreUtils.DEFAULT_DATABASE_NAME,tbl.getName(),pvals);
    ;
  }
 catch (  Exception e) {
    LOG.error(StringUtils.stringifyException(e));
    throw new HiveException(e);
  }
  return new Partition(tbl,tpart);
}
