{
  if (tbl.isPartitioned()) {
    List<org.apache.hadoop.hive.metastore.api.Partition> tParts;
    try {
      tParts=getMSC().listPartitions(tbl.getDbName(),tbl.getTableName(),(short)-1);
    }
 catch (    Exception e) {
      LOG.error(StringUtils.stringifyException(e));
      throw new HiveException(e);
    }
    List<Partition> parts=new ArrayList<Partition>(tParts.size());
    for (    org.apache.hadoop.hive.metastore.api.Partition tpart : tParts) {
      parts.add(new Partition(tbl,tpart));
    }
    return parts;
  }
 else {
    Partition part=new Partition(tbl);
    ArrayList<Partition> parts=new ArrayList<Partition>(1);
    parts.add(part);
    return parts;
  }
}
