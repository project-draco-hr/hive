{
  try {
    Map<String,String> newPartSpec=newPart.getSpec();
    if (oldPartSpec.keySet().size() != tbl.getPartCols().size() || newPartSpec.keySet().size() != tbl.getPartCols().size()) {
      throw new HiveException("Unable to rename partition to the same name: number of partition cols don't match. ");
    }
    if (!oldPartSpec.keySet().equals(newPartSpec.keySet())) {
      throw new HiveException("Unable to rename partition to the same name: old and new partition cols don't match. ");
    }
    List<String> pvals=new ArrayList<String>();
    for (    FieldSchema field : tbl.getPartCols()) {
      String val=oldPartSpec.get(field.getName());
      if (val == null || val.length() == 0) {
        throw new HiveException("get partition: Value for key " + field.getName() + " is null or empty");
      }
 else       if (val != null) {
        pvals.add(val);
      }
    }
    getMSC().renamePartition(tbl.getDbName(),tbl.getTableName(),pvals,newPart.getTPartition());
  }
 catch (  InvalidOperationException e) {
    throw new HiveException("Unable to rename partition. " + e.getMessage(),e);
  }
catch (  MetaException e) {
    throw new HiveException("Unable to rename partition. " + e.getMessage(),e);
  }
catch (  TException e) {
    throw new HiveException("Unable to rename partition. " + e.getMessage(),e);
  }
}
