{
  if (!tbl.isPartitioned()) {
    throw new HiveException("Partition spec should only be supplied for a " + "partitioned table");
  }
  int numParts=getMSC().getNumPartitionsByFilter(tbl.getDbName(),tbl.getTableName(),filter);
  return numParts;
}
