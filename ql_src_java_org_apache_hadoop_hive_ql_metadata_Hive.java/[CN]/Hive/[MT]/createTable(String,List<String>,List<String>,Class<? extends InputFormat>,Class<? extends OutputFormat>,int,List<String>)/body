{
  if (columns == null) {
    throw new HiveException("columns not specified for table " + tableName);
  }
  Table tbl=new Table(tableName);
  tbl.setInputFormatClass(fileInputFormat.getName());
  tbl.setOutputFormatClass(fileOutputFormat.getName());
  for (  String col : columns) {
    FieldSchema field=new FieldSchema(col,org.apache.hadoop.hive.serde.Constants.STRING_TYPE_NAME,"default");
    tbl.getCols().add(field);
  }
  if (partCols != null) {
    for (    String partCol : partCols) {
      FieldSchema part=new FieldSchema();
      part.setName(partCol);
      part.setType(org.apache.hadoop.hive.serde.Constants.STRING_TYPE_NAME);
      tbl.getPartCols().add(part);
    }
  }
  tbl.setSerializationLib(org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe.shortName());
  tbl.setNumBuckets(bucketCount);
  createTable(tbl);
}
