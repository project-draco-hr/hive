{
  try {
    if (tbl.getCols().size() == 0) {
      tbl.setFields(MetaStoreUtils.getFieldsFromDeserializer(tbl.getTableName(),tbl.getDeserializer()));
    }
    tbl.checkValidity();
    getMSC().createTable(tbl.getTTable());
  }
 catch (  AlreadyExistsException e) {
    if (!ifNotExists) {
      throw new HiveException(e);
    }
  }
catch (  Exception e) {
    throw new HiveException(e);
  }
}
