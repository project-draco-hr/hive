{
  if (!tbl.isPartitioned()) {
    throw new HiveException("Partition spec should only be supplied for a " + "partitioned table");
  }
  List<String> names=getPartitionNames(tbl.getDbName(),tbl.getTableName(),partialPartSpec,(short)-1);
  List<Partition> partitions=new ArrayList<Partition>();
  for (  String pval : names) {
    try {
      org.apache.hadoop.hive.metastore.api.Partition tpart=getMSC().getPartition(tbl.getDbName(),tbl.getTableName(),pval);
      if (tpart != null) {
        Partition p=new Partition(tbl,tpart);
        partitions.add(p);
      }
    }
 catch (    Exception e) {
      throw new HiveException(e);
    }
  }
  return partitions;
}
