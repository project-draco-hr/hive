{
  if (!tbl.isPartitioned()) {
    throw new HiveException(ErrorMsg.TABLE_NOT_PARTITIONED,tbl.getTableName());
  }
  List<String> names=getPartitionNames(tbl.getDbName(),tbl.getTableName(),partialPartSpec,(short)-1);
  List<Partition> partitions=getPartitionsByNames(tbl,names);
  return partitions;
}
