{
  Table tbl=getTable(tableName);
  try {
    Partition oldPart=getPartition(tbl,partSpec,false,null);
    Path oldPartPath=null;
    if (oldPart != null) {
      oldPartPath=oldPart.getPartitionPath();
    }
    Path partPath=new Path(tbl.getDataLocation().getPath(),Warehouse.makePartPath(partSpec));
    Path newPartPath=new Path(loadPath.toUri().getScheme(),loadPath.toUri().getAuthority(),partPath.toUri().getPath());
    if (replace) {
      Hive.replaceFiles(loadPath,newPartPath,oldPartPath,tmpDirPath,getConf());
    }
 else {
      FileSystem fs=FileSystem.get(tbl.getDataLocation(),getConf());
      Hive.copyFiles(loadPath,newPartPath,fs);
    }
    if (!holdDDLTime) {
      getPartition(tbl,partSpec,true,newPartPath.toString());
    }
  }
 catch (  IOException e) {
    LOG.error(StringUtils.stringifyException(e));
    throw new HiveException(e);
  }
catch (  MetaException e) {
    LOG.error(StringUtils.stringifyException(e));
    throw new HiveException(e);
  }
}
