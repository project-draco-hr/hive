{
  if (metaStoreClient == null) {
    try {
      owner=UserGroupInformation.getCurrentUser();
    }
 catch (    IOException e) {
      String msg="Error getting current user: " + e.getMessage();
      LOG.error(msg,e);
      throw new MetaException(msg + "\n" + StringUtils.stringifyException(e));
    }
    metaStoreClient=createMetaStoreClient();
    String metaStoreUris=conf.getVar(HiveConf.ConfVars.METASTOREURIS);
    if (!org.apache.commons.lang3.StringUtils.isEmpty(metaStoreUris)) {
      metaStoreClient=HiveMetaStoreClient.newSynchronizedClient(metaStoreClient);
    }
  }
  return metaStoreClient;
}
