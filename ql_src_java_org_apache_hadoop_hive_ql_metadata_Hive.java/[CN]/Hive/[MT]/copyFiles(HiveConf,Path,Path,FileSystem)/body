{
  try {
    if (!fs.exists(destf)) {
      fs.mkdirs(destf);
    }
  }
 catch (  IOException e) {
    throw new HiveException("copyFiles: error while checking/creating destination directory!!!",e);
  }
  FileStatus[] srcs;
  try {
    srcs=fs.globStatus(srcf);
  }
 catch (  IOException e) {
    LOG.error(StringUtils.stringifyException(e));
    throw new HiveException("addFiles: filesystem error in check phase",e);
  }
  if (srcs == null) {
    LOG.info("No sources specified to move: " + srcf);
    return;
  }
  checkPaths(conf,fs,srcs,destf,false);
  try {
    for (    FileStatus src : srcs) {
      FileStatus[] items=fs.listStatus(src.getPath());
      for (      FileStatus item : items) {
        Path source=item.getPath();
        Path target=new Path(destf,item.getPath().getName());
        if (!fs.rename(source,target)) {
          throw new IOException("Cannot move " + source + " to "+ target);
        }
      }
    }
  }
 catch (  IOException e) {
    throw new HiveException("copyFiles: error while moving files!!!",e);
  }
}
