{
  LOG.debug("altering partition for table " + tbl.getTableName() + " with partition spec : "+ partSpec);
  if (inheritTableSpecs) {
    tpart.getSd().setOutputFormat(tbl.getTTable().getSd().getOutputFormat());
    tpart.getSd().setInputFormat(tbl.getTTable().getSd().getInputFormat());
    tpart.getSd().getSerdeInfo().setSerializationLib(tbl.getSerializationLib());
    tpart.getSd().getSerdeInfo().setParameters(tbl.getTTable().getSd().getSerdeInfo().getParameters());
    tpart.getSd().setBucketCols(tbl.getBucketCols());
    tpart.getSd().setNumBuckets(tbl.getNumBuckets());
    tpart.getSd().setSortCols(tbl.getSortCols());
  }
  if (partPath == null || partPath.trim().equals("")) {
    throw new HiveException("new partition path should not be null or empty.");
  }
  tpart.getSd().setLocation(partPath);
}
