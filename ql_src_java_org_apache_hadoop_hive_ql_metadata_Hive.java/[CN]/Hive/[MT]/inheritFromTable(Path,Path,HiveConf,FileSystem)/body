{
  if (!FileUtils.isSubDir(destf,tablePath,fs)) {
    return;
  }
  HadoopShims shims=ShimLoader.getHadoopShims();
  Path currPath=destf;
  List<Path> pathsToSet=new LinkedList<Path>();
  while (!currPath.equals(tablePath)) {
    pathsToSet.add(currPath);
    currPath=currPath.getParent();
  }
  try {
    HadoopShims.HdfsFileStatus fullFileStatus=shims.getFullFileStatus(conf,fs,currPath);
    for (    Path pathToSet : pathsToSet) {
      shims.setFullFileStatus(conf,fullFileStatus,fs,pathToSet);
    }
  }
 catch (  Exception e) {
    LOG.warn("Error setting permissions or group of " + destf,e);
  }
}
