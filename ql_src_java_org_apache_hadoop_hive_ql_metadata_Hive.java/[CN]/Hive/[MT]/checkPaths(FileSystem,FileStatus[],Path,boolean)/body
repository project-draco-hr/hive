{
  try {
    for (    FileStatus src : srcs) {
      FileStatus[] items=fs.listStatus(src.getPath());
      for (      FileStatus item : items) {
        if (Utilities.isTempPath(item)) {
          fs.delete(item.getPath(),true);
          continue;
        }
        if (item.isDir()) {
          throw new HiveException("checkPaths: " + src.toString() + " has nested directory"+ item.toString());
        }
        Path tmpDest=new Path(destf,item.getPath().getName());
        if (!replace && fs.exists(tmpDest)) {
          throw new HiveException("checkPaths: " + tmpDest + " already exists");
        }
      }
    }
  }
 catch (  IOException e) {
    throw new HiveException("checkPaths: filesystem error in check phase",e);
  }
}
