{
  try {
    for (    FileStatus src : srcs) {
      FileStatus[] items=fs.listStatus(src.getPath());
      for (      FileStatus item : items) {
        Path itemStaging=item.getPath();
        if (Utilities.isTempPath(item)) {
          fs.delete(itemStaging,true);
          continue;
        }
        if (item.isDir()) {
          throw new HiveException("checkPaths: " + src.getPath() + " has nested directory"+ itemStaging);
        }
        if (!replace) {
          int counter=1;
          String name=itemStaging.getName();
          String filetype;
          int index=name.lastIndexOf('.');
          if (index >= 0) {
            filetype=name.substring(index);
            name=name.substring(0,index);
          }
 else {
            filetype="";
          }
          Path itemDest=new Path(destf,itemStaging.getName());
          Path itemStagingBase=new Path(itemStaging.getParent(),name);
          while (fs.exists(itemDest)) {
            Path proposedStaging=itemStagingBase.suffix("_copy_" + counter++).suffix(filetype);
            Path proposedDest=new Path(destf,proposedStaging.getName());
            if (fs.exists(proposedDest)) {
              LOG.trace(proposedDest + " already exists");
              continue;
            }
            if (!fs.rename(itemStaging,proposedStaging)) {
              LOG.debug("Unsuccessfully in attempt to rename " + itemStaging + " to "+ proposedStaging+ "...");
              continue;
            }
            LOG.debug("Successfully renamed " + itemStaging + " to "+ proposedStaging);
            itemDest=proposedDest;
          }
        }
      }
    }
  }
 catch (  IOException e) {
    throw new HiveException("checkPaths: filesystem error in check phase",e);
  }
}
