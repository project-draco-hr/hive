{
  try {
    for (int i=0; i < srcs.length; i++) {
      FileStatus[] items=fs.listStatus(srcs[i].getPath());
      for (int j=0; j < items.length; j++) {
        if (Utilities.isTempPath(items[j])) {
          fs.delete(items[j].getPath(),true);
          continue;
        }
        if (items[j].isDir()) {
          throw new HiveException("checkPaths: " + srcs[i].toString() + " has nested directory"+ items[j].toString());
        }
        Path tmpDest=new Path(destf,items[j].getPath().getName());
        if (!replace && fs.exists(tmpDest)) {
          throw new HiveException("checkPaths: " + tmpDest + " already exists");
        }
      }
    }
  }
 catch (  IOException e) {
    throw new HiveException("checkPaths: filesystem error in check phase",e);
  }
}
