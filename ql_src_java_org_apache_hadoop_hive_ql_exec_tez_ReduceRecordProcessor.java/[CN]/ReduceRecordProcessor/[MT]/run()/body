{
  List<ShuffledMergedInput> shuffleInputs=getShuffleInputs(inputs);
  KeyValuesReader kvsReader;
  if (shuffleInputs.size() == 1) {
    kvsReader=shuffleInputs.get(0).getReader();
  }
 else {
    kvsReader=new InputMerger(shuffleInputs);
  }
  while (kvsReader.next()) {
    Object key=kvsReader.getCurrentKey();
    Iterable<Object> values=kvsReader.getCurrentValues();
    boolean needMore=processKeyValues(key,values);
    if (!needMore) {
      break;
    }
  }
}
