{
  port=MetaStoreUtils.findFreePort();
  hiveServer2=new HiveServer2();
  hiveConf=new HiveConf();
  hiveConf.setBoolVar(ConfVars.HIVE_SERVER2_THRIFT_HTTP_COOKIE_AUTH_ENABLED,true);
  hiveConf.setTimeVar(ConfVars.HIVE_SERVER2_THRIFT_HTTP_COOKIE_MAX_AGE,1,TimeUnit.SECONDS);
  hiveConf.setBoolVar(ConfVars.HIVE_SERVER2_THRIFT_HTTP_COOKIE_IS_SECURE,false);
  hiveConf.setVar(ConfVars.HIVE_SERVER2_TRANSPORT_MODE,"http");
  hiveConf.setVar(ConfVars.HIVE_SERVER2_THRIFT_HTTP_PATH,"cliservice");
  assertNotNull(port);
  assertNotNull(hiveServer2);
  assertNotNull(hiveConf);
  hiveConf.setBoolVar(ConfVars.HIVE_SERVER2_ENABLE_DOAS,false);
  hiveConf.setVar(ConfVars.HIVE_SERVER2_THRIFT_BIND_HOST,host);
  hiveConf.setIntVar(ConfVars.HIVE_SERVER2_THRIFT_HTTP_PORT,port);
  hiveConf.setVar(ConfVars.HIVE_SERVER2_AUTHENTICATION,AuthTypes.NOSASL.toString());
  startHiveServer2WithConf(hiveConf);
  client=getServiceClientInternal();
}
