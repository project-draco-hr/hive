{
  String tbl="test_convert_boolean_to_int";
  String inputFileName=TEST_DATA_DIR + "/testConvertBooleanToInt/data.txt";
  File inputDataDir=new File(inputFileName).getParentFile();
  inputDataDir.mkdir();
  String[] lines=new String[]{"llama\t1","alpaca\t0"};
  HcatTestUtils.createTestDataFile(inputFileName,lines);
  assertEquals(0,driver.run("drop table if exists " + tbl).getResponseCode());
  assertEquals(0,driver.run("create external table " + tbl + " (a string, b boolean) row format delimited fields terminated by '\t'"+ " stored as textfile location 'file://"+ inputDataDir.getAbsolutePath()+ "'").getResponseCode());
  Properties properties=new Properties();
  properties.setProperty(HCatConstants.HCAT_DATA_CONVERT_BOOLEAN_TO_INTEGER,"true");
  PigServer server=new PigServer(ExecType.LOCAL,properties);
  server.registerQuery("data = load 'test_convert_boolean_to_int' using org.apache.hcatalog.pig.HCatLoader();");
  Schema schema=server.dumpSchema("data");
  assertEquals(2,schema.getFields().size());
  assertEquals("a",schema.getField(0).alias);
  assertEquals(DataType.CHARARRAY,schema.getField(0).type);
  assertEquals("b",schema.getField(1).alias);
  assertEquals(DataType.INTEGER,schema.getField(1).type);
  Iterator<Tuple> iterator=server.openIterator("data");
  Tuple t=iterator.next();
  assertEquals("llama",t.get(0));
  assertEquals(1,t.get(1));
  t=iterator.next();
  assertEquals("alpaca",t.get(0));
  assertEquals(0,t.get(1));
  assertFalse(iterator.hasNext());
}
