{
  List<String> columnComments;
  if (columnCommentProperty == null || columnCommentProperty.isEmpty()) {
    columnComments=new ArrayList<String>();
  }
 else {
    columnComments=Arrays.asList(columnCommentProperty.split("\0"));
    if (LOG.isDebugEnabled()) {
      LOG.debug("columnComments is " + columnCommentProperty);
    }
  }
  if (columnNames.size() != columnTypes.size()) {
    throw new IllegalArgumentException("AvroSerde initialization failed. Number of column " + "name and column type differs. columnNames = " + columnNames + ", columnTypes = "+ columnTypes);
  }
  final String tableName=properties.getProperty(TABLE_NAME);
  final String tableComment=properties.getProperty(TABLE_COMMENT);
  TypeInfoToSchema typeInfoToSchema=new TypeInfoToSchema();
  return typeInfoToSchema.convert(columnNames,columnTypes,columnComments,properties.getProperty(AvroSerdeUtils.AvroTableProperties.SCHEMA_NAMESPACE.getPropName()),properties.getProperty(AvroSerdeUtils.AvroTableProperties.SCHEMA_NAME.getPropName(),tableName),properties.getProperty(AvroSerdeUtils.AvroTableProperties.SCHEMA_DOC.getPropName(),tableComment));
}
