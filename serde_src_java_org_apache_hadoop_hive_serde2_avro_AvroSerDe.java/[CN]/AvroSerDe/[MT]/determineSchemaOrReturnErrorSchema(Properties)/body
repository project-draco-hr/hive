{
  try {
    configErrors="";
    return AvroSerdeUtils.determineSchemaOrThrowException(props);
  }
 catch (  AvroSerdeException he) {
    LOG.warn("Encountered AvroSerdeException determining schema. Returning " + "signal schema to indicate problem",he);
    configErrors=new String("Encountered AvroSerdeException determining schema. Returning " + "signal schema to indicate problem: " + he.getMessage());
    return schema=SchemaResolutionProblem.SIGNAL_BAD_SCHEMA;
  }
catch (  Exception e) {
    LOG.warn("Encountered exception determining schema. Returning signal " + "schema to indicate problem",e);
    configErrors=new String("Encountered exception determining schema. Returning signal " + "schema to indicate problem: " + e.getMessage());
    return SchemaResolutionProblem.SIGNAL_BAD_SCHEMA;
  }
}
