{
  if (schema != null) {
    LOG.info("Resetting already initialized AvroSerDe");
  }
  schema=null;
  oi=null;
  columnNames=null;
  columnTypes=null;
  schema=AvroSerdeUtils.determineSchemaOrReturnErrorSchema(properties);
  if (configuration == null) {
    LOG.info("Configuration null, not inserting schema");
  }
 else {
    configuration.set("hive.output.file.extension",".avro");
    configuration.set(AvroSerdeUtils.AVRO_SERDE_SCHEMA,schema.toString(false));
  }
  badSchema=schema.equals(SchemaResolutionProblem.SIGNAL_BAD_SCHEMA);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(schema);
  this.columnNames=aoig.getColumnNames();
  this.columnTypes=aoig.getColumnTypes();
  this.oi=aoig.getObjectInspector();
}
