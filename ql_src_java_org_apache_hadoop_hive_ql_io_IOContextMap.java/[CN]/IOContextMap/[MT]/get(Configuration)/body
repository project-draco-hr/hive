{
  if (HiveConf.getVar(conf,HiveConf.ConfVars.HIVE_EXECUTION_ENGINE).equals("spark")) {
    return sparkThreadLocal.get();
  }
  String inputName=conf.get(Utilities.INPUT_NAME);
  if (inputName == null) {
    inputName=DEFAULT_CONTEXT;
  }
  ConcurrentHashMap<String,IOContext> map;
  map=globalMap;
  IOContext ioContext=map.get(inputName);
  if (ioContext != null)   return ioContext;
  ioContext=new IOContext();
  IOContext oldContext=map.putIfAbsent(inputName,ioContext);
  return (oldContext == null) ? ioContext : oldContext;
}
