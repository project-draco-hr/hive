{
  try {
    String ddl=tbl.getProperty(Constants.SERIALIZATION_DDL);
    type_name=tbl.getProperty(META_TABLE_NAME);
    String protoName=tbl.getProperty(Constants.SERIALIZATION_FORMAT);
    if (protoName == null) {
      protoName="com.facebook.thrift.protocol.TBinaryProtocol";
    }
    TProtocolFactory protFactory=TReflectionUtils.getProtocolFactoryByName(protoName);
    bos_=new ByteStream.Output();
    bis_=new ByteStream.Input();
    tios=new TIOStreamTransport(bis_,bos_);
    oprot_=protFactory.getProtocol(tios);
    iprot_=protFactory.getProtocol(tios);
    if (oprot_ instanceof org.apache.hadoop.hive.serde2.thrift.ConfigurableTProtocol) {
      ((ConfigurableTProtocol)oprot_).initialize(job,tbl);
    }
    if (iprot_ instanceof org.apache.hadoop.hive.serde2.thrift.ConfigurableTProtocol) {
      ((ConfigurableTProtocol)iprot_).initialize(job,tbl);
    }
    List<String> include_path=new ArrayList<String>();
    include_path.add(".");
    LOG.debug("ddl=" + ddl);
    this.parse_tree=new thrift_grammar(new ByteArrayInputStream(ddl.getBytes()),include_path,false);
    this.parse_tree.Start();
    this.bt=(DynamicSerDeStructBase)this.parse_tree.types.get(type_name);
    if (this.bt == null) {
      this.bt=(DynamicSerDeStructBase)this.parse_tree.tables.get(type_name);
    }
    if (this.bt == null) {
      throw new SerDeException("Could not lookup table type " + type_name + " in this ddl: "+ ddl);
    }
    this.bt.initialize();
  }
 catch (  Exception e) {
    System.err.println(StringUtils.stringifyException(e));
    throw new SerDeException(e);
  }
}
