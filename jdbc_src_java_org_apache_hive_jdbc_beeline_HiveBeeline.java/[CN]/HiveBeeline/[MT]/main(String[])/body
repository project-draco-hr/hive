{
  OptionsProcessor oproc=new OptionsProcessor();
  if (!oproc.processArgs(args)) {
    System.exit(1);
  }
  String jdbcURL=URI_PREFIX;
  if (oproc.getHost() != null) {
    jdbcURL+=oproc.getHost() + ":" + oproc.getPort();
  }
  if (!oproc.getDatabase().isEmpty()) {
    jdbcURL+=URL_DB_MARKER + oproc.getDatabase();
  }
  if (!oproc.getSessVars().isEmpty()) {
    jdbcURL+=URL_SESS_VAR_MARKER + oproc.getSessVars();
  }
  if (!oproc.getHiveConfs().isEmpty()) {
    jdbcURL+=URL_HIVE_CONF_MARKER + oproc.getHiveConfs();
  }
  if (!oproc.getHiveVars().isEmpty()) {
    jdbcURL+=URL_HIVE_VAR_MARKER + oproc.getHiveVars();
  }
  InputStream sqlLineInput=null;
  if (oproc.getFileName() != null) {
    String scriptCmd=SQLLINE_SCRIPT_CMD + " " + oproc.getFileName().trim()+ "\n";
    sqlLineInput=new ByteArrayInputStream(scriptCmd.getBytes());
  }
 else   if (oproc.getExecString() != null) {
    String execString=oproc.getExecString().trim();
    String execCommand="";
    String command="";
    for (    String oneCmd : execString.split(";")) {
      if (StringUtils.endsWith(oneCmd,"\\")) {
        command+=StringUtils.chop(oneCmd) + ";";
        continue;
      }
 else {
        command+=oneCmd;
      }
      if (StringUtils.isBlank(command)) {
        continue;
      }
      execCommand+=command + ";\n";
      command="";
    }
    sqlLineInput=new ByteArrayInputStream(execCommand.getBytes());
  }
  List<String> argList=new ArrayList<String>();
  argList.add("-u");
  argList.add(jdbcURL);
  argList.add("-d");
  argList.add(HIVE_JDBC_DRIVER);
  if (oproc.getpMode() == PrintMode.SILENT) {
    argList.add(SQLLINE_SILENT);
  }
 else   if (oproc.getpMode() == PrintMode.VERBOSE) {
    argList.add(SQLLINE_VERBOSE);
  }
  SqlLine.mainWithInputRedirection(argList.toArray(new String[0]),sqlLineInput);
}
