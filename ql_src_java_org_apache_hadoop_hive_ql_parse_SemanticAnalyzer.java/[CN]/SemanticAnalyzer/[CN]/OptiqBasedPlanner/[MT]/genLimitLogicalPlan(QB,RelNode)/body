{
  HiveRel sortRel=null;
  QBParseInfo qbp=getQBParseInfo(qb);
  Integer limit=qbp.getDestToLimit().get(qbp.getClauseNames().iterator().next());
  if (limit != null) {
    RexNode fetch=m_cluster.getRexBuilder().makeExactLiteral(BigDecimal.valueOf(limit));
    RelTraitSet traitSet=m_cluster.traitSetOf(HiveRel.CONVENTION);
    RelCollation canonizedCollation=traitSet.canonize(RelCollationImpl.EMPTY);
    sortRel=new HiveSortRel(m_cluster,traitSet,srcRel,canonizedCollation,null,fetch);
    RowResolver outputRR=new RowResolver();
    RowResolver.add(outputRR,m_relToHiveRR.get(srcRel),0);
    ImmutableMap<String,Integer> hiveColNameOptiqPosMap=buildHiveToOptiqColumnMap(outputRR,sortRel);
    m_relToHiveRR.put(sortRel,outputRR);
    m_relToHiveColNameOptiqPosMap.put(sortRel,hiveColNameOptiqPosMap);
  }
  return sortRel;
}
