{
  HiveRel sortRel=null;
  QBParseInfo qbp=getQBParseInfo(qb);
  Integer limit=qbp.getDestToLimit().get(qbp.getClauseNames().iterator().next());
  if (limit != null) {
    RexNode fetch=cluster.getRexBuilder().makeExactLiteral(BigDecimal.valueOf(limit));
    RelTraitSet traitSet=cluster.traitSetOf(HiveRel.CONVENTION);
    RelCollation canonizedCollation=traitSet.canonize(RelCollationImpl.EMPTY);
    sortRel=new HiveSortRel(cluster,traitSet,srcRel,canonizedCollation,null,fetch);
    RowResolver outputRR=new RowResolver();
    if (!RowResolver.add(outputRR,relToHiveRR.get(srcRel))) {
      throw new OptiqSemanticException("Duplicates detected when adding columns to RR: see previous message");
    }
    ImmutableMap<String,Integer> hiveColNameOptiqPosMap=buildHiveToOptiqColumnMap(outputRR,sortRel);
    relToHiveRR.put(sortRel,outputRR);
    relToHiveColNameOptiqPosMap.put(sortRel,hiveColNameOptiqPosMap);
  }
  return sortRel;
}
