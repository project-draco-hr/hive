{
  basePlan=hepPlan(basePlan,true,mdProvider,new PushFilterPastProjectRule(FilterRelBase.class,HiveFilterRel.DEFAULT_FILTER_FACTORY,HiveProjectRel.class,HiveProjectRel.DEFAULT_PROJECT_FACTORY),new PushFilterPastSetOpRule(HiveFilterRel.DEFAULT_FILTER_FACTORY),new MergeFilterRule(HiveFilterRel.DEFAULT_FILTER_FACTORY),HivePushFilterPastJoinRule.JOIN,HivePushFilterPastJoinRule.FILTER_ON_JOIN);
  basePlan=hepPlan(basePlan,false,mdProvider,new TransitivePredicatesOnJoinRule(JoinRelBase.class,HiveFilterRel.DEFAULT_FILTER_FACTORY),RemoveTrivialProjectRule.INSTANCE,new HivePartitionPrunerRule(SemanticAnalyzer.this.conf));
  HiveRelFieldTrimmer fieldTrimmer=new HiveRelFieldTrimmer(null);
  basePlan=fieldTrimmer.trim(basePlan);
  return basePlan;
}
