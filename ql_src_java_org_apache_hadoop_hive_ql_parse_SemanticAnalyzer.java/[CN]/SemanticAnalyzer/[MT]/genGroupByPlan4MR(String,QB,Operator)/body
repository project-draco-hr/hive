{
  QBParseInfo parseInfo=qb.getParseInfo();
  Operator groupByOperatorInfo=genGroupByPlanMapGroupByOperator(qb,dest,inputOperatorInfo,groupByDesc.Mode.HASH);
  if (!optimizeMapAggrGroupBy(dest,qb)) {
    Operator reduceSinkOperatorInfo=genGroupByPlanReduceSinkOperator(parseInfo,dest,groupByOperatorInfo);
    Operator groupByOperatorInfo2=genGroupByPlanGroupByOperator1(parseInfo,dest,reduceSinkOperatorInfo,groupByDesc.Mode.PARTIAL2);
    Operator reduceSinkOperatorInfo2=genGroupByPlanReduceSinkOperator2MR(parseInfo,dest,groupByOperatorInfo2,getGroupByForClause(parseInfo,dest).size());
    return genGroupByPlanGroupByOperator2MR(parseInfo,dest,reduceSinkOperatorInfo2,groupByDesc.Mode.FINAL);
  }
 else {
    Operator reduceSinkOperatorInfo=genGroupByPlanReduceSinkOperator(parseInfo,dest,groupByOperatorInfo,1);
    return genGroupByPlanGroupByOperator2MR(parseInfo,dest,reduceSinkOperatorInfo,groupByDesc.Mode.FINAL);
  }
}
