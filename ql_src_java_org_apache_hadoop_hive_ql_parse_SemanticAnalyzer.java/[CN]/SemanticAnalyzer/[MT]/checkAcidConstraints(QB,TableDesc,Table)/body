{
  String tableName=tableDesc.getTableName();
  if (!qb.getParseInfo().isInsertIntoTable(tableName)) {
    LOG.debug("Couldn't find table " + tableName + " in insertIntoTable");
    throw new SemanticException(ErrorMsg.NO_INSERT_OVERWRITE_WITH_ACID.getMsg());
  }
  LOG.info("Modifying config values for ACID write");
  conf.setBoolVar(ConfVars.HIVEOPTREDUCEDEDUPLICATION,true);
  conf.setIntVar(ConfVars.HIVEOPTREDUCEDEDUPLICATIONMINREDUCER,1);
  conf.set(AcidUtils.CONF_ACID_KEY,"true");
  conf.setBoolVar(ConfVars.HIVEOPTSORTDYNAMICPARTITION,false);
  if (table.getNumBuckets() < 1) {
    throw new SemanticException(ErrorMsg.ACID_OP_ON_NONACID_TABLE,table.getTableName());
  }
  if (table.getSortCols() != null && table.getSortCols().size() > 0) {
    throw new SemanticException(ErrorMsg.ACID_NO_SORTED_BUCKETS,table.getTableName());
  }
}
