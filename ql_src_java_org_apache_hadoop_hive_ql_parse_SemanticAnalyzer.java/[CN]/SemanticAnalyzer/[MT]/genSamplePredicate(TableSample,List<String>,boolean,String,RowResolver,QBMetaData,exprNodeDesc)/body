{
  exprNodeDesc numeratorExpr=new exprNodeConstantDesc(TypeInfoFactory.intTypeInfo,Integer.valueOf(ts.getNumerator() - 1));
  exprNodeDesc denominatorExpr=new exprNodeConstantDesc(TypeInfoFactory.intTypeInfo,Integer.valueOf(ts.getDenominator()));
  exprNodeDesc intMaxExpr=new exprNodeConstantDesc(TypeInfoFactory.intTypeInfo,Integer.valueOf(Integer.MAX_VALUE));
  ArrayList<exprNodeDesc> args=new ArrayList<exprNodeDesc>();
  if (planExpr != null)   args.add(planExpr);
 else   if (useBucketCols) {
    for (    String col : bucketCols) {
      ColumnInfo ci=rwsch.get(alias,col);
      args.add(new exprNodeColumnDesc(ci.getType(),ci.getInternalName(),ci.getTabAlias(),ci.getIsPartitionCol()));
    }
  }
 else {
    for (    ASTNode expr : ts.getExprs()) {
      args.add(genExprNodeDesc(expr,rwsch));
    }
  }
  exprNodeDesc equalsExpr=null;
{
    exprNodeDesc hashfnExpr=new exprNodeGenericFuncDesc(TypeInfoFactory.intTypeInfo,new GenericUDFHash(),args);
    assert(hashfnExpr != null);
    LOG.info("hashfnExpr = " + hashfnExpr);
    exprNodeDesc andExpr=TypeCheckProcFactory.DefaultExprProcessor.getFuncExprNodeDesc("&",hashfnExpr,intMaxExpr);
    assert(andExpr != null);
    LOG.info("andExpr = " + andExpr);
    exprNodeDesc modExpr=TypeCheckProcFactory.DefaultExprProcessor.getFuncExprNodeDesc("%",andExpr,denominatorExpr);
    assert(modExpr != null);
    LOG.info("modExpr = " + modExpr);
    LOG.info("numeratorExpr = " + numeratorExpr);
    equalsExpr=TypeCheckProcFactory.DefaultExprProcessor.getFuncExprNodeDesc("==",modExpr,numeratorExpr);
    LOG.info("equalsExpr = " + equalsExpr);
    assert(equalsExpr != null);
  }
  return equalsExpr;
}
