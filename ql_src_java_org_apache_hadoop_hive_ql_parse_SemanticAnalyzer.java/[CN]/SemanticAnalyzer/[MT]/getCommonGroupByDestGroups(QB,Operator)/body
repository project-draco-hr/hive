{
  RowResolver inputRR=opParseCtx.get(input).getRowResolver();
  QBParseInfo qbp=qb.getParseInfo();
  TreeSet<String> ks=new TreeSet<String>();
  ks.addAll(qbp.getClauseNames());
  List<List<String>> commonGroupByDestGroups=new ArrayList<List<String>>();
  if (ks.size() <= 1) {
    List<String> oneList=new ArrayList<String>(1);
    if (ks.size() == 1) {
      oneList.add(ks.first());
    }
    commonGroupByDestGroups.add(oneList);
    return commonGroupByDestGroups;
  }
  List<List<ExprNodeDesc.ExprNodeDescEqualityWrapper>> sprayKeyLists=new ArrayList<List<ExprNodeDesc.ExprNodeDescEqualityWrapper>>(ks.size());
  for (  String dest : ks) {
    List<ExprNodeDesc.ExprNodeDescEqualityWrapper> sprayKeys=getDistinctExprs(qbp,dest,inputRR);
    List<ASTNode> grpByExprs=getGroupByForClause(qbp,dest);
    for (    ASTNode grpByExpr : grpByExprs) {
      ExprNodeDesc.ExprNodeDescEqualityWrapper grpByExprWrapper=new ExprNodeDesc.ExprNodeDescEqualityWrapper(genExprNodeDesc(grpByExpr,inputRR));
      if (!sprayKeys.contains(grpByExprWrapper)) {
        sprayKeys.add(grpByExprWrapper);
      }
    }
    boolean found=false;
    for (int i=0; i < sprayKeyLists.size(); i++) {
      if (!matchExprLists(sprayKeyLists.get(i),sprayKeys)) {
        continue;
      }
      commonGroupByDestGroups.get(i).add(dest);
      found=true;
      break;
    }
    if (!found) {
      sprayKeyLists.add(sprayKeys);
      List<String> destGroup=new ArrayList<String>();
      destGroup.add(dest);
      commonGroupByDestGroups.add(destGroup);
    }
  }
  return commonGroupByDestGroups;
}
