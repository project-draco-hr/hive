{
  OpParseContext inputCtx=opParseCtx.get(input);
  RowResolver inputRR=inputCtx.getRowResolver();
  ASTNode whereExpr=qb.getParseInfo().getWhrForClause(dest);
  ASTNode searchCond=(ASTNode)whereExpr.getChild(0);
  List<ASTNode> subQueriesInOriginalTree=SubQueryUtils.findSubQueries(searchCond);
  if (subQueriesInOriginalTree.size() > 0) {
    if (qb.getSubQueryPredicateDef() != null) {
      throw new SemanticException(ErrorMsg.UNSUPPORTED_SUBQUERY_EXPRESSION.getMsg(subQueriesInOriginalTree.get(0),"Nested SubQuery expressions are not supported."));
    }
    if (subQueriesInOriginalTree.size() > 1) {
      throw new SemanticException(ErrorMsg.UNSUPPORTED_SUBQUERY_EXPRESSION.getMsg(subQueriesInOriginalTree.get(1),"Only 1 SubQuery expression is supported."));
    }
    ASTNode clonedSearchCond=(ASTNode)ParseDriver.adaptor.dupTree(searchCond);
    List<ASTNode> subQueries=SubQueryUtils.findSubQueries(clonedSearchCond);
    for (int i=0; i < subQueries.size(); i++) {
      ASTNode subQueryAST=subQueries.get(i);
      ASTNode originalSubQueryAST=subQueriesInOriginalTree.get(i);
      int sqIdx=i + 1;
      clonedSearchCond=SubQueryUtils.rewriteParentQueryWhere(clonedSearchCond,subQueryAST);
      QBSubQuery subQuery=SubQueryUtils.buildSubQuery(qb.getId(),sqIdx,subQueryAST,originalSubQueryAST,ctx);
      subQuery.validateAndRewriteAST(inputRR);
      QB qbSQ=new QB(subQuery.getOuterQueryId(),subQuery.getAlias(),true);
      qbSQ.setSubQueryDef(subQuery);
      Phase1Ctx ctx_1=initPhase1Ctx();
      doPhase1(subQuery.getSubQueryAST(),qbSQ,ctx_1);
      getMetaData(qbSQ);
      Operator sqPlanTopOp=genPlan(qbSQ);
      aliasToOpInfo.put(subQuery.getAlias(),sqPlanTopOp);
      RowResolver sqRR=opParseCtx.get(sqPlanTopOp).getRowResolver();
      if (subQuery.getOperator().getType() != SubQueryType.EXISTS && subQuery.getOperator().getType() != SubQueryType.NOT_EXISTS && sqRR.getColumnInfos().size() - subQuery.getNumOfCorrelationExprsAddedToSQSelect() > 1) {
        throw new SemanticException(ErrorMsg.INVALID_SUBQUERY_EXPRESSION.getMsg(subQueryAST,"SubQuery can contain only 1 item in Select List."));
      }
      subQuery.buildJoinCondition(inputRR,sqRR);
      QBJoinTree joinTree=genSQJoinTree(qb,subQuery,input,aliasToOpInfo);
      pushJoinFilters(qb,joinTree,aliasToOpInfo,false);
      input=genJoinOperator(qbSQ,joinTree,aliasToOpInfo,input);
      searchCond=subQuery.updateOuterQueryFilter(clonedSearchCond);
    }
  }
  return genFilterPlan(qb,searchCond,input);
}
