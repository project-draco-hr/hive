{
  boolean runOptiqPlanner=false;
  if (qb.getIsQuery() && ((queryProperties.getJoinCount() > 1) || conf.getBoolVar(ConfVars.HIVE_IN_TEST)) && !queryProperties.hasClusterBy()&& !queryProperties.hasDistributeBy()&& !queryProperties.hasSortBy()&& !queryProperties.hasPTF()&& !queryProperties.usesScript()&& !queryProperties.hasMultiDestQuery()) {
    runOptiqPlanner=true;
  }
 else {
    LOG.info("Can not invoke CBO; query contains operators not supported for CBO.");
  }
  return runOptiqPlanner;
}
