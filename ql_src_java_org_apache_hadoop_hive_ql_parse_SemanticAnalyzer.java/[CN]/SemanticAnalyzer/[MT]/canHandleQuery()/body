{
  boolean runOptiqPlanner=false;
  if (conf.getBoolVar(ConfVars.HIVE_IN_TEST) || (queryProperties.getJoinCount() > 1) && !queryProperties.hasClusterBy() && !queryProperties.hasDistributeBy()&& !queryProperties.hasSortBy()&& !queryProperties.hasPTF()&& !queryProperties.usesScript()&& !queryProperties.hasMultiDestQuery()&& !queryProperties.hasFilterWithSubQuery()) {
    runOptiqPlanner=true;
  }
 else {
    LOG.info("Can not invoke CBO; query contains operators not supported for CBO.");
  }
  return runOptiqPlanner;
}
