{
  boolean runOptiqPlanner=false;
  if ((queryProperties.getJoinCount() < HiveConf.getIntVar(conf,HiveConf.ConfVars.HIVE_CBO_MAX_JOINS_SUPPORTED)) && !queryProperties.hasClusterBy() && !queryProperties.hasDistributeBy()&& !queryProperties.hasSortBy()&& !queryProperties.hasWindowing()&& !queryProperties.hasPTF()&& !queryProperties.usesScript()&& !queryProperties.hasMultiDestQuery()&& !queryProperties.hasFilterWithSubQuery()) {
    runOptiqPlanner=true;
  }
 else {
    LOG.info("Can not invoke CBO; query contains operators not supported for CBO.");
  }
  return runOptiqPlanner;
}
