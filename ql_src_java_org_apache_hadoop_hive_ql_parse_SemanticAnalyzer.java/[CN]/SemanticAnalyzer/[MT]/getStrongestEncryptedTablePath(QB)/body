{
  List<String> tabAliases=new ArrayList<String>(qb.getTabAliases());
  Path strongestPath=null;
  for (  String alias : tabAliases) {
    Table tab=qb.getMetaData().getTableForAlias(alias);
    if (tab != null) {
      Path tablePath=tab.getDataLocation();
      if (tablePath != null) {
        try {
          if (strongestPath == null) {
            strongestPath=tablePath;
          }
 else           if ("hdfs".equals(tablePath.toUri().getScheme()) && isPathEncrypted(tablePath) && comparePathKeyStrength(tablePath,strongestPath) > 0) {
            strongestPath=tablePath;
          }
        }
 catch (        HiveException e) {
          throw new HiveException("Unable to find the most secure table path: " + e,e);
        }
      }
    }
  }
  return strongestPath;
}
