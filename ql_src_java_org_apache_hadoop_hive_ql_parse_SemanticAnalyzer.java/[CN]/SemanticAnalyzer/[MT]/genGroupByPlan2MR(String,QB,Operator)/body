{
  QBParseInfo parseInfo=qb.getParseInfo();
  Operator reduceSinkOperatorInfo=genGroupByPlanReduceSinkOperator(qb,dest,input,(parseInfo.getDistinctFuncExprForClause(dest) == null ? -1 : Integer.MAX_VALUE),-1,false);
  Operator groupByOperatorInfo=genGroupByPlanGroupByOperator(parseInfo,dest,reduceSinkOperatorInfo,groupByDesc.Mode.PARTIAL1);
  int numReducers=-1;
  List<ASTNode> grpByExprs=getGroupByForClause(parseInfo,dest);
  if (grpByExprs.isEmpty())   numReducers=1;
  Operator reduceSinkOperatorInfo2=genGroupByPlanReduceSinkOperator2MR(parseInfo,dest,groupByOperatorInfo,grpByExprs.size(),numReducers);
  Operator groupByOperatorInfo2=genGroupByPlanGroupByOperator2MR(parseInfo,dest,reduceSinkOperatorInfo2,groupByDesc.Mode.FINAL);
  return groupByOperatorInfo2;
}
