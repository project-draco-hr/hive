{
  RowResolver rr=opParseCtx.get(operator).getRowResolver();
  RowResolver newRR=new RowResolver();
  for (  ColumnInfo colInfo : rr.getColumnInfos()) {
    String name=colInfo.getInternalName();
    String[] tmp=rr.reverseLookup(name);
    if ("".equals(tmp[0]) || tmp[1] == null) {
      tmp[1]=colInfo.getInternalName();
    }
 else     if (newRR.get(alias,tmp[1]) != null) {
      if (!skipAmbiguityCheck) {
        throw new SemanticException(ErrorMsg.AMBIGUOUS_COLUMN.getMsg(tmp[1] + " in " + alias));
      }
      tmp[1]=colInfo.getInternalName();
    }
    newRR.put(alias,tmp[1],colInfo);
  }
  opParseCtx.get(operator).setRowResolver(newRR);
}
