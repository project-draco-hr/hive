{
  ASTNode child=ast;
  this.ast=ast;
  viewsExpanded=new ArrayList<String>();
  ctesExpanded=new ArrayList<String>();
  processPositionAlias(ast);
  if (ast.getToken().getType() == HiveParser.TOK_CREATETABLE) {
    if ((child=analyzeCreateTable(ast,qb,plannerCtx)) == null) {
      return false;
    }
  }
 else {
    SessionState.get().setCommandType(HiveOperation.QUERY);
  }
  if (ast.getToken().getType() == HiveParser.TOK_CREATEVIEW || (ast.getToken().getType() == HiveParser.TOK_ALTERVIEW && ast.getChild(1).getType() == HiveParser.TOK_QUERY)) {
    child=analyzeCreateView(ast,qb);
    SessionState.get().setCommandType(HiveOperation.CREATEVIEW);
    if (child == null) {
      return false;
    }
    viewSelect=child;
    viewsExpanded.add(createVwDesc.getViewName());
  }
  Phase1Ctx ctx_1=initPhase1Ctx();
  if (!doPhase1(child,qb,ctx_1,plannerCtx)) {
    return false;
  }
  LOG.info("Completed phase 1 of Semantic Analysis");
  getMetaData(qb);
  LOG.info("Completed getting MetaData in Semantic Analysis");
  plannerCtx.setParseTreeAttr(child,ctx_1);
  return true;
}
