{
  HiveConf conf=SessionState.get().getConf();
  try {
    FileSystem fs=path.getFileSystem(conf);
    UserGroupInformation ugi=Utils.getUGI();
    FileStatus status=fs.getFileStatus(path);
    FileUtils.checkFileAccessWithImpersonation(fs,status,FsAction.WRITE,ugi.getUserName());
    return false;
  }
 catch (  AccessControlException e) {
    return true;
  }
catch (  Exception e) {
    throw new HiveException("Unable to determine if " + path + " is read only: "+ e,e);
  }
}
