{
  RowResolver reduceSinkInputRowResolver=opParseCtx.get(inputOperatorInfo).getRowResolver();
  QBParseInfo parseInfo=qb.getParseInfo();
  RowResolver reduceSinkOutputRowResolver=new RowResolver();
  reduceSinkOutputRowResolver.setIsExprResolver(true);
  Map<String,ExprNodeDesc> colExprMap=new HashMap<String,ExprNodeDesc>();
  String dest=dests.get(0);
  List<String> outputKeyColumnNames=new ArrayList<String>();
  List<String> outputValueColumnNames=new ArrayList<String>();
  List<ASTNode> grpByExprs=getGroupByForClause(parseInfo,dest);
  ArrayList<ExprNodeDesc> reduceKeys=getReduceKeysForReduceSink(grpByExprs,dest,reduceSinkInputRowResolver,reduceSinkOutputRowResolver,outputKeyColumnNames,colExprMap);
  List<List<Integer>> distinctColIndices=getDistinctColIndicesForReduceSink(parseInfo,dest,reduceKeys,reduceSinkInputRowResolver,reduceSinkOutputRowResolver,outputKeyColumnNames,colExprMap);
  ArrayList<ExprNodeDesc> reduceValues=new ArrayList<ExprNodeDesc>();
  for (  String destination : dests) {
    getReduceValuesForReduceSinkNoMapAgg(parseInfo,destination,reduceSinkInputRowResolver,reduceSinkOutputRowResolver,outputValueColumnNames,reduceValues,colExprMap);
    ASTNode whereClause=parseInfo.getWhrForClause(destination);
    if (whereClause != null) {
      List<ASTNode> columnExprs=getColumnExprsFromASTNode(whereClause,reduceSinkInputRowResolver);
      for (int i=0; i < columnExprs.size(); i++) {
        ASTNode parameter=columnExprs.get(i);
        if (reduceSinkOutputRowResolver.getExpression(parameter) == null) {
          ExprNodeDesc expr=genExprNodeDesc(parameter,reduceSinkInputRowResolver);
          reduceValues.add(expr);
          outputValueColumnNames.add(getColumnInternalName(reduceValues.size() - 1));
          String field=Utilities.ReduceField.VALUE.toString() + "." + getColumnInternalName(reduceValues.size() - 1);
          ColumnInfo colInfo=new ColumnInfo(field,reduceValues.get(reduceValues.size() - 1).getTypeInfo(),null,false);
          reduceSinkOutputRowResolver.putExpression(parameter,colInfo);
          colExprMap.put(colInfo.getInternalName(),expr);
        }
      }
    }
  }
  ReduceSinkOperator rsOp=(ReduceSinkOperator)putOpInsertMap(OperatorFactory.getAndMakeChild(PlanUtils.getReduceSinkDesc(reduceKeys,grpByExprs.size(),reduceValues,distinctColIndices,outputKeyColumnNames,outputValueColumnNames,true,-1,grpByExprs.size(),-1),new RowSchema(reduceSinkOutputRowResolver.getColumnInfos()),inputOperatorInfo),reduceSinkOutputRowResolver);
  rsOp.setColumnExprMap(colExprMap);
  return rsOp;
}
