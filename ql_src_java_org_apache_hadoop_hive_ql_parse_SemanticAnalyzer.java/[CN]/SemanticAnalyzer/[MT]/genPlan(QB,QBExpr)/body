{
  if (qbexpr.getOpcode() == QBExpr.Opcode.NULLOP) {
    boolean skipAmbiguityCheck=viewSelect == null && parent.isTopLevelSelectStarQuery();
    return genPlan(qbexpr.getQB(),skipAmbiguityCheck);
  }
  if (qbexpr.getOpcode() == QBExpr.Opcode.UNION) {
    Operator qbexpr1Ops=genPlan(parent,qbexpr.getQBExpr1());
    Operator qbexpr2Ops=genPlan(parent,qbexpr.getQBExpr2());
    return genUnionPlan(qbexpr.getAlias(),qbexpr.getQBExpr1().getAlias(),qbexpr1Ops,qbexpr.getQBExpr2().getAlias(),qbexpr2Ops);
  }
  return null;
}
