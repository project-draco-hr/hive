{
  List<PTFExpressionDef> partColList=tabDef.getPartition().getExpressions();
  for (  PTFExpressionDef colDef : partColList) {
    ExprNodeDesc exprNode=colDef.getExprNode();
    if (ExprNodeDescUtils.indexOf(exprNode,partCols) < 0) {
      partCols.add(exprNode);
      orderCols.add(exprNode);
      orderString.append('+');
      nullOrderString.append('a');
    }
  }
  List<OrderExpressionDef> orderColList=tabDef.getOrder().getExpressions();
  for (int i=0; i < orderColList.size(); i++) {
    OrderExpressionDef colDef=orderColList.get(i);
    char orderChar=colDef.getOrder() == PTFInvocationSpec.Order.ASC ? '+' : '-';
    char nullOrderChar=colDef.getNullOrder() == PTFInvocationSpec.NullOrder.NULLS_FIRST ? 'a' : 'z';
    int index=ExprNodeDescUtils.indexOf(colDef.getExprNode(),orderCols);
    if (index >= 0) {
      orderString.setCharAt(index,orderChar);
      nullOrderString.setCharAt(index,nullOrderChar);
      continue;
    }
    orderCols.add(colDef.getExprNode());
    orderString.append(orderChar);
    nullOrderString.append(nullOrderChar);
  }
}
