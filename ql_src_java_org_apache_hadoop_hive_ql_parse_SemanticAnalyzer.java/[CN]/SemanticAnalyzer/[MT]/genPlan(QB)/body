{
  HashMap<String,Operator> aliasToOpInfo=new HashMap<String,Operator>();
  for (  String alias : qb.getSubqAliases()) {
    QBExpr qbexpr=qb.getSubqForAlias(alias);
    aliasToOpInfo.put(alias,genPlan(qbexpr));
    qbexpr.setAlias(alias);
  }
  for (  String alias : qb.getTabAliases()) {
    Operator op=genTablePlan(alias,qb);
    aliasToOpInfo.put(alias,op);
  }
  genLateralViewPlans(aliasToOpInfo,qb);
  Operator srcOpInfo=null;
  if (qb.getParseInfo().getJoinExpr() != null) {
    ASTNode joinExpr=qb.getParseInfo().getJoinExpr();
    if (joinExpr.getToken().getType() == HiveParser.TOK_UNIQUEJOIN) {
      QBJoinTree joinTree=genUniqueJoinTree(qb,joinExpr);
      qb.setQbJoinTree(joinTree);
    }
 else {
      QBJoinTree joinTree=genJoinTree(qb,joinExpr);
      qb.setQbJoinTree(joinTree);
      mergeJoinTree(qb);
    }
    pushJoinFilters(qb,qb.getQbJoinTree(),aliasToOpInfo);
    srcOpInfo=genJoinPlan(qb,aliasToOpInfo);
  }
 else {
    srcOpInfo=aliasToOpInfo.values().iterator().next();
  }
  Operator bodyOpInfo=genBodyPlan(qb,srcOpInfo);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Created Plan for Query Block " + qb.getId());
  }
  this.qb=qb;
  return bodyOpInfo;
}
