{
  exprNodeDesc numeratorExpr=new exprNodeConstantDesc(TypeInfoFactory.getPrimitiveTypeInfo(Integer.class),Integer.valueOf(ts.getNumerator() - 1));
  exprNodeDesc denominatorExpr=new exprNodeConstantDesc(TypeInfoFactory.getPrimitiveTypeInfo(Integer.class),Integer.valueOf(ts.getDenominator()));
  exprNodeDesc intMaxExpr=new exprNodeConstantDesc(TypeInfoFactory.getPrimitiveTypeInfo(Integer.class),Integer.valueOf(Integer.MAX_VALUE));
  ArrayList<exprNodeDesc> args=new ArrayList<exprNodeDesc>();
  if (useBucketCols) {
    for (    String col : bucketCols) {
      ColumnInfo ci=rwsch.get(alias,col);
      args.add(new exprNodeColumnDesc(ci.getType().getPrimitiveClass(),ci.getInternalName()));
    }
  }
 else {
    for (    ASTNode expr : ts.getExprs()) {
      args.add(genExprNodeDesc(expr,rwsch));
    }
  }
  exprNodeDesc hashfnExpr=TypeCheckProcFactory.DefaultExprProcessor.getFuncExprNodeDesc("default_sample_hashfn",args);
  assert(hashfnExpr != null);
  LOG.info("hashfnExpr = " + hashfnExpr);
  exprNodeDesc andExpr=TypeCheckProcFactory.DefaultExprProcessor.getFuncExprNodeDesc("&",hashfnExpr,intMaxExpr);
  assert(andExpr != null);
  LOG.info("andExpr = " + andExpr);
  exprNodeDesc modExpr=TypeCheckProcFactory.DefaultExprProcessor.getFuncExprNodeDesc("%",andExpr,denominatorExpr);
  assert(modExpr != null);
  LOG.info("modExpr = " + modExpr);
  LOG.info("numeratorExpr = " + numeratorExpr);
  exprNodeDesc equalsExpr=TypeCheckProcFactory.DefaultExprProcessor.getFuncExprNodeDesc("==",modExpr,numeratorExpr);
  LOG.info("equalsExpr = " + equalsExpr);
  assert(equalsExpr != null);
  return equalsExpr;
}
