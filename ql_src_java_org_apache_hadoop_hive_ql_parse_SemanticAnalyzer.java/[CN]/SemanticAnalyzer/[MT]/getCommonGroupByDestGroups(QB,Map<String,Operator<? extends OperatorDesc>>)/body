{
  QBParseInfo qbp=qb.getParseInfo();
  TreeSet<String> ks=new TreeSet<String>();
  ks.addAll(qbp.getClauseNames());
  List<List<String>> commonGroupByDestGroups=new ArrayList<List<String>>();
  if (ks.size() <= 1) {
    List<String> oneList=new ArrayList<String>(1);
    if (ks.size() == 1) {
      oneList.add(ks.first());
    }
    commonGroupByDestGroups.add(oneList);
    return commonGroupByDestGroups;
  }
  List<Operator<? extends OperatorDesc>> inputOperators=new ArrayList<Operator<? extends OperatorDesc>>(ks.size());
  List<List<ExprNodeDesc>> sprayKeyLists=new ArrayList<List<ExprNodeDesc>>(ks.size());
  for (  String dest : ks) {
    Operator input=inputs.get(dest);
    RowResolver inputRR=opParseCtx.get(input).getRowResolver();
    List<ExprNodeDesc> sprayKeys=getDistinctExprs(qbp,dest,inputRR);
    List<ASTNode> grpByExprs=getGroupByForClause(qbp,dest);
    for (    ASTNode grpByExpr : grpByExprs) {
      ExprNodeDesc exprDesc=genExprNodeDesc(grpByExpr,inputRR);
      if (ExprNodeDescUtils.indexOf(exprDesc,sprayKeys) < 0) {
        sprayKeys.add(exprDesc);
      }
    }
    boolean found=false;
    for (int i=0; i < sprayKeyLists.size(); i++) {
      if (!input.equals(inputOperators.get(i))) {
        continue;
      }
      if (!matchExprLists(sprayKeyLists.get(i),sprayKeys)) {
        continue;
      }
      commonGroupByDestGroups.get(i).add(dest);
      found=true;
      break;
    }
    if (!found) {
      inputOperators.add(input);
      sprayKeyLists.add(sprayKeys);
      List<String> destGroup=new ArrayList<String>();
      destGroup.add(dest);
      commonGroupByDestGroups.add(destGroup);
    }
  }
  return commonGroupByDestGroups;
}
