{
  boolean tableSamplePresent=false;
  int aliasIndex=0;
  if (tabref.getChildCount() == 2) {
    CommonTree ct=(CommonTree)tabref.getChild(1);
    if (ct.getToken().getType() == HiveParser.TOK_TABLESAMPLE) {
      tableSamplePresent=true;
    }
 else {
      aliasIndex=1;
    }
  }
 else   if (tabref.getChildCount() == 3) {
    aliasIndex=2;
    tableSamplePresent=true;
  }
  CommonTree tableTree=(CommonTree)(tabref.getChild(0));
  String alias=tabref.getChild(aliasIndex).getText();
  if (qb.exists(alias)) {
    throw new SemanticException(ErrorMsg.AMBIGOUS_TABLE_ALIAS.getMsg(tabref.getChild(aliasIndex)));
  }
  if (tableSamplePresent) {
    CommonTree sampleClause=(CommonTree)tabref.getChild(1);
    ArrayList<String> sampleCols=new ArrayList<String>();
    if (sampleClause.getChildCount() > 2) {
      for (int i=2; i < sampleClause.getChildCount(); i++) {
        sampleCols.add(sampleClause.getChild(i).getText());
      }
    }
    if (sampleCols.size() > 2) {
      throw new SemanticException(ErrorMsg.SAMPLE_RESTRICTION.getMsg(tabref.getChild(0)));
    }
    qb.getParseInfo().setTabSample(alias,new TableSample(sampleClause.getChild(0).getText(),sampleClause.getChild(1).getText(),sampleCols));
  }
  String table_name=tabref.getChild(0).getText();
  qb.setTabAlias(alias,table_name);
  qb.getParseInfo().setSrcForAlias(alias,tableTree);
}
