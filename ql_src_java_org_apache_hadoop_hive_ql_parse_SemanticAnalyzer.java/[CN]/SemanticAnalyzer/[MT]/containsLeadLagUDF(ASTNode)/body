{
  int exprTokenType=expressionTree.getToken().getType();
  if (exprTokenType == HiveParser.TOK_FUNCTION) {
    assert(expressionTree.getChildCount() != 0);
    if (expressionTree.getChild(0).getType() == HiveParser.Identifier) {
      String functionName=unescapeIdentifier(expressionTree.getChild(0).getText());
      functionName=functionName.toLowerCase();
      if (FunctionRegistry.LAG_FUNC_NAME.equals(functionName) || FunctionRegistry.LEAD_FUNC_NAME.equals(functionName)) {
        return true;
      }
    }
  }
  for (int i=0; i < expressionTree.getChildCount(); i++) {
    if (containsLeadLagUDF((ASTNode)expressionTree.getChild(i))) {
      return true;
    }
  }
  return false;
}
