{
  String tableName=getUnescapedName((ASTNode)tree.getChild(0).getChild(0));
  Table tbl;
  try {
    tbl=db.getTable(tableName);
  }
 catch (  InvalidTableException e) {
    throw new SemanticException(ErrorMsg.INVALID_TABLE.getMsg(tableName),e);
  }
catch (  HiveException e) {
    throw new SemanticException(e.getMessage(),e);
  }
  if (tbl.isNonNative()) {
    throw new SemanticException(ErrorMsg.ANALYZE_TABLE_PARTIALSCAN_NON_NATIVE.getMsg(tbl.getTableName()));
  }
  if (tbl.getTableType().equals(TableType.EXTERNAL_TABLE)) {
    throw new SemanticException(ErrorMsg.ANALYZE_TABLE_PARTIALSCAN_EXTERNAL_TABLE.getMsg(tbl.getTableName()));
  }
  if (!HiveConf.getBoolVar(conf,HiveConf.ConfVars.HIVESTATSAUTOGATHER)) {
    throw new SemanticException(ErrorMsg.ANALYZE_TABLE_PARTIALSCAN_AUTOGATHER.getMsg());
  }
}
