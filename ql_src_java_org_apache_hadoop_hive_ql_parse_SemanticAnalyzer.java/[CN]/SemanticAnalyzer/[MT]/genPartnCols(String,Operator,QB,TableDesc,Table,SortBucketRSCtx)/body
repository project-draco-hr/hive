{
  boolean enforceBucketing=false;
  boolean enforceSorting=false;
  ArrayList<ExprNodeDesc> partnColsNoConvert=new ArrayList<ExprNodeDesc>();
  if ((dest_tab.getNumBuckets() > 0) && (conf.getBoolVar(HiveConf.ConfVars.HIVEENFORCEBUCKETING))) {
    enforceBucketing=true;
    if (updating() || deleting()) {
      partnColsNoConvert=getPartitionColsFromBucketColsForUpdateDelete(input,false);
    }
 else {
      partnColsNoConvert=getPartitionColsFromBucketCols(dest,qb,dest_tab,table_desc,input,false);
    }
  }
  if ((dest_tab.getSortCols() != null) && (dest_tab.getSortCols().size() > 0) && (conf.getBoolVar(HiveConf.ConfVars.HIVEENFORCESORTING))) {
    enforceSorting=true;
    if (!enforceBucketing) {
      partnColsNoConvert=getSortCols(dest,qb,dest_tab,table_desc,input,false);
    }
  }
  if (enforceBucketing || enforceSorting) {
    ctx.setPartnCols(partnColsNoConvert);
  }
}
