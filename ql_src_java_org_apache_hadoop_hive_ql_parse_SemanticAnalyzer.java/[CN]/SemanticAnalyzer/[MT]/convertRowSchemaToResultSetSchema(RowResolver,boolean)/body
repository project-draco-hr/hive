{
  List<FieldSchema> fieldSchemas=new ArrayList<FieldSchema>();
  String[] qualifiedColName;
  String colName;
  for (  ColumnInfo colInfo : rr.getColumnInfos()) {
    if (colInfo.isHiddenVirtualCol()) {
      continue;
    }
    qualifiedColName=rr.reverseLookup(colInfo.getInternalName());
    if (useTabAliasIfAvailable && qualifiedColName[0] != null && !qualifiedColName[0].isEmpty()) {
      colName=qualifiedColName[0] + "." + qualifiedColName[1];
    }
 else {
      colName=qualifiedColName[1];
    }
    fieldSchemas.add(new FieldSchema(colName,colInfo.getType().getTypeName(),null));
  }
  return fieldSchemas;
}
