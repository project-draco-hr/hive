{
  if (node.getType() == HiveParser.TOK_PTBLFUNCTION) {
    return unescapeIdentifier(node.getChild(1).getText().toLowerCase());
  }
  if (node.getChildCount() == 1) {
    return tableName;
  }
  for (int i=node.getChildCount() - 1; i >= 1; i--) {
    if (node.getChild(i).getType() == HiveParser.Identifier) {
      return unescapeIdentifier(node.getChild(i).getText().toLowerCase());
    }
  }
  return tableName;
}
