{
  if (!qbp.isAnalyzeCommand()) {
    tsDesc.setGatherStats(false);
  }
 else {
    tsDesc.setGatherStats(true);
    String tblName=tab.getTableName();
    tableSpec tblSpec=qbp.getTableSpec(alias);
    Map<String,String> partSpec=tblSpec.getPartSpec();
    if (partSpec != null) {
      List<String> cols=new ArrayList<String>();
      cols.addAll(partSpec.keySet());
      tsDesc.setPartColumns(cols);
    }
    String k=tblName + Path.SEPARATOR;
    tsDesc.setStatsAggPrefix(k);
    outputs.add(new WriteEntity(tab,true));
    if (tab.isPartitioned()) {
      if (partSpec == null) {
        throw new SemanticException(ErrorMsg.NEED_PARTITION_SPECIFICATION.getMsg());
      }
      List<Partition> partitions=qbp.getTableSpec().partitions;
      if (partitions != null) {
        for (        Partition partn : partitions) {
          outputs.add(new WriteEntity(partn,true));
        }
      }
    }
  }
}
