{
  String colAlias=null;
  String tabAlias=null;
  String[] colRef=new String[2];
  if (selExpr.getChildCount() == 2) {
    colAlias=unescapeIdentifier(selExpr.getChild(1).getText());
    colRef[0]=tabAlias;
    colRef[1]=colAlias;
    return colRef;
  }
  ASTNode root=(ASTNode)selExpr.getChild(0);
  if (root.getType() == HiveParser.TOK_COLREF && root.getChildCount() > 1) {
    ASTNode tab=(ASTNode)root.getChild(0);
    tabAlias=unescapeIdentifier(tab.getText());
  }
  while (root.getType() == HiveParser.DOT || root.getType() == HiveParser.TOK_COLREF) {
    if (root.getType() == HiveParser.TOK_COLREF && root.getChildCount() == 1) {
      root=(ASTNode)root.getChild(0);
    }
 else {
      assert(root.getChildCount() == 2);
      root=(ASTNode)root.getChild(1);
    }
  }
  if (root.getType() == HiveParser.Identifier) {
    colAlias=unescapeIdentifier(root.getText());
  }
  if (colAlias == null) {
    colAlias=defaultName;
  }
  colRef[0]=tabAlias;
  colRef[1]=colAlias;
  return colRef;
}
