{
  if ((confOverlay != null && !confOverlay.isEmpty())) {
    conf=(conf == null ? new HiveConf() : new HiveConf(conf));
    for (    Map.Entry<String,String> confEntry : confOverlay.entrySet()) {
      try {
        conf.verifyAndSet(confEntry.getKey(),confEntry.getValue());
      }
 catch (      IllegalArgumentException e) {
        throw new RuntimeException("Error applying statement specific settings",e);
      }
    }
  }
 else   if (runAsync) {
    conf=(conf == null ? new HiveConf() : new HiveConf(conf));
  }
  if (conf == null) {
    conf=new HiveConf();
  }
  conf.setVar(HiveConf.ConfVars.HIVEQUERYID,QueryPlan.makeQueryId());
  return conf;
}
