{
  Path partPath=new Path(table.getTTable().getSd().getLocation());
  if (!customDynamicLocationUsed) {
    for (    FieldSchema partKey : table.getPartitionKeys()) {
      partPath=constructPartialPartPath(partPath,partKey.getName().toLowerCase(),partKVs);
    }
    return partPath.toString();
  }
 else {
    if (jobInfo.getCustomDynamicRoot() != null && jobInfo.getCustomDynamicRoot().length() > 0) {
      partPath=new Path(partPath,jobInfo.getCustomDynamicRoot());
    }
    return new Path(partPath,HCatFileUtil.resolveCustomPath(jobInfo,partKVs,false)).toString();
  }
}
