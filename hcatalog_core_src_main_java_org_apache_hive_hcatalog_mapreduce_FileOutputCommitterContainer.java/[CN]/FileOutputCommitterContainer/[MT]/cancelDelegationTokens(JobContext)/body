{
  LOG.info("Cancelling delegation token for the job.");
  IMetaStoreClient client=null;
  try {
    HiveConf hiveConf=HCatUtil.getHiveConf(context.getConfiguration());
    client=HCatUtil.getHiveMetastoreClient(hiveConf);
    String tokenStrForm=client.getTokenStrForm();
    if (tokenStrForm != null && context.getConfiguration().get(HCatConstants.HCAT_KEY_TOKEN_SIGNATURE) != null) {
      client.cancelDelegationToken(tokenStrForm);
    }
  }
 catch (  MetaException e) {
    LOG.warn("MetaException while cancelling delegation token.",e);
  }
catch (  TException e) {
    LOG.warn("TException while cancelling delegation token.",e);
  }
 finally {
    HCatUtil.closeHiveClientQuietly(client);
  }
}
