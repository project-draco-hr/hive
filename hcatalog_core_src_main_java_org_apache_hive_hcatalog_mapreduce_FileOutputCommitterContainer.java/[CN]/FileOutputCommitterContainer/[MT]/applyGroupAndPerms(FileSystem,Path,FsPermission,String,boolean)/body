{
  if (LOG.isDebugEnabled()) {
    LOG.debug("applyGroupAndPerms : " + dir + " perms: "+ permission+ " group: "+ group+ " recursive: "+ recursive);
  }
  fs.setPermission(dir,permission);
  if (recursive) {
    for (    FileStatus fileStatus : fs.listStatus(dir)) {
      if (fileStatus.isDir()) {
        applyGroupAndPerms(fs,fileStatus.getPath(),permission,group,true);
      }
 else {
        fs.setPermission(fileStatus.getPath(),permission);
      }
    }
  }
}
