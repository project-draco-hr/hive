{
  super(context,baseCommitter);
  jobInfo=HCatOutputFormat.getJobInfo(context.getConfiguration());
  dynamicPartitioningUsed=jobInfo.isDynamicPartitioningUsed();
  this.partitionsDiscovered=!dynamicPartitioningUsed;
  cachedStorageHandler=HCatUtil.getStorageHandler(context.getConfiguration(),jobInfo.getTableInfo().getStorerInfo());
  Table table=new Table(jobInfo.getTableInfo().getTable());
  if (dynamicPartitioningUsed && Boolean.valueOf((String)table.getProperty("EXTERNAL")) && jobInfo.getCustomDynamicPath() != null && jobInfo.getCustomDynamicPath().length() > 0) {
    customDynamicLocationUsed=true;
  }
 else {
    customDynamicLocationUsed=false;
  }
}
