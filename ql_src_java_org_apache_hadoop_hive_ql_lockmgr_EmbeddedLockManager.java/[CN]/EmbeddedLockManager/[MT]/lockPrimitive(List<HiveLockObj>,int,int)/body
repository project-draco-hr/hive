{
  List<HiveLock> locks=new ArrayList<HiveLock>();
  for (  HiveLockObj obj : objs) {
    HiveLock lock=lockPrimitive(obj.getObj(),obj.getMode());
    if (lock == null) {
      releaseLocks(locks,numRetriesForLock,sleepTime);
      return null;
    }
    locks.add(lock);
  }
  return locks;
}
