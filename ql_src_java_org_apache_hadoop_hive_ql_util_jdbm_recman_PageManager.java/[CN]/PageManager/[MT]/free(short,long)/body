{
  if (type == Magic.FREE_PAGE) {
    throw new Error("free free page?");
  }
  if (recid == 0) {
    throw new Error("free header page?");
  }
  BlockIo buf=file.get(recid);
  PageHeader pageHdr=PageHeader.getView(buf);
  long prev=pageHdr.getPrev();
  long next=pageHdr.getNext();
  pageHdr.setType(Magic.FREE_PAGE);
  pageHdr.setNext(header.getFirstOf(Magic.FREE_PAGE));
  pageHdr.setPrev(0);
  header.setFirstOf(Magic.FREE_PAGE,recid);
  file.release(recid,true);
  if (prev != 0) {
    buf=file.get(prev);
    pageHdr=PageHeader.getView(buf);
    pageHdr.setNext(next);
    file.release(prev,true);
  }
 else {
    header.setFirstOf(type,next);
  }
  if (next != 0) {
    buf=file.get(next);
    pageHdr=PageHeader.getView(buf);
    pageHdr.setPrev(prev);
    file.release(next,true);
  }
 else {
    header.setLastOf(type,prev);
  }
}
