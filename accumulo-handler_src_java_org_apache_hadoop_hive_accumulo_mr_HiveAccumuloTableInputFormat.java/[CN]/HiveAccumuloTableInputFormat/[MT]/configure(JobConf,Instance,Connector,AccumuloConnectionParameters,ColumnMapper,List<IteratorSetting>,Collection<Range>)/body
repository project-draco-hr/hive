{
  if (instance instanceof MockInstance) {
    setMockInstance(conf,instance.getInstanceName());
  }
 else {
    setZooKeeperInstance(conf,instance.getInstanceName(),instance.getZooKeepers());
  }
  setConnectorInfo(conf,accumuloParams.getAccumuloUserName(),new PasswordToken(accumuloParams.getAccumuloPassword()));
  setInputTableName(conf,accumuloParams.getAccumuloTableName());
  Authorizations auths=AccumuloSerDeParameters.getAuthorizationsFromConf(conf);
  if (null == auths) {
    auths=connector.securityOperations().getUserAuthorizations(accumuloParams.getAccumuloUserName());
  }
  setScanAuthorizations(conf,auths);
  addIterators(conf,iterators);
  if (null != ranges) {
    log.info("Setting ranges: " + ranges);
    setRanges(conf,ranges);
  }
  HashSet<Pair<Text,Text>> pairs=getPairCollection(columnMapper.getColumnMappings());
  if (null != pairs && !pairs.isEmpty()) {
    fetchColumns(conf,pairs);
  }
}
