{
  final String defaultStorageType=conf.get(AccumuloSerDeParameters.DEFAULT_STORAGE_TYPE);
  String[] columnNamesArr=conf.getStrings(serdeConstants.LIST_COLUMNS);
  if (null == columnNamesArr) {
    throw new IOException("Hive column names must be provided to InputFormat in the Configuration");
  }
  List<String> columnNames=Arrays.asList(columnNamesArr);
  String serializedTypes=conf.get(serdeConstants.LIST_COLUMN_TYPES);
  if (null == serializedTypes) {
    throw new IOException("Hive column types must be provided to InputFormat in the Configuration");
  }
  ArrayList<TypeInfo> columnTypes=TypeInfoUtils.getTypeInfosFromTypeString(serializedTypes);
  return new ColumnMapper(conf.get(AccumuloSerDeParameters.COLUMN_MAPPINGS),defaultStorageType,columnNames,columnTypes);
}
