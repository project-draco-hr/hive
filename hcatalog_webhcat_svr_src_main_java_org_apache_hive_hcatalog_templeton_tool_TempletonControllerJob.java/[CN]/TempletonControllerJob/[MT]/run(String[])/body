{
  Configuration conf=getConf();
  conf.set(JAR_ARGS_NAME,TempletonUtils.encodeArray(args));
  String user=UserGroupInformation.getCurrentUser().getShortUserName();
  conf.set("user.name",user);
  Job job=new Job(conf);
  job.setJarByClass(TempletonControllerJob.class);
  job.setJobName("TempletonControllerJob");
  job.setMapperClass(LaunchMapper.class);
  job.setMapOutputKeyClass(Text.class);
  job.setMapOutputValueClass(Text.class);
  job.setInputFormatClass(SingleInputFormat.class);
  NullOutputFormat<NullWritable,NullWritable> of=new NullOutputFormat<NullWritable,NullWritable>();
  job.setOutputFormatClass(of.getClass());
  job.setNumReduceTasks(0);
  JobClient jc=new JobClient(new JobConf(job.getConfiguration()));
  Token<DelegationTokenIdentifier> mrdt=jc.getDelegationToken(new Text("mr token"));
  job.getCredentials().addToken(new Text("mr token"),mrdt);
  String metastoreTokenStrForm=addHMSToken(job,user);
  job.submit();
  submittedJobId=job.getJobID();
  if (metastoreTokenStrForm != null) {
    DelegationTokenCache.getStringFormTokenCache().storeDelegationToken(submittedJobId.toString(),metastoreTokenStrForm);
    LOG.debug("Added metastore delegation token for jobId=" + submittedJobId.toString() + " "+ "user="+ user);
  }
  return 0;
}
