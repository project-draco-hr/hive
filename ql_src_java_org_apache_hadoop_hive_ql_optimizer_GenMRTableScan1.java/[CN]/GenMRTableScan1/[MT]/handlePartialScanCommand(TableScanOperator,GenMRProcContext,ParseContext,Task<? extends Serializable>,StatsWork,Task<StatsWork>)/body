{
  String aggregationKey=op.getConf().getStatsAggPrefix();
  StringBuilder aggregationKeyBuffer=new StringBuilder(aggregationKey);
  List<Path> inputPaths=GenMapRedUtils.getInputPathsForPartialScan(op,aggregationKeyBuffer);
  aggregationKey=aggregationKeyBuffer.toString();
  PartialScanWork scanWork=new PartialScanWork(inputPaths);
  scanWork.setMapperCannotSpanPartns(true);
  scanWork.setAggKey(aggregationKey);
  scanWork.setStatsTmpDir(op.getConf().getTmpStatsDir(),parseCtx.getConf());
  statsWork.setPartialScanAnalyzeCommand(true);
  DriverContext driverCxt=new DriverContext();
  Task<PartialScanWork> psTask=TaskFactory.get(scanWork,parseCtx.getConf());
  psTask.initialize(parseCtx.getConf(),null,driverCxt,op.getCompilationOpContext());
  psTask.setWork(scanWork);
  ctx.getRootTasks().remove(currTask);
  ctx.getRootTasks().add(psTask);
  psTask.addDependentTask(statsTask);
  List<Task<? extends Serializable>> parentTasks=new ArrayList<Task<? extends Serializable>>();
  parentTasks.add(psTask);
  statsTask.setParentTasks(parentTasks);
}
