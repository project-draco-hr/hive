{
  TypeDescription schema=TypeDescription.createLong();
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(100000).bufferSize(10000).encodingStrategy(encodingStrategy));
  VectorizedRowBatch batch=schema.createRowBatch();
  appendLong(batch,-7486502418706614742L);
  appendLong(batch,0L);
  appendLong(batch,1L);
  appendLong(batch,1L);
  appendLong(batch,-5535739865598783616L);
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  batch=reader.getSchema().createRowBatch();
  assertEquals(true,rows.nextBatch(batch));
  assertEquals(5,batch.size);
  assertEquals(-7486502418706614742L,((LongColumnVector)batch.cols[0]).vector[0]);
  assertEquals(0L,((LongColumnVector)batch.cols[0]).vector[1]);
  assertEquals(1L,((LongColumnVector)batch.cols[0]).vector[2]);
  assertEquals(1L,((LongColumnVector)batch.cols[0]).vector[3]);
  assertEquals(-5535739865598783616L,((LongColumnVector)batch.cols[0]).vector[4]);
  assertEquals(false,rows.nextBatch(batch));
}
