{
  TypeDescription schema=TypeDescription.createStruct().addField("ts",TypeDescription.createTimestamp());
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(100000).bufferSize(10000).encodingStrategy(encodingStrategy));
  VectorizedRowBatch batch=schema.createRowBatch();
  List<Timestamp> tslist=Lists.newArrayList();
  tslist.add(Timestamp.valueOf("2099-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2003-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("1999-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("1995-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2002-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2010-03-02 00:00:00"));
  tslist.add(Timestamp.valueOf("2005-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2006-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2003-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("1996-08-02 00:00:00"));
  tslist.add(Timestamp.valueOf("1998-11-02 00:00:00"));
  tslist.add(Timestamp.valueOf("2008-10-02 00:00:00"));
  tslist.add(Timestamp.valueOf("1993-08-02 00:00:00"));
  tslist.add(Timestamp.valueOf("2008-01-02 00:00:00"));
  tslist.add(Timestamp.valueOf("2007-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2004-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2008-10-02 00:00:00"));
  tslist.add(Timestamp.valueOf("2003-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2004-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2008-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2005-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("1994-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2006-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2004-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2001-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2000-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2000-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2002-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2006-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2011-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2002-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2005-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("1974-01-01 00:00:00"));
  int idx=0;
  for (  Timestamp ts : tslist) {
    ((TimestampColumnVector)batch.cols[0]).set(idx,ts);
  }
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  batch=reader.getSchema().createRowBatch();
  idx=0;
  while (rows.nextBatch(batch)) {
    for (int r=0; r < batch.size; ++r) {
      assertEquals(tslist.get(idx++),((TimestampColumnVector)batch.cols[0]).asScratchTimestamp(r));
    }
  }
}
