{
  JoinOperator joinOp=(JoinOperator)nd;
  HiveConf conf=((OptimizeSparkProcContext)procCtx).getParseContext().getConf();
  if (!conf.getBoolVar(HiveConf.ConfVars.HIVE_AUTO_SORTMERGE_JOIN)) {
    return null;
  }
  SortBucketJoinProcCtx smbJoinContext=new SortBucketJoinProcCtx(conf);
  boolean convert=canConvertJoinToSMBJoin(joinOp,smbJoinContext,pGraphContext,stack);
  if (convert) {
    return convertJoinToSMBJoinAndReturn(joinOp,smbJoinContext);
  }
  return null;
}
