{
  String pcols=tableDesc.getProperties().getProperty(org.apache.hadoop.hive.metastore.api.hive_metastoreConstants.META_TABLE_PARTITION_COLUMNS);
  String pcolTypes=tableDesc.getProperties().getProperty(org.apache.hadoop.hive.metastore.api.hive_metastoreConstants.META_TABLE_PARTITION_COLUMN_TYPES);
  String[] partKeys=pcols.trim().split("/");
  String[] partKeyTypes=pcolTypes.trim().split(":");
  ObjectInspector[] inspectors=new ObjectInspector[partKeys.length];
  for (int i=0; i < partKeys.length; i++) {
    inspectors[i]=PrimitiveObjectInspectorFactory.getPrimitiveWritableObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(partKeyTypes[i]));
  }
  return ObjectInspectorFactory.getStandardStructObjectInspector(Arrays.asList(partKeys),Arrays.asList(inspectors));
}
