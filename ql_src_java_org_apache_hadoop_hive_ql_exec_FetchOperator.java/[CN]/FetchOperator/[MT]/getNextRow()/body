{
  try {
    while (true) {
      if (context != null) {
        context.resetRow();
      }
      if (currRecReader == null) {
        currRecReader=getRecordReader();
        if (currRecReader == null) {
          return null;
        }
      }
      boolean ret=currRecReader.next(key,value);
      if (ret) {
        if (operator != null && context != null && context.inputFileChanged()) {
          try {
            operator.cleanUpInputFileChanged();
          }
 catch (          HiveException e) {
            throw new IOException(e);
          }
        }
        if (hasVC) {
          vcValues=MapOperator.populateVirtualColumnValues(context,vcCols,vcValues,serde);
          row[isPartitioned ? 2 : 1]=vcValues;
        }
        row[0]=partTblObjectInspectorConverter.convert(serde.deserialize(value));
        if (hasVC || isPartitioned) {
          inspectable.o=row;
          inspectable.oi=rowObjectInspector;
          return inspectable;
        }
        inspectable.o=row[0];
        inspectable.oi=tblSerde.getObjectInspector();
        return inspectable;
      }
 else {
        currRecReader.close();
        currRecReader=null;
      }
    }
  }
 catch (  Exception e) {
    throw new IOException(e);
  }
}
