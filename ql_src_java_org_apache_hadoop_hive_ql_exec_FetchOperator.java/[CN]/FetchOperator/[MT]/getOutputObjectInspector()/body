{
  try {
    if (work.getTblDir() != null) {
      TableDesc tbl=work.getTblDesc();
      Deserializer serde=tbl.getDeserializerClass().newInstance();
      serde.initialize(job,tbl.getProperties());
      return serde.getObjectInspector();
    }
    TableDesc tbl;
    Map<String,String> partSpec;
    List<PartitionDesc> listParts=work.getPartDesc();
    if (listParts == null || listParts.isEmpty()) {
      tbl=work.getTblDesc();
      partSpec=null;
    }
 else {
      currPart=listParts.get(0);
      tbl=currPart.getTableDesc();
      partSpec=currPart.getPartSpec();
    }
    serde=tbl.getDeserializerClass().newInstance();
    serde.initialize(job,tbl.getProperties());
    setPrtnDesc(tbl,partSpec);
    currPart=null;
    return rowObjectInspector;
  }
 catch (  Exception e) {
    throw new HiveException("Failed with exception " + e.getMessage() + org.apache.hadoop.util.StringUtils.stringifyException(e));
  }
}
