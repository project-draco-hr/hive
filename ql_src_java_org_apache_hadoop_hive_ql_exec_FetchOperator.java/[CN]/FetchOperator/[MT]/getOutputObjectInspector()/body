{
  try {
    if (work.isNotPartitioned()) {
      return setTableDesc(work.getTblDesc());
    }
    List<PartitionDesc> listParts=work.getPartDesc();
    if (listParts == null || listParts.isEmpty()) {
      return setPrtnDesc(work.getTblDesc());
    }
    return setPrtnDesc(listParts.get(0));
  }
 catch (  Exception e) {
    throw new HiveException("Failed with exception " + e.getMessage() + org.apache.hadoop.util.StringUtils.stringifyException(e));
  }
 finally {
    currPart=null;
  }
}
