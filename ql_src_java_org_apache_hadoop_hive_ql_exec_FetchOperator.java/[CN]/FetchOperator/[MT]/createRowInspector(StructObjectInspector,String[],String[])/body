{
  List<String> partNames=new ArrayList<String>();
  List<ObjectInspector> partObjectInspectors=new ArrayList<ObjectInspector>();
  for (int i=0; i < partKeys.length; i++) {
    String key=partKeys[i];
    partNames.add(key);
    ObjectInspector oi=TypeInfoUtils.getStandardJavaObjectInspectorFromTypeInfo(TypeInfoFactory.getPrimitiveTypeInfo(partKeyTypes[i]));
    partObjectInspectors.add(oi);
  }
  StructObjectInspector partObjectInspector=ObjectInspectorFactory.getStandardStructObjectInspector(partNames,partObjectInspectors);
  return ObjectInspectorFactory.getUnionStructObjectInspector(hasVC ? Arrays.asList(current,partObjectInspector,vcsOI) : Arrays.asList(current,partObjectInspector));
}
