{
  if (currPath == null) {
    getNextPath();
    if (currPath == null) {
      return null;
    }
    job.set("mapred.input.dir",org.apache.hadoop.util.StringUtils.escapeString(currPath.toString()));
    PartitionDesc tmp;
    if (currTbl == null) {
      tmp=currPart;
    }
 else {
      tmp=new PartitionDesc(currTbl,null);
    }
    inputFormat=getInputFormatFromCache(tmp.getInputFileFormatClass(),job);
    Utilities.copyTableJobPropertiesToConf(tmp.getTableDesc(),job);
    inputSplits=inputFormat.getSplits(job,1);
    splitNum=0;
    serde=tmp.getDeserializerClass().newInstance();
    serde.initialize(job,tmp.getProperties());
    if (LOG.isDebugEnabled()) {
      LOG.debug("Creating fetchTask with deserializer typeinfo: " + serde.getObjectInspector().getTypeName());
      LOG.debug("deserializer properties: " + tmp.getProperties());
    }
    if (currPart != null) {
      setPrtnDesc();
    }
  }
  if (splitNum >= inputSplits.length) {
    if (currRecReader != null) {
      currRecReader.close();
      currRecReader=null;
    }
    currPath=null;
    return getRecordReader();
  }
  currRecReader=inputFormat.getRecordReader(inputSplits[splitNum++],job,Reporter.NULL);
  key=currRecReader.createKey();
  value=currRecReader.createValue();
  return currRecReader;
}
