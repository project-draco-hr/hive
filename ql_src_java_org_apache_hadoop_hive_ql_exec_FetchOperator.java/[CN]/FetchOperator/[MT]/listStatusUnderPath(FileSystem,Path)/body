{
  HiveConf hiveConf=new HiveConf(job,FetchOperator.class);
  boolean recursive=hiveConf.getBoolVar(HiveConf.ConfVars.HADOOPMAPREDINPUTDIRRECURSIVE);
  if (!recursive) {
    return fs.listStatus(p);
  }
  List<FileStatus> results=new ArrayList<FileStatus>();
  for (  FileStatus stat : fs.listStatus(p)) {
    FileUtils.listStatusRecursively(fs,stat,results);
  }
  return results.toArray(new FileStatus[results.size()]);
}
