{
  boolean recursive=job.getBoolean(FileInputFormat.INPUT_DIR_RECURSIVE,false);
  if (!recursive && !AcidUtils.isAcid(p,job)) {
    return fs.listStatus(p,FileUtils.HIDDEN_FILES_PATH_FILTER);
  }
  List<FileStatus> results=new ArrayList<FileStatus>();
  for (  FileStatus stat : fs.listStatus(p,FileUtils.HIDDEN_FILES_PATH_FILTER)) {
    FileUtils.listStatusRecursively(fs,stat,results);
  }
  return results.toArray(new FileStatus[results.size()]);
}
