{
  try {
    byte[] orderedFields=reorderFields(record);
    Object encodedRow=encode(orderedFields);
    int bucket=getBucket(encodedRow);
    getRecordUpdater(bucket).insert(transactionId,encodedRow);
  }
 catch (  IOException e) {
    throw new StreamingIOFailure("Error writing record in transaction (" + transactionId + ")",e);
  }
}
