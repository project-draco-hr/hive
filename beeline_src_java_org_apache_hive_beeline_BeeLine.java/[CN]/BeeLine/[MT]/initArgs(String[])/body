{
  List<String> commands=new LinkedList<String>();
  List<String> files=new LinkedList<String>();
  CommandLine cl;
  BeelineParser beelineParser;
  try {
    beelineParser=new BeelineParser();
    cl=beelineParser.parse(options,args);
  }
 catch (  ParseException e1) {
    output(e1.getMessage());
    return false;
  }
  String driver=null, user=null, pass=null, url=null;
  String auth=null;
  if (cl.hasOption("help")) {
    return false;
  }
  Properties hiveVars=cl.getOptionProperties("hivevar");
  for (  String key : hiveVars.stringPropertyNames()) {
    getOpts().getHiveVariables().put(key,hiveVars.getProperty(key));
  }
  Properties hiveConfs=cl.getOptionProperties("hiveconf");
  for (  String key : hiveConfs.stringPropertyNames()) {
    getOpts().getHiveConfVariables().put(key,hiveConfs.getProperty(key));
  }
  driver=cl.getOptionValue("d");
  auth=cl.getOptionValue("a");
  user=cl.getOptionValue("n");
  getOpts().setAuthType(auth);
  pass=cl.getOptionValue("p");
  url=cl.getOptionValue("u");
  getOpts().setInitFile(cl.getOptionValue("i"));
  getOpts().setScriptFile(cl.getOptionValue("f"));
  if (cl.getOptionValues('e') != null) {
    commands=Arrays.asList(cl.getOptionValues('e'));
  }
  if (url != null) {
    String com="!connect " + url + " "+ (user == null || user.length() == 0 ? "''" : user)+ " "+ (pass == null || pass.length() == 0 ? "''" : pass)+ " "+ (driver == null ? "" : driver);
    debug("issuing: " + com);
    dispatch(com);
  }
  for (Iterator<String> i=files.iterator(); i.hasNext(); ) {
    dispatch("!properties " + i.next());
  }
  if (commands.size() > 0) {
    getOpts().setColor(false);
    getOpts().setHeaderInterval(-1);
    for (Iterator<String> i=commands.iterator(); i.hasNext(); ) {
      String command=i.next().toString();
      debug(loc("executing-command",command));
      dispatch(command);
    }
    exit=true;
  }
  return true;
}
