{
  List<String> commands=Collections.emptyList();
  List<String> files=Collections.emptyList();
  CommandLine cl;
  BeelineParser beelineParser;
  try {
    beelineParser=new BeelineParser();
    cl=beelineParser.parse(options,args);
  }
 catch (  ParseException e1) {
    output(e1.getMessage());
    usage();
    return -1;
  }
  String driver=null, user=null, pass=null, url=null;
  String auth=null;
  if (cl.hasOption("help")) {
    usage();
    return 0;
  }
  Properties hiveVars=cl.getOptionProperties("hivevar");
  for (  String key : hiveVars.stringPropertyNames()) {
    getOpts().getHiveVariables().put(key,hiveVars.getProperty(key));
  }
  Properties hiveConfs=cl.getOptionProperties("hiveconf");
  for (  String key : hiveConfs.stringPropertyNames()) {
    getOpts().getHiveConfVariables().put(key,hiveConfs.getProperty(key));
  }
  driver=cl.getOptionValue("d");
  auth=cl.getOptionValue("a");
  user=cl.getOptionValue("n");
  getOpts().setAuthType(auth);
  if (cl.hasOption("w")) {
    pass=obtainPasswordFromFile(cl.getOptionValue("w"));
  }
 else {
    pass=cl.getOptionValue("p");
  }
  url=cl.getOptionValue("u");
  getOpts().setInitFiles(cl.getOptionValues("i"));
  getOpts().setScriptFile(cl.getOptionValue("f"));
  if (cl.getOptionValues('e') != null) {
    commands=Arrays.asList(cl.getOptionValues('e'));
  }
  if (url != null) {
    String com="!connect " + url + " "+ (user == null || user.length() == 0 ? "''" : user)+ " "+ (pass == null || pass.length() == 0 ? "''" : pass)+ " "+ (driver == null ? "" : driver);
    debug("issuing: " + com);
    dispatch(com);
  }
  for (Iterator<String> i=files.iterator(); i.hasNext(); ) {
    dispatch("!properties " + i.next());
  }
  int code=0;
  if (!commands.isEmpty()) {
    for (Iterator<String> i=commands.iterator(); i.hasNext(); ) {
      String command=i.next().toString();
      debug(loc("executing-command",command));
      if (!dispatch(command)) {
        code++;
      }
    }
    exit=true;
  }
  return code;
}
