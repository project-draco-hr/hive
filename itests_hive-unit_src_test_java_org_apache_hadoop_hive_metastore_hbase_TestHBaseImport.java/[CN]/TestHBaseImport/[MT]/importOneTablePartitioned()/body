{
  RawStore rdbms;
  rdbms=new ObjectStore();
  rdbms.setConf(conf);
  String[] dbNames=new String[]{"onetabpartdb1","onetabpartodb2"};
  String[] roles=new String[]{"onetabpartorole1","onetabpartorole2"};
  String[] tokenIds=new String[]{"onetabpartotokenid1","onetabpartotokenid2"};
  String[] tokens=new String[]{"onetabpartotoken1","onetabpartotoken2"};
  String[] masterKeys=new String[]{"onetabpartomk1","onetabpartomk2"};
  int now=(int)System.currentTimeMillis() / 1000;
  setupObjectStore(rdbms,roles,dbNames,tokenIds,tokens,masterKeys,now);
  int baseNumRoles=store.listRoleNames() == null ? 0 : store.listRoleNames().size();
  int baseNumDbs=store.getAllDatabases() == null ? 0 : store.getAllDatabases().size();
  int baseNumToks=store.getAllTokenIdentifiers() == null ? 0 : store.getAllTokenIdentifiers().size();
  int baseNumKeys=store.getMasterKeys() == null ? 0 : store.getMasterKeys().length;
  store.createDatabase(new Database(dbNames[0],"no description","file:/tmp",emptyParameters));
  HBaseImport importer=new HBaseImport("-t",dbNames[0] + "." + tableNames[1]);
  importer.setConnections(rdbms,store);
  importer.run();
  Assert.assertEquals(baseNumRoles,store.listRoleNames().size());
  Database db=store.getDatabase(dbNames[0]);
  Assert.assertNotNull(db);
  Table table=store.getTable(db.getName(),tableNames[1]);
  Assert.assertNotNull(table);
  Assert.assertEquals(1,store.getAllTables(db.getName()).size());
  for (int j=0; j < partVals.length; j++) {
    Partition part=store.getPartition(dbNames[0],tableNames[1],Arrays.asList(partVals[j]));
    Assert.assertNotNull(part);
    Assert.assertEquals("file:/tmp/region=" + partVals[j],part.getSd().getLocation());
  }
  Assert.assertEquals(4,store.getPartitions(dbNames[0],tableNames[1],-1).size());
  Assert.assertNull(store.getTable(db.getName(),tableNames[0]));
  List<Index> indexes=store.getIndexes(db.getName(),tableNames[1],-1);
  Assert.assertEquals(0,indexes.size());
  Assert.assertEquals(0,store.getFunctions(dbNames[0],"*").size());
  Assert.assertEquals(baseNumDbs + 1,store.getAllDatabases().size());
  Assert.assertEquals(baseNumToks,store.getAllTokenIdentifiers().size());
  String[] hbaseKeys=store.getMasterKeys();
  Assert.assertEquals(baseNumKeys,hbaseKeys.length);
}
