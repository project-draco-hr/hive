{
  RawStore rdbms;
  rdbms=new ObjectStore();
  rdbms.setConf(conf);
  String[] dbNames=new String[]{"onetabdb1","onetabdb2"};
  String[] roles=new String[]{"onetabrole1","onetabrole2"};
  String[] tokenIds=new String[]{"onetabtokenid1","onetabtokenid2"};
  String[] tokens=new String[]{"onetabtoken1","onetabtoken2"};
  String[] masterKeys=new String[]{"onetabmk1","onetabmk2"};
  int now=(int)System.currentTimeMillis() / 1000;
  setupObjectStore(rdbms,roles,dbNames,tokenIds,tokens,masterKeys,now);
  int baseNumRoles=store.listRoleNames() == null ? 0 : store.listRoleNames().size();
  int baseNumDbs=store.getAllDatabases() == null ? 0 : store.getAllDatabases().size();
  int baseNumToks=store.getAllTokenIdentifiers() == null ? 0 : store.getAllTokenIdentifiers().size();
  int baseNumKeys=store.getMasterKeys() == null ? 0 : store.getMasterKeys().length;
  store.createDatabase(new Database(dbNames[0],"no description","file:/tmp",emptyParameters));
  HBaseImport importer=new HBaseImport("-t",dbNames[0] + "." + tableNames[0]);
  importer.setConnections(rdbms,store);
  importer.run();
  Assert.assertEquals(baseNumRoles,store.listRoleNames().size());
  Database db=store.getDatabase(dbNames[0]);
  Assert.assertNotNull(db);
  Table table=store.getTable(db.getName(),tableNames[0]);
  Assert.assertNotNull(table);
  Assert.assertEquals(1,store.getAllTables(db.getName()).size());
  Assert.assertNull(store.getTable(db.getName(),tableNames[1]));
  Assert.assertEquals(0,store.getFunctions(dbNames[0],"*").size());
  Assert.assertEquals(baseNumDbs + 1,store.getAllDatabases().size());
  Assert.assertEquals(baseNumToks,store.getAllTokenIdentifiers().size());
  String[] hbaseKeys=store.getMasterKeys();
  Assert.assertEquals(baseNumKeys,hbaseKeys.length);
}
