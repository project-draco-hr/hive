{
  RawStore rdbms;
  rdbms=new ObjectStore();
  rdbms.setConf(conf);
  String[] dbNames=new String[]{"onefuncdb1","onefuncdb2"};
  String[] roles=new String[]{"onefuncrole1","onefuncrole2"};
  String[] tokenIds=new String[]{"onefunctokenid1","onefunctokenid2"};
  String[] tokens=new String[]{"onefunctoken1","onefunctoken2"};
  String[] masterKeys=new String[]{"onefuncmk1","onefuncmk2"};
  int now=(int)System.currentTimeMillis() / 1000;
  setupObjectStore(rdbms,roles,dbNames,tokenIds,tokens,masterKeys,now);
  int baseNumRoles=store.listRoleNames() == null ? 0 : store.listRoleNames().size();
  int baseNumDbs=store.getAllDatabases() == null ? 0 : store.getAllDatabases().size();
  int baseNumToks=store.getAllTokenIdentifiers() == null ? 0 : store.getAllTokenIdentifiers().size();
  int baseNumKeys=store.getMasterKeys() == null ? 0 : store.getMasterKeys().length;
  store.createDatabase(new Database(dbNames[0],"no description","file:/tmp",emptyParameters));
  HBaseImport importer=new HBaseImport("-f",dbNames[0] + "." + funcNames[0]);
  importer.setConnections(rdbms,store);
  importer.run();
  Assert.assertEquals(baseNumRoles,store.listRoleNames().size());
  Database db=store.getDatabase(dbNames[0]);
  Assert.assertNotNull(db);
  Assert.assertEquals(0,store.getAllTables(dbNames[0]).size());
  Assert.assertEquals(1,store.getFunctions(dbNames[0],"*").size());
  Assert.assertNotNull(store.getFunction(dbNames[0],funcNames[0]));
  Assert.assertNull(store.getFunction(dbNames[0],funcNames[1]));
  Assert.assertEquals(baseNumDbs + 1,store.getAllDatabases().size());
  Assert.assertEquals(baseNumToks,store.getAllTokenIdentifiers().size());
  String[] hbaseKeys=store.getMasterKeys();
  Assert.assertEquals(baseNumKeys,hbaseKeys.length);
}
