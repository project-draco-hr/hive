{
switch (oi.getPrimitiveCategory()) {
case BOOLEAN:
    return ((BooleanObjectInspector)oi).get(o) ? 1 : 0;
case BYTE:
  return ((ByteObjectInspector)oi).get(o);
case SHORT:
return ((ShortObjectInspector)oi).get(o);
case INT:
return ((IntObjectInspector)oi).get(o);
case LONG:
return ((LongObjectInspector)oi).get(o);
case FLOAT:
return ((FloatObjectInspector)oi).get(o);
case DOUBLE:
return ((DoubleObjectInspector)oi).get(o);
case STRING:
return Double.valueOf(((StringObjectInspector)oi).getPrimitiveJavaObject(o));
default :
throw new NumberFormatException();
}
}
