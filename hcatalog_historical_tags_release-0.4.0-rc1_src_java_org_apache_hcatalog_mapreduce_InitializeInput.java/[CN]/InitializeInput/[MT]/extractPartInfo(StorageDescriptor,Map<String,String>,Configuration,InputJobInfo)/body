{
  HCatSchema schema=HCatUtil.extractSchemaFromStorageDescriptor(sd);
  StorerInfo storerInfo=InternalUtil.extractStorerInfo(sd,parameters);
  Properties hcatProperties=new Properties();
  HCatStorageHandler storageHandler=HCatUtil.getStorageHandler(conf,storerInfo);
  Map<String,String> jobProperties=HCatUtil.getInputJobProperties(storageHandler,inputJobInfo);
  for (  String key : parameters.keySet()) {
    if (key.startsWith(HCAT_KEY_PREFIX)) {
      hcatProperties.put(key,parameters.get(key));
    }
  }
  return new PartInfo(schema,storageHandler,sd.getLocation(),hcatProperties,jobProperties,inputJobInfo.getTableInfo());
}
