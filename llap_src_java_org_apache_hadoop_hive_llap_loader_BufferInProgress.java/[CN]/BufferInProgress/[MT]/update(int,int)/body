{
  if (newOffset > bufferLimit) {
    throw new AssertionError("Offset is beyond buffer limit: " + newOffset + "/"+ bufferLimit+ "; previous offset "+ offset+ ", chunk "+ chunkInProgress);
  }
  chunkInProgress.length+=(newOffset - offset);
  this.offset=newOffset;
  this.chunkInProgressRows+=rowsWritten;
}
