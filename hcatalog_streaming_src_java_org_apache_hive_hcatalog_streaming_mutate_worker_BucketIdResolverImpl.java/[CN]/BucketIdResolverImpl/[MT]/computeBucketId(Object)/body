{
  int bucketId=1;
  for (int columnIndex=0; columnIndex < bucketFields.length; columnIndex++) {
    Object columnValue=structObjectInspector.getStructFieldData(record,bucketFields[columnIndex]);
    bucketId=bucketId * 31 + ObjectInspectorUtils.hashCode(columnValue,bucketFields[columnIndex].getFieldObjectInspector());
  }
  if (bucketId < 0) {
    bucketId=-1 * bucketId;
  }
  return bucketId % totalBuckets;
}
