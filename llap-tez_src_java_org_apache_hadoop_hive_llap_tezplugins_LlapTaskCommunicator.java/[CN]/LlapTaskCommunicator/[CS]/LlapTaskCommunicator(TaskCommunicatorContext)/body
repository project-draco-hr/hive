{
  super(taskCommunicatorContext);
  Credentials credentials=taskCommunicatorContext.getAMCredentials();
  if (credentials != null) {
    @SuppressWarnings("unchecked") Token<LlapTokenIdentifier> llapToken=(Token<LlapTokenIdentifier>)credentials.getToken(LlapTokenIdentifier.KIND_NAME);
    this.token=llapToken;
  }
 else {
    this.token=null;
  }
  if (LOG.isInfoEnabled()) {
    LOG.info("Task communicator with a token " + token);
  }
  Preconditions.checkState((token != null) == UserGroupInformation.isSecurityEnabled());
  serviceRegistry=LlapRegistryService.getClient(conf);
  umbilical=new LlapTaskUmbilicalProtocolImpl(getUmbilical());
  user=System.getenv(ApplicationConstants.Environment.USER.name());
  appAttemptId=taskCommunicatorContext.getApplicationAttemptId().getAttemptId();
  credentialMap=new ConcurrentHashMap<>();
  sourceStateTracker=new SourceStateTracker(getContext(),this);
}
