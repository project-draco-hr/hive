{
  String hHistDir=HiveConf.getVar(conf,HiveConf.ConfVars.HIVEHISTORYFILELOC);
  File tmpDir=new File(hHistDir);
  String sessionID=conf.getVar(HiveConf.ConfVars.HIVESESSIONID);
  if (!tmpDir.exists()) {
    if (!tmpDir.mkdirs()) {
      if (!tmpDir.exists()) {
        throw new RuntimeException("Unable to create log directory " + hHistDir);
      }
    }
  }
  File tmpFile=File.createTempFile(sessionID,".pipeout",tmpDir);
  tmpFile.deleteOnExit();
  return tmpFile;
}
