{
  String lScratchDir=HiveConf.getVar(conf,HiveConf.ConfVars.LOCALSCRATCHDIR);
  File tmpDir=new File(lScratchDir);
  String sessionID=conf.getVar(HiveConf.ConfVars.HIVESESSIONID);
  if (!tmpDir.exists()) {
    if (!tmpDir.mkdirs()) {
      if (!tmpDir.exists()) {
        throw new RuntimeException("Unable to create log directory " + lScratchDir);
      }
    }
  }
  File tmpFile=File.createTempFile(sessionID,".pipeout",tmpDir);
  tmpFile.deleteOnExit();
  return tmpFile;
}
