{
  String scratchDirPermission=HiveConf.getVar(conf,HiveConf.ConfVars.SCRATCHDIRPERMISSION);
  String sessionId=getSessionId();
  hdfsSessionPath=new Path(HiveConf.getVar(conf,HiveConf.ConfVars.SCRATCHDIR),sessionId);
  createPath(conf,hdfsSessionPath,scratchDirPermission);
  conf.set(HDFS_SESSION_PATH_KEY,hdfsSessionPath.toUri().toString());
  localSessionPath=new Path(HiveConf.getVar(conf,HiveConf.ConfVars.LOCALSCRATCHDIR),sessionId);
  createPath(conf,localSessionPath,scratchDirPermission);
  conf.set(LOCAL_SESSION_PATH_KEY,localSessionPath.toUri().toString());
  hdfsTmpTableSpace=new Path(hdfsSessionPath,TMP_PREFIX);
  createPath(conf,hdfsTmpTableSpace,scratchDirPermission);
  conf.set(TMP_TABLE_SPACE_KEY,hdfsTmpTableSpace.toUri().toString());
}
