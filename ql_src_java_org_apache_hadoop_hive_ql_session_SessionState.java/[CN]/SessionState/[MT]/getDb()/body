{
  boolean needsRefresh=false;
  for (  HiveConf.ConfVars oneVar : metaVars) {
    if (!StringUtils.isEmpty(StringUtils.difference(dbOptions.get(oneVar),conf.getVar(oneVar)))) {
      needsRefresh=true;
      break;
    }
  }
  if ((db == null) || needsRefresh) {
    db=Hive.get(conf);
  }
  return db;
}
