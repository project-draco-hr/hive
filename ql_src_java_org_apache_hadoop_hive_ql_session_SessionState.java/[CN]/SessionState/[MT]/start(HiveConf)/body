{
  SessionState ss=new SessionState(conf);
  ss.getConf().setVar(HiveConf.ConfVars.HIVESESSIONID,makeSessionId());
  ss.hiveHist=new HiveHistory(ss);
  ss.authenticator=HiveUtils.getAuthenticator(conf);
  ss.authorizer=HiveUtils.getAuthorizeProviderManager(conf,ss.authenticator);
  ss.createTableGrants=CreateTableAutomaticGrant.create(conf);
  tss.set(ss);
  return (ss);
}
