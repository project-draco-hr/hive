{
  if (txnMgr != null && !txnMgr.getTxnManagerName().equals(conf.getVar(HiveConf.ConfVars.HIVE_TXN_MANAGER))) {
    txnMgr.closeTxnManager();
    txnMgr=null;
  }
  if (txnMgr == null) {
    txnMgr=TxnManagerFactory.getTxnManagerFactory().getTxnManager(conf);
  }
  return txnMgr;
}
