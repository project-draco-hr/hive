{
  AccumuloPredicateHandler mockHandler=Mockito.mock(AccumuloPredicateHandler.class);
  ExprNodeDesc root=Mockito.mock(ExprNodeDesc.class);
  String hiveRowIdColumnName="rid";
  Range r1=new Range("a"), r2=new Range("z");
  Mockito.when(mockHandler.getRanges(conf,columnMapper)).thenCallRealMethod();
  Mockito.when(mockHandler.generateRanges(columnMapper,hiveRowIdColumnName,root)).thenReturn(Arrays.asList(r1,r2));
  Mockito.when(mockHandler.getExpression(conf)).thenReturn(root);
  Assert.assertEquals(Arrays.asList(r1,r2),mockHandler.getRanges(conf,columnMapper));
}
