{
  ArrayList<String> parts=splitIdentifier(name);
  if (parts != null) {
    StringBuilder norm=new StringBuilder();
    int size=parts.size();
    boolean appended=false;
    for (int i=0; i < size; i++) {
      if (i == size - 2) {
        String schema=getTargetSchemaName(parts.get(i));
        if (schema != null) {
          norm.append(schema);
          appended=true;
        }
      }
 else {
        norm.append(normalizeIdentifierPart(parts.get(i)));
        appended=true;
      }
      if (i + 1 < parts.size() && appended) {
        norm.append(".");
      }
    }
    return norm.toString();
  }
  return normalizeIdentifierPart(name);
}
