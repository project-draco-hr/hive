{
  Row row=null;
  Conn.Type connType=exec.getConnectionType(conn);
  if (connType == Conn.Type.HIVE) {
    String sql="DESCRIBE " + table;
    Query query=new Query(sql);
    exec.executeQuery(ctx,query,conn);
    if (!query.error()) {
      ResultSet rs=query.getResultSet();
      try {
        while (rs.next()) {
          String col=rs.getString(1);
          String typ=rs.getString(2);
          if (row == null) {
            row=new Row();
          }
          row.addColumn(col.toUpperCase(),typ);
        }
        map.put(table,row);
      }
 catch (      Exception e) {
      }
    }
    exec.closeQuery(query,conn);
  }
 else {
    Query query=exec.prepareQuery(ctx,"SELECT * FROM " + table,conn);
    if (!query.error()) {
      try {
        PreparedStatement stmt=query.getPreparedStatement();
        ResultSetMetaData rm=stmt.getMetaData();
        int cols=rm.getColumnCount();
        for (int i=1; i <= cols; i++) {
          String col=rm.getColumnName(i);
          String typ=rm.getColumnTypeName(i);
          if (row == null) {
            row=new Row();
          }
          row.addColumn(col.toUpperCase(),typ);
        }
        map.put(table,row);
      }
 catch (      Exception e) {
      }
    }
    exec.closeQuery(query,conn);
  }
  return row;
}
