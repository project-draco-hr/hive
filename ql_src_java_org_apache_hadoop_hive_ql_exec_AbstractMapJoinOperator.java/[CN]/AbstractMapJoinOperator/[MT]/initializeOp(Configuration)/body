{
  super.initializeOp(hconf);
  numMapRowsRead=0;
  firstRow=true;
  joinKeys=new HashMap<Byte,List<ExprNodeEvaluator>>();
  JoinUtil.populateJoinKeyValue(joinKeys,conf.getKeys(),NOTSKIPBIGTABLE);
  joinKeysObjectInspectors=JoinUtil.getObjectInspectorsFromEvaluators(joinKeys,inputObjInspectors,NOTSKIPBIGTABLE);
  joinKeysStandardObjectInspectors=JoinUtil.getStandardObjectInspectors(joinKeysObjectInspectors,NOTSKIPBIGTABLE);
  posBigTable=conf.getPosBigTable();
  emptyList=new RowContainer<ArrayList<Object>>(1,hconf,reporter);
  RowContainer bigPosRC=JoinUtil.getRowContainer(hconf,rowContainerStandardObjectInspectors.get((byte)posBigTable),order[posBigTable],joinCacheSize,spillTableDesc,conf,!hasFilter(posBigTable),reporter);
  storage.put((byte)posBigTable,bigPosRC);
  mapJoinRowsKey=HiveConf.getIntVar(hconf,HiveConf.ConfVars.HIVEMAPJOINROWSIZE);
  List<? extends StructField> structFields=((StructObjectInspector)outputObjInspector).getAllStructFieldRefs();
  if (conf.getOutputColumnNames().size() < structFields.size()) {
    List<ObjectInspector> structFieldObjectInspectors=new ArrayList<ObjectInspector>();
    for (    Byte alias : order) {
      int sz=conf.getExprs().get(alias).size();
      List<Integer> retained=conf.getRetainList().get(alias);
      for (int i=0; i < sz; i++) {
        int pos=retained.get(i);
        structFieldObjectInspectors.add(structFields.get(pos).getFieldObjectInspector());
      }
    }
    outputObjInspector=ObjectInspectorFactory.getStandardStructObjectInspector(conf.getOutputColumnNames(),structFieldObjectInspectors);
  }
  initializeChildren(hconf);
}
