{
  if (memoryManager == null) {
    memoryManager=new ThreadLocal<MemoryManager>(){
      @Override protected MemoryManager initialValue(){
        return new MemoryManager(conf);
      }
    }
;
  }
  return memoryManager.get();
}
