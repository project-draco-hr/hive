{
  super(LlapProtocolClientProxy.class.getSimpleName());
  this.hostProxies=new ConcurrentHashMap<>();
  this.socketFactory=NetUtils.getDefaultSocketFactory(conf);
  this.llapToken=llapToken;
  long connectionTimeout=HiveConf.getTimeVar(conf,ConfVars.LLAP_TASK_COMMUNICATOR_CONNECTION_TIMEOUT_MS,TimeUnit.MILLISECONDS);
  long retrySleep=HiveConf.getTimeVar(conf,ConfVars.LLAP_TASK_COMMUNICATOR_CONNECTION_SLEEP_BETWEEN_RETRIES_MS,TimeUnit.MILLISECONDS);
  this.retryPolicy=RetryPolicies.retryUpToMaximumTimeWithFixedSleep(connectionTimeout,retrySleep,TimeUnit.MILLISECONDS);
  this.requestManager=new RequestManager(numThreads);
  ExecutorService localExecutor=Executors.newFixedThreadPool(1,new ThreadFactoryBuilder().setNameFormat("RequestManagerExecutor").build());
  this.requestManagerExecutor=MoreExecutors.listeningDecorator(localExecutor);
  LOG.info("Setting up taskCommunicator with" + "numThreads=" + numThreads + "retryTime(millis)="+ connectionTimeout+ "retrySleep(millis)="+ retrySleep);
}
