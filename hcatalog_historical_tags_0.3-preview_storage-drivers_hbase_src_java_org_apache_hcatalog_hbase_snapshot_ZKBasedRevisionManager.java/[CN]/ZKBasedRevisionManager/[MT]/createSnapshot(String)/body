{
  refreshTransactionList(tableName);
  long latestID=zkUtil.currentID(tableName);
  HashMap<String,Long> cfMap=new HashMap<String,Long>();
  List<String> columnFamilyNames=zkUtil.getColumnFamiliesOfTable(tableName);
  for (  String cfName : columnFamilyNames) {
    String cfPath=PathUtil.getRunningTxnInfoPath(baseDir,tableName,cfName);
    List<FamilyRevision> tranxList=zkUtil.getTransactionList(cfPath);
    long version;
    if (!tranxList.isEmpty()) {
      Collections.sort(tranxList);
      long runningVersion=tranxList.get(0).getRevision();
      version=runningVersion - 1;
    }
 else {
      version=latestID;
    }
    cfMap.put(cfName,version);
  }
  return new TableSnapshot(tableName,cfMap);
}
