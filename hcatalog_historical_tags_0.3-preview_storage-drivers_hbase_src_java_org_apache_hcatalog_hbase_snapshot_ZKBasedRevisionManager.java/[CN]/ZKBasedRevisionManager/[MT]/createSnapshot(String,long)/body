{
  long currentID=zkUtil.currentID(tableName);
  if (revision > currentID) {
    throw new IOException("The revision specified in the snapshot is higher than the current revision of the table.");
  }
  refreshTransactionList(tableName);
  HashMap<String,Long> cfMap=new HashMap<String,Long>();
  List<String> columnFamilies=zkUtil.getColumnFamiliesOfTable(tableName);
  for (  String cf : columnFamilies) {
    cfMap.put(cf,revision);
  }
  return new TableSnapshot(tableName,cfMap);
}
