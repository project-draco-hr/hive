{
  boolean useLowLevelCache=HiveConf.getBoolVar(conf,HiveConf.ConfVars.LLAP_LOW_LEVEL_CACHE);
  if (LOGL.isInfoEnabled()) {
    LOG.info("Initializing LLAP IO" + (useLowLevelCache ? " with low level cache" : ""));
  }
  String displayName="LlapDaemonCacheMetrics-" + MetricsUtils.getHostName();
  String sessionId=conf.get("llap.daemon.metrics.sessionid");
  this.cacheMetrics=LlapDaemonCacheMetrics.create(displayName,sessionId);
  displayName="LlapDaemonQueueMetrics-" + MetricsUtils.getHostName();
  int[] intervals=conf.getInts(String.valueOf(HiveConf.ConfVars.LLAP_QUEUE_METRICS_PERCENTILE_INTERVALS));
  this.queueMetrics=LlapDaemonQueueMetrics.create(displayName,sessionId,intervals);
  LOG.info("Started llap daemon metrics with displayName: " + displayName + " sessionId: "+ sessionId);
  Cache<OrcCacheKey> cache=useLowLevelCache ? null : new NoopCache<OrcCacheKey>();
  boolean useLrfu=HiveConf.getBoolVar(conf,HiveConf.ConfVars.LLAP_USE_LRFU);
  LowLevelCachePolicy cachePolicy=useLrfu ? new LowLevelLrfuCachePolicy(conf) : new LowLevelFifoCachePolicy(conf);
  LowLevelCacheMemoryManager memManager=new LowLevelCacheMemoryManager(conf,cachePolicy,cacheMetrics);
  OrcMetadataCache metadataCache=new OrcMetadataCache(memManager,cachePolicy);
  LowLevelCacheImpl orcCache=null;
  if (useLowLevelCache) {
    allocator=new BuddyAllocator(conf,memManager,cacheMetrics);
    orcCache=new LowLevelCacheImpl(cacheMetrics,cachePolicy,allocator,true);
    cachePolicy.setEvictionListener(new EvictionDispatcher(orcCache,metadataCache));
    orcCache.init();
  }
 else {
    cachePolicy.setEvictionListener(metadataCache);
  }
  executor=MoreExecutors.listeningDecorator(Executors.newFixedThreadPool(10));
  this.cvp=new OrcColumnVectorProducer(metadataCache,orcCache,cache,conf,cacheMetrics,queueMetrics);
  if (LOGL.isInfoEnabled()) {
    LOG.info("LLAP IO initialized");
  }
  registerMXBeans();
}
