{
  Configuration conf=getHbaseConf();
  RevisionManager rm=RevisionManagerFactory.getOpenedRevisionManager(RevisionManagerEndpointClient.class.getName(),conf);
  MockRM mockImpl=MockRM.INSTANCES.get(MockRM.DEFAULT_INSTANCE);
  Assert.assertNotNull(mockImpl);
  Assert.assertTrue(mockImpl.isOpen);
  Transaction t=new Transaction("t1",Arrays.asList("f1","f2"),0,0);
  MockRM.Invocation call=new MockRM.Invocation("keepAlive",null,t);
  rm.keepAlive(t);
  Assert.assertEquals(call.methodName,call,mockImpl.lastCall);
  t=new Transaction("t2",Arrays.asList("f21","f22"),0,0);
  call=new MockRM.Invocation("beginWriteTransaction",null,t.getTableName(),t.getColumnFamilies());
  call.ret=rm.beginWriteTransaction(t.getTableName(),t.getColumnFamilies());
  Assert.assertEquals(call.methodName,call,mockImpl.lastCall);
  call=new MockRM.Invocation("createSnapshot",null,"t3",1L);
  call.ret=rm.createSnapshot("t3",1L);
  Assert.assertEquals(call.methodName,call,mockImpl.lastCall);
}
