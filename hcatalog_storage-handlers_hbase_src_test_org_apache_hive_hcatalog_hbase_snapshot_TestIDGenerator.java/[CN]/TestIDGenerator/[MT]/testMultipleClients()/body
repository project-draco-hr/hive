{
  int port=getHbaseConf().getInt("hbase.zookeeper.property.clientPort",2181);
  String servers=getHbaseConf().get("hbase.zookeeper.quorum");
  String[] splits=servers.split(",");
  StringBuffer sb=new StringBuffer();
  for (  String split : splits) {
    sb.append(split);
    sb.append(':');
    sb.append(port);
  }
  ArrayList<IDGenClient> clients=new ArrayList<IDGenClient>();
  for (int i=0; i < 5; i++) {
    IDGenClient idClient=new IDGenClient(sb.toString(),"/rm_base",10,"testTable");
    clients.add(idClient);
  }
  for (  IDGenClient idClient : clients) {
    idClient.run();
  }
  for (  IDGenClient idClient : clients) {
    idClient.join();
  }
  HashMap<Long,Long> idMap=new HashMap<Long,Long>();
  for (  IDGenClient idClient : clients) {
    idMap.putAll(idClient.getIdMap());
  }
  ArrayList<Long> keys=new ArrayList<Long>(idMap.keySet());
  Collections.sort(keys);
  int startId=1;
  for (  Long key : keys) {
    Long id=idMap.get(key);
    System.out.println("Key: " + key + " Value "+ id);
    assertTrue(id == startId);
    startId++;
  }
}
