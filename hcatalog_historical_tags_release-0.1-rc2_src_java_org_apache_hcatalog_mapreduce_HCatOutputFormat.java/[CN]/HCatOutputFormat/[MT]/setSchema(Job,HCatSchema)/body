{
  OutputJobInfo jobInfo=getJobInfo(job);
  Map<String,String> partMap=jobInfo.getTableInfo().getPartitionValues();
  List<Integer> posOfPartCols=new ArrayList<Integer>();
  HCatSchema schemaWithoutParts=new HCatSchema(schema.getFields());
  for (  String partKey : partMap.keySet()) {
    Integer idx;
    if ((idx=schema.getPosition(partKey)) != null) {
      posOfPartCols.add(idx);
      schemaWithoutParts.remove(schema.get(partKey));
    }
  }
  HCatUtil.validatePartitionSchema(jobInfo.getTable(),schemaWithoutParts);
  jobInfo.setPosOfPartCols(posOfPartCols);
  jobInfo.setOutputSchema(schemaWithoutParts);
  job.getConfiguration().set(HCatConstants.HCAT_KEY_OUTPUT_INFO,HCatUtil.serialize(jobInfo));
}
