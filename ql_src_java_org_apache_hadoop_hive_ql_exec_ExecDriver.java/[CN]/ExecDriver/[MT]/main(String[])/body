{
  String planFileName=null;
  ArrayList<String> jobConfArgs=new ArrayList<String>();
  boolean noLog=false;
  String files=null;
  try {
    for (int i=0; i < args.length; i++) {
      if (args[i].equals("-plan")) {
        planFileName=args[++i];
      }
 else       if (args[i].equals("-jobconf")) {
        jobConfArgs.add(args[++i]);
      }
 else       if (args[i].equals("-nolog")) {
        noLog=true;
      }
 else       if (args[i].equals("-files")) {
        files=args[++i];
      }
    }
  }
 catch (  IndexOutOfBoundsException e) {
    System.err.println("Missing argument to option");
    printUsage();
  }
  JobConf conf=new JobConf(ExecDriver.class);
  StringBuilder sb=new StringBuilder("JobConf:\n");
  for (  String one : jobConfArgs) {
    int eqIndex=one.indexOf('=');
    if (eqIndex != -1) {
      try {
        String key=one.substring(0,eqIndex);
        String value=URLDecoder.decode(one.substring(eqIndex + 1),"UTF-8");
        conf.set(key,value);
        sb.append(key).append("=").append(value).append("\n");
      }
 catch (      UnsupportedEncodingException e) {
        System.err.println("Unexpected error " + e.getMessage() + " while encoding "+ one.substring(eqIndex + 1));
        System.exit(3);
      }
    }
  }
  if (files != null) {
    conf.set("tmpfiles",files);
  }
  boolean isSilent=HiveConf.getBoolVar(conf,HiveConf.ConfVars.HIVESESSIONSILENT);
  if (noLog) {
    BasicConfigurator.resetConfiguration();
    BasicConfigurator.configure(new NullAppender());
  }
 else {
    setupChildLog4j(conf);
  }
  Log LOG=LogFactory.getLog(ExecDriver.class.getName());
  LogHelper console=new LogHelper(LOG,isSilent);
  if (planFileName == null) {
    console.printError("Must specify Plan File Name");
    printUsage();
  }
  for (  Appender appender : Collections.list((Enumeration<Appender>)LogManager.getRootLogger().getAllAppenders())) {
    if (appender instanceof FileAppender) {
      console.printInfo("Execution log at: " + ((FileAppender)appender).getFile());
    }
  }
  LOG.info(sb.toString());
  Path p=new Path(planFileName);
  FileSystem fs=FileSystem.getLocal(conf);
  InputStream pathData=fs.open(p);
  String auxJars=HiveConf.getVar(conf,HiveConf.ConfVars.HIVEAUXJARS);
  String addedJars=HiveConf.getVar(conf,HiveConf.ConfVars.HIVEADDEDJARS);
  try {
    ClassLoader loader=conf.getClassLoader();
    if (StringUtils.isNotBlank(auxJars)) {
      loader=Utilities.addToClassPath(loader,StringUtils.split(auxJars,","));
    }
    if (StringUtils.isNotBlank(addedJars)) {
      loader=Utilities.addToClassPath(loader,StringUtils.split(addedJars,","));
    }
    conf.setClassLoader(loader);
    Thread.currentThread().setContextClassLoader(loader);
  }
 catch (  Exception e) {
    throw new HiveException(e.getMessage(),e);
  }
  MapredWork plan=Utilities.deserializeMapRedWork(pathData,conf);
  ExecDriver ed=new ExecDriver(plan,conf,isSilent);
  int ret=ed.execute(new DriverContext());
  if (ret != 0) {
    System.exit(2);
  }
}
