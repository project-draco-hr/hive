{
  FileSystem fs=FileSystem.get(job);
  if ((work.getReducer() != null) && (work.getInferNumReducers() == true)) {
    long inpSz=0;
    Path[] inputPaths=FileInputFormat.getInputPaths(job);
    for (    Path inputP : inputPaths) {
      if (fs.exists(inputP)) {
        FileStatus[] fStats=fs.listStatus(inputP);
        for (        FileStatus fStat : fStats)         inpSz+=fStat.getLen();
      }
    }
    int newRed=(int)(inpSz / LOAD_PER_REDUCER) + 1;
    if (newRed < work.getNumReduceTasks().intValue()) {
      LOG.warn("Number of reduce tasks inferred based on input size to : " + newRed);
      work.setNumReduceTasks(Integer.valueOf(newRed));
    }
  }
}
