{
  String lastReport="";
  SimpleDateFormat dateFormat=new SimpleDateFormat("yyyy-MM-dd hh:mm:ss,SSS");
  while (!rj.isComplete()) {
    try {
      Thread.sleep(1000);
    }
 catch (    InterruptedException e) {
    }
    rj=jc.getJob(rj.getJobID());
    String report=null;
    report=dateFormat.format(Calendar.getInstance().getTime()) + " map = " + Math.round(rj.mapProgress() * 100)+ "%,  reduce ="+ Math.round(rj.reduceProgress() * 100)+ "%";
    if (!report.equals(lastReport)) {
      SessionState ss=SessionState.get();
      if (ss != null) {
        ss.getHiveHistory().setTaskCounters(SessionState.get().getQueryId(),getId(),rj);
        ss.getHiveHistory().setTaskProperty(SessionState.get().getQueryId(),getId(),Keys.TASK_HADOOP_PROGRESS,report);
        ss.getHiveHistory().progressTask(SessionState.get().getQueryId(),this);
      }
      console.printInfo(report);
      lastReport=report;
    }
  }
  return rj;
}
