{
  RunningJob rj=th.getRunningJob();
  mapProgress=Math.round(rj.mapProgress() * 100);
  reduceProgress=Math.round(rj.reduceProgress() * 100);
  taskCounters.put("CNTR_NAME_" + getId() + "_MAP_PROGRESS",Long.valueOf(mapProgress));
  taskCounters.put("CNTR_NAME_" + getId() + "_REDUCE_PROGRESS",Long.valueOf(reduceProgress));
  Counters ctrs=th.getCounters();
  if (ctrs == null) {
    return;
  }
  for (  Operator<? extends Serializable> op : work.getAliasToWork().values()) {
    op.updateCounters(ctrs);
  }
  if (work.getReducer() != null) {
    work.getReducer().updateCounters(ctrs);
  }
}
