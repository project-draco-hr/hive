{
  if (hive == null) {
    hive=new HiveConf();
  }
  long bytesPerReducer=hive.getLongVar(HiveConf.ConfVars.BYTESPERREDUCER);
  int maxReducers=hive.getIntVar(HiveConf.ConfVars.MAXREDUCERS);
  long totalInputFileSize=getTotalInputFileSize(job,work);
  LOG.info("BytesPerReducer=" + bytesPerReducer + " maxReducers="+ maxReducers+ " totalInputFileSize="+ totalInputFileSize);
  int reducers=(int)((totalInputFileSize + bytesPerReducer - 1) / bytesPerReducer);
  reducers=Math.max(1,reducers);
  reducers=Math.min(maxReducers,reducers);
  return reducers;
}
