{
  int numEmptyPaths=0;
  Set<String> pathsProcessed=new HashSet<String>();
  List<String> pathsToAdd=new LinkedList<String>();
  for (  String oneAlias : work.getAliasToWork().keySet()) {
    LOG.info("Processing alias " + oneAlias);
    List<String> emptyPaths=new ArrayList<String>();
    String path=null;
    for (    String onefile : work.getPathToAliases().keySet()) {
      List<String> aliases=work.getPathToAliases().get(onefile);
      if (aliases.contains(oneAlias)) {
        path=onefile;
        if (pathsProcessed.contains(path)) {
          continue;
        }
        pathsProcessed.add(path);
        LOG.info("Adding input file " + path);
        if (Utilities.isEmptyPath(job,path,ctx)) {
          emptyPaths.add(path);
        }
 else {
          pathsToAdd.add(path);
        }
      }
    }
    for (    String emptyPath : emptyPaths) {
      numEmptyPaths=addInputPath(emptyPath,job,work,hiveScratchDir,numEmptyPaths,true,oneAlias);
    }
    if (path == null) {
      numEmptyPaths=addInputPath(null,job,work,hiveScratchDir,numEmptyPaths,false,oneAlias);
    }
  }
  setInputPaths(job,pathsToAdd);
}
