{
  final boolean invert=columnSortOrderIsDesc[++index];
  BinarySortableSerDe.writeByte(output,(byte)1,invert);
  int sign=dec.compareTo(HiveDecimal.ZERO);
  dec=dec.abs();
  int factor=dec.precision() - dec.scale();
  factor=sign == 1 ? factor : -factor;
  dec.scaleByPowerOfTen(Math.abs(dec.scale()));
  String digits=dec.unscaledValue().toString();
  BinarySortableSerDe.writeByte(output,(byte)(sign + 1),invert);
  BinarySortableSerDe.writeByte(output,(byte)((factor >> 24) ^ 0x80),invert);
  BinarySortableSerDe.writeByte(output,(byte)(factor >> 16),invert);
  BinarySortableSerDe.writeByte(output,(byte)(factor >> 8),invert);
  BinarySortableSerDe.writeByte(output,(byte)factor,invert);
  BinarySortableSerDe.serializeBytes(output,digits.getBytes(BinarySortableSerDe.decimalCharSet),digits.length(),sign == -1 ? !invert : invert);
}
