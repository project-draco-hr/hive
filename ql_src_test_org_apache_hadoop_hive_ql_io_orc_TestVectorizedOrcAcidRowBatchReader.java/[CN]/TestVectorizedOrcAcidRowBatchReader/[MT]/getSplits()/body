{
  conf.setInt(HiveConf.ConfVars.HIVE_TXN_OPERATIONAL_PROPERTIES.varname,AcidUtils.AcidOperationalProperties.getDefault().toInt());
  OrcInputFormat.Context context=new OrcInputFormat.Context(conf);
  OrcInputFormat.FileGenerator gen=new OrcInputFormat.FileGenerator(context,fs,root,false,null);
  OrcInputFormat.AcidDirInfo adi=gen.call();
  List<OrcInputFormat.SplitStrategy<?>> splitStrategies=OrcInputFormat.determineSplitStrategies(null,context,adi.fs,adi.splitPath,adi.acidInfo,adi.baseFiles,adi.parsedDeltas,null,null,true);
  assertEquals(1,splitStrategies.size());
  List<OrcSplit> splits=((OrcInputFormat.ACIDSplitStrategy)splitStrategies.get(0)).getSplits();
  assertEquals(1,splits.size());
  assertEquals("file://" + root.toUri().toString() + File.separator+ "delta_0000001_0000010_0000/bucket_00000",splits.get(0).getPath().toUri().toString());
  assertFalse(splits.get(0).isOriginal());
  return splits;
}
