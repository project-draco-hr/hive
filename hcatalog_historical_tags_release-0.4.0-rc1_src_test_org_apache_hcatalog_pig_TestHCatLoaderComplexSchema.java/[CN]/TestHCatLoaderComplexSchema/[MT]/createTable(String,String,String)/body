{
  String createTable;
  createTable="create table " + tablename + "("+ schema+ ") ";
  if ((partitionedBy != null) && (!partitionedBy.trim().isEmpty())) {
    createTable=createTable + "partitioned by (" + partitionedBy+ ") ";
  }
  createTable=createTable + "stored as RCFILE tblproperties('hcat.isd'='org.apache.hcatalog.rcfile.RCFileInputDriver'," + "'hcat.osd'='org.apache.hcatalog.rcfile.RCFileOutputDriver') ";
  System.out.println("Creating table:\n" + createTable);
  CommandProcessorResponse result=driver.run(createTable);
  int retCode=result.getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table. [" + createTable + "], return code from hive driver : ["+ retCode+ " "+ result.getErrorMessage()+ "]");
  }
}
