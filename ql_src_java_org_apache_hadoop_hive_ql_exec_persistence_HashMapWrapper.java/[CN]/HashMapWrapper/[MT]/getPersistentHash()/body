{
  try {
    if (tmpFile != null) {
      tmpFile.delete();
    }
    tmpFile=File.createTempFile("HashMapWrapper",".tmp",new File("/tmp"));
    LOG.info("HashMapWrapper created temp file " + tmpFile.getAbsolutePath());
    tmpFile.deleteOnExit();
    Properties props=new Properties();
    props.setProperty(RecordManagerOptions.CACHE_TYPE,RecordManagerOptions.NO_CACHE);
    props.setProperty(RecordManagerOptions.DISABLE_TRANSACTIONS,"true");
    recman=RecordManagerFactory.createRecordManager(tmpFile,props);
    pHash=HTree.createInstance(recman);
    recman.setNamedObject("hashtable",pHash.getRecid());
    recman.commit();
  }
 catch (  Exception e) {
    LOG.warn(e.toString());
    throw new HiveException(e);
  }
  return pHash;
}
