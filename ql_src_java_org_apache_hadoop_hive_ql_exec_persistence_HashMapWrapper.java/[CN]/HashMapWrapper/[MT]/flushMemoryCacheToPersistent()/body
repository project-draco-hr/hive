{
  try {
    if (pHash == null) {
      pHash=getPersistentHash();
    }
    int mm_size=mHash.size();
    if (mm_size == 0) {
      return tmpFile.getAbsolutePath();
    }
    for (    Map.Entry<K,MRUItem> entry : mHash.entrySet()) {
      K key=entry.getKey();
      MRUItem item=entry.getValue();
      pHash.put(key,item.value);
    }
    recman.commit();
    mHash.clear();
  }
 catch (  Exception e) {
    LOG.warn(e.toString());
    throw new HiveException(e);
  }
  return tmpFile.getAbsolutePath();
}
