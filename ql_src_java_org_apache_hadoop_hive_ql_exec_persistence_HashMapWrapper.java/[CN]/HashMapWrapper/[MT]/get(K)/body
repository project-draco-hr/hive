{
  V value=null;
  MRUItem item=mHash.get(key);
  if (item != null) {
    value=item.value;
    MRUList.moveToHead(item);
  }
 else   if (pHash != null) {
    try {
      value=(V)pHash.get(key);
      if (value != null) {
        if (mHash.size() < threshold) {
          mHash.put(key,new MRUItem(key,value));
          pHash.remove(key);
        }
 else         if (threshold > 0) {
          MRUItem tail=MRUList.tail();
          pHash.put(tail.key,tail.value);
          pHash.remove(key);
          recman.commit();
          item=mHash.remove(tail.key);
          item.key=key;
          item.value=value;
          mHash.put(key,item);
          tail.key=key;
          tail.value=value;
          MRUList.moveToHead(tail);
        }
      }
    }
 catch (    Exception e) {
      LOG.warn(e.toString());
      throw new HiveException(e);
    }
  }
  return value;
}
