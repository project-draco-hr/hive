{
  while (writingToQueue || tableNameQueue.size() > 0) {
    try {
      String[] name=tableNameQueue.poll(1,TimeUnit.SECONDS);
      if (name != null) {
        Table table=rdbmsStore.get().getTable(name[0],name[1]);
        if (table.getPartitionKeys() != null && table.getPartitionKeys().size() > 0) {
          partitionedTables.put(table);
        }
        screen("Copying table " + name[0] + "."+ name[1]);
        hbaseStore.get().createTable(table);
      }
    }
 catch (    InterruptedException|MetaException|InvalidObjectException e) {
      throw new RuntimeException(e);
    }
  }
}
