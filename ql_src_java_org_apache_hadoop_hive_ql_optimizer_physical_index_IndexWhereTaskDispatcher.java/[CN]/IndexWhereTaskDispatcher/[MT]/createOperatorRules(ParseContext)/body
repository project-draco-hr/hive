{
  Map<Rule,NodeProcessor> operatorRules=new LinkedHashMap<Rule,NodeProcessor>();
  List<String> supportedIndexes=new ArrayList<String>();
  supportedIndexes.add(CompactIndexHandler.class.getName());
  supportedIndexes.add(BitmapIndexHandler.class.getName());
  Collection<Table> topTables=pctx.getTopToTable().values();
  Map<TableScanOperator,List<Index>> indexes=new HashMap<TableScanOperator,List<Index>>();
  for (  Map.Entry<TableScanOperator,Table> entry : pctx.getTopToTable().entrySet()) {
    List<Index> tblIndexes=IndexUtils.getIndexes(entry.getValue(),supportedIndexes);
    if (tblIndexes.size() > 0) {
      indexes.put(entry.getKey(),tblIndexes);
    }
  }
  if (indexes.size() == 0) {
    return null;
  }
  operatorRules.put(new RuleRegExp("RULEWhere",TableScanOperator.getOperatorName() + "%"),new IndexWhereProcessor(indexes));
  return operatorRules;
}
