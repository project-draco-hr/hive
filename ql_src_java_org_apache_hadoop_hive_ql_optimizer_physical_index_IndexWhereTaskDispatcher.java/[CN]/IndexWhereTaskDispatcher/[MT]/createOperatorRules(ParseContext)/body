{
  Map<Rule,NodeProcessor> operatorRules=new LinkedHashMap<Rule,NodeProcessor>();
  List<String> supportedIndexes=new ArrayList<String>();
  supportedIndexes.add(CompactIndexHandler.class.getName());
  supportedIndexes.add(BitmapIndexHandler.class.getName());
  Collection<Table> topTables=pctx.getTopToTable().values();
  Map<Table,List<Index>> indexes=new HashMap<Table,List<Index>>();
  for (  Table tbl : topTables) {
    List<Index> tblIndexes=IndexUtils.getIndexes(tbl,supportedIndexes);
    if (tblIndexes.size() > 0) {
      indexes.put(tbl,tblIndexes);
    }
  }
  if (indexes.size() == 0) {
    return null;
  }
  operatorRules.put(new RuleRegExp("RULEWhere","TS%"),new IndexWhereProcessor(indexes));
  return operatorRules;
}
