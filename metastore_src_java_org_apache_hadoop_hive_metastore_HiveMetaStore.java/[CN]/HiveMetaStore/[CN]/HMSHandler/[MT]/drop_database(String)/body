{
  incrementCounter("drop_database");
  logStartFunction("drop_database: " + name);
  if (name.equalsIgnoreCase(MetaStoreUtils.DEFAULT_DATABASE_NAME)) {
    throw new MetaException("Can't drop default database");
  }
  boolean success=false;
  try {
    getMS().openTransaction();
    if (getMS().dropDatabase(name)) {
      success=getMS().commitTransaction();
    }
  }
  finally {
    if (!success) {
      getMS().rollbackTransaction();
    }
 else {
      wh.deleteDir(wh.getDefaultDatabasePath(name),true);
    }
  }
  return success;
}
