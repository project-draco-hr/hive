{
  this.incrementCounter("drop_database");
  if (name.equalsIgnoreCase(MetaStoreUtils.DEFAULT_DATABASE_NAME)) {
    throw new MetaException("Can't drop default database");
  }
  boolean success=false;
  try {
    ms.openTransaction();
    success=ms.dropDatabase(name);
    if (ms.dropDatabase(name)) {
      success=ms.commitTransaction();
    }
  }
  finally {
    if (!success) {
      ms.rollbackTransaction();
    }
 else {
      wh.deleteDir(wh.getDefaultDatabasePath(name),true);
    }
  }
  return success;
}
