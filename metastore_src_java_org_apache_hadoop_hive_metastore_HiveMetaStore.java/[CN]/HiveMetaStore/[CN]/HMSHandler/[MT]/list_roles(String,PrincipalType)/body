{
  incrementCounter("list_roles");
  List<Role> ret=null;
  try {
    ret=executeWithRetry(new Command<List<Role>>(){
      @Override List<Role> run(      RawStore ms) throws Exception {
        List<Role> result=new ArrayList<Role>();
        List<MRoleMap> roleMap=ms.listRoles(principalName,principalType);
        if (roleMap != null) {
          for (          MRoleMap role : roleMap) {
            MRole r=role.getRole();
            result.add(new Role(r.getRoleName(),r.getCreateTime(),r.getOwnerName()));
          }
        }
        return result;
      }
    }
);
  }
 catch (  MetaException e) {
    throw e;
  }
catch (  Exception e) {
    throw new RuntimeException(e);
  }
  return ret;
}
