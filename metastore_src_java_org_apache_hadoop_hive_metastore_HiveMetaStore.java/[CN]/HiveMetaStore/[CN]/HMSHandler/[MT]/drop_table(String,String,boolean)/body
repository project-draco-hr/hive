{
  this.incrementCounter("drop_table");
  logStartFunction("drop_table",dbname,name);
  boolean success=false;
  Path tblPath=null;
  Table tbl=null;
  try {
    getMS().openTransaction();
    tbl=get_table(dbname,name);
    if (tbl == null) {
      throw new NoSuchObjectException(name + " doesn't exist");
    }
    if (tbl.getSd() == null || tbl.getSd().getLocation() == null) {
      throw new MetaException("Table metadata is corrupted");
    }
    if (!getMS().dropTable(dbname,name)) {
      throw new MetaException("Unable to drop table");
    }
    success=getMS().commitTransaction();
    tblPath=new Path(tbl.getSd().getLocation());
  }
  finally {
    if (!success) {
      getMS().rollbackTransaction();
    }
 else     if (deleteData && (tblPath != null) && !isExternal(tbl)) {
      wh.deleteDir(tblPath,true);
    }
  }
}
