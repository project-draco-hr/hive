{
  String db=parts.get(0).getDbName();
  String tbl=parts.get(0).getTableName();
  logStartFunction("add_partitions",db,tbl);
  boolean success=false;
  try {
    ms.openTransaction();
    for (    Partition part : parts) {
      add_partition(part);
    }
    success=true;
    ms.commitTransaction();
  }
  finally {
    if (!success) {
      ms.rollbackTransaction();
    }
  }
  return parts.size();
}
