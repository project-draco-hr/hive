{
  boolean success=false;
  try {
    ms.openTransaction();
    if (ms.dropDatabase(name)) {
      success=ms.commitTransaction();
    }
  }
  finally {
    if (!success) {
      ms.rollbackTransaction();
    }
 else {
      wh.deleteDir(wh.getDefaultDatabasePath(name),true);
    }
  }
  return success;
}
