{
  incrementCounter("get_partition_names_ps");
  logStartFunction("get_partitions_names_ps",db_name,tbl_name);
  Table t;
  try {
    t=get_table(db_name,tbl_name);
  }
 catch (  NoSuchObjectException e) {
    throw new MetaException(e.getMessage());
  }
  List<String> partNames=get_partition_names(db_name,tbl_name,max_parts);
  List<String> filteredPartNames=new ArrayList<String>();
  for (  String name : partNames) {
    LinkedHashMap<String,String> spec=Warehouse.makeSpecFromName(name);
    List<String> vals=new ArrayList<String>();
    for (    String val : spec.values()) {
      vals.add(val);
    }
    if (MetaStoreUtils.pvalMatches(part_vals,vals)) {
      filteredPartNames.add(name);
    }
  }
  return filteredPartNames;
}
