{
  startFunction("get_fields",": db=" + db + "tbl="+ tableName);
  String[] names=tableName.split("\\.");
  String base_table_name=names[0];
  Table tbl;
  List<FieldSchema> ret=null;
  Exception ex=null;
  try {
    try {
      tbl=get_table_core(db,base_table_name);
    }
 catch (    NoSuchObjectException e) {
      throw new UnknownTableException(e.getMessage());
    }
    if (null == tbl.getSd().getSerdeInfo().getSerializationLib() || hiveConf.getStringCollection(ConfVars.SERDESUSINGMETASTOREFORSCHEMA.varname).contains(tbl.getSd().getSerdeInfo().getSerializationLib())) {
      ret=tbl.getSd().getCols();
    }
 else {
      try {
        Deserializer s=MetaStoreUtils.getDeserializer(hiveConf,tbl);
        ret=MetaStoreUtils.getFieldsFromDeserializer(tableName,s);
      }
 catch (      SerDeException e) {
        StringUtils.stringifyException(e);
        throw new MetaException(e.getMessage());
      }
    }
  }
 catch (  Exception e) {
    ex=e;
    if (e instanceof UnknownDBException) {
      throw (UnknownDBException)e;
    }
 else     if (e instanceof UnknownTableException) {
      throw (UnknownTableException)e;
    }
 else     if (e instanceof MetaException) {
      throw (MetaException)e;
    }
 else {
      throw newMetaException(e);
    }
  }
 finally {
    endFunction("get_fields",ret != null,ex,tableName);
  }
  return ret;
}
