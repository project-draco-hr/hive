{
  startTableFunction("alter_partitions",db_name,tbl_name);
  if (LOG.isInfoEnabled()) {
    for (    Partition tmpPart : new_parts) {
      LOG.info("New partition values:" + tmpPart.getValues());
    }
  }
  List<Partition> oldParts=null;
  Exception ex=null;
  try {
    for (    Partition tmpPart : new_parts) {
      try {
        for (        MetaStorePreEventListener listener : preListeners) {
          listener.onEvent(new PreAlterPartitionEvent(db_name,tbl_name,null,tmpPart,this));
        }
      }
 catch (      NoSuchObjectException e) {
        throw new MetaException(e.getMessage());
      }
    }
    oldParts=alterHandler.alterPartitions(getMS(),wh,db_name,tbl_name,new_parts);
    Iterator<Partition> olditr=oldParts.iterator();
    for (    Partition tmpPart : new_parts) {
      Partition oldTmpPart=null;
      if (olditr.hasNext()) {
        oldTmpPart=(Partition)olditr.next();
      }
 else {
        throw new InvalidOperationException("failed to alterpartitions");
      }
      for (      MetaStoreEventListener listener : listeners) {
        AlterPartitionEvent alterPartitionEvent=new AlterPartitionEvent(oldTmpPart,tmpPart,true,this);
        listener.onAlterPartition(alterPartitionEvent);
      }
    }
  }
 catch (  InvalidObjectException e) {
    ex=e;
    throw new InvalidOperationException(e.getMessage());
  }
catch (  AlreadyExistsException e) {
    ex=e;
    throw new InvalidOperationException(e.getMessage());
  }
catch (  Exception e) {
    ex=e;
    if (e instanceof MetaException) {
      throw (MetaException)e;
    }
 else     if (e instanceof InvalidOperationException) {
      throw (InvalidOperationException)e;
    }
 else     if (e instanceof TException) {
      throw (TException)e;
    }
 else {
      MetaException me=new MetaException(e.toString());
      me.initCause(e);
      throw me;
    }
  }
 finally {
    endFunction("alter_partition",oldParts != null,ex);
  }
  return;
}
