{
  incrementCounter("get_partition_by_name");
  logStartFunction("get_partition_by_name: db=" + db_name + " tbl_name="+ tbl_name+ " part_name="+ part_name);
  LinkedHashMap<String,String> hm=Warehouse.makeSpecFromName(part_name);
  Table t=getMS().getTable(db_name,tbl_name);
  if (t == null) {
    throw new UnknownTableException(db_name + "." + tbl_name+ " table not found");
  }
  List<String> partVals=new ArrayList<String>();
  for (  FieldSchema field : t.getPartitionKeys()) {
    String key=field.getName();
    String val=hm.get(key);
    if (val == null) {
      throw new NoSuchObjectException("incomplete partition name - missing " + key);
    }
    partVals.add(val);
  }
  Partition p=getMS().getPartition(db_name,tbl_name,partVals);
  if (p == null) {
    throw new NoSuchObjectException(db_name + "." + tbl_name+ " partition ("+ part_name+ ") not found");
  }
  return p;
}
