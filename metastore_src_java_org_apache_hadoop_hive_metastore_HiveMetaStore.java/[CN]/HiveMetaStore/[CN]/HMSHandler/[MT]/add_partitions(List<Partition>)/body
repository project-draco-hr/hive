{
  this.incrementCounter("add_partition");
  if (parts.size() == 0) {
    return 0;
  }
  String db=parts.get(0).getDbName();
  String tbl=parts.get(0).getTableName();
  logStartFunction("add_partitions",db,tbl);
  boolean success=false;
  try {
    getMS().openTransaction();
    for (    Partition part : parts) {
      this.add_partition(part);
    }
    success=true;
    getMS().commitTransaction();
  }
  finally {
    if (!success) {
      getMS().rollbackTransaction();
    }
  }
  return parts.size();
}
