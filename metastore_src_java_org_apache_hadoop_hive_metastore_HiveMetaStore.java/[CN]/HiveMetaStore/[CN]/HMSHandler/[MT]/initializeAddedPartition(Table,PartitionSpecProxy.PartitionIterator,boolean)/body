{
  if (HiveConf.getBoolVar(hiveConf,HiveConf.ConfVars.HIVESTATSAUTOGATHER) && !MetaStoreUtils.isView(tbl)) {
    MetaStoreUtils.updatePartitionStatsFast(part,wh,madeDir,false,null);
  }
  long time=System.currentTimeMillis() / 1000;
  part.setCreateTime((int)time);
  if (part.getParameters() == null || part.getParameters().get(hive_metastoreConstants.DDL_TIME) == null) {
    part.putToParameters(hive_metastoreConstants.DDL_TIME,Long.toString(time));
  }
  Map<String,String> tblParams=tbl.getParameters();
  String inheritProps=hiveConf.getVar(ConfVars.METASTORE_PART_INHERIT_TBL_PROPS).trim();
  Set<String> inheritKeys=new HashSet<String>(Arrays.asList(inheritProps.split(",")));
  if (inheritKeys.contains("*")) {
    inheritKeys=tblParams.keySet();
  }
  for (  String key : inheritKeys) {
    String paramVal=tblParams.get(key);
    if (null != paramVal) {
      part.putToParameters(key,paramVal);
    }
  }
}
