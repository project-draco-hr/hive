{
  if (MetricsFactory.getInstance() != null) {
    try {
      MetricsFactory.getInstance().endScope(function);
    }
 catch (    IOException e) {
      LOG.debug("Exception when closing metrics scope" + e);
    }
  }
  for (  MetaStoreEndFunctionListener listener : endFunctionListeners) {
    listener.onEndFunction(function,context);
  }
}
