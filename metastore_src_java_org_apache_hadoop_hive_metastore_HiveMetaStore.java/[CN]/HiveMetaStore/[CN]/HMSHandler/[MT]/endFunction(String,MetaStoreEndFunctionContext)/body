{
  if (hiveConf.getBoolVar(ConfVars.METASTORE_METRICS)) {
    try {
      MetricsFactory.getMetricsInstance().endScope(function);
    }
 catch (    IOException e) {
      LOG.debug("Exception when closing metrics scope" + e);
    }
  }
  for (  MetaStoreEndFunctionListener listener : endFunctionListeners) {
    listener.onEndFunction(function,context);
  }
}
