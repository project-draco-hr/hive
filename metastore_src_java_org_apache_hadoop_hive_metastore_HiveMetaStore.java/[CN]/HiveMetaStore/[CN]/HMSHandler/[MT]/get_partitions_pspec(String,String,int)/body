{
  String dbName=db_name.toLowerCase();
  String tableName=tbl_name.toLowerCase();
  startTableFunction("get_partitions_pspec",dbName,tableName);
  List<PartitionSpec> partitionSpecs=null;
  try {
    Table table=get_table(dbName,tableName);
    List<Partition> partitions=get_partitions(dbName,tableName,(short)max_parts);
    if (is_partition_spec_grouping_enabled(table)) {
      partitionSpecs=get_partitionspecs_grouped_by_storage_descriptor(table,partitions);
    }
 else {
      PartitionSpec pSpec=new PartitionSpec();
      pSpec.setPartitionList(new PartitionListComposingSpec(partitions));
      pSpec.setDbName(dbName);
      pSpec.setTableName(tableName);
      pSpec.setRootPath(table.getSd().getLocation());
      partitionSpecs=Arrays.asList(pSpec);
    }
    return partitionSpecs;
  }
  finally {
    endFunction("get_partitions_pspec",partitionSpecs != null && !partitionSpecs.isEmpty(),null,tbl_name);
  }
}
