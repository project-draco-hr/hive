{
  if (cmd == null) {
    return;
  }
  UserGroupInformation ugi;
  try {
    ugi=ShimLoader.getHadoopShims().getUGIForConf(getConf());
  }
 catch (  Exception ex) {
    throw new RuntimeException(ex);
  }
  final Formatter fmt=auditFormatter.get();
  ((StringBuilder)fmt.out()).setLength(0);
  String address;
  if (useSasl) {
    address=saslServer.getRemoteAddress().toString();
  }
 else {
    address=getIpAddress();
  }
  if (address == null) {
    address="unknown-ip-addr";
  }
  auditLog.info(fmt.format(AUDIT_FORMAT,ugi.getUserName(),address,cmd).toString());
}
