{
  if (!ShimLoader.getHadoopShims().isSecureShimImpl() || cmd == null) {
    return;
  }
  UserGroupInformation ugi;
  try {
    ugi=ShimLoader.getHadoopShims().getUGIForConf(getConf());
  }
 catch (  Exception ex) {
    throw new RuntimeException(ex);
  }
  InetAddress addr=TLoggingProcessor.getRemoteAddress();
  final Formatter fmt=auditFormatter.get();
  ((StringBuilder)fmt.out()).setLength(0);
  auditLog.info(fmt.format(AUDIT_FORMAT,ugi.getUserName(),addr == null ? "unknown-ip-addr" : addr.toString(),cmd).toString());
}
