{
  if (!useSasl || cmd == null) {
    return;
  }
  UserGroupInformation ugi;
  try {
    ugi=ShimLoader.getHadoopShims().getUGIForConf(getConf());
  }
 catch (  Exception ex) {
    throw new RuntimeException(ex);
  }
  final Formatter fmt=auditFormatter.get();
  ((StringBuilder)fmt.out()).setLength(0);
  auditLog.info(fmt.format(AUDIT_FORMAT,ugi.getUserName(),saslServer.getRemoteAddress().toString(),cmd).toString());
}
