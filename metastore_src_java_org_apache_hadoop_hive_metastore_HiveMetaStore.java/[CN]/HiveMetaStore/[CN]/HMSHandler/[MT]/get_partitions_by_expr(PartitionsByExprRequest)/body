{
  String dbName=req.getDbName(), tblName=req.getTblName();
  startTableFunction("get_partitions_by_expr",dbName,tblName);
  fireReadTablePreEvent(dbName,tblName);
  PartitionsByExprResult ret=null;
  Exception ex=null;
  try {
    checkLimitNumberOfPartitionsByExpr(dbName,tblName,req.getExpr(),UNLIMITED_MAX_PARTITIONS);
    List<Partition> partitions=new LinkedList<Partition>();
    boolean hasUnknownPartitions=getMS().getPartitionsByExpr(dbName,tblName,req.getExpr(),req.getDefaultPartitionName(),req.getMaxParts(),partitions);
    ret=new PartitionsByExprResult(partitions,hasUnknownPartitions);
  }
 catch (  Exception e) {
    ex=e;
    rethrowException(e);
  }
 finally {
    endFunction("get_partitions_by_expr",ret != null,ex,tblName);
  }
  return ret;
}
