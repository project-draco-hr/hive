{
  if (useSasl) {
    if (saslServer != null && saslServer.getRemoteAddress() != null) {
      return saslServer.getRemoteAddress().getHostAddress();
    }
  }
 else {
    return getThreadLocalIpAddress();
  }
  return null;
}
