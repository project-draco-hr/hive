{
  rawStoreClassName=hiveConf.get("hive.metastore.rawstore.impl");
  checkForDefaultDb=hiveConf.getBoolean("hive.metastore.checkForDefaultDb",true);
  String alterHandlerName=hiveConf.get("hive.metastore.alter.impl",HiveAlterHandler.class.getName());
  alterHandler=(AlterHandler)ReflectionUtils.newInstance(getClass(alterHandlerName,AlterHandler.class),hiveConf);
  wh=new Warehouse(hiveConf);
  retryInterval=HiveConf.getIntVar(hiveConf,HiveConf.ConfVars.METASTOREINTERVAL);
  retryLimit=HiveConf.getIntVar(hiveConf,HiveConf.ConfVars.METASTOREATTEMPTS);
  updateConnectionURL(hiveConf,null);
  createDefaultDB();
  if (hiveConf.getBoolean("hive.metastore.metrics.enabled",false)) {
    try {
      Metrics.init();
    }
 catch (    Exception e) {
      LOG.error("error in Metrics init: " + e.getClass().getName() + " "+ e.getMessage());
      MetaStoreUtils.printStackTrace(e);
    }
  }
  listeners=MetaStoreUtils.getMetaStoreListener(hiveConf);
  return true;
}
