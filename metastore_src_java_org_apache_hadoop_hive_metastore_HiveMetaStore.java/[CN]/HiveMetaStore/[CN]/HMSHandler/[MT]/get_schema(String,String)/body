{
  incrementCounter("get_schema");
  logStartFunction("get_schema: db=" + db + "tbl="+ tableName);
  String[] names=tableName.split("\\.");
  String base_table_name=names[0];
  Table tbl;
  try {
    tbl=get_table(db,base_table_name);
  }
 catch (  NoSuchObjectException e) {
    throw new UnknownTableException(e.getMessage());
  }
  List<FieldSchema> fieldSchemas=get_fields(db,base_table_name);
  if (tbl == null || fieldSchemas == null) {
    throw new UnknownTableException(tableName + " doesn't exist");
  }
  if (tbl.getPartitionKeys() != null) {
    fieldSchemas.addAll(tbl.getPartitionKeys());
  }
  return fieldSchemas;
}
