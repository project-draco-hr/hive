{
  HiveMetastoreCli cli=new HiveMetastoreCli();
  cli.parse(args);
  Properties hiveconf=cli.addHiveconfToSystemProperties();
  if (System.getProperty("log4j.configuration") == null) {
    try {
      LogUtils.initHiveLog4j();
    }
 catch (    LogInitializationException e) {
      HMSHandler.LOG.warn(e.getMessage());
    }
  }
  try {
    String msg="Starting hive metastore on port " + cli.port;
    HMSHandler.LOG.info(msg);
    if (cli.isVerbose()) {
      System.err.println(msg);
    }
    HiveConf conf=new HiveConf(HMSHandler.class);
    for (    Map.Entry<Object,Object> item : hiveconf.entrySet()) {
      conf.set((String)item.getKey(),(String)item.getValue());
    }
    startMetaStore(cli.port,ShimLoader.getHadoopThriftAuthBridge(),conf);
  }
 catch (  Throwable t) {
    HMSHandler.LOG.error("Metastore Thrift Server threw an exception...",t);
    throw t;
  }
}
