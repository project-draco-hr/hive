{
  FileOutputStream fos=null;
  if (this.getResultFile() != null) {
    try {
      fos=new FileOutputStream(new File(this.resultFile));
      ss.out=new PrintStream(fos,true,"UTF-8");
    }
 catch (    java.io.FileNotFoundException fex) {
      l4j.error(this.getSessionName() + " opening resultfile " + this.resultFile,fex);
    }
catch (    java.io.UnsupportedEncodingException uex) {
      l4j.error(this.getSessionName() + " opening resultfile " + this.resultFile,uex);
    }
  }
 else {
    l4j.debug(this.getSessionName() + " Output file was not specified");
  }
  l4j.debug(this.getSessionName() + " state is now QUERY_RUNNING.");
  this.status=WebSessionItemStatus.QUERY_RUNNING;
  queryRet=qp.run(this.query);
  Vector<String> res=new Vector<String>();
  try {
    while (qp.getResults(res)) {
      for (      String row : res) {
        if (ss.out != null) {
          ss.out.println(row);
        }
      }
      res.clear();
    }
  }
 catch (  IOException ex) {
    l4j.error(this.getSessionName() + " getting results " + this.getResultFile()+ " caused exception.",ex);
  }
  try {
    if (fos != null) {
      fos.close();
    }
  }
 catch (  IOException ex) {
    l4j.error(this.getSessionName() + " closing result file " + this.getResultFile()+ " caused exception.",ex);
  }
  this.status=WebSessionItemStatus.QUERY_COMPLETE;
  l4j.debug(this.getSessionName() + " state is now QUERY_COMPLETE.");
}
