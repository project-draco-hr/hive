{
  if (val == null || val.value == null) {
    value=null;
  }
 else   if (type == Type.DERIVED_TYPE) {
    type=val.type;
    value=val.value;
  }
 else   if (type == val.type && type == Type.STRING) {
    cast((String)val.value);
  }
 else   if (type == val.type) {
    value=val.value;
  }
 else   if (type == Type.STRING) {
    cast(val.toString());
  }
 else   if (type == Type.DECIMAL) {
    if (val.type == Type.BIGINT) {
      value=BigDecimal.valueOf(val.longValue());
    }
  }
 else   if (type == Type.DATE) {
    value=Utils.toDate(val.toString());
  }
 else   if (type == Type.TIMESTAMP) {
    value=Utils.toTimestamp(val.toString());
  }
  return this;
}
