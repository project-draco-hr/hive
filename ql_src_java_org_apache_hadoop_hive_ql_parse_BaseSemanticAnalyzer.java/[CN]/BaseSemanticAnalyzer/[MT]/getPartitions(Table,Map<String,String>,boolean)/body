{
  try {
    List<Partition> partitions=partSpec == null ? db.getPartitions(table) : db.getPartitions(table,partSpec);
    if (partitions.isEmpty() && throwException) {
      throw new SemanticException(toMessage(ErrorMsg.INVALID_PARTITION,partSpec));
    }
    return partitions;
  }
 catch (  HiveException e) {
    throw new SemanticException(toMessage(ErrorMsg.INVALID_PARTITION,partSpec),e);
  }
}
