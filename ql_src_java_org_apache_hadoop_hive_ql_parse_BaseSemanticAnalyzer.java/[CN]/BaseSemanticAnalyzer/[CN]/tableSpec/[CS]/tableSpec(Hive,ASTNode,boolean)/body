{
  assert(ast.getToken().getType() == HiveParser.TOK_TAB);
  int childIndex=0;
  try {
    tableName=unescapeIdentifier(ast.getChild(0).getText());
    tableHandle=db.getTable(tableName);
    if (ast.getChildCount() == 2) {
      childIndex=1;
      ASTNode partspec=(ASTNode)ast.getChild(1);
      partSpec=new LinkedHashMap<String,String>();
      for (int i=0; i < partspec.getChildCount(); ++i) {
        ASTNode partspec_val=(ASTNode)partspec.getChild(i);
        String val=stripQuotes(partspec_val.getChild(1).getText());
        partSpec.put(unescapeIdentifier(partspec_val.getChild(0).getText()),val);
      }
      partHandle=Hive.get().getPartition(tableHandle,partSpec,forceCreatePartition);
      if (partHandle == null) {
        throw new SemanticException(ErrorMsg.INVALID_PARTITION.getMsg(ast.getChild(childIndex)));
      }
    }
  }
 catch (  InvalidTableException ite) {
    throw new SemanticException(ErrorMsg.INVALID_TABLE.getMsg(ast.getChild(0)),ite);
  }
catch (  HiveException e) {
    throw new SemanticException(ErrorMsg.GENERIC_ERROR.getMsg(ast.getChild(childIndex),e.getMessage()),e);
  }
}
