{
  if ((inputFormat == null) && (storageHandler == null)) {
    if ("SequenceFile".equalsIgnoreCase(conf.getVar(HiveConf.ConfVars.HIVEDEFAULTFILEFORMAT))) {
      inputFormat=SEQUENCEFILE_INPUT;
      outputFormat=SEQUENCEFILE_OUTPUT;
    }
 else     if ("RCFile".equalsIgnoreCase(conf.getVar(HiveConf.ConfVars.HIVEDEFAULTFILEFORMAT))) {
      inputFormat=RCFILE_INPUT;
      outputFormat=RCFILE_OUTPUT;
      shared.serde=conf.getVar(HiveConf.ConfVars.HIVEDEFAULTRCFILESERDE);
    }
 else     if ("ORC".equalsIgnoreCase(conf.getVar(HiveConf.ConfVars.HIVEDEFAULTFILEFORMAT))) {
      inputFormat=ORCFILE_INPUT;
      outputFormat=ORCFILE_OUTPUT;
      shared.serde=ORCFILE_SERDE;
    }
 else     if ("PARQUET".equalsIgnoreCase(conf.getVar(HiveConf.ConfVars.HIVEDEFAULTFILEFORMAT))) {
      inputFormat=PARQUETFILE_INPUT;
      outputFormat=PARQUETFILE_OUTPUT;
      shared.serde=PARQUETFILE_SERDE;
    }
 else {
      inputFormat=TEXTFILE_INPUT;
      outputFormat=TEXTFILE_OUTPUT;
    }
  }
}
