{
  WriterContextImpl cntxtImpl=(WriterContextImpl)context;
  try {
    new HCatOutputFormat().getOutputCommitter(ShimLoader.getHadoopShims().getHCatShim().createTaskAttemptContext(cntxtImpl.getConf(),ShimLoader.getHadoopShims().getHCatShim().createTaskAttemptID())).abortJob(ShimLoader.getHadoopShims().getHCatShim().createJobContext(cntxtImpl.getConf(),null),State.FAILED);
  }
 catch (  IOException e) {
    throw new HCatException(ErrorType.ERROR_NOT_INITIALIZED,e);
  }
catch (  InterruptedException e) {
    throw new HCatException(ErrorType.ERROR_NOT_INITIALIZED,e);
  }
}
