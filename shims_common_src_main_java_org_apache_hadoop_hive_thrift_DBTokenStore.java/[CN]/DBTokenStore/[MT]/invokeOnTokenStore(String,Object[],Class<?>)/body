{
  Object tokenStore;
  try {
switch (smode) {
case METASTORE:
      tokenStore=handler.getClass().getMethod("getMS").invoke(handler);
    break;
case HIVESERVER2:
  Object hiveObject=((Class<?>)handler).getMethod("get",org.apache.hadoop.conf.Configuration.class,java.lang.Class.class).invoke(handler,conf,DBTokenStore.class);
tokenStore=((Class<?>)handler).getMethod("getMSC").invoke(hiveObject);
break;
default :
throw new TokenStoreException(new Exception("unknown server mode"));
}
return tokenStore.getClass().getMethod(methName,paramTypes).invoke(tokenStore,params);
}
 catch (IllegalArgumentException e) {
throw new TokenStoreException(e);
}
catch (SecurityException e) {
throw new TokenStoreException(e);
}
catch (IllegalAccessException e) {
throw new TokenStoreException(e);
}
catch (InvocationTargetException e) {
throw new TokenStoreException(e.getCause());
}
catch (NoSuchMethodException e) {
throw new TokenStoreException(e);
}
}
