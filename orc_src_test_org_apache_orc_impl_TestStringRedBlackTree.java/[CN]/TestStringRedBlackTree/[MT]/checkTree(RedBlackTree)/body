{
  IntWritable count=new IntWritable(0);
  if (tree.isRed(tree.root)) {
    printTree(tree,"",tree.root);
    throw new IllegalStateException("root is red");
  }
  checkSubtree(tree,tree.root,count);
  if (count.get() != tree.size) {
    printTree(tree,"",tree.root);
    throw new IllegalStateException("Broken tree! visited= " + count.get() + " size="+ tree.size);
  }
}
