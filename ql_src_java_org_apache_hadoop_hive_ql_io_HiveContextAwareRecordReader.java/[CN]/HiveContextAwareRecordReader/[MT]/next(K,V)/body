{
  if (!initDone) {
    throw new IOException("Hive IOContext is not inited.");
  }
  updateIOContext();
  try {
    boolean retVal=doNext(key,value);
    if (retVal) {
      if (key instanceof RecordIdentifier) {
        ioCxtRef.ri=(RecordIdentifier)key;
      }
 else       if (recordReader instanceof AcidInputFormat.AcidRecordReader) {
        ioCxtRef.ri=((AcidInputFormat.AcidRecordReader)recordReader).getRecordIdentifier();
      }
    }
    return retVal;
  }
 catch (  IOException e) {
    ioCxtRef.setIOExceptions(true);
    throw e;
  }
}
