{
  SessionHandle sessionHandle=client.openSession("tom","password",new HashMap<String,String>());
  assertNotNull(sessionHandle);
  String tabName="TEST_CONF_EXEC";
  String tabNameVar="tabNameVar";
  String setLockMgr="SET " + HiveConf.ConfVars.HIVE_SUPPORT_CONCURRENCY.varname + " = false";
  OperationHandle opHandle=client.executeStatement(sessionHandle,setLockMgr,null);
  client.closeOperation(opHandle);
  String dropTable="DROP TABLE IF EXISTS " + tabName;
  opHandle=client.executeStatement(sessionHandle,dropTable,null);
  client.closeOperation(opHandle);
  Map<String,String> confOverlay=new HashMap<String,String>();
  confOverlay.put(tabNameVar,tabName);
  String createTab="CREATE TABLE ${hiveconf:" + tabNameVar + "} (id int)";
  opHandle=client.executeStatement(sessionHandle,createTab,confOverlay);
  assertNotNull(opHandle);
  assertEquals("Query should be finished",OperationState.FINISHED,client.getOperationStatus(opHandle).getState());
  client.closeOperation(opHandle);
  String selectTab="SELECT * FROM " + tabName;
  opHandle=client.executeStatement(sessionHandle,selectTab,null);
  assertNotNull(opHandle);
  assertEquals("Query should be finished",OperationState.FINISHED,client.getOperationStatus(opHandle).getState());
  client.closeOperation(opHandle);
  selectTab="SELECT * FROM ${hiveconf:" + tabNameVar + "}";
  try {
    opHandle=client.executeStatement(sessionHandle,selectTab,null);
    fail("Query should fail");
  }
 catch (  HiveSQLException e) {
  }
  dropTable="DROP TABLE IF EXISTS " + tabName;
  opHandle=client.executeStatement(sessionHandle,dropTable,null);
  client.closeOperation(opHandle);
  client.closeSession(sessionHandle);
}
