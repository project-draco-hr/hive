{
  HashMap<String,String> confOverlay=new HashMap<String,String>();
  SessionHandle sessionHandle=client.openSession("tom","password",new HashMap<String,String>());
  assertNotNull(sessionHandle);
  String queryString="SET hive.lock.manager=" + "org.apache.hadoop.hive.ql.lockmgr.EmbeddedLockManager";
  client.executeStatement(sessionHandle,queryString,confOverlay);
  queryString="DROP TABLE IF EXISTS TEST_EXEC";
  client.executeStatement(sessionHandle,queryString,confOverlay);
  queryString="CREATE TABLE TEST_EXEC(ID STRING)";
  client.executeStatement(sessionHandle,queryString,confOverlay);
  queryString="SELECT ID FROM TEST_EXEC";
  OperationHandle ophandle=client.executeStatement(sessionHandle,queryString,confOverlay);
  assertEquals("Query should be finished",OperationState.FINISHED,client.getOperationStatus(ophandle));
}
