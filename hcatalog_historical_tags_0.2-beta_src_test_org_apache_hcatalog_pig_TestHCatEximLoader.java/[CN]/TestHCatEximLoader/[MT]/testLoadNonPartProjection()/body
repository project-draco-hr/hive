{
  populateDataFile();
{
    PigServer server=new PigServer(ExecType.LOCAL,props);
    UDFContext.getUDFContext().setClientSystemProps();
    server.setBatchOn();
    server.registerQuery("A = load '" + fqdataLocation + "' using PigStorage(',') as (emp_id:int, emp_name:chararray, emp_dob:chararray, emp_sex:chararray);");
    server.registerQuery("store A into '" + NONPART_TABLE + "' using org.apache.hcatalog.pig.HCatEximStorer('"+ fqexportLocation+ "');");
    server.executeBatch();
  }
{
    PigServer server=new PigServer(ExecType.LOCAL,props);
    UDFContext.getUDFContext().setClientSystemProps();
    server.registerQuery("A = load '" + fqexportLocation + "' using org.apache.hcatalog.pig.HCatEximLoader();");
    server.registerQuery("B = foreach A generate emp_sex, emp_name;");
    Iterator<Tuple> XIter=server.openIterator("B");
    assertTrue(XIter.hasNext());
    Tuple t=XIter.next();
    assertEmpDetail(t,"M","Krishna");
    assertTrue(XIter.hasNext());
    t=XIter.next();
    assertEmpDetail(t,"F","Kalpana");
    assertTrue(XIter.hasNext());
    t=XIter.next();
    assertEmpDetail(t,"M","Satya");
    assertTrue(XIter.hasNext());
    t=XIter.next();
    assertEmpDetail(t,"F","Kavya");
    assertFalse(XIter.hasNext());
  }
}
