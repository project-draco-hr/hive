{
  try {
    Schema fullSchema=client.getSchema();
    List<FieldSchema> schema=fullSchema.getFieldSchemas();
    columnNames=new ArrayList<String>();
    columnTypes=new ArrayList<String>();
    StringBuilder namesSb=new StringBuilder();
    StringBuilder typesSb=new StringBuilder();
    if ((schema != null) && (!schema.isEmpty())) {
      for (int pos=0; pos < schema.size(); pos++) {
        if (pos != 0) {
          namesSb.append(",");
          typesSb.append(",");
        }
        columnNames.add(schema.get(pos).getName());
        columnTypes.add(schema.get(pos).getType());
        namesSb.append(schema.get(pos).getName());
        typesSb.append(schema.get(pos).getType());
      }
    }
    String names=namesSb.toString();
    String types=typesSb.toString();
    serde=new LazySimpleSerDe();
    Properties props=new Properties();
    if (names.length() > 0) {
      LOG.debug("Column names: " + names);
      props.setProperty(Constants.LIST_COLUMNS,names);
    }
    if (types.length() > 0) {
      LOG.debug("Column types: " + types);
      props.setProperty(Constants.LIST_COLUMN_TYPES,types);
    }
    serde.initialize(new Configuration(),props);
  }
 catch (  Exception ex) {
    ex.printStackTrace();
    throw new SQLException("Could not create ResultSet: " + ex.getMessage(),ex);
  }
}
