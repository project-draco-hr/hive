{
  QueryIdentifier queryIdentifier=new QueryIdentifier(request.getQueryIdentifier().getAppIdentifier(),request.getQueryIdentifier().getDagIdentifier());
  LOG.info("Processing queryComplete notification for {}",queryIdentifier);
  List<QueryFragmentInfo> knownFragments=queryTracker.queryComplete(queryIdentifier,request.getDeleteDelay());
  LOG.info("DBG: Pending fragment count for completed query {} = {}",queryIdentifier,knownFragments.size());
  for (  QueryFragmentInfo fragmentInfo : knownFragments) {
    LOG.info("DBG: Issuing killFragment for completed query {} {}",queryIdentifier,fragmentInfo.getFragmentIdentifierString());
    executorService.killFragment(fragmentInfo.getFragmentIdentifierString());
  }
  return QueryCompleteResponseProto.getDefaultInstance();
}
