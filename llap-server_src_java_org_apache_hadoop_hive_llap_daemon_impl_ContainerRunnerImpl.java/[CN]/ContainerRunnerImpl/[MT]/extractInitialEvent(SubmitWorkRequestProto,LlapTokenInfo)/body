{
  if (!request.hasInitialEventBytes())   return null;
  ByteString initialEventByteString=request.getInitialEventBytes();
  byte[] initialEventBytes=initialEventByteString.toByteArray();
  NotTezEvent initialEvent=NotTezEvent.parseFrom(initialEventBytes);
  if (tokenInfo.isSigningRequired) {
    if (!request.hasInitialEventSignature()) {
      throw new SecurityException("Unsigned initial event is not allowed");
    }
    byte[] signatureBytes=request.getInitialEventSignature().toByteArray();
    signer.checkSignature(initialEventBytes,signatureBytes,initialEvent.getKeyId());
  }
  return NotTezEventHelper.toTezEvent(initialEvent);
}
