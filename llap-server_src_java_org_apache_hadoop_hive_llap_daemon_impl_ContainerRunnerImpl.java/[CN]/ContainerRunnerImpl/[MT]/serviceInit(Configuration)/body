{
  try {
    localFs=FileSystem.getLocal(conf);
    confParams.amCounterHeartbeatInterval=conf.getLong(TezConfiguration.TEZ_TASK_AM_HEARTBEAT_COUNTER_INTERVAL_MS,TezConfiguration.TEZ_TASK_AM_HEARTBEAT_COUNTER_INTERVAL_MS_DEFAULT);
    confParams.amHeartbeatIntervalMsMax=conf.getInt(TezConfiguration.TEZ_TASK_AM_HEARTBEAT_INTERVAL_MS,TezConfiguration.TEZ_TASK_AM_HEARTBEAT_INTERVAL_MS_DEFAULT);
    confParams.amMaxEventsPerHeartbeat=conf.getInt(TezConfiguration.TEZ_TASK_MAX_EVENTS_PER_HEARTBEAT,TezConfiguration.TEZ_TASK_MAX_EVENTS_PER_HEARTBEAT_DEFAULT);
  }
 catch (  IOException e) {
    throw new RuntimeException("Failed to setup local filesystem instance",e);
  }
}
