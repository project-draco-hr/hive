{
  LOG.info("Processing query failed notification for {}",queryIdentifier);
  List<QueryFragmentInfo> knownFragments;
  try {
    knownFragments=queryTracker.queryComplete(queryIdentifier,-1,true);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
  LOG.info("DBG: Pending fragment count for failed query {} = {}",queryIdentifier,knownFragments.size());
  for (  QueryFragmentInfo fragmentInfo : knownFragments) {
    LOG.info("DBG: Issuing killFragment for failed query {} {}",queryIdentifier,fragmentInfo.getFragmentIdentifierString());
    executorService.killFragment(fragmentInfo.getFragmentIdentifierString());
  }
}
