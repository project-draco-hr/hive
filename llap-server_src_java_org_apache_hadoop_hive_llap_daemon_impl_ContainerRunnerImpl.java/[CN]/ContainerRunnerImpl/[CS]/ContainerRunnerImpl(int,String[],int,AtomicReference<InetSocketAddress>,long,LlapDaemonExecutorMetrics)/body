{
  super("ContainerRunnerImpl");
  Preconditions.checkState(numExecutors > 0,"Invalid number of executors: " + numExecutors + ". Must be > 0");
  this.localDirsBase=localDirsBase;
  this.localAddress=localAddress;
  this.confParams=new ConfParams();
  confParams.amMaxEventsPerHeartbeat=TezConfiguration.TEZ_TASK_MAX_EVENTS_PER_HEARTBEAT_DEFAULT;
  confParams.amHeartbeatIntervalMsMax=TezConfiguration.TEZ_AM_RM_HEARTBEAT_INTERVAL_MS_MAX_DEFAULT;
  confParams.amCounterHeartbeatInterval=TezConfiguration.TEZ_TASK_AM_HEARTBEAT_COUNTER_INTERVAL_MS_DEFAULT;
  ExecutorService raw=Executors.newFixedThreadPool(numExecutors,new ThreadFactoryBuilder().setNameFormat(THREAD_NAME_FORMAT).build());
  this.executorService=MoreExecutors.listeningDecorator(raw);
  AuxiliaryServiceHelper.setServiceDataIntoEnv(TezConstants.TEZ_SHUFFLE_HANDLER_SERVICE_ID,ByteBuffer.allocate(4).putInt(localShufflePort),localEnv);
  this.memoryPerExecutor=(long)(totalMemoryAvailableBytes * 0.8 / (float)numExecutors);
  this.metrics=metrics;
  LOG.info("ContainerRunnerImpl config: " + "memoryPerExecutorDerviced=" + memoryPerExecutor);
}
