{
  super("ContainerRunnerImpl");
  this.conf=conf;
  Preconditions.checkState(numExecutors > 0,"Invalid number of executors: " + numExecutors + ". Must be > 0");
  this.localDirsBase=localDirsBase;
  this.localAddress=localAddress;
  ExecutorService raw=Executors.newFixedThreadPool(numExecutors,new ThreadFactoryBuilder().setNameFormat(THREAD_NAME_FORMAT).build());
  this.executorService=MoreExecutors.listeningDecorator(raw);
  AuxiliaryServiceHelper.setServiceDataIntoEnv(TezConstants.TEZ_SHUFFLE_HANDLER_SERVICE_ID,ByteBuffer.allocate(4).putInt(localShufflePort),localEnv);
  this.memoryPerExecutor=(long)(totalMemoryAvailableBytes * 0.8 / (float)numExecutors);
  this.metrics=metrics;
  try {
    localFs=FileSystem.getLocal(conf);
  }
 catch (  IOException e) {
    throw new RuntimeException("Failed to setup local filesystem instance",e);
  }
  confParams=new ConfParams(conf.getInt(TezConfiguration.TEZ_TASK_AM_HEARTBEAT_INTERVAL_MS,TezConfiguration.TEZ_TASK_AM_HEARTBEAT_INTERVAL_MS_DEFAULT),conf.getLong(TezConfiguration.TEZ_TASK_AM_HEARTBEAT_COUNTER_INTERVAL_MS,TezConfiguration.TEZ_TASK_AM_HEARTBEAT_COUNTER_INTERVAL_MS_DEFAULT),conf.getInt(TezConfiguration.TEZ_TASK_MAX_EVENTS_PER_HEARTBEAT,TezConfiguration.TEZ_TASK_MAX_EVENTS_PER_HEARTBEAT_DEFAULT));
  LOG.info("ContainerRunnerImpl config: " + "memoryPerExecutorDerviced=" + memoryPerExecutor);
}
