{
  super("ContainerRunnerImpl");
  this.conf=conf;
  Preconditions.checkState(numExecutors > 0,"Invalid number of executors: " + numExecutors + ". Must be > 0");
  this.localAddress=localAddress;
  this.amReporter=amReporter;
  this.queryTracker=new QueryTracker(conf,localDirsBase);
  addIfService(queryTracker);
  String waitQueueSchedulerClassName=conf.get(LlapConfiguration.LLAP_DAEMON_WAIT_QUEUE_SCHEDULER_CLASS_NAME,LlapConfiguration.LLAP_DAEMON_WAIT_QUEUE_SCHEDULER_CLASS_NAME_DEFAULT);
  this.executorService=new TaskExecutorService(numExecutors,waitQueueSize,waitQueueSchedulerClassName,enablePreemption);
  AuxiliaryServiceHelper.setServiceDataIntoEnv(TezConstants.TEZ_SHUFFLE_HANDLER_SERVICE_ID,ByteBuffer.allocate(4).putInt(localShufflePort),localEnv);
  addIfService(executorService);
  this.memoryPerExecutor=(long)(totalMemoryAvailableBytes * 0.8 / (float)numExecutors);
  this.metrics=metrics;
  confParams=new TaskRunnerCallable.ConfParams(conf.getInt(TezConfiguration.TEZ_TASK_AM_HEARTBEAT_INTERVAL_MS,TezConfiguration.TEZ_TASK_AM_HEARTBEAT_INTERVAL_MS_DEFAULT),conf.getLong(TezConfiguration.TEZ_TASK_AM_HEARTBEAT_COUNTER_INTERVAL_MS,TezConfiguration.TEZ_TASK_AM_HEARTBEAT_COUNTER_INTERVAL_MS_DEFAULT),conf.getInt(TezConfiguration.TEZ_TASK_MAX_EVENTS_PER_HEARTBEAT,TezConfiguration.TEZ_TASK_MAX_EVENTS_PER_HEARTBEAT_DEFAULT));
  LOG.info("ContainerRunnerImpl config: " + "memoryPerExecutorDerviced=" + memoryPerExecutor);
}
