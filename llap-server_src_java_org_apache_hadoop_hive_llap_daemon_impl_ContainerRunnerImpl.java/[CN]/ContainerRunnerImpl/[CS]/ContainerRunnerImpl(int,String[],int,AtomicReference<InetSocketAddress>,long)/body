{
  super("ContainerRunnerImpl");
  Preconditions.checkState(numExecutors > 0,"Invalid number of executors: " + numExecutors + ". Must be > 0");
  this.numExecutors=numExecutors;
  this.localDirsBase=localDirsBase;
  this.localShufflePort=localShufflePort;
  this.localAddress=localAddress;
  ExecutorService raw=Executors.newFixedThreadPool(numExecutors,new ThreadFactoryBuilder().setNameFormat("ContainerExecutor %d").build());
  this.executorService=MoreExecutors.listeningDecorator(raw);
  AuxiliaryServiceHelper.setServiceDataIntoEnv(TezConstants.TEZ_SHUFFLE_HANDLER_SERVICE_ID,ByteBuffer.allocate(4).putInt(localShufflePort),localEnv);
  this.memoryPerExecutor=(long)(totalMemoryAvailableBytes * 0.8 / (float)numExecutors);
  LOG.info("ContainerRunnerImpl config: " + "memoryPerExecutorDerviced=" + memoryPerExecutor);
}
