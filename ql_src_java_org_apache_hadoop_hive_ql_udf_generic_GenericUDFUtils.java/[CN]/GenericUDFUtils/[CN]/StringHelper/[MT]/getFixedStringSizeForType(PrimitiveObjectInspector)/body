{
switch (poi.getPrimitiveCategory()) {
case VARCHAR:
    VarcharTypeParams varcharParams=null;
  varcharParams=(VarcharTypeParams)poi.getTypeParams();
if (varcharParams == null || varcharParams.length < 0) {
  throw new UDFArgumentException("varchar type used without type params");
}
return varcharParams.length;
default :
throw new UDFArgumentException("No fixed size for type " + poi.getTypeName());
}
}
