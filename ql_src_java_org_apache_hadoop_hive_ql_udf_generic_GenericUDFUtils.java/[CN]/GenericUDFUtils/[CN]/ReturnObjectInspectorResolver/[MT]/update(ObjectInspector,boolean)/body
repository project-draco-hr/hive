{
  if (oi instanceof VoidObjectInspector) {
    return true;
  }
  if (returnObjectInspector == null) {
    returnObjectInspector=ObjectInspectorUtils.getStandardObjectInspector(oi,ObjectInspectorCopyOption.WRITABLE);
    return true;
  }
  if (returnObjectInspector == oi) {
    return true;
  }
  TypeInfo oiTypeInfo=TypeInfoUtils.getTypeInfoFromObjectInspector(oi);
  TypeInfo rTypeInfo=TypeInfoUtils.getTypeInfoFromObjectInspector(returnObjectInspector);
  if (oiTypeInfo == rTypeInfo) {
    returnObjectInspector=ObjectInspectorUtils.getStandardObjectInspector(returnObjectInspector,ObjectInspectorCopyOption.WRITABLE);
    return true;
  }
  if (!allowTypeConversion) {
    return false;
  }
  TypeInfo commonTypeInfo=null;
  if (isUnionAll) {
    commonTypeInfo=FunctionRegistry.getCommonClassForUnionAll(rTypeInfo,oiTypeInfo);
  }
 else {
    commonTypeInfo=FunctionRegistry.getCommonClass(oiTypeInfo,rTypeInfo);
  }
  if (commonTypeInfo == null) {
    return false;
  }
  if (commonTypeInfo instanceof DecimalTypeInfo) {
    if ((!FunctionRegistry.isExactNumericType((PrimitiveTypeInfo)oiTypeInfo)) || (!FunctionRegistry.isExactNumericType((PrimitiveTypeInfo)rTypeInfo))) {
      commonTypeInfo=TypeInfoFactory.doubleTypeInfo;
    }
  }
  returnObjectInspector=TypeInfoUtils.getStandardWritableObjectInspectorFromTypeInfo(commonTypeInfo);
  return true;
}
