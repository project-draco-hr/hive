{
  HWIAuth user1=new HWIAuth();
  user1.setUser("hadoop");
  user1.setGroups(new String[]{"hadoop"});
  HWISessionItem user1_item1=hsm.createSession(user1,"session1");
  HWISessionItem user1_item2=hsm.createSession(user1,"session2");
  HWIAuth user2=new HWIAuth();
  user2.setUser("user2");
  user2.setGroups(new String[]{"user2"});
  HWISessionItem user2_item1=hsm.createSession(user2,"session1");
  assertEquals(hsm.findAllSessionsForUser(user1).size(),2);
  assertEquals(hsm.findAllSessionsForUser(user2).size(),1);
  assertEquals(hsm.findAllSessionItems().size(),3);
  HWISessionItem searchItem=hsm.findSessionItemByName(user1,"session1");
  assertEquals(searchItem,user1_item1);
  searchItem.setQuery("create table " + tableName + " (key int, value string)");
  searchItem.clientStart();
  while (searchItem.getStatus() != HWISessionItem.WebSessionItemStatus.QUERY_COMPLETE) {
    Thread.sleep(1);
  }
  assertEquals(searchItem.getQueryRet(),0);
  user1_item2.setQuery("select distinct(test_hwi_table.key) from " + tableName);
  user2_item1.setQuery("select distinct(test_hwi_table.key) from " + tableName);
  user1_item2.clientStart();
  user2_item1.clientStart();
  while (user1_item2.getStatus() != HWISessionItem.WebSessionItemStatus.QUERY_COMPLETE) {
    Thread.sleep(1);
  }
  while (user2_item1.getStatus() != HWISessionItem.WebSessionItemStatus.QUERY_COMPLETE) {
    Thread.sleep(1);
  }
  assertEquals(user1_item2.getQueryRet(),0);
  assertEquals(user2_item1.getQueryRet(),0);
  HWISessionItem cleanup=hsm.createSession(user1,"cleanup");
  cleanup.setQuery("drop table " + tableName);
  cleanup.clientStart();
  while (cleanup.getStatus() != HWISessionItem.WebSessionItemStatus.QUERY_COMPLETE) {
    Thread.sleep(1);
  }
  assertEquals(cleanup.getQueryRet(),0);
}
