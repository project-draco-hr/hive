{
  exec("CREATE TABLE foo1 (foo INT) STORED AS RCFILE");
  Path tablePath=new Path(whPath,new Random().nextInt() + "/mytable");
  whFs.mkdirs(tablePath,perm500);
  execFail("ALTER TABLE foo1 SET LOCATION '%s'",tablePath.makeQualified(whFs));
  tablePath=new Path(whPath,new Random().nextInt() + "/mytable2");
  exec("CREATE EXTERNAL TABLE foo3 (foo INT) STORED AS RCFILE LOCATION '%s'",tablePath.makeQualified(whFs));
  tablePath=new Path(whPath,new Random().nextInt() + "/mytable2");
  whFs.mkdirs(tablePath,perm500);
  execFail("ALTER TABLE foo3 SET LOCATION '%s'",tablePath.makeQualified(whFs));
  tablePath=new Path(whPath,new Random().nextInt() + "/mytable3");
  exec("CREATE EXTERNAL TABLE foo4 (foo INT) STORED AS RCFILE LOCATION '%s'",tablePath.makeQualified(whFs));
  whFs.mkdirs(tablePath,perm500);
  tablePath=new Path(whPath,new Random().nextInt() + "/mytable3");
  execFail("ALTER TABLE foo4 SET LOCATION '%s'",tablePath.makeQualified(whFs));
}
