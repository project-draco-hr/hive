{
  HiveConf hiveConf=getHiveConf(url,conf);
  try {
    return new HiveMetaStoreClient(hiveConf);
  }
 catch (  MetaException e) {
    LOG.error("Error connecting to the metastore (conf follows): " + e.getMessage(),e);
    HCatUtil.logHiveConf(LOG,hiveConf);
    throw e;
  }
}
