{
  final String F1="#affiliations";
  final String F2="friends[0].friendid";
  try {
    ExprNodeDesc expr1=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,F1,"",false);
    ExprNodeDesc expr2=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,F2,"",false);
    ExprNodeDesc filterExpr=TypeCheckProcFactory.DefaultExprProcessor.getFuncExprNodeDesc("==",expr1,expr2);
    FilterDesc filterCtx=new FilterDesc(filterExpr,false);
    Operator<FilterDesc> op=OperatorFactory.get(FilterDesc.class);
    op.setConf(filterCtx);
    ArrayList<String> aliasList=new ArrayList<String>();
    aliasList.add("a");
    LinkedHashMap<String,ArrayList<String>> pa=new LinkedHashMap<String,ArrayList<String>>();
    pa.put("/tmp/testfolder",aliasList);
    TableDesc tblDesc=Utilities.defaultTd;
    PartitionDesc partDesc=new PartitionDesc(tblDesc,null);
    LinkedHashMap<String,PartitionDesc> pt=new LinkedHashMap<String,PartitionDesc>();
    pt.put("/tmp/testfolder",partDesc);
    LinkedHashMap<String,Operator<? extends Serializable>> ao=new LinkedHashMap<String,Operator<? extends Serializable>>();
    ao.put("a",op);
    MapredWork mrwork=new MapredWork();
    mrwork.setPathToAliases(pa);
    mrwork.setPathToPartitionInfo(pt);
    mrwork.setAliasToWork(ao);
    ByteArrayOutputStream baos=new ByteArrayOutputStream();
    Utilities.serializeMapRedWork(mrwork,baos);
    baos.close();
    String v1=baos.toString();
    JobConf job=new JobConf(TestPlan.class);
    job.set("fs.default.name","file:///");
    Utilities.setMapRedWork(job,mrwork);
    MapredWork mrwork2=Utilities.getMapRedWork(job);
    Utilities.clearMapRedWork(job);
    baos.reset();
    Utilities.serializeMapRedWork(mrwork2,baos);
    baos.close();
    assertEquals(v1,baos.toString());
  }
 catch (  Exception excp) {
    excp.printStackTrace();
    throw excp;
  }
  System.out.println("Serialization/Deserialization of plan successful");
}
