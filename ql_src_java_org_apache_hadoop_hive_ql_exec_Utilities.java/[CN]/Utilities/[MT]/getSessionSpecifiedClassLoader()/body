{
  SessionState state=SessionState.get();
  if (state == null || state.getConf() == null) {
    LOG.debug("Hive Conf not found or Session not initiated, use thread based class loader instead");
    return JavaUtils.getClassLoader();
  }
  ClassLoader sessionCL=state.getConf().getClassLoader();
  if (sessionCL != null) {
    LOG.debug("Use session specified class loader");
    return sessionCL;
  }
  LOG.debug("Session specified class loader not found, use thread based class loader");
  return JavaUtils.getClassLoader();
}
