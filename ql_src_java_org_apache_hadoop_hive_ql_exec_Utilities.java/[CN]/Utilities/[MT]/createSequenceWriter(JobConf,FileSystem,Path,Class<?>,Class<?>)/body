{
  CompressionCodec codec=null;
  CompressionType compressionType=CompressionType.NONE;
  if (SequenceFileOutputFormat.getCompressOutput(jc)) {
    compressionType=SequenceFileOutputFormat.getOutputCompressionType(jc);
    Class codecClass=SequenceFileOutputFormat.getOutputCompressorClass(jc,DefaultCodec.class);
    codec=(CompressionCodec)ReflectionUtils.newInstance(codecClass,jc);
  }
  return (SequenceFile.createWriter(fs,jc,file,keyClass,valClass,compressionType,codec));
}
