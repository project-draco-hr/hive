{
  int sequenceNumber=0;
  Set<Path> pathsProcessed=new HashSet<Path>();
  List<Path> pathsToAdd=new LinkedList<Path>();
  for (  String alias : work.getAliasToWork().keySet()) {
    LOG.info("Processing alias " + alias);
    Path path=null;
    for (    String file : new LinkedList<String>(work.getPathToAliases().keySet())) {
      List<String> aliases=work.getPathToAliases().get(file);
      if (aliases.contains(alias)) {
        path=new Path(file);
        if (pathsProcessed.contains(path)) {
          continue;
        }
        pathsProcessed.add(path);
        LOG.info("Adding input file " + path);
        if (!skipDummy && isEmptyPath(job,path,ctx)) {
          path=createDummyFileForEmptyPartition(path,job,work,hiveScratchDir,alias,sequenceNumber++);
        }
        pathsToAdd.add(path);
      }
    }
    if (path == null && !skipDummy) {
      path=createDummyFileForEmptyTable(job,work,hiveScratchDir,alias,sequenceNumber++);
      pathsToAdd.add(path);
    }
  }
  return pathsToAdd;
}
