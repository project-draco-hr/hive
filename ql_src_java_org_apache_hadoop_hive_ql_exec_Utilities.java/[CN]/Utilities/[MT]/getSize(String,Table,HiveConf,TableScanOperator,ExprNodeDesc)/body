{
  long result=0;
  int numPartitions=0;
  Map<String,PrunedPartitionList> prunedPartitionsMap=new HashMap<String,PrunedPartitionList>();
  if (!table.isPartitioned()) {
    result=getSize(conf,table);
  }
 else {
    PrunedPartitionList partsList=PartitionPruner.prune(table,expr,conf,alias,prunedPartitionsMap);
    numPartitions=partsList.getNotDeniedPartns().size();
    for (    Partition part : partsList.getNotDeniedPartns()) {
      result+=getSize(conf,part);
    }
  }
  return result;
}
