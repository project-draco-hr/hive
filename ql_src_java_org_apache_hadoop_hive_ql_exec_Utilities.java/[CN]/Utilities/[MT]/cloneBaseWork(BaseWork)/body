{
  PerfLogger perfLogger=PerfLogger.getPerfLogger();
  perfLogger.PerfLogBegin(CLASS_NAME,PerfLogger.CLONE_PLAN);
  ByteArrayOutputStream baos=new ByteArrayOutputStream(4096);
  Configuration conf=new HiveConf();
  serializePlan(plan,baos,conf,true);
  BaseWork newPlan=deserializePlan(new ByteArrayInputStream(baos.toByteArray()),plan.getClass(),conf,true);
  perfLogger.PerfLogEnd(CLASS_NAME,PerfLogger.CLONE_PLAN);
  return newPlan;
}
