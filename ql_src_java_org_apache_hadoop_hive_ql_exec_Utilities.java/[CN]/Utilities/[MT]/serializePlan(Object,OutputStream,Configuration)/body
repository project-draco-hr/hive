{
  PerfLogger perfLogger=PerfLogger.getPerfLogger();
  perfLogger.PerfLogBegin(LOG,PerfLogger.SERIALIZE_PLAN);
  if (conf.get(HiveConf.ConfVars.PLAN_SERIALIZATION.varname,"kryo").equals("javaXML")) {
    serializeObjectByJavaXML(plan,out);
  }
 else {
    serializeObjectByKryo(plan,out);
  }
  perfLogger.PerfLogEnd(LOG,PerfLogger.SERIALIZE_PLAN);
}
