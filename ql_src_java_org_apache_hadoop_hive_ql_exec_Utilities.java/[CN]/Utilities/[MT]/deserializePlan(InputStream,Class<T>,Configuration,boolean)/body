{
  PerfLogger perfLogger=PerfLogger.getPerfLogger();
  perfLogger.PerfLogBegin(CLASS_NAME,PerfLogger.DESERIALIZE_PLAN);
  T plan;
  String serializationType=conf.get(HiveConf.ConfVars.PLAN_SERIALIZATION.varname,"kryo");
  LOG.info("Deserializing " + planClass.getSimpleName() + " via "+ serializationType);
  if ("javaXML".equalsIgnoreCase(serializationType)) {
    plan=deserializeObjectByJavaXML(in);
  }
 else {
    if (cloningPlan) {
      plan=deserializeObjectByKryo(cloningQueryPlanKryo.get(),in,planClass);
    }
 else {
      plan=deserializeObjectByKryo(runtimeSerializationKryo.get(),in,planClass);
    }
  }
  perfLogger.PerfLogEnd(CLASS_NAME,PerfLogger.DESERIALIZE_PLAN);
  return plan;
}
