{
  Random r=new Random();
  for (int failures=0; ; failures++) {
    try {
      return conn.prepareStatement(stmt);
    }
 catch (    SQLTransientException e) {
      if (failures >= maxRetries) {
        LOG.error("Error preparing JDBC Statement " + stmt + " :"+ e);
        throw e;
      }
      long waitTime=Utilities.getRandomWaitTime(waitWindow,failures,r);
      try {
        Thread.sleep(waitTime);
      }
 catch (      InterruptedException e1) {
      }
    }
catch (    SQLException e) {
      throw e;
    }
  }
}
