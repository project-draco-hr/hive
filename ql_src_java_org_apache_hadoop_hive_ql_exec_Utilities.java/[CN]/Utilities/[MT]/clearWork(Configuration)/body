{
  Path mapPath=getPlanPath(conf,MAP_PLAN_NAME);
  Path reducePath=getPlanPath(conf,REDUCE_PLAN_NAME);
  if (mapPath == null || reducePath == null) {
    return;
  }
  try {
    FileSystem fs=mapPath.getFileSystem(conf);
    if (fs.exists(mapPath)) {
      fs.delete(mapPath,true);
    }
    if (fs.exists(reducePath)) {
      fs.delete(reducePath,true);
    }
  }
 catch (  Exception e) {
    LOG.warn("Failed to clean-up tmp directories.",e);
  }
 finally {
    if (mapPath != null) {
      gWorkMap.remove(mapPath);
    }
    if (reducePath != null) {
      gWorkMap.remove(reducePath);
    }
  }
}
