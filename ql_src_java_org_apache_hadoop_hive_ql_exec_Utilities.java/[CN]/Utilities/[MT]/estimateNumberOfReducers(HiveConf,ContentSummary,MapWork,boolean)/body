{
  long bytesPerReducer=conf.getLongVar(HiveConf.ConfVars.BYTESPERREDUCER);
  int maxReducers=conf.getIntVar(HiveConf.ConfVars.MAXREDUCERS);
  double samplePercentage=getHighestSamplePercentage(work);
  long totalInputFileSize=getTotalInputFileSize(inputSummary,work,samplePercentage);
  if (totalInputFileSize != inputSummary.getLength()) {
    LOG.info("BytesPerReducer=" + bytesPerReducer + " maxReducers="+ maxReducers+ " estimated totalInputFileSize="+ totalInputFileSize);
  }
 else {
    LOG.info("BytesPerReducer=" + bytesPerReducer + " maxReducers="+ maxReducers+ " totalInputFileSize="+ totalInputFileSize);
  }
  boolean powersOfTwo=conf.getBoolVar(HiveConf.ConfVars.HIVE_INFER_BUCKET_SORT_NUM_BUCKETS_POWER_TWO) && finalMapRed && !work.getBucketedColsByDirectory().isEmpty();
  return estimateReducers(totalInputFileSize,bytesPerReducer,maxReducers,powersOfTwo);
}
