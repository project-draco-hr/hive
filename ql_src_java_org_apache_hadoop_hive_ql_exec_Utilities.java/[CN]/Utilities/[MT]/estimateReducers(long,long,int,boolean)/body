{
  double bytes=Math.max(totalInputFileSize,bytesPerReducer);
  int reducers=(int)Math.ceil(bytes / bytesPerReducer);
  reducers=Math.max(1,reducers);
  reducers=Math.min(maxReducers,reducers);
  int reducersLog=(int)(Math.log(reducers) / Math.log(2)) + 1;
  int reducersPowerTwo=(int)Math.pow(2,reducersLog);
  if (powersOfTwo) {
    if (reducersPowerTwo / 2 == reducers) {
    }
 else     if (reducersPowerTwo > maxReducers) {
      reducers=reducersPowerTwo / 2;
    }
 else {
      reducers=reducersPowerTwo;
    }
  }
  return reducers;
}
