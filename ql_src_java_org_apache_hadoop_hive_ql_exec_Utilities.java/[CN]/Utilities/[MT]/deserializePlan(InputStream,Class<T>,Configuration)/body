{
  PerfLogger perfLogger=PerfLogger.getPerfLogger();
  perfLogger.PerfLogBegin(LOG,PerfLogger.DESERIALIZE_PLAN);
  T plan;
  if (conf.get(HiveConf.ConfVars.PLAN_SERIALIZATION.varname,"kryo").equals("javaXML")) {
    plan=deserializeObjectByJavaXML(in);
  }
 else {
    plan=deserializeObjectByKryo(in,planClass);
  }
  perfLogger.PerfLogEnd(LOG,PerfLogger.DESERIALIZE_PLAN);
  return plan;
}
