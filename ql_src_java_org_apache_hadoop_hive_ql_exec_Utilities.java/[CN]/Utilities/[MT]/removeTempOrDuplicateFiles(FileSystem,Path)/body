{
  if (path == null)   return;
  FileStatus items[]=fs.listStatus(path);
  if (items == null)   return;
  HashMap<String,FileStatus> taskIdToFile=new HashMap<String,FileStatus>();
  for (  FileStatus one : items) {
    if (isTempPath(one)) {
      if (!fs.delete(one.getPath(),true)) {
        throw new IOException("Unable to delete tmp file: " + one.getPath());
      }
    }
 else {
      String taskId=getTaskIdFromFilename(one.getPath().getName());
      FileStatus otherFile=taskIdToFile.get(taskId);
      if (otherFile == null) {
        taskIdToFile.put(taskId,one);
      }
 else {
        if (!fs.delete(one.getPath(),true)) {
          throw new IOException("Unable to delete duplicate file: " + one.getPath() + ". Existing file: "+ otherFile.getPath());
        }
 else {
          LOG.warn("Duplicate taskid file removed: " + one.getPath() + ". Existing file: "+ otherFile.getPath());
        }
      }
    }
  }
}
