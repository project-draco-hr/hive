{
  if (!fs.exists(dst)) {
    if (!fs.rename(src,dst)) {
      throw new HiveException("Unable to move: " + src + " to: "+ dst);
    }
  }
 else {
    FileStatus[] files=fs.listStatus(src);
    for (    FileStatus file : files) {
      Path srcFilePath=file.getPath();
      String fileName=srcFilePath.getName();
      Path dstFilePath=new Path(dst,fileName);
      if (fs.exists(dstFilePath)) {
        int suffix=0;
        do {
          suffix++;
          dstFilePath=new Path(dst,fileName + "_" + suffix);
        }
 while (fs.exists(dstFilePath));
      }
      if (!fs.rename(srcFilePath,dstFilePath)) {
        throw new HiveException("Unable to move: " + src + " to: "+ dst);
      }
    }
  }
}
