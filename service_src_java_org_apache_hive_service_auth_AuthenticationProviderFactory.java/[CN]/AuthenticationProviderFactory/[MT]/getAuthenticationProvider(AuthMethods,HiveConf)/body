{
  if (authMethod == AuthMethods.LDAP) {
    return new LdapAuthenticationProviderImpl(conf);
  }
 else   if (authMethod == AuthMethods.PAM) {
    return new PamAuthenticationProviderImpl(conf);
  }
 else   if (authMethod == AuthMethods.CUSTOM) {
    return new CustomAuthenticationProviderImpl(conf);
  }
 else   if (authMethod == AuthMethods.NONE) {
    return new AnonymousAuthenticationProviderImpl();
  }
 else {
    throw new AuthenticationException("Unsupported authentication method");
  }
}
