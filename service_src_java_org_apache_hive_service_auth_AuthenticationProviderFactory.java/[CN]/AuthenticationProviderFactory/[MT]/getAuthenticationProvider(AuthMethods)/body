{
  if (authMethod.equals(AuthMethods.LDAP)) {
    return new LdapAuthenticationProviderImpl();
  }
 else   if (authMethod.equals(AuthMethods.CUSTOM)) {
    return new CustomAuthenticationProviderImpl();
  }
 else   if (authMethod.equals(AuthMethods.NONE)) {
    return new AnonymousAuthenticationProviderImpl();
  }
 else {
    throw new AuthenticationException("Unsupported authentication method");
  }
}
