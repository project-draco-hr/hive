{
  if (authMethod == AuthMethods.LDAP) {
    return new LdapAuthenticationProviderImpl();
  }
 else   if (authMethod == AuthMethods.PAM) {
    return new PamAuthenticationProviderImpl();
  }
 else   if (authMethod == AuthMethods.CUSTOM) {
    return new CustomAuthenticationProviderImpl();
  }
 else   if (authMethod == AuthMethods.NONE) {
    return new AnonymousAuthenticationProviderImpl();
  }
 else {
    throw new AuthenticationException("Unsupported authentication method");
  }
}
