{
  JSONObject outJSONObject=new JSONObject();
  boolean jsonOutput=work.isFormatted();
  if (jsonOutput) {
    out=null;
  }
  if (work.getAstStringTree() != null) {
    String jsonAST=outputAST(work.getAstStringTree(),out,jsonOutput,0);
    if (out != null) {
      out.println();
    }
    if (jsonOutput) {
      outJSONObject.put("ABSTRACT SYNTAX TREE",jsonAST);
    }
  }
  List<Task<?>> tasks=work.getRootTasks();
  List<Task> ordered=StageIDsRearranger.getExplainOrder(conf,tasks);
  Task<? extends Serializable> fetchTask=work.getFetchTask();
  if (fetchTask != null) {
    fetchTask.setRootTask(true);
    ordered.add(fetchTask);
  }
  JSONObject jsonDependencies=outputDependencies(out,work,ordered);
  if (out != null) {
    out.println();
  }
  if (jsonOutput) {
    outJSONObject.put("STAGE DEPENDENCIES",jsonDependencies);
  }
  JSONObject jsonPlan=outputStagePlans(out,work,ordered);
  if (jsonOutput) {
    outJSONObject.put("STAGE PLANS",jsonPlan);
  }
  return jsonOutput ? outJSONObject : null;
}
