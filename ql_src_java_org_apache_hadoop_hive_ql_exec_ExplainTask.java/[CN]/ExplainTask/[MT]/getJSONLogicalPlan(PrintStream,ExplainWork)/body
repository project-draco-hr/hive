{
  isLogical=true;
  JSONObject outJSONObject=new JSONObject(new LinkedHashMap<>());
  boolean jsonOutput=work.isFormatted();
  if (jsonOutput) {
    out=null;
  }
  if (work.getAstStringTree() != null) {
    String jsonAST=outputAST(work.getAstStringTree(),out,jsonOutput,0);
    if (out != null) {
      out.println();
    }
    if (jsonOutput) {
      outJSONObject.put("ABSTRACT SYNTAX TREE",jsonAST);
    }
  }
  if (work.getParseContext() != null) {
    if (out != null) {
      out.print("LOGICAL PLAN:");
    }
    JSONObject jsonPlan=outputMap(work.getParseContext().getTopOps(),true,out,jsonOutput,work.getExtended(),0);
    if (out != null) {
      out.println();
    }
    if (jsonOutput) {
      outJSONObject.put("LOGICAL PLAN",jsonPlan);
    }
  }
 else {
    System.err.println("No parse context!");
  }
  return outJSONObject;
}
