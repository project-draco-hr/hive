{
  PrintStream out=null;
  try {
    Path resFile=new Path(work.getResFile());
    OutputStream outS=resFile.getFileSystem(conf).create(resFile);
    out=new PrintStream(outS);
    outputAST(work.getAstStringTree(),out,0);
    out.println();
    outputDependencies(out,work.getRootTasks(),0);
    out.println();
    outputStagePlans(out,work.getRootTasks(),0);
    out.close();
    out=null;
    return (0);
  }
 catch (  Exception e) {
    console.printError("Failed with exception " + e.getMessage(),"\n" + StringUtils.stringifyException(e));
    return (1);
  }
 finally {
    IOUtils.closeStream(out);
  }
}
