{
  JSONObject outJSONObject=new JSONObject();
  if (jsonOutput) {
    out=null;
  }
  if (ast != null && isExtended) {
    String jsonAST=outputAST(ast,out,jsonOutput,0);
    if (out != null) {
      out.println();
    }
    if (jsonOutput) {
      outJSONObject.put("ABSTRACT SYNTAX TREE",jsonAST);
    }
  }
  List<Task> ordered=StageIDsRearranger.getExplainOrder(conf,tasks);
  if (fetchTask != null) {
    fetchTask.setParentTasks((List)StageIDsRearranger.getFetchSources(tasks));
    if (fetchTask.getNumParent() == 0) {
      fetchTask.setRootTask(true);
    }
    ordered.add(fetchTask);
  }
  JSONObject jsonDependencies=outputDependencies(out,jsonOutput,appendTaskType,ordered);
  if (out != null) {
    out.println();
  }
  if (jsonOutput) {
    outJSONObject.put("STAGE DEPENDENCIES",jsonDependencies);
  }
  JSONObject jsonPlan=outputStagePlans(out,ordered,jsonOutput,isExtended);
  if (jsonOutput) {
    outJSONObject.put("STAGE PLANS",jsonPlan);
  }
  if (fetchTask != null) {
    fetchTask.setParentTasks(null);
  }
  return jsonOutput ? outJSONObject : null;
}
