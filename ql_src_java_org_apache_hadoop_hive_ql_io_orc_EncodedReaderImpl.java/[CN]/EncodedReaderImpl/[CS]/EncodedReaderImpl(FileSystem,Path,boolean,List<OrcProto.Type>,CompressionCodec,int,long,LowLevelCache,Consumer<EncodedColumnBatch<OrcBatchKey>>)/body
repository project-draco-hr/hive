{
  this.fileName=path.toString().intern();
  this.file=fileSystem.open(path);
  this.codec=codec;
  this.types=types;
  this.bufferSize=bufferSize;
  this.pool=useZeroCopy ? new ByteBufferAllocatorPool() : null;
  this.zcr=useZeroCopy ? RecordReaderUtils.createZeroCopyShim(file,codec,pool) : null;
  this.rowIndexStride=strideRate;
  this.cache=cache;
  this.consumer=consumer;
  if (zcr != null && !cache.isDirectAlloc()) {
    throw new UnsupportedOperationException("Cannot use zero-copy reader with non-direct cache " + "buffers; either disable zero-copy or enable direct cache allocation");
  }
}
