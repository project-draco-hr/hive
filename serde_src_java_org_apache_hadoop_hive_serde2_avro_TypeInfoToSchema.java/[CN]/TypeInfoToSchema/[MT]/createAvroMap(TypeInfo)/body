{
  TypeInfo keyTypeInfo=((MapTypeInfo)typeInfo).getMapKeyTypeInfo();
  if (((PrimitiveTypeInfo)keyTypeInfo).getPrimitiveCategory() != PrimitiveObjectInspector.PrimitiveCategory.STRING) {
    throw new UnsupportedOperationException("Key of Map can only be a String");
  }
  TypeInfo valueTypeInfo=((MapTypeInfo)typeInfo).getMapValueTypeInfo();
  Schema valueSchema=createAvroSchema(valueTypeInfo);
  return Schema.createMap(valueSchema);
}
