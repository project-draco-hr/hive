{
  Schema schema=null;
switch (typeInfo.getCategory()) {
case PRIMITIVE:
    schema=createAvroPrimitive(typeInfo);
  break;
case LIST:
schema=createAvroArray(typeInfo);
break;
case MAP:
schema=createAvroMap(typeInfo);
break;
case STRUCT:
schema=createAvroRecord(typeInfo);
break;
case UNION:
schema=createAvroUnion(typeInfo);
break;
}
return wrapInUnionWithNull(schema);
}
