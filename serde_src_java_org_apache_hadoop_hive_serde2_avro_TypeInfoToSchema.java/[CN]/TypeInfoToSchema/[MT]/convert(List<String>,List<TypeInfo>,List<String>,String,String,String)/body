{
  List<Schema.Field> fields=new ArrayList<Schema.Field>();
  for (int i=0; i < columnNames.size(); ++i) {
    final String comment=columnComments.size() > i ? columnComments.get(i) : null;
    final Schema.Field avroField=createAvroField(columnNames.get(i),columnTypes.get(i),comment);
    fields.addAll(getFields(avroField));
  }
  if (name == null || name.isEmpty()) {
    name="baseRecord";
  }
  Schema avroSchema=Schema.createRecord(name,doc,namespace,false);
  avroSchema.setFields(fields);
  return avroSchema;
}
