{
  Configuration conf=new Configuration();
  Job job=new Job(conf,"test outputformat");
  Map<String,String> partitionValues=new HashMap<String,String>();
  partitionValues.put("colname","p1");
  HCatTableInfo info=HCatTableInfo.getOutputTableInfo(null,null,dbName,tblName,partitionValues);
  HCatOutputFormat.setOutput(job,info);
  OutputJobInfo jobInfo=HCatOutputFormat.getJobInfo(job);
  assertNotNull(jobInfo.getTableInfo());
  assertEquals(1,jobInfo.getTableInfo().getPartitionValues().size());
  assertEquals("p1",jobInfo.getTableInfo().getPartitionValues().get("colname"));
  assertEquals(1,jobInfo.getTableSchema().getFields().size());
  assertEquals("colname",jobInfo.getTableSchema().getFields().get(0).getName());
  StorerInfo storer=jobInfo.getStorerInfo();
  assertEquals(RCFileOutputDriver.class.getName(),storer.getOutputSDClass());
  publishTest(job);
}
