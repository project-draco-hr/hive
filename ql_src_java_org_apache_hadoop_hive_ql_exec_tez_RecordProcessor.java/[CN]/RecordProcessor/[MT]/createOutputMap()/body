{
  Preconditions.checkState(outMap == null,"Outputs should only be setup once");
  outMap=Maps.newHashMap();
  for (  Entry<String,LogicalOutput> entry : outputs.entrySet()) {
    TezKVOutputCollector collector=new TezKVOutputCollector(entry.getValue());
    outMap.put(entry.getKey(),collector);
  }
}
