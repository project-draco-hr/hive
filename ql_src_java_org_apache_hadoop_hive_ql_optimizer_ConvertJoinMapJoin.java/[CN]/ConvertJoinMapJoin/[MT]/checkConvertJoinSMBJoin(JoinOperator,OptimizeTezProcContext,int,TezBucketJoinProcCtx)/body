{
  ReduceSinkOperator bigTableRS=(ReduceSinkOperator)joinOp.getParentOperators().get(bigTablePosition);
  int numBuckets=bigTableRS.getParentOperators().get(0).getOpTraits().getNumBuckets();
  int size=-1;
  for (  Operator<?> parentOp : joinOp.getParentOperators()) {
    @SuppressWarnings({"rawtypes","unchecked"}) Set<ReduceSinkOperator> set=OperatorUtils.findOperatorsUpstream((Collection)parentOp.getParentOperators(),ReduceSinkOperator.class);
    if (size < 0) {
      size=set.size();
      continue;
    }
    if (((size > 0) && (set.size() > 0)) || ((size == 0) && (set.size() == 0))) {
      continue;
    }
 else {
      return false;
    }
  }
  for (  Operator<? extends OperatorDesc> parentOp : joinOp.getParentOperators()) {
    if (!(parentOp instanceof ReduceSinkOperator)) {
      LOG.info("Found correlation optimizer operators. Cannot convert to SMB at this time.");
      return false;
    }
    ReduceSinkOperator rsOp=(ReduceSinkOperator)parentOp;
    if (checkColEquality(rsOp.getParentOperators().get(0).getOpTraits().getSortCols(),rsOp.getOpTraits().getSortCols(),rsOp.getColumnExprMap(),tezBucketJoinProcCtx,false) == false) {
      LOG.info("We cannot convert to SMB because the sort column names do not match.");
      return false;
    }
    if (checkColEquality(rsOp.getParentOperators().get(0).getOpTraits().getBucketColNames(),rsOp.getOpTraits().getBucketColNames(),rsOp.getColumnExprMap(),tezBucketJoinProcCtx,true) == false) {
      LOG.info("We cannot convert to SMB because bucket column names do not match.");
      return false;
    }
  }
  if (numBuckets < 0) {
    numBuckets=bigTableRS.getConf().getNumReducers();
  }
  tezBucketJoinProcCtx.setNumBuckets(numBuckets);
  LOG.info("We can convert the join to an SMB join.");
  return true;
}
