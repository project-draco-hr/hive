{
  ReduceSinkOperator bigTableRS=(ReduceSinkOperator)joinOp.getParentOperators().get(bigTablePosition);
  int numBuckets=bigTableRS.getParentOperators().get(0).getOpTraits().getNumBuckets();
  for (  Operator<? extends OperatorDesc> parentOp : joinOp.getParentOperators()) {
    if (!(parentOp instanceof ReduceSinkOperator)) {
      LOG.info("Found correlation optimizer operators. Cannot convert to SMB at this time.");
      return false;
    }
    ReduceSinkOperator rsOp=(ReduceSinkOperator)parentOp;
    if (checkColEquality(rsOp.getParentOperators().get(0).getOpTraits().getSortCols(),rsOp.getOpTraits().getSortCols(),rsOp.getColumnExprMap(),tezBucketJoinProcCtx) == false) {
      LOG.info("We cannot convert to SMB because the sort column names do not match.");
      return false;
    }
    if (checkColEquality(rsOp.getParentOperators().get(0).getOpTraits().getBucketColNames(),rsOp.getOpTraits().getBucketColNames(),rsOp.getColumnExprMap(),tezBucketJoinProcCtx) == false) {
      LOG.info("We cannot convert to SMB because bucket column names do not match.");
      return false;
    }
  }
  boolean isSubQuery=false;
  if (numBuckets < 0) {
    isSubQuery=true;
    numBuckets=bigTableRS.getConf().getNumReducers();
  }
  tezBucketJoinProcCtx.setNumBuckets(numBuckets);
  tezBucketJoinProcCtx.setIsSubQuery(isSubQuery);
  LOG.info("We can convert the join to an SMB join.");
  return true;
}
