{
  String logName=makeLogName();
  File logFile=new File(logName);
  if (!logFile.exists()) {
    return;
  }
  if (logFile.length() == 0) {
    logFile.delete();
    return;
  }
  FileInputStream fis=new FileInputStream(logFile);
  ObjectInputStream ois=new ObjectInputStream(fis);
  try {
    if (ois.readShort() != Magic.LOGFILE_HEADER) {
      throw new Error("Bad magic on log file");
    }
  }
 catch (  IOException e) {
    logFile.delete();
    return;
  }
  while (true) {
    ArrayList blocks=null;
    try {
      blocks=(ArrayList)ois.readObject();
    }
 catch (    ClassNotFoundException e) {
      throw new Error("Unexcepted exception: " + e);
    }
catch (    IOException e) {
      break;
    }
    synchronizeBlocks(blocks.iterator(),false);
    try {
      ois=new ObjectInputStream(fis);
    }
 catch (    IOException e) {
      break;
    }
  }
  owner.sync();
  logFile.delete();
}
