{
  try {
    int port=10000;
    if (args.length >= 1) {
      port=Integer.parseInt(args[0]);
    }
    TServerTransport serverTransport=new TServerSocket(port);
    Iface handler=new HiveServerHandler();
    FacebookService.Processor processor=new ThriftHive.Processor(handler);
    TThreadPoolServer.Options options=new TThreadPoolServer.Options();
    TServer server=new TThreadPoolServer(processor,serverTransport,new TTransportFactory(),new TTransportFactory(),new TBinaryProtocol.Factory(),new TBinaryProtocol.Factory(),options);
    server.serve();
    HiveServerHandler.LOG.info("Started the new hive server on port " + port);
  }
 catch (  Exception x) {
    x.printStackTrace();
  }
}
