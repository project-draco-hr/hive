{
  HiveClusterStatus hcs;
  try {
    Driver drv=new Driver();
    drv.init();
    ClusterStatus cs=drv.getClusterStatus();
    JobTrackerState state=JobTrackerState.valueOf(ShimLoader.getHadoopShims().getJobTrackerState(cs).name());
    hcs=new HiveClusterStatus(cs.getTaskTrackers(),cs.getMapTasks(),cs.getReduceTasks(),cs.getMaxMapTasks(),cs.getMaxReduceTasks(),state);
  }
 catch (  Exception e) {
    LOG.error(e.toString());
    e.printStackTrace();
    HiveServerException ex=new HiveServerException();
    ex.setMessage("Unable to get cluster status: " + e.toString());
    throw ex;
  }
  return hcs;
}
