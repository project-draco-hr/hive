{
  HiveClusterStatus hcs;
  try {
    Driver drv=new Driver();
    drv.init();
    ClusterStatus cs=drv.getClusterStatus();
    JobTracker.State jbs=cs.getJobTrackerState();
    JobTrackerState state;
switch (jbs) {
case INITIALIZING:
      state=JobTrackerState.INITIALIZING;
    break;
case RUNNING:
  state=JobTrackerState.RUNNING;
break;
default :
String errorMsg="Unrecognized JobTracker state: " + jbs.toString();
throw new Exception(errorMsg);
}
hcs=new HiveClusterStatus(cs.getTaskTrackers(),cs.getMapTasks(),cs.getReduceTasks(),cs.getMaxMapTasks(),cs.getMaxReduceTasks(),state);
}
 catch (Exception e) {
LOG.error(e.toString());
e.printStackTrace();
HiveServerException ex=new HiveServerException();
ex.setMessage("Unable to get cluster status: " + e.toString());
throw ex;
}
return hcs;
}
