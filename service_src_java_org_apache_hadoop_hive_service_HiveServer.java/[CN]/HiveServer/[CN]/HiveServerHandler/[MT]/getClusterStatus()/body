{
  HiveClusterStatus hcs;
  try {
    ClusterStatus cs=driver.getClusterStatus();
    JobTracker.State jbs=cs.getJobTrackerState();
    int state;
switch (jbs) {
case INITIALIZING:
      state=JobTrackerState.INITIALIZING;
    break;
case RUNNING:
  state=JobTrackerState.RUNNING;
break;
default :
String errorMsg="Unrecognized JobTracker state: " + jbs.toString();
throw new Exception(errorMsg);
}
hcs=new HiveClusterStatus(cs.getTaskTrackers(),cs.getMapTasks(),cs.getReduceTasks(),cs.getMaxMapTasks(),cs.getMaxReduceTasks(),state);
}
 catch (Exception e) {
LOG.error(e.toString());
e.printStackTrace();
throw new HiveServerException("Unable to get cluster status: " + e.toString());
}
return hcs;
}
