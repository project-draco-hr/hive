{
  HiveServerHandler.LOG.info("Running the query: " + cmd);
  SessionState ss=SessionState.get();
  String cmd_trimmed=cmd.trim();
  String[] tokens=cmd_trimmed.split("\\s");
  String cmd_1=cmd_trimmed.substring(tokens[0].length()).trim();
  int ret=0;
  try {
    CommandProcessor proc=CommandProcessorFactory.get(tokens[0]);
    if (proc != null) {
      if (proc instanceof Driver) {
        isHiveQuery=true;
        ret=driver.run(cmd);
      }
 else {
        isHiveQuery=false;
        ret=proc.run(cmd_1);
      }
    }
  }
 catch (  Exception e) {
    throw new HiveServerException("Error running query: " + e.toString());
  }
  if (ret != 0) {
    throw new HiveServerException("Query returned non-zero code: " + ret);
  }
}
