{
  if (!isHiveQuery) {
    return new Schema();
  }
  try {
    Schema schema=driver.getThriftSchema();
    if (schema == null) {
      schema=new Schema();
    }
    LOG.info("Returning schema: " + schema);
    return schema;
  }
 catch (  Exception e) {
    LOG.error(e.toString());
    e.printStackTrace();
    HiveServerException ex=new HiveServerException();
    ex.setMessage("Unable to get schema: " + e.toString());
    throw ex;
  }
}
