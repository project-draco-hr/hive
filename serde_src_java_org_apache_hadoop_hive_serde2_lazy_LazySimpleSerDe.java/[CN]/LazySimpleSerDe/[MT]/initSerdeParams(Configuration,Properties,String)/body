{
  SerDeParameters serdeParams=new SerDeParameters();
  serdeParams.separators=new byte[8];
  serdeParams.separators[0]=getByte(tbl.getProperty(Constants.FIELD_DELIM,tbl.getProperty(Constants.SERIALIZATION_FORMAT)),DefaultSeparators[0]);
  serdeParams.separators[1]=getByte(tbl.getProperty(Constants.COLLECTION_DELIM),DefaultSeparators[1]);
  serdeParams.separators[2]=getByte(tbl.getProperty(Constants.MAPKEY_DELIM),DefaultSeparators[2]);
  for (int i=3; i < serdeParams.separators.length; i++) {
    serdeParams.separators[i]=(byte)(i + 1);
  }
  serdeParams.nullString=tbl.getProperty(Constants.SERIALIZATION_NULL_FORMAT,"\\N");
  serdeParams.nullSequence=new Text(serdeParams.nullString);
  String lastColumnTakesRestString=tbl.getProperty(Constants.SERIALIZATION_LAST_COLUMN_TAKES_REST);
  serdeParams.lastColumnTakesRest=(lastColumnTakesRestString != null && lastColumnTakesRestString.equalsIgnoreCase("true"));
  LazyUtils.extractColumnInfo(tbl,serdeParams,serdeName);
  serdeParams.rowTypeInfo=TypeInfoFactory.getStructTypeInfo(serdeParams.columnNames,serdeParams.columnTypes);
  String escapeProperty=tbl.getProperty(Constants.ESCAPE_CHAR);
  serdeParams.escaped=(escapeProperty != null);
  if (serdeParams.escaped) {
    serdeParams.escapeChar=getByte(escapeProperty,(byte)'\\');
  }
  if (serdeParams.escaped) {
    serdeParams.needsEscape=new boolean[128];
    for (int i=0; i < 128; i++) {
      serdeParams.needsEscape[i]=false;
    }
    serdeParams.needsEscape[serdeParams.escapeChar]=true;
    for (int i=0; i < serdeParams.separators.length; i++) {
      serdeParams.needsEscape[serdeParams.separators[i]]=true;
    }
  }
  return serdeParams;
}
