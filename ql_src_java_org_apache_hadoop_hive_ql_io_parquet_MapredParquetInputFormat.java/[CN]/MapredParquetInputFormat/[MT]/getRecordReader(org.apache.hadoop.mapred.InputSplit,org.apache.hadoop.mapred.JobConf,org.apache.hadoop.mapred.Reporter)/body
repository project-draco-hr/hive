{
  try {
    if (Utilities.isVectorMode(job)) {
      if (LOG.isDebugEnabled()) {
        LOG.debug("Using vectorized record reader");
      }
      return (RecordReader)vectorizedSelf.getRecordReader(split,job,reporter);
    }
 else {
      if (LOG.isDebugEnabled()) {
        LOG.debug("Using row-mode record reader");
      }
      return (RecordReader<Void,ArrayWritable>)new ParquetRecordReaderWrapper(realInput,split,job,reporter);
    }
  }
 catch (  final InterruptedException e) {
    throw new RuntimeException("Cannot create a RecordReaderWrapper",e);
  }
}
