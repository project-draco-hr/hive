{
  if (numLiterals == 0) {
    literals[numLiterals++]=value;
    tailRunLength=1;
  }
 else   if (repeat) {
    if (value == literals[0]) {
      numLiterals+=1;
      if (numLiterals == MAX_REPEAT_SIZE) {
        writeValues();
      }
    }
 else {
      writeValues();
      literals[numLiterals++]=value;
      tailRunLength=1;
    }
  }
 else {
    if (value == literals[numLiterals - 1]) {
      tailRunLength+=1;
    }
 else {
      tailRunLength=1;
    }
    if (tailRunLength == MIN_REPEAT_SIZE) {
      if (numLiterals + 1 == MIN_REPEAT_SIZE) {
        repeat=true;
        numLiterals+=1;
      }
 else {
        numLiterals-=MIN_REPEAT_SIZE - 1;
        writeValues();
        literals[0]=value;
        repeat=true;
        numLiterals=MIN_REPEAT_SIZE;
      }
    }
 else {
      literals[numLiterals++]=value;
      if (numLiterals == MAX_LITERAL_SIZE) {
        writeValues();
      }
    }
  }
}
