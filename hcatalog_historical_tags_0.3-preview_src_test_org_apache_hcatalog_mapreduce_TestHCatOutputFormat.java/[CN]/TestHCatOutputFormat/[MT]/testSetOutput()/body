{
  Configuration conf=new Configuration();
  Job job=new Job(conf,"test outputformat");
  Map<String,String> partitionValues=new HashMap<String,String>();
  partitionValues.put("colname","p1");
  OutputJobInfo info=OutputJobInfo.create(dbName,tblName,partitionValues,null,null);
  HCatOutputFormat.setOutput(job,info);
  OutputJobInfo jobInfo=HCatOutputFormat.getJobInfo(job);
  assertNotNull(jobInfo.getTableInfo());
  assertEquals(1,jobInfo.getPartitionValues().size());
  assertEquals("p1",jobInfo.getPartitionValues().get("colname"));
  assertEquals(1,jobInfo.getTableInfo().getDataColumns().getFields().size());
  assertEquals("colname",jobInfo.getTableInfo().getDataColumns().getFields().get(0).getName());
  StorerInfo storer=jobInfo.getTableInfo().getStorerInfo();
  assertEquals(RCFileOutputDriver.class.getName(),storer.getOutputSDClass());
  publishTest(job);
}
