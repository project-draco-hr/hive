{
  OutputJobInfo jobInfo=getJobInfo(context.getConfiguration());
  HiveStorageHandler storageHandler=HCatUtil.getStorageHandler(context.getConfiguration(),jobInfo.getTableInfo().getStorerInfo());
  configureOutputStorageHandler(context);
  if (storageHandler instanceof FosterStorageHandler) {
    return new FileOutputFormatContainer(ReflectionUtils.newInstance(storageHandler.getOutputFormatClass(),context.getConfiguration()));
  }
 else {
    return new DefaultOutputFormatContainer(ReflectionUtils.newInstance(storageHandler.getOutputFormatClass(),context.getConfiguration()));
  }
}
