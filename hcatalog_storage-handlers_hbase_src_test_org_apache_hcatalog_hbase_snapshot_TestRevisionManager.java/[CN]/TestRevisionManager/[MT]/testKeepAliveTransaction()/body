{
  int port=getHbaseConf().getInt("hbase.zookeeper.property.clientPort",2181);
  String servers=getHbaseConf().get("hbase.zookeeper.quorum");
  String[] splits=servers.split(",");
  StringBuffer sb=new StringBuffer();
  for (  String split : splits) {
    sb.append(split);
    sb.append(':');
    sb.append(port);
  }
  Configuration conf=RevisionManagerConfiguration.create(getHbaseConf());
  conf.set(RMConstants.ZOOKEEPER_DATADIR,"/rm_base");
  ZKBasedRevisionManager manager=new ZKBasedRevisionManager();
  manager.initialize(conf);
  manager.open();
  String tableName=newTableName("testTable");
  List<String> columnFamilies=Arrays.asList("cf1","cf2");
  Transaction txn=manager.beginWriteTransaction(tableName,columnFamilies,40);
  Thread.sleep(100);
  try {
    manager.commitWriteTransaction(txn);
  }
 catch (  Exception e) {
    assertTrue(e instanceof IOException);
    assertEquals(e.getMessage(),"The transaction to be removed not found in the data.");
  }
}
