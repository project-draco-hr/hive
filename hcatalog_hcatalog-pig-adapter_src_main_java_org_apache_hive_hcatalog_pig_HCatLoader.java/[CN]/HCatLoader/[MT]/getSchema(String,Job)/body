{
  HCatContext.INSTANCE.setConf(job.getConfiguration()).getConf().get().setBoolean(HCatConstants.HCAT_DATA_TINY_SMALL_INT_PROMOTION,true);
  Table table=phutil.getTable(location,hcatServerUri != null ? hcatServerUri : PigHCatUtil.getHCatServerUri(job),PigHCatUtil.getHCatServerPrincipal(job),job);
  HCatSchema hcatTableSchema=HCatUtil.getTableSchemaWithPtnCols(table);
  try {
    PigHCatUtil.validateHCatTableSchemaFollowsPigRules(hcatTableSchema);
  }
 catch (  IOException e) {
    throw new PigException("Table schema incompatible for reading through HCatLoader :" + e.getMessage() + ";[Table schema was "+ hcatTableSchema.toString()+ "]",PigHCatUtil.PIG_EXCEPTION_CODE,e);
  }
  storeInUDFContext(signature,HCatConstants.HCAT_TABLE_SCHEMA,hcatTableSchema);
  outputSchema=hcatTableSchema;
  return PigHCatUtil.getResourceSchema(hcatTableSchema);
}
