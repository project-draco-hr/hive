{
  String parentPath=tableLocation;
  if (dynHash != null) {
    parentPath=new Path(tableLocation,HCatOutputFormat.DYNTEMP_DIR_NAME + dynHash).toString();
  }
  if ((dynHash == null) && (partitionValues == null || partitionValues.size() == 0)) {
    return new Path(tableLocation,HCatOutputFormat.TEMP_DIR_NAME).toString();
  }
  List<String> values=new ArrayList<String>();
  for (  String partitionCol : partitionCols) {
    values.add(partitionValues.get(partitionCol));
  }
  String partitionLocation=FileUtils.makePartName(partitionCols,values);
  Path path=new Path(parentPath,partitionLocation);
  return path.toString();
}
