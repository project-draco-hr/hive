{
  List<String> fieldNames=new ArrayList<>();
  for (  FieldSchema fieldSchema : resultSchema) {
    fieldNames.add(fieldSchema.getName());
  }
  RelNode newRoot=null;
  List<RexNode> projectList=null;
  if (!(optimizedOptiqPlan instanceof Project)) {
    projectList=HiveCalciteUtil.getProjsFromBelowAsInputRef(optimizedOptiqPlan);
    newRoot=HiveProject.create(optimizedOptiqPlan,projectList,fieldNames);
  }
 else {
    HiveProject project=(HiveProject)optimizedOptiqPlan;
    newRoot=HiveProject.create(project.getInput(0),project.getChildExps(),fieldNames);
  }
  return newRoot;
}
