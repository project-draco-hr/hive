{
  byte[][] checkBytes=null;
  BytesRefArrayWritable checkRow=new BytesRefArrayWritable(allColumnsNumber);
  if (chechCorrect) {
    resetRandomGenerators();
    checkBytes=new byte[allColumnsNumber][];
  }
  int actualReadCount=0;
  ColumnProjectionUtils.setReadAllColumns(conf);
  RCFile.Reader reader=new RCFile.Reader(fs,file,conf);
  LongWritable rowID=new LongWritable();
  BytesRefArrayWritable cols=new BytesRefArrayWritable();
  while (reader.next(rowID)) {
    reader.getCurrentRow(cols);
    boolean ok=true;
    if (chechCorrect) {
      nextRandomRow(checkBytes,checkRow);
      ok=ok && checkRow.equals(cols);
    }
    if (!ok) {
      throw new IllegalStateException("Compare read and write error.");
    }
    actualReadCount++;
  }
  return actualReadCount;
}
