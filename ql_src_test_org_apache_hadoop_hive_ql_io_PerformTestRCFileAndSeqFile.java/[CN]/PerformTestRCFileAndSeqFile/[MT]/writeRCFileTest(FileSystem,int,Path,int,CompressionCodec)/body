{
  fs.delete(file,true);
  resetRandomGenerators();
  RCFileOutputFormat.setColumnNumber(conf,columnNum);
  RCFile.Writer writer=new RCFile.Writer(fs,conf,file,null,codec);
  byte[][] columnRandom;
  BytesRefArrayWritable bytes=new BytesRefArrayWritable(columnNum);
  columnRandom=new byte[columnNum][];
  for (int i=0; i < columnNum; i++) {
    BytesRefWritable cu=new BytesRefWritable();
    bytes.set(i,cu);
  }
  for (int i=0; i < rowCount; i++) {
    nextRandomRow(columnRandom,bytes);
    writer.append(bytes);
  }
  writer.close();
}
