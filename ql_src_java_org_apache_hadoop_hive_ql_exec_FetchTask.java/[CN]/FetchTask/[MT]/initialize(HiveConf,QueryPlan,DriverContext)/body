{
  super.initialize(conf,queryPlan,ctx);
  work.initializeForFetch();
  try {
    JobConf job=new JobConf(conf);
    Operator<?> source=work.getSource();
    if (source instanceof TableScanOperator) {
      TableScanOperator ts=(TableScanOperator)source;
      ColumnProjectionUtils.appendReadColumns(job,ts.getNeededColumnIDs(),ts.getNeededColumns());
      HiveInputFormat.pushFilters(job,ts);
    }
    sink=work.getSink();
    fetch=new FetchOperator(work,job,source,getVirtualColumns(source));
    source.initialize(conf,new ObjectInspector[]{fetch.getOutputObjectInspector()});
  }
 catch (  Exception e) {
    LOG.error(StringUtils.stringifyException(e));
    throw new RuntimeException(e);
  }
}
