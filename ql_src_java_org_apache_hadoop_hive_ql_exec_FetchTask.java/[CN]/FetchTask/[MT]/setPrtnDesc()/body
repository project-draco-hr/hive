{
  List<String> partNames=new ArrayList<String>();
  List<String> partValues=new ArrayList<String>();
  String pcols=currPart.getTableDesc().getProperties().getProperty(org.apache.hadoop.hive.metastore.api.Constants.META_TABLE_PARTITION_COLUMNS);
  LinkedHashMap<String,String> partSpec=currPart.getPartSpec();
  List<ObjectInspector> partObjectInspectors=new ArrayList<ObjectInspector>();
  String[] partKeys=pcols.trim().split("/");
  for (  String key : partKeys) {
    partNames.add(key);
    partValues.add(partSpec.get(key));
    partObjectInspectors.add(ObjectInspectorFactory.getStandardPrimitiveObjectInspector(String.class));
  }
  StructObjectInspector partObjectInspector=ObjectInspectorFactory.getStandardStructObjectInspector(partNames,partObjectInspectors);
  rowObjectInspector=(StructObjectInspector)serde.getObjectInspector();
  rowWithPart[1]=partValues;
  rowObjectInspector=ObjectInspectorFactory.getUnionStructObjectInspector(Arrays.asList(new StructObjectInspector[]{rowObjectInspector,partObjectInspector}));
}
