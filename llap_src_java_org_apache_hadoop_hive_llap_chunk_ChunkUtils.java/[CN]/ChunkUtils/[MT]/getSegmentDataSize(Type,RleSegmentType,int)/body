{
  int valueSize=TYPE_SIZES[type.value()];
switch (segmentType) {
case REPEATING_NULL:
    return 0;
case REPEATING_VALUE:
  return valueSize;
case UNIQUE_NOT_NULL:
return valueSize * rowCount;
case UNIQUE_NULL_BITMASK:
return valueSize * rowCount + align8(bitMaskSize(rowCount));
default :
throw new AssertionError("Unsupported segment type " + segmentType);
}
}
