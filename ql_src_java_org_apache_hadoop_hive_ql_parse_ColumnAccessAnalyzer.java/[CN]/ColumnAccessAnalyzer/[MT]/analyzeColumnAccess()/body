{
  ColumnAccessInfo columnAccessInfo=new ColumnAccessInfo();
  Collection<Operator<? extends OperatorDesc>> topOps=pGraphContext.getTopOps().values();
  for (  Operator<? extends OperatorDesc> op : topOps) {
    if (op instanceof TableScanOperator) {
      TableScanOperator top=(TableScanOperator)op;
      Table table=top.getConf().getTableMetadata();
      String tableName=table.getCompleteName();
      List<String> referenced=top.getReferencedColumns();
      for (      String column : referenced) {
        columnAccessInfo.add(tableName,column);
      }
      if (table.isPartitioned()) {
        PrunedPartitionList parts=pGraphContext.getPrunedPartitions(table.getTableName(),top);
        if (parts.getReferredPartCols() != null) {
          for (          String partKey : parts.getReferredPartCols()) {
            columnAccessInfo.add(tableName,partKey);
          }
        }
      }
    }
  }
  return columnAccessInfo;
}
