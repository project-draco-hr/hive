{
  TreeMap<Key,ByteBuffer> tree=getBufferTree(buffer.isDirect());
  while (true) {
    Key key=new Key(buffer.capacity(),currentGeneration++);
    if (!tree.containsKey(key)) {
      tree.put(key,buffer);
      return;
    }
  }
}
