{
  long offset=stripes.get(stripeIndex).getOffset();
  OrcProto.StripeFooter stripeFooter;
  OrcProto.RowIndex[] indexes;
  if (stripeIndex == currentStripe) {
    stripeFooter=this.stripeFooter;
    indexes=this.indexes;
  }
 else {
    stripeFooter=readStripeFooter(stripes.get(stripeIndex));
    indexes=new OrcProto.RowIndex[this.indexes.length];
  }
  for (  OrcProto.Stream stream : stripeFooter.getStreamsList()) {
    if (stream.getKind() == OrcProto.Stream.Kind.ROW_INDEX) {
      int col=stream.getColumn();
      if ((included == null || included[col]) && indexes[col] == null) {
        byte[] buffer=new byte[(int)stream.getLength()];
        file.seek(offset);
        file.readFully(buffer);
        indexes[col]=OrcProto.RowIndex.parseFrom(InStream.create("index",new ByteBuffer[]{ByteBuffer.wrap(buffer)},new long[]{0},stream.getLength(),codec,bufferSize));
      }
    }
    offset+=stream.getLength();
  }
  return indexes;
}
