{
  VectorizedRowBatch result=null;
  if (rowInStripe >= rowCountInStripe) {
    currentStripe+=1;
    readStripe();
  }
  long batchSize=Math.min(VectorizedRowBatch.DEFAULT_SIZE,(rowCountInStripe - rowInStripe));
  rowInStripe+=batchSize;
  if (previous == null) {
    ColumnVector[] cols=(ColumnVector[])reader.nextVector(null,(int)batchSize);
    result=new VectorizedRowBatch(cols.length);
    result.cols=cols;
  }
 else {
    result=(VectorizedRowBatch)previous;
    result.selectedInUse=false;
    reader.nextVector(result.cols,(int)batchSize);
  }
  result.size=(int)batchSize;
  advanceToNextRow(rowInStripe + rowBaseInStripe);
  return result;
}
