{
  try {
    final VectorizedRowBatch result;
    if (rowInStripe >= rowCountInStripe) {
      currentStripe+=1;
      readStripe();
    }
    long batchSize=computeBatchSize(VectorizedRowBatch.DEFAULT_SIZE);
    rowInStripe+=batchSize;
    if (previous == null) {
      ColumnVector[] cols=(ColumnVector[])reader.nextVector(null,(int)batchSize);
      result=new VectorizedRowBatch(cols.length);
      result.cols=cols;
    }
 else {
      result=(VectorizedRowBatch)previous;
      result.selectedInUse=false;
      reader.setVectorColumnCount(result.getDataColumnCount());
      reader.nextVector(result.cols,(int)batchSize);
    }
    result.size=(int)batchSize;
    advanceToNextRow(reader,rowInStripe + rowBaseInStripe,true);
    return result;
  }
 catch (  IOException e) {
    throw new IOException("Error reading file: " + path,e);
  }
}
