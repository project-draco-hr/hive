{
  LinkedList<DiskRange> result=new LinkedList<DiskRange>();
  long offset=0;
  boolean[] hasNull=RecordReaderUtils.findPresentStreamsByColumn(streamList,types);
  DiskRange lastRange=null;
  for (  OrcProto.Stream stream : streamList) {
    long length=stream.getLength();
    int column=stream.getColumn();
    OrcProto.Stream.Kind streamKind=stream.getKind();
    if (stream.hasKind() && (StreamName.getArea(streamKind) == StreamName.Area.DATA) && includedColumns[column]) {
      if (includedRowGroups == null || RecordReaderUtils.isDictionary(streamKind,encodings.get(column))) {
        lastRange=RecordReaderUtils.addEntireStreamToRanges(offset,length,lastRange,result);
      }
 else {
        lastRange=RecordReaderUtils.addRgFilteredStreamToRanges(stream,includedRowGroups,isCompressed,indexes[column],encodings.get(column),types.get(column),compressionSize,hasNull[column],offset,length,lastRange,result);
      }
    }
    offset+=length;
  }
  return result;
}
