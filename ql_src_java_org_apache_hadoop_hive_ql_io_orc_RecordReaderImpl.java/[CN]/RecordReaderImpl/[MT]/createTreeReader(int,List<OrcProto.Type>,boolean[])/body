{
  OrcProto.Type type=types.get(columnId);
switch (type.getKind()) {
case BOOLEAN:
    return new BooleanTreeReader(columnId);
case BYTE:
  return new ByteTreeReader(columnId);
case DOUBLE:
return new DoubleTreeReader(columnId);
case FLOAT:
return new FloatTreeReader(columnId);
case SHORT:
return new ShortTreeReader(columnId);
case INT:
return new IntTreeReader(columnId);
case LONG:
return new LongTreeReader(columnId);
case STRING:
return new StringTreeReader(columnId);
case BINARY:
return new BinaryTreeReader(columnId);
case TIMESTAMP:
return new TimestampTreeReader(columnId);
case STRUCT:
return new StructTreeReader(columnId,types,included);
case LIST:
return new ListTreeReader(columnId,types,included);
case MAP:
return new MapTreeReader(columnId,types,included);
case UNION:
return new UnionTreeReader(columnId,types,included);
default :
throw new IllegalArgumentException("Unsupported type " + type.getKind());
}
}
