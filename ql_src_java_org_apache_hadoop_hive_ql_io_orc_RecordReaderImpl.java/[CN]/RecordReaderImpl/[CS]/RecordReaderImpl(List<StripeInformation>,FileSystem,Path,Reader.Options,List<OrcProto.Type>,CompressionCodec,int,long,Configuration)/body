{
  this.fileName=path.toString().intern();
  this.file=fileSystem.open(path);
  this.codec=codec;
  this.types=types;
  this.bufferSize=bufferSize;
  this.included=options.getInclude();
  this.conf=conf;
  this.rowIndexStride=strideRate;
  this.metadata=new MetadataReader(file,codec,bufferSize,types.size());
  SearchArgument sarg=options.getSearchArgument();
  if (sarg != null && strideRate != 0) {
    sargApp=new SargApplier(sarg,options.getColumnNames(),strideRate);
  }
 else {
    sargApp=null;
  }
  long rows=0;
  long skippedRows=0;
  long offset=options.getOffset();
  long maxOffset=options.getMaxOffset();
  for (  StripeInformation stripe : stripes) {
    long stripeStart=stripe.getOffset();
    if (offset > stripeStart) {
      skippedRows+=stripe.getNumberOfRows();
    }
 else     if (stripeStart < maxOffset) {
      this.stripes.add(stripe);
      rows+=stripe.getNumberOfRows();
    }
  }
  final boolean zeroCopy=(conf != null) && (HiveConf.getBoolVar(conf,HIVE_ORC_ZEROCOPY));
  zcr=zeroCopy ? RecordReaderUtils.createZeroCopyShim(file,codec,pool) : null;
  firstRow=skippedRows;
  totalRowCount=rows;
  reader=createTreeReader(path,0,types,included,conf);
  indexes=new OrcProto.RowIndex[types.size()];
  advanceToNextRow(reader,0L,true);
}
