{
  this.file=fileSystem.open(path);
  this.codec=codec;
  this.bufferSize=bufferSize;
  this.included=included;
  long rows=0;
  long skippedRows=0;
  for (  StripeInformation stripe : stripes) {
    long stripeStart=stripe.getOffset();
    if (offset > stripeStart) {
      skippedRows+=stripe.getNumberOfRows();
    }
 else     if (stripeStart < offset + length) {
      this.stripes.add(stripe);
      rows+=stripe.getNumberOfRows();
    }
  }
  firstRow=skippedRows;
  totalRowCount=rows;
  reader=createTreeReader(path,0,types,included);
  indexes=new OrcProto.RowIndex[types.size()];
  rowIndexStride=strideRate;
  if (this.stripes.size() > 0) {
    readStripe();
  }
}
