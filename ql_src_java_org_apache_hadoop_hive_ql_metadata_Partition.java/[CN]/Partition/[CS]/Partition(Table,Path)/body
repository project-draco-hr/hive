{
  this.table=tbl;
  this.tPartition=new org.apache.hadoop.hive.metastore.api.Partition();
  this.tPartition.setDbName(tbl.getDbName());
  this.tPartition.setTableName(tbl.getName());
  StorageDescriptor sd=tbl.getTTable().getSd();
  StorageDescriptor psd=new StorageDescriptor(sd.getCols(),sd.getLocation(),sd.getInputFormat(),sd.getOutputFormat(),sd.isCompressed(),sd.getNumBuckets(),sd.getSerdeInfo(),sd.getBucketCols(),sd.getSortCols(),new HashMap<String,String>());
  this.tPartition.setSd(psd);
  if (table.isPartitioned()) {
    this.partPath=path;
  }
 else {
    this.partPath=table.getPath();
  }
  spec=makeSpecFromPath();
  psd.setLocation(this.partPath.toString());
  List<String> partVals=new ArrayList<String>();
  tPartition.setValues(partVals);
  for (  FieldSchema field : tbl.getPartCols()) {
    partVals.add(spec.get(field.getName()));
  }
  try {
    this.partName=Warehouse.makePartName(tbl.getPartCols(),partVals);
  }
 catch (  MetaException e) {
    throw new HiveException("Invalid partition key values",e);
  }
}
