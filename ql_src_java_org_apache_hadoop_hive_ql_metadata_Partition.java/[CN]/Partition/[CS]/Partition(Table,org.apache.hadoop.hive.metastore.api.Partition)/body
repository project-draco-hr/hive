{
  this.table=tbl;
  this.tPartition=tp;
  String partName="";
  if (table.isPartitioned()) {
    try {
      partName=Warehouse.makePartName(tbl.getPartCols(),tp.getValues());
    }
 catch (    MetaException e) {
      throw new HiveException("Invalid partition for table " + tbl.getName(),e);
    }
    this.partPath=new Path(table.getPath(),partName);
  }
 else {
    this.partPath=table.getPath();
  }
  spec=makeSpecFromPath();
  URI tmpURI=table.getDataLocation();
  try {
    partURI=new URI(tmpURI.getScheme(),tmpURI.getAuthority(),tmpURI.getPath() + "/" + partName,null,null);
  }
 catch (  URISyntaxException e) {
    throw new RuntimeException(e);
  }
}
