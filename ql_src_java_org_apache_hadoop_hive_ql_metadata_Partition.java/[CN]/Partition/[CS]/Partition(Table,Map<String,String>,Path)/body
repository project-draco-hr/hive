{
  List<String> pvals=new ArrayList<String>();
  for (  FieldSchema field : tbl.getPartCols()) {
    pvals.add(partSpec.get(field.getName()));
  }
  org.apache.hadoop.hive.metastore.api.Partition tpart=new org.apache.hadoop.hive.metastore.api.Partition();
  tpart.setDbName(tbl.getDbName());
  tpart.setTableName(tbl.getName());
  tpart.setValues(pvals);
  StorageDescriptor sd=new StorageDescriptor();
  try {
    TMemoryBuffer buffer=new TMemoryBuffer(1024);
    TBinaryProtocol prot=new TBinaryProtocol(buffer);
    tbl.getTTable().getSd().write(prot);
    sd.read(prot);
  }
 catch (  TException e) {
    LOG.error("Could not create a copy of StorageDescription");
    throw new HiveException("Could not create a copy of StorageDescription");
  }
  tpart.setSd(sd);
  tpart.getSd().setLocation(location.toString());
  initialize(tbl,tpart);
}
