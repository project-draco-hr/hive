{
  try {
    FileSystem fs=FileSystem.get(getPartitionPath().toUri(),Hive.get().getConf());
    String pathPattern=getPartitionPath().toString();
    if (getBucketCount() > 0) {
      pathPattern=pathPattern + "/*";
    }
    LOG.info("Path pattern = " + pathPattern);
    FileStatus srcs[]=fs.globStatus(new Path(pathPattern));
    Arrays.sort(srcs);
    for (    FileStatus src : srcs) {
      LOG.info("Got file: " + src.getPath());
    }
    if (srcs.length == 0) {
      return null;
    }
    return srcs[bucketNum].getPath();
  }
 catch (  Exception e) {
    throw new RuntimeException("Cannot get bucket path for bucket " + bucketNum,e);
  }
}
