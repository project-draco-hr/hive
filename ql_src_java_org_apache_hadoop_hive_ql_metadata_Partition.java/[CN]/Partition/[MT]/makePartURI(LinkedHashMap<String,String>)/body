{
  StringBuffer suffix=new StringBuffer();
  if (table.getPartCols() != null) {
    for (    FieldSchema k : table.getPartCols()) {
      suffix.append(k + "=" + spec.get(k.getName())+ "/");
    }
  }
  URI tmpURI=table.getDataLocation();
  try {
    return new URI(tmpURI.getScheme(),tmpURI.getAuthority(),tmpURI.getPath() + suffix.toString(),null,null);
  }
 catch (  URISyntaxException e) {
    throw new HiveException(e);
  }
}
