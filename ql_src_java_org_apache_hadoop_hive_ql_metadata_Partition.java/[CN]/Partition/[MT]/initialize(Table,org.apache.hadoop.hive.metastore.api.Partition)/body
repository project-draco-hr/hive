{
  table=tbl;
  tPartition=tp;
  partName="";
  if (tbl.isPartitioned()) {
    try {
      partName=Warehouse.makePartName(tbl.getPartCols(),tp.getValues());
      if (tp.getSd().getLocation() == null) {
        partPath=new Path(tbl.getDataLocation().toString(),partName);
        tp.getSd().setLocation(partPath.toString());
      }
 else {
        partPath=new Path(tp.getSd().getLocation());
      }
    }
 catch (    MetaException e) {
      throw new HiveException("Invalid partition for table " + tbl.getName(),e);
    }
  }
 else {
    partPath=table.getPath();
  }
  spec=tbl.createSpec(tp);
  partURI=partPath.toUri();
}
