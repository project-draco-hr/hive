{
  this.table=tbl;
  this.tPartition=tp;
  this.partName="";
  if (tbl.isPartitioned()) {
    try {
      this.partName=Warehouse.makePartName(tbl.getPartCols(),tp.getValues());
    }
 catch (    MetaException e) {
      throw new HiveException("Invalid partition for table " + tbl.getName(),e);
    }
    this.partPath=new Path(tp.getSd().getLocation());
  }
 else {
    this.partPath=table.getPath();
  }
  this.spec=new LinkedHashMap<String,String>(tbl.createSpec(tp));
  this.partURI=partPath.toUri();
}
