{
  this.table=table;
  this.tPartition=tPartition;
  String partName="";
  if (table.isPartitioned()) {
    try {
      partName=Warehouse.makePartName(table.getPartCols(),tPartition.getValues());
      if (tPartition.getSd().getLocation() == null) {
        Path partPath=new Path(table.getDataLocation().toString(),partName);
        tPartition.getSd().setLocation(partPath.toString());
      }
    }
 catch (    MetaException e) {
      throw new HiveException("Invalid partition for table " + table.getTableName(),e);
    }
  }
  getInputFormatClass();
  getOutputFormatClass();
}
