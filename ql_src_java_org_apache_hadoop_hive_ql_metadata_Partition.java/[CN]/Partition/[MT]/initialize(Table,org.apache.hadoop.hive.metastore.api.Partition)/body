{
  this.table=table;
  this.tPartition=tPartition;
  if (table.isView()) {
    return;
  }
  if (table.isPartitioned()) {
    try {
      if (tPartition.getSd().getLocation() == null) {
        if (table.getDataLocation() != null) {
          Path partPath=new Path(table.getDataLocation(),Warehouse.makePartName(table.getPartCols(),tPartition.getValues()));
          tPartition.getSd().setLocation(partPath.toString());
        }
      }
      if (tPartition.getSd().getCols() == null) {
        if (table.getCols() != null) {
          tPartition.getSd().setCols(table.getCols());
        }
      }
    }
 catch (    MetaException e) {
      throw new HiveException("Invalid partition for table " + table.getTableName(),e);
    }
  }
}
