{
  if (outputFormatClass == null) {
    String clsName=null;
    if (tPartition != null && tPartition.getSd() != null) {
      clsName=tPartition.getSd().getOutputFormat();
    }
    if (clsName == null) {
      clsName=HiveSequenceFileOutputFormat.class.getName();
    }
    try {
      Class<?> c=(Class.forName(clsName,true,Utilities.getSessionSpecifiedClassLoader()));
      if (!HiveOutputFormat.class.isAssignableFrom(c)) {
        outputFormatClass=HiveFileFormatUtils.getOutputFormatSubstitute(c,false);
      }
 else {
        outputFormatClass=(Class<? extends HiveOutputFormat>)c;
      }
    }
 catch (    ClassNotFoundException e) {
      throw new HiveException("Class not found: " + clsName,e);
    }
  }
  return outputFormatClass;
}
