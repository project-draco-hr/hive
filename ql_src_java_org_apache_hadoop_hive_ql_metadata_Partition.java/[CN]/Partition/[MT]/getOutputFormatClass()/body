{
  if (outputFormatClass == null) {
    String clsName=getSchema().getProperty(org.apache.hadoop.hive.metastore.api.Constants.FILE_OUTPUT_FORMAT,HiveSequenceFileOutputFormat.class.getName());
    try {
      Class<?> c=(Class<? extends HiveOutputFormat>)(Class.forName(clsName,true,JavaUtils.getClassLoader()));
      if (!HiveOutputFormat.class.isAssignableFrom(c)) {
        outputFormatClass=HiveFileFormatUtils.getOutputFormatSubstitute(c);
      }
 else {
        outputFormatClass=(Class<? extends HiveOutputFormat>)c;
      }
    }
 catch (    ClassNotFoundException e) {
      throw new HiveException("Class not found: " + clsName,e);
    }
  }
  return outputFormatClass;
}
