{
  String defaultQueues=HiveConf.getVar(conf,HiveConf.ConfVars.HIVE_SERVER2_TEZ_DEFAULT_QUEUES);
  int numSessions=conf.getIntVar(HiveConf.ConfVars.HIVE_SERVER2_TEZ_SESSIONS_PER_DEFAULT_QUEUE);
  numConcurrentLlapQueries=conf.getIntVar(HiveConf.ConfVars.HIVE_SERVER2_LLAP_CONCURRENT_QUERIES);
  String defaultQueueList[]=defaultQueues.split(",");
  defaultQueuePool=new ArrayBlockingQueue<TezSessionState>(numSessions * defaultQueueList.length);
  llapQueue=new Semaphore(numConcurrentLlapQueries,true);
  this.initConf=conf;
  blockingQueueLength=0;
  for (int i=0; i < numSessions; i++) {
    for (    String queue : defaultQueueList) {
      if (queue.length() == 0) {
        continue;
      }
      TezSessionState sessionState=createSession(TezSessionState.makeSessionId());
      sessionState.setQueueName(queue);
      sessionState.setDefault();
      LOG.info("Created new tez session for queue: " + queue + " with session id: "+ sessionState.getSessionId());
      defaultQueuePool.put(sessionState);
      blockingQueueLength++;
    }
  }
}
