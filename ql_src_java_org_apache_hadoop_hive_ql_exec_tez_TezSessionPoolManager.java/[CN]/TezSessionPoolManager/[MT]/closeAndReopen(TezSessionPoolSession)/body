{
  String queueName=oldSession.getQueueName();
  HiveConf conf=oldSession.getConf();
  Path scratchDir=oldSession.getTezScratchDir();
  boolean isDefault=oldSession.isDefault();
  Set<String> additionalFiles=oldSession.getAdditionalFilesNotFromConf();
  try {
    oldSession.close(false);
    defaultQueuePool.remove(oldSession);
  }
  finally {
    TezSessionPoolSession newSession=createAndInitSession(queueName,isDefault);
    newSession.open(conf,additionalFiles,scratchDir);
    defaultQueuePool.put(newSession);
  }
}
