{
  if (llap && (this.numConcurrentLlapQueries > 0)) {
    llapQueue.acquire();
  }
  if (canWorkWithSameSession(session,conf)) {
    return session;
  }
  if (session != null) {
    close(session,false);
  }
  return getSession(conf,doOpen,forceCreate);
}
