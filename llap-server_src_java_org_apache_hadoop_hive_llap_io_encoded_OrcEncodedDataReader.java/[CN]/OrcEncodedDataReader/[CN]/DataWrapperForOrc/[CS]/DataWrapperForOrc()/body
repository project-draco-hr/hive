{
  boolean useZeroCopy=(conf != null) && HiveConf.getBoolVar(conf,HiveConf.ConfVars.HIVE_ORC_ZEROCOPY);
  if (useZeroCopy && !lowLevelCache.getAllocator().isDirectAlloc()) {
    throw new UnsupportedOperationException("Cannot use zero-copy reader with non-direct cache " + "buffers; either disable zero-copy or enable direct cache allocation");
  }
  this.orcDataReader=orcReader.createDefaultDataReader(useZeroCopy);
}
