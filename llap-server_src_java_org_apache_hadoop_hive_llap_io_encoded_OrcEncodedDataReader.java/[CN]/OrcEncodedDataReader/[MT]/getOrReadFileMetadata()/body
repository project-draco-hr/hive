{
  OrcFileMetadata metadata=null;
  if (fileKey != null && metadataCache != null) {
    metadata=metadataCache.getFileMetadata(fileKey);
    if (metadata != null) {
      counters.incrCounter(LlapIOCounters.METADATA_CACHE_HIT);
      return metadata;
    }
 else {
      counters.incrCounter(LlapIOCounters.METADATA_CACHE_MISS);
    }
  }
  ensureOrcReader();
  metadata=new OrcFileMetadata(fileKey,orcReader);
  if (fileKey == null || metadataCache == null)   return metadata;
  return metadataCache.putFileMetadata(metadata);
}
