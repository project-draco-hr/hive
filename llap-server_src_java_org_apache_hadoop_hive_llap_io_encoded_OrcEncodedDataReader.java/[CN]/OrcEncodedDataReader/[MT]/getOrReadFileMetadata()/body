{
  OrcFileMetadata metadata=null;
  if (fileId != null && metadataCache != null) {
    metadata=metadataCache.getFileMetadata(fileId);
    if (metadata != null) {
      counters.incrCounter(Counter.METADATA_CACHE_HIT);
      return metadata;
    }
 else {
      counters.incrCounter(Counter.METADATA_CACHE_MISS);
    }
  }
  ensureOrcReader();
  metadata=new OrcFileMetadata(fileId != null ? fileId : 0,orcReader);
  if (fileId == null || metadataCache == null)   return metadata;
  return metadataCache.putFileMetadata(metadata);
}
