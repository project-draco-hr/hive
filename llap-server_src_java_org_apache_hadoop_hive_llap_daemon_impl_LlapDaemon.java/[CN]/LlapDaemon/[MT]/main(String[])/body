{
  LlapDaemon llapDaemon=null;
  try {
    LlapDaemonConfiguration daemonConf=new LlapDaemonConfiguration();
    Configuration shuffleHandlerConf=new Configuration(daemonConf);
    shuffleHandlerConf.set(ShuffleHandler.SHUFFLE_HANDLER_LOCAL_DIRS,daemonConf.get(LlapDaemonConfiguration.LLAP_DAEMON_WORK_DIRS));
    ShuffleHandler.initializeAndStart(shuffleHandlerConf);
    llapDaemon=new LlapDaemon(daemonConf);
    llapDaemon.init(daemonConf);
    llapDaemon.start();
    LOG.info("Started LlapDaemon");
  }
 catch (  Throwable t) {
    LOG.warn("Failed to start LLAP Daemon with exception",t);
    if (llapDaemon != null) {
      llapDaemon.shutdown();
    }
    System.exit(-1);
  }
}
