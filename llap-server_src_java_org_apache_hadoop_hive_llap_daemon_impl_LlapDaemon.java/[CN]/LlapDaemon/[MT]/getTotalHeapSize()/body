{
  long total=0;
  MemoryMXBean m=ManagementFactory.getMemoryMXBean();
  for (  MemoryPoolMXBean mp : ManagementFactory.getMemoryPoolMXBeans()) {
    long sz=mp.getUsage().getMax();
    if (mp.getName().contains("Survivor")) {
      sz*=2;
    }
    if (mp.getType().equals(MemoryType.HEAP)) {
      total+=sz;
    }
  }
  return total;
}
