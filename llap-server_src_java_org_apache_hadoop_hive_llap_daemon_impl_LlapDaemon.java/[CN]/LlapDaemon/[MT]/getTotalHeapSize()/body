{
  long total=0;
  for (  MemoryPoolMXBean mp : ManagementFactory.getMemoryPoolMXBeans()) {
    long sz=mp.getUsage().getMax();
    if (mp.getName().contains("Survivor")) {
      sz*=2;
    }
    if (mp.getType().equals(MemoryType.HEAP)) {
      total+=sz;
    }
  }
  total+=(total % (1024 * 1024));
  return total;
}
