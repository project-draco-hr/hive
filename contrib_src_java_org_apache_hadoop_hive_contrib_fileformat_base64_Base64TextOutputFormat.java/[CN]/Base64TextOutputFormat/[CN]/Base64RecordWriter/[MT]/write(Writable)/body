{
  byte[] input;
  int inputLength;
  if (w instanceof Text) {
    input=((Text)w).getBytes();
    inputLength=((Text)w).getLength();
  }
 else {
    assert(w instanceof BytesWritable);
    input=((BytesWritable)w).getBytes();
    inputLength=((BytesWritable)w).getLength();
  }
  byte[] wrapped=new byte[signature.length + inputLength];
  for (int i=0; i < signature.length; i++) {
    wrapped[i]=signature[i];
  }
  for (int i=0; i < inputLength; i++) {
    wrapped[i + signature.length]=input[i];
  }
  byte[] output=base64.encode(wrapped);
  bytesWritable.set(output,0,output.length);
  writer.write(bytesWritable);
}
