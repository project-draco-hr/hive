{
  List<InputSplit> ins=new ArrayList<InputSplit>();
  if (url == null)   url=job.get(URL_KEY);
  if (query == null)   query=job.get(QUERY_KEY);
  if (user == null)   user=job.get(USER_KEY);
  if (pwd == null)   pwd=job.get(PWD_KEY);
  if (url == null || query == null) {
    throw new IllegalStateException();
  }
  try {
    Class.forName(driverName);
  }
 catch (  ClassNotFoundException e) {
    throw new IOException(e);
  }
  try {
    con=DriverManager.getConnection(url,user,pwd);
    stmt=con.createStatement();
    String sql=String.format(SPLIT_QUERY,query,numSplits);
    ResultSet res=stmt.executeQuery(sql);
    while (res.next()) {
      DataInput in=new DataInputStream(res.getBinaryStream(1));
      InputSplitWithLocationInfo is=new LlapInputSplit();
      is.readFields(in);
      ins.add(is);
    }
    res.close();
    stmt.close();
  }
 catch (  Exception e) {
    throw new IOException(e);
  }
  return ins.toArray(new InputSplit[ins.size()]);
}
