{
  TaskSpec taskSpec=submitWorkInfo.getTaskSpec();
  ApplicationId appId=submitWorkInfo.getFakeAppId();
  int attemptId=taskSpec.getTaskAttemptID().getId();
  String user=System.getenv(ApplicationConstants.Environment.USER.name());
  LOG.info("Setting user in submitWorkRequest to: " + user);
  SignableVertexSpec svs=Converters.convertTaskSpecToProto(taskSpec,attemptId,appId.toString(),null,user);
  ContainerId containerId=ContainerId.newInstance(ApplicationAttemptId.newInstance(appId,0),taskNum);
  Credentials taskCredentials=new Credentials();
  Credentials credentials=new Credentials();
  TokenCache.setSessionToken(token,credentials);
  ByteBuffer credentialsBinary=serializeCredentials(credentials);
  FragmentRuntimeInfo.Builder runtimeInfo=FragmentRuntimeInfo.newBuilder();
  runtimeInfo.setCurrentAttemptStartTime(System.currentTimeMillis());
  runtimeInfo.setWithinDagPriority(0);
  runtimeInfo.setDagStartTime(submitWorkInfo.getCreationTime());
  runtimeInfo.setFirstAttemptStartTime(submitWorkInfo.getCreationTime());
  runtimeInfo.setNumSelfAndUpstreamTasks(taskSpec.getVertexParallelism());
  runtimeInfo.setNumSelfAndUpstreamCompletedTasks(0);
  SubmitWorkRequestProto.Builder builder=SubmitWorkRequestProto.newBuilder();
  builder.setWorkSpec(VertexOrBinary.newBuilder().setVertex(svs).build());
  builder.setFragmentNumber(taskSpec.getTaskAttemptID().getTaskID().getId());
  builder.setAttemptNumber(0);
  builder.setContainerIdString(containerId.toString());
  builder.setAmHost(address.getHostName());
  builder.setAmPort(address.getPort());
  builder.setCredentialsBinary(ByteString.copyFrom(credentialsBinary));
  builder.setFragmentRuntimeInfo(runtimeInfo.build());
  return builder.build();
}
