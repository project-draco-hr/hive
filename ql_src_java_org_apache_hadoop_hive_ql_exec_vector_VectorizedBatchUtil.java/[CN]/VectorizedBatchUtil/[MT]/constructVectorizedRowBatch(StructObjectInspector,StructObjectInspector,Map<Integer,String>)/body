{
  ArrayList<String> colNames=new ArrayList<String>();
  ArrayList<ObjectInspector> ois=new ArrayList<ObjectInspector>();
  List<? extends StructField> fields=keyInspector.getAllStructFieldRefs();
  for (  StructField field : fields) {
    colNames.add(Utilities.ReduceField.KEY.toString() + "." + field.getFieldName());
    ois.add(field.getFieldObjectInspector());
  }
  fields=valueInspector.getAllStructFieldRefs();
  for (  StructField field : fields) {
    colNames.add(Utilities.ReduceField.VALUE.toString() + "." + field.getFieldName());
    ois.add(field.getFieldObjectInspector());
  }
  StandardStructObjectInspector rowObjectInspector=ObjectInspectorFactory.getStandardStructObjectInspector(colNames,ois);
  VectorizedRowBatchCtx batchContext=new VectorizedRowBatchCtx();
  batchContext.init(vectorScratchColumnTypeMap,rowObjectInspector);
  return new ObjectPair<>(batchContext.createVectorizedRowBatch(),rowObjectInspector);
}
