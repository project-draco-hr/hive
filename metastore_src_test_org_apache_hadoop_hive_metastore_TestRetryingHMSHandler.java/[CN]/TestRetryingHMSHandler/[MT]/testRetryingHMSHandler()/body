{
  String dbName="tmpdb";
  String tblName="tmptbl";
  Database db=new Database();
  db.setName(dbName);
  msc.createDatabase(db);
  Assert.assertEquals(2,AlternateFailurePreListener.getCallCount());
  ArrayList<FieldSchema> cols=new ArrayList<FieldSchema>(2);
  cols.add(new FieldSchema("c1",serdeConstants.STRING_TYPE_NAME,""));
  cols.add(new FieldSchema("c2",serdeConstants.INT_TYPE_NAME,""));
  Map<String,String> params=new HashMap<String,String>();
  params.put("test_param_1","Use this for comments etc");
  Map<String,String> serdParams=new HashMap<String,String>();
  serdParams.put(serdeConstants.SERIALIZATION_FORMAT,"1");
  StorageDescriptor sd=new StorageDescriptor();
  sd.setCols(cols);
  sd.setCompressed(false);
  sd.setNumBuckets(1);
  sd.setParameters(params);
  sd.setBucketCols(new ArrayList<String>(2));
  sd.getBucketCols().add("name");
  sd.setSerdeInfo(new SerDeInfo());
  sd.getSerdeInfo().setName(tblName);
  sd.getSerdeInfo().setParameters(serdParams);
  sd.getSerdeInfo().getParameters().put(serdeConstants.SERIALIZATION_FORMAT,"1");
  sd.setSortCols(new ArrayList<Order>());
  Table tbl=new Table();
  tbl.setDbName(dbName);
  tbl.setTableName(tblName);
  tbl.setSd(sd);
  tbl.setLastAccessTime(0);
  msc.createTable(tbl);
  Assert.assertEquals(4,AlternateFailurePreListener.getCallCount());
}
