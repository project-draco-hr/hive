{
  TimeZone.setDefault(TimeZone.getTimeZone(readerTimeZone));
  Path oldFilePath=new Path(HiveTestUtils.getFileFromClasspath("orc-file-11-format.orc"));
  Reader reader=OrcFile.createReader(oldFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  List<? extends StructField> fields=readerInspector.getAllStructFieldRefs();
  TimestampObjectInspector tso=(TimestampObjectInspector)readerInspector.getStructFieldRef("ts").getFieldObjectInspector();
  RecordReader rows=reader.rows();
  Object row=rows.next(null);
  assertNotNull(row);
  assertEquals(Timestamp.valueOf("2000-03-12 15:00:00"),tso.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(12))));
  assertEquals(true,rows.hasNext());
  rows.seekToRow(7499);
  row=rows.next(null);
  assertEquals(Timestamp.valueOf("2000-03-12 15:00:01"),tso.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(12))));
  assertEquals(false,rows.hasNext());
  rows.close();
}
