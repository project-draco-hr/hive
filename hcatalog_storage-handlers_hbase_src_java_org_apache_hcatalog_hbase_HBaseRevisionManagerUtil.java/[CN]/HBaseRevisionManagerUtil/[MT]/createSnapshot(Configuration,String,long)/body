{
  TableSnapshot snpt;
  RevisionManager rm=null;
  try {
    rm=getOpenedRevisionManager(jobConf);
    snpt=rm.createSnapshot(tableName,revision);
  }
  finally {
    closeRevisionManagerQuietly(rm);
  }
  String inputJobString=jobConf.get(HCatConstants.HCAT_KEY_JOB_INFO);
  if (inputJobString == null) {
    throw new IOException("InputJobInfo information not found in JobContext. " + "HCatInputFormat.setInput() not called?");
  }
  InputJobInfo inputInfo=(InputJobInfo)HCatUtil.deserialize(inputJobString);
  HCatTableSnapshot hcatSnapshot=HBaseRevisionManagerUtil.convertSnapshot(snpt,inputInfo.getTableInfo());
  return hcatSnapshot;
}
