{
  HCatSchema hcatTableSchema=hcatTableInfo.getDataColumns();
  Map<String,Long> revisionMap=new HashMap<String,Long>();
  Map<String,String> hcatHbaseColMap=getHCatHBaseColumnMapping(hcatTableInfo);
  for (  HCatFieldSchema fSchema : hcatTableSchema.getFields()) {
    String colFamily=hcatHbaseColMap.get(fSchema.getName());
    if (hcatSnapshot.containsColumn(fSchema.getName())) {
      long revision=hcatSnapshot.getRevision(fSchema.getName());
      revisionMap.put(colFamily,revision);
    }
  }
  String fullyQualifiedName=hcatSnapshot.getDatabaseName() + "." + hcatSnapshot.getTableName();
  return new TableSnapshot(fullyQualifiedName,revisionMap,hcatSnapshot.getLatestRevision());
}
