{
  final Double rowCount=RelMetadataQuery.getRowCount(rel.getInput());
  if (rowCount != null && rel.fetch != null) {
    final int offset=rel.offset == null ? 0 : RexLiteral.intValue(rel.offset);
    final int limit=RexLiteral.intValue(rel.fetch);
    final Double offsetLimit=new Double(offset + limit);
    if (offsetLimit < rowCount) {
      return offsetLimit;
    }
  }
  return rowCount;
}
