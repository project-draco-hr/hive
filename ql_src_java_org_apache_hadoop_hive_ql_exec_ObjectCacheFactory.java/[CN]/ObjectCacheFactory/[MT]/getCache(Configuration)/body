{
  if (HiveConf.getVar(conf,HiveConf.ConfVars.HIVE_EXECUTION_ENGINE).equals("tez")) {
    if (LlapIoProxy.isDaemon()) {
      if (HiveConf.getBoolVar(conf,HiveConf.ConfVars.LLAP_OBJECT_CACHE_ENABLED)) {
        return new org.apache.hadoop.hive.ql.exec.tez.LlapObjectCache();
      }
 else {
        return new org.apache.hadoop.hive.ql.exec.mr.ObjectCache();
      }
    }
 else {
      return new org.apache.hadoop.hive.ql.exec.tez.ObjectCache();
    }
  }
 else {
    return new org.apache.hadoop.hive.ql.exec.mr.ObjectCache();
  }
}
