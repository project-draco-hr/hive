{
  commandLine=new GnuParser().parse(options,argv);
  if (commandLine.hasOption('H') || false == commandLine.hasOption("instances")) {
    printUsage();
    return null;
  }
  int instances=Integer.parseInt(commandLine.getOptionValue("instances"));
  String directory=commandLine.getOptionValue("directory");
  String jars=commandLine.getOptionValue("auxjars");
  String name=commandLine.getOptionValue("name",null);
  final int executors=Integer.parseInt(commandLine.getOptionValue("executors","-1"));
  final long cache=parseSuffixed(commandLine.getOptionValue("cache","-1"));
  final long size=parseSuffixed(commandLine.getOptionValue("size","-1"));
  final long xmx=parseSuffixed(commandLine.getOptionValue("xmx","-1"));
  final Properties hiveconf;
  if (commandLine.hasOption("hiveconf")) {
    hiveconf=commandLine.getOptionProperties("hiveconf");
  }
 else {
    hiveconf=new Properties();
  }
  return new LlapOptions(name,instances,directory,executors,cache,size,xmx,jars,hiveconf);
}
