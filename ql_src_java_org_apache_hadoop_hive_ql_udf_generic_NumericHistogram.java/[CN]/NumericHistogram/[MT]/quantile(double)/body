{
  assert(bins != null && nusedbins > 0 && nbins > 0);
  double sum=0, csum=0;
  int b;
  for (b=0; b < nusedbins; b++) {
    sum+=bins[b].y;
  }
  for (b=0; b < nusedbins; b++) {
    csum+=bins[b].y;
    if (csum / sum >= q) {
      if (b == 0) {
        return bins[b].x;
      }
      csum-=bins[b].y;
      double r=bins[b - 1].x + (q * sum - csum) * (bins[b].x - bins[b - 1].x) / (bins[b].y);
      return r;
    }
  }
  return -1;
}
