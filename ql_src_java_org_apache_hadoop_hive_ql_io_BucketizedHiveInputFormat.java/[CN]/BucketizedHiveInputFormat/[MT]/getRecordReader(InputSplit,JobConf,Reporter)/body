{
  BucketizedHiveInputSplit hsplit=(BucketizedHiveInputSplit)split;
  String inputFormatClassName=null;
  Class inputFormatClass=null;
  try {
    inputFormatClassName=hsplit.inputFormatClassName();
    inputFormatClass=job.getClassByName(inputFormatClassName);
  }
 catch (  Exception e) {
    throw new IOException("cannot find class " + inputFormatClassName);
  }
  JobConf cloneJobConf=new JobConf(job);
  pushProjectionsAndFilters(cloneJobConf,inputFormatClass,hsplit.getPath().toString(),hsplit.getPath().toUri().getPath());
  InputFormat inputFormat=getInputFormatFromCache(inputFormatClass,cloneJobConf);
  BucketizedHiveRecordReader<K,V> rr=new BucketizedHiveRecordReader(inputFormat,hsplit,cloneJobConf,reporter);
  rr.initIOContext(hsplit,cloneJobConf,inputFormatClass);
  return rr;
}
