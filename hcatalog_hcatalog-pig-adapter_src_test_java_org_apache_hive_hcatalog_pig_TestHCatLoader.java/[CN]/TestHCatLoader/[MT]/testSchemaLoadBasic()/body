{
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  PigServer server=new PigServer(ExecType.LOCAL);
  server.registerQuery("X = load '" + BASIC_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Schema dumpedXSchema=server.dumpSchema("X");
  List<FieldSchema> Xfields=dumpedXSchema.getFields();
  assertEquals(2,Xfields.size());
  assertTrue(Xfields.get(0).alias.equalsIgnoreCase("a"));
  assertTrue(Xfields.get(0).type == DataType.INTEGER);
  assertTrue(Xfields.get(1).alias.equalsIgnoreCase("b"));
  assertTrue(Xfields.get(1).type == DataType.CHARARRAY);
}
