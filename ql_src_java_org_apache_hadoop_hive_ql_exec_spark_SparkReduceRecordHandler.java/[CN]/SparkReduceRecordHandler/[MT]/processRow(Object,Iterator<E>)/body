{
  if (reducer.getDone()) {
    return;
  }
  try {
    BytesWritable keyWritable=(BytesWritable)key;
    byte tag=0;
    if (isTagged) {
      int size=keyWritable.getSize() - 1;
      tag=keyWritable.get()[size];
      keyWritable.setSize(size);
    }
    if (!keyWritable.equals(groupKey)) {
      if (groupKey == null) {
        groupKey=new BytesWritable();
      }
 else {
        LOG.trace("End Group");
        reducer.endGroup();
      }
      try {
        keyObject=inputKeyDeserializer.deserialize(keyWritable);
      }
 catch (      Exception e) {
        throw new HiveException("Hive Runtime Error: Unable to deserialize reduce input key from " + Utilities.formatBinaryString(keyWritable.get(),0,keyWritable.getSize()) + " with properties "+ keyTableDesc.getProperties(),e);
      }
      groupKey.set(keyWritable.get(),0,keyWritable.getSize());
      LOG.trace("Start Group");
      reducer.setGroupKeyObject(keyObject);
      reducer.startGroup();
    }
    if (vectorized) {
      processVectors(values,tag);
    }
 else {
      processKeyValues(values,tag);
    }
  }
 catch (  Throwable e) {
    abort=true;
    if (e instanceof OutOfMemoryError) {
      throw (OutOfMemoryError)e;
    }
 else {
      String msg="Fatal error: " + e;
      LOG.fatal(msg,e);
      throw new RuntimeException(e);
    }
  }
}
