{
  int tag=GenericData.get().resolveUnion(recordSchema,datum);
  Schema schema=recordSchema.getTypes().get(tag);
  if (schema.getType().equals(Schema.Type.NULL))   return null;
  return worker(datum,schema,SchemaToTypeInfo.generateTypeInfo(schema));
}
