{
switch (columnType.getPrimitiveCategory()) {
case STRING:
    return datum.toString();
case BINARY:
  if (recordSchema.getType() == Type.FIXED) {
    Fixed fixed=(Fixed)datum;
    return fixed.bytes();
  }
 else   if (recordSchema.getType() == Type.BYTES) {
    ByteBuffer bb=(ByteBuffer)datum;
    bb.rewind();
    byte[] result=new byte[bb.limit()];
    bb.get(result);
    return result;
  }
 else {
    throw new AvroSerdeException("Unexpected Avro schema for Binary TypeInfo: " + recordSchema.getType());
  }
default :
return datum;
}
}
