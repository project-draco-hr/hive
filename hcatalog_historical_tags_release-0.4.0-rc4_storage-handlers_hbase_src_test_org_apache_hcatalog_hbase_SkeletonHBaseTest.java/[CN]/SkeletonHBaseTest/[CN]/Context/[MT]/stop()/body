{
  if (--usageCount == 0) {
    try {
      cluster.stop();
      cluster=null;
    }
  finally {
      System.out.println("Trying to cleanup: " + testDir);
      try {
        FileUtil.fullyDelete(new File(testDir));
      }
 catch (      IOException e) {
        throw new IllegalStateException("Failed to cleanup test dir",e);
      }
    }
  }
}
