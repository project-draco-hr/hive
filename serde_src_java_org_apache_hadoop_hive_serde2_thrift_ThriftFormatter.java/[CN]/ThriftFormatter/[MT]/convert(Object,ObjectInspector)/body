{
  StructObjectInspector structOI=(StructObjectInspector)rowOI;
  List<? extends StructField> fields=structOI.getAllStructFieldRefs();
  Object[] converted=new Object[fields.size()];
  for (int i=0; i < converted.length; i++) {
    StructField fieldRef=fields.get(i);
    Object field=structOI.getStructFieldData(row,fieldRef);
    converted[i]=field == null ? null : SerDeUtils.toThriftPayload(field,fieldRef.getFieldObjectInspector(),protocol);
  }
  return converted;
}
