{
  ColumnStatsAggregator agg;
switch (type) {
case BOOLEAN_STATS:
    agg=new BooleanColumnStatsAggregator();
  break;
case LONG_STATS:
agg=new LongColumnStatsAggregator();
break;
case DOUBLE_STATS:
agg=new DoubleColumnStatsAggregator();
break;
case STRING_STATS:
agg=new StringColumnStatsAggregator();
break;
case BINARY_STATS:
agg=new BinaryColumnStatsAggregator();
break;
case DECIMAL_STATS:
agg=new DecimalColumnStatsAggregator();
break;
default :
throw new RuntimeException("Woh, bad.  Unknown stats type " + type.toString());
}
if (numBitVectors > 0) {
agg.ndvEstimator=new NumDistinctValueEstimator(numBitVectors);
}
return agg;
}
