{
  int rc=1;
  Context ctx=driverContext.getCtx();
  try {
    Path scratchDir=new Path(ctx.getMRScratchDir());
    JobConf jobConf=DagUtils.createConfiguration(conf);
    LocalResource appJarLr=DagUtils.createHiveExecLocalResource(scratchDir);
    DAG dag=build(jobConf,work,scratchDir,appJarLr,ctx);
    DAGClient client=submit(jobConf,dag,scratchDir,appJarLr);
    TezJobMonitor monitor=new TezJobMonitor();
    rc=monitor.monitorExecution(client);
  }
 catch (  Exception e) {
    LOG.error("Failed to execute tez graph.",e);
  }
 finally {
    Utilities.clearWork(conf);
    try {
      ctx.clear();
    }
 catch (    Exception e) {
      LOG.warn("Failed to clean up after tez job");
    }
  }
  return rc;
}
