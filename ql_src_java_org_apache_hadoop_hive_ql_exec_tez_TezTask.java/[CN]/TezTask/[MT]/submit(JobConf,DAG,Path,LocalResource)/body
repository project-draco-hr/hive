{
  TezClient tezClient=new TezClient(new TezConfiguration(conf));
  Map<String,String> amEnv=new HashMap<String,String>();
  MRHelpers.updateEnvironmentForMRTasks(conf,amEnv,false);
  Map<String,LocalResource> amLrs=new HashMap<String,LocalResource>();
  amLrs.put(DagUtils.getBaseName(appJarLr),appJarLr);
  DAGClient dagClient=tezClient.submitDAGApplication(dag,scratchDir,null,"default",Collections.singletonList(""),amEnv,amLrs,new TezConfiguration(conf));
  return dagClient;
}
