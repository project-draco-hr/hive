{
  perfLogger.PerfLogBegin(CLASS_NAME,PerfLogger.TEZ_SUBMIT_DAG);
  DAGClient dagClient=null;
  try {
    dagClient=sessionState.getSession().submitDAG(dag);
  }
 catch (  SessionNotRunning nr) {
    console.printInfo("Tez session was closed. Reopening...");
    sessionState.close(true);
    sessionState.open(this.conf);
    console.printInfo("Session re-established.");
    dagClient=sessionState.getSession().submitDAG(dag);
  }
  perfLogger.PerfLogEnd(CLASS_NAME,PerfLogger.TEZ_SUBMIT_DAG);
  return dagClient;
}
