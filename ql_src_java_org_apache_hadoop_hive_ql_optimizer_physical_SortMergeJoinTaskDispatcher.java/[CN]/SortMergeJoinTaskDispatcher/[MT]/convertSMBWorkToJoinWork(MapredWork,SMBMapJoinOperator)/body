{
  try {
    String xml=currWork.toXML();
    InputStream in=new ByteArrayInputStream(xml.getBytes("UTF-8"));
    MapredWork currJoinWork=Utilities.deserializeMapRedWork(in,physicalContext.getConf());
    SMBMapJoinOperator newSMBJoinOp=getSMBMapJoinOp(currJoinWork);
    Map<Operator<? extends OperatorDesc>,OpParseContext> opParseContextMap=physicalContext.getParseContext().getOpParseCtx();
    opParseContextMap.put(newSMBJoinOp,opParseContextMap.get(oldSMBJoinOp));
    genSMBJoinWork(currJoinWork,newSMBJoinOp);
    return currJoinWork;
  }
 catch (  Exception e) {
    e.printStackTrace();
    throw new SemanticException("Generate Map Join Task Error: " + e.getMessage());
  }
}
