{
  int sign=dec.compareTo(HiveDecimal.ZERO);
  dec=dec.abs();
  int factor=dec.bigDecimalValue().precision() - dec.bigDecimalValue().scale();
  factor=sign == 1 ? factor : -factor;
  dec.scaleByPowerOfTen(Math.abs(dec.scale()));
  String digits=dec.unscaledValue().toString();
  writeByte(buffer,(byte)(sign + 1),invert);
  writeByte(buffer,(byte)((factor >> 24) ^ 0x80),invert);
  writeByte(buffer,(byte)(factor >> 16),invert);
  writeByte(buffer,(byte)(factor >> 8),invert);
  writeByte(buffer,(byte)factor,invert);
  serializeBytes(buffer,digits.getBytes(decimalCharSet),digits.length(),sign == -1 ? !invert : invert);
}
