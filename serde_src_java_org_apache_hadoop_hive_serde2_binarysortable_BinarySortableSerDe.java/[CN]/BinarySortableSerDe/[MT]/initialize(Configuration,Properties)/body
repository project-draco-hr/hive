{
  String columnNameProperty=tbl.getProperty(serdeConstants.LIST_COLUMNS);
  String columnTypeProperty=tbl.getProperty(serdeConstants.LIST_COLUMN_TYPES);
  if (columnNameProperty.length() == 0) {
    columnNames=new ArrayList<String>();
  }
 else {
    columnNames=Arrays.asList(columnNameProperty.split(","));
  }
  if (columnTypeProperty.length() == 0) {
    columnTypes=new ArrayList<TypeInfo>();
  }
 else {
    columnTypes=TypeInfoUtils.getTypeInfosFromTypeString(columnTypeProperty);
  }
  assert(columnNames.size() == columnTypes.size());
  rowTypeInfo=TypeInfoFactory.getStructTypeInfo(columnNames,columnTypes);
  rowObjectInspector=(StructObjectInspector)TypeInfoUtils.getStandardWritableObjectInspectorFromTypeInfo(rowTypeInfo);
  row=new ArrayList<Object>(columnNames.size());
  for (int i=0; i < columnNames.size(); i++) {
    row.add(null);
  }
  String columnSortOrder=tbl.getProperty(serdeConstants.SERIALIZATION_SORT_ORDER);
  columnSortOrderIsDesc=new boolean[columnNames.size()];
  for (int i=0; i < columnSortOrderIsDesc.length; i++) {
    columnSortOrderIsDesc[i]=(columnSortOrder != null && columnSortOrder.charAt(i) == '-');
  }
  String columnNullOrder=tbl.getProperty(serdeConstants.SERIALIZATION_NULL_SORT_ORDER);
  columnNullMarker=new byte[columnNames.size()];
  columnNotNullMarker=new byte[columnNames.size()];
  for (int i=0; i < columnSortOrderIsDesc.length; i++) {
    if (columnSortOrderIsDesc[i]) {
      if (columnNullOrder != null && columnNullOrder.charAt(i) == 'a') {
        columnNullMarker[i]=ONE;
        columnNotNullMarker[i]=ZERO;
      }
 else {
        columnNullMarker[i]=ZERO;
        columnNotNullMarker[i]=ONE;
      }
    }
 else {
      if (columnNullOrder != null && columnNullOrder.charAt(i) == 'z') {
        columnNullMarker[i]=ONE;
        columnNotNullMarker[i]=ZERO;
      }
 else {
        columnNullMarker[i]=ZERO;
        columnNotNullMarker[i]=ONE;
      }
    }
  }
}
