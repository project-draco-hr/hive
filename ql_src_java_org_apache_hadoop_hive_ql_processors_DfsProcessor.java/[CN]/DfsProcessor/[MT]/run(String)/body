{
  try {
    SessionState ss=SessionState.get();
    command=new VariableSubstitution(new HiveVariableSource(){
      @Override public Map<String,String> getHiveVariable(){
        return SessionState.get().getHiveVariables();
      }
    }
).substitute(ss.getConf(),command);
    String[] tokens=command.split("\\s+");
    CommandProcessorResponse authErrResp=CommandUtil.authorizeCommand(ss,HiveOperationType.DFS,Arrays.asList(tokens));
    if (authErrResp != null) {
      return authErrResp;
    }
    PrintStream oldOut=System.out;
    if (ss != null && ss.out != null) {
      System.setOut(ss.out);
    }
    int ret=dfs.run(tokens);
    if (ret != 0) {
      console.printError("Command " + command + " failed with exit code = "+ ret);
    }
    System.setOut(oldOut);
    return new CommandProcessorResponse(ret,null,null,dfsSchema);
  }
 catch (  Exception e) {
    console.printError("Exception raised from DFSShell.run " + e.getLocalizedMessage(),org.apache.hadoop.util.StringUtils.stringifyException(e));
    return new CommandProcessorResponse(1);
  }
}
