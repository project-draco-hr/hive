{
  AcidInputFormat aif=instantiate(AcidInputFormat.class,jobConf.get(INPUT_FORMAT_CLASS_NAME));
  ValidTxnList txnList=new ValidTxnListImpl(jobConf.get(ValidTxnList.VALID_TXNS_KEY));
  AcidInputFormat.RawReader<V> reader=aif.getRawReader(jobConf,jobConf.getBoolean(IS_MAJOR,false),split.getBucket(),txnList,split.getBaseDir(),split.getDeltaDirs());
  RecordIdentifier identifier=reader.createKey();
  V value=reader.createValue();
  getWriter(reporter,reader.getObjectInspector(),split.getBucket());
  while (reader.next(identifier,value)) {
    writer.write(value);
    reporter.progress();
  }
}
