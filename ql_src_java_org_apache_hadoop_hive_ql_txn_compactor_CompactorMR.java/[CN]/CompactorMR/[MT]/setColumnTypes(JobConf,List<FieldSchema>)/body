{
  StringBuilder colNames=new StringBuilder();
  StringBuilder colTypes=new StringBuilder();
  boolean isFirst=true;
  for (  FieldSchema col : cols) {
    if (isFirst) {
      isFirst=false;
    }
 else {
      colNames.append(',');
      colTypes.append(',');
    }
    colNames.append(col.getName());
    colTypes.append(col.getType());
  }
  job.set(IOConstants.SCHEMA_EVOLUTION_COLUMNS,colNames.toString());
  job.set(IOConstants.SCHEMA_EVOLUTION_COLUMNS_TYPES,colTypes.toString());
  HiveConf.setBoolVar(job,HiveConf.ConfVars.HIVE_TRANSACTIONAL_TABLE_SCAN,true);
  HiveConf.setVar(job,HiveConf.ConfVars.HIVEINPUTFORMAT,HiveInputFormat.class.getName());
}
