{
  MRInputUserPayloadProto userPayloadProto=MRHelpers.parseMRInputPayload(rootInputContext.getUserPayload());
  Configuration conf=MRHelpers.createConfFromByteString(userPayloadProto.getConfigurationBytes());
  boolean sendSerializedEvents=conf.getBoolean("mapreduce.tez.input.initializer.serialize.event.payload",true);
  JobConf jobConf=new JobConf(conf);
  ShimLoader.getHadoopShims().getMergedCredentials(jobConf);
  InputSplitInfoMem inputSplitInfo=null;
  String realInputFormatName=userPayloadProto.getInputFormatName();
  if (realInputFormatName != null && !realInputFormatName.isEmpty()) {
    inputSplitInfo=generateGroupedSplits(rootInputContext,jobConf,conf,realInputFormatName);
  }
 else {
    inputSplitInfo=MRHelpers.generateInputSplitsToMem(jobConf);
  }
  return createEventList(sendSerializedEvents,inputSplitInfo);
}
