{
  final BitSet buckets=work.getIncludedBuckets();
  final String bucketIn=buckets.toString();
  List<InputSplit> filteredSplits=new ArrayList<InputSplit>(splits.length / 2);
  for (  InputSplit split : splits) {
    final int bucket=Utilities.parseSplitBucket(split);
    if (bucket < 0 || buckets.get(bucket)) {
      filteredSplits.add(split);
    }
 else {
      LOG.info("Pruning with IN ({}) - removing {}",bucketIn,split);
    }
  }
  if (filteredSplits.size() < splits.length) {
    splits=filteredSplits.toArray(new InputSplit[filteredSplits.size()]);
  }
  return splits;
}
