{
  List<Event> events=Lists.newArrayListWithCapacity(inputSplitInfo.getNumTasks() + 1);
  RootInputConfigureVertexTasksEvent configureVertexEvent=new RootInputConfigureVertexTasksEvent(inputSplitInfo.getNumTasks(),inputSplitInfo.getTaskLocationHints());
  events.add(configureVertexEvent);
  if (sendSerializedEvents) {
    MRSplitsProto splitsProto=inputSplitInfo.getSplitsProto();
    int count=0;
    for (    MRSplitProto mrSplit : splitsProto.getSplitsList()) {
      RootInputDataInformationEvent diEvent=new RootInputDataInformationEvent(count++,mrSplit.toByteArray());
      events.add(diEvent);
    }
  }
 else {
    int count=0;
    for (    org.apache.hadoop.mapred.InputSplit split : inputSplitInfo.getOldFormatSplits()) {
      RootInputDataInformationEvent diEvent=new RootInputDataInformationEvent(count++,split);
      events.add(diEvent);
    }
  }
  return events;
}
