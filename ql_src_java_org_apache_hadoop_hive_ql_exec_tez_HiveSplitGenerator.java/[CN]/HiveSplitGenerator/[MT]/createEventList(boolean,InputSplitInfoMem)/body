{
  List<Event> events=Lists.newArrayListWithCapacity(inputSplitInfo.getNumTasks() + 1);
  InputConfigureVertexTasksEvent configureVertexEvent=InputConfigureVertexTasksEvent.create(inputSplitInfo.getNumTasks(),VertexLocationHint.create(inputSplitInfo.getTaskLocationHints()),InputSpecUpdate.getDefaultSinglePhysicalInputSpecUpdate());
  events.add(configureVertexEvent);
  if (sendSerializedEvents) {
    MRSplitsProto splitsProto=inputSplitInfo.getSplitsProto();
    int count=0;
    for (    MRSplitProto mrSplit : splitsProto.getSplitsList()) {
      InputDataInformationEvent diEvent=InputDataInformationEvent.createWithSerializedPayload(count++,mrSplit.toByteString().asReadOnlyByteBuffer());
      events.add(diEvent);
    }
  }
 else {
    int count=0;
    for (    org.apache.hadoop.mapred.InputSplit split : inputSplitInfo.getOldFormatSplits()) {
      InputDataInformationEvent diEvent=InputDataInformationEvent.createWithObjectPayload(count++,split);
      events.add(diEvent);
    }
  }
  return events;
}
