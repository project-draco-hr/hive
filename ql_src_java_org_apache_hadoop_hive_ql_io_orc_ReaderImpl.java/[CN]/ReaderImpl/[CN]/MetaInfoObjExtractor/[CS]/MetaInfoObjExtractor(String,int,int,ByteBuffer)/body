{
  this.compressionKind=CompressionKind.valueOf(codecStr);
  this.bufferSize=bufferSize;
  this.codec=WriterImpl.createCodec(compressionKind);
  this.metadataSize=metadataSize;
  int position=footerBuffer.position();
  int footerBufferSize=footerBuffer.limit() - footerBuffer.position() - metadataSize;
  this.metadata=extractMetadata(footerBuffer,position,metadataSize,codec,bufferSize);
  this.footer=extractFooter(footerBuffer,position + metadataSize,footerBufferSize,codec,bufferSize);
  footerBuffer.position(position);
  this.inspector=OrcStruct.createObjectInspector(0,footer.getTypesList());
}
