{
  FileSystem fs=options.getFilesystem();
  if (fs == null) {
    fs=path.getFileSystem(options.getConfiguration());
  }
  this.fileSystem=fs;
  this.path=path;
  this.conf=options.getConfiguration();
  FileMetaInfo footerMetaData;
  if (options.getFileMetaInfo() != null) {
    footerMetaData=options.getFileMetaInfo();
  }
 else {
    footerMetaData=extractMetaInfoFromFooter(fs,path,options.getMaxLength());
  }
  MetaInfoObjExtractor rInfo=new MetaInfoObjExtractor(footerMetaData.compressionType,footerMetaData.bufferSize,footerMetaData.metadataSize,footerMetaData.footerBuffer);
  this.footerByteBuffer=footerMetaData.footerBuffer;
  this.compressionKind=rInfo.compressionKind;
  this.codec=rInfo.codec;
  this.bufferSize=rInfo.bufferSize;
  this.metadataSize=rInfo.metadataSize;
  this.metadata=rInfo.metadata;
  this.footer=rInfo.footer;
  this.inspector=rInfo.inspector;
  this.versionList=footerMetaData.versionList;
}
