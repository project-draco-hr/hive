{
  FileSystem fs=options.getFilesystem();
  if (fs == null) {
    fs=path.getFileSystem(options.getConfiguration());
  }
  this.fileSystem=fs;
  this.path=path;
  this.conf=options.getConfiguration();
  FileMetadata fileMetadata=options.getFileMetadata();
  if (fileMetadata != null) {
    this.compressionKind=fileMetadata.getCompressionKind();
    this.bufferSize=fileMetadata.getCompressionBufferSize();
    this.codec=WriterImpl.createCodec(compressionKind);
    this.metadataSize=fileMetadata.getMetadataSize();
    this.stripeStats=fileMetadata.getStripeStats();
    this.versionList=fileMetadata.getVersionList();
    this.writerVersion=WriterVersion.from(fileMetadata.getWriterVersionNum());
    this.types=fileMetadata.getTypes();
    this.rowIndexStride=fileMetadata.getRowIndexStride();
    this.contentLength=fileMetadata.getContentLength();
    this.numberOfRows=fileMetadata.getNumberOfRows();
    this.fileStats=fileMetadata.getFileStats();
    this.stripes=fileMetadata.getStripes();
    this.inspector=OrcStruct.createObjectInspector(0,fileMetadata.getTypes());
    this.footerByteBuffer=null;
    this.userMetadata=null;
  }
 else {
    FileMetaInfo footerMetaData;
    if (options.getFileMetaInfo() != null) {
      footerMetaData=options.getFileMetaInfo();
    }
 else {
      footerMetaData=extractMetaInfoFromFooter(fs,path,options.getMaxLength());
    }
    MetaInfoObjExtractor rInfo=new MetaInfoObjExtractor(footerMetaData.compressionType,footerMetaData.bufferSize,footerMetaData.metadataSize,footerMetaData.footerBuffer);
    this.footerByteBuffer=footerMetaData.footerBuffer;
    this.compressionKind=rInfo.compressionKind;
    this.codec=rInfo.codec;
    this.bufferSize=rInfo.bufferSize;
    this.metadataSize=rInfo.metadataSize;
    this.stripeStats=rInfo.metadata.getStripeStatsList();
    this.types=rInfo.footer.getTypesList();
    this.rowIndexStride=rInfo.footer.getRowIndexStride();
    this.contentLength=rInfo.footer.getContentLength();
    this.numberOfRows=rInfo.footer.getNumberOfRows();
    this.userMetadata=rInfo.footer.getMetadataList();
    this.fileStats=rInfo.footer.getStatisticsList();
    this.inspector=rInfo.inspector;
    this.versionList=footerMetaData.versionList;
    this.writerVersion=footerMetaData.writerVersion;
    this.stripes=new ArrayList<StripeInformation>(rInfo.footer.getStripesCount());
    for (    OrcProto.StripeInformation info : rInfo.footer.getStripesList()) {
      this.stripes.add(new StripeInformationImpl(info));
    }
  }
}
