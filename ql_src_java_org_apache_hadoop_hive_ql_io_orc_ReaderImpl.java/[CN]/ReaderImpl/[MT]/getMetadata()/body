{
  if (metadata == null && metadataSize > 0) {
    FSDataInputStream file=this.fileSystem.open(path);
    file.seek(footerOffset - metadataSize);
    ByteBuffer buffer=ByteBuffer.allocate(metadataSize);
    file.readFully(buffer.array(),buffer.arrayOffset() + buffer.position(),buffer.remaining());
    buffer.position(0);
    buffer.limit(metadataSize);
    InputStream instream=InStream.create("metadata",new ByteBuffer[]{buffer},new long[]{0L},metadataSize,codec,bufferSize);
    metadata=OrcProto.Metadata.parseFrom(instream);
    file.close();
  }
  return new Metadata(metadata);
}
