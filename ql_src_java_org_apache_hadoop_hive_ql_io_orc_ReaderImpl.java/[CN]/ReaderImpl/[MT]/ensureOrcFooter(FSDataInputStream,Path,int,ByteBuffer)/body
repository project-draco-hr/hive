{
  int len=OrcFile.MAGIC.length();
  if (psLen < len + 1) {
    throw new IOException("Malformed ORC file " + path + ". Invalid postscript length "+ psLen);
  }
  int offset=buffer.arrayOffset() + buffer.position() + buffer.limit() - 1 - len;
  byte[] array=buffer.array();
  if (!Text.decode(array,offset,len).equals(OrcFile.MAGIC)) {
    in.seek(0);
    byte[] header=new byte[len];
    in.readFully(header,0,len);
    if (!Text.decode(header,0,len).equals(OrcFile.MAGIC)) {
      throw new IOException("Malformed ORC file " + path + ". Invalid postscript.");
    }
  }
}
