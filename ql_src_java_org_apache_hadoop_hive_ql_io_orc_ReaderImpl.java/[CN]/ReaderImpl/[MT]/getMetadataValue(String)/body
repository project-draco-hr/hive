{
  for (  OrcProto.UserMetadataItem item : footer.getMetadataList()) {
    if (item.hasName() && item.getName().equals(key)) {
      return item.getValue().asReadOnlyByteBuffer();
    }
  }
  throw new IllegalArgumentException("Can't find user metadata " + key);
}
