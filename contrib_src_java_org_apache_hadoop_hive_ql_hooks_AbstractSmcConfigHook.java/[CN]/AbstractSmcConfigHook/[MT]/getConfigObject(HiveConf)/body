{
  String packageName=conf.get(FBHiveConf.FB_CURRENT_CLUSTER);
  if (packageName == null) {
    LOG.error("Unable to use configs stored in SMC - no hive package set.");
    return null;
  }
  if (urlFactory == null) {
    urlFactory=new ThreadLocal<ConnectionUrlFactory>();
    urlFactory.set(HookUtils.getUrlFactory(conf,FBHiveConf.CONNECTION_FACTORY,null,null,null));
  }
  String s=urlFactory.get().getValue(conf.get(FBHiveConf.HIVE_CONFIG_TIER),packageName);
  JSONObject jo=new JSONObject(s);
  Object configObj=null;
  if (!isConfigEnabled(jo,packageName)) {
    return null;
  }
  if (jo.has(CONFIG_FIELD)) {
    configObj=jo.get(CONFIG_FIELD);
  }
  return configObj;
}
