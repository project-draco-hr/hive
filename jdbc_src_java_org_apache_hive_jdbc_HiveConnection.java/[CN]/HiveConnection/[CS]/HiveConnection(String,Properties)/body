{
  setupLoginTimeout();
  try {
    connParams=Utils.parseURL(uri);
  }
 catch (  ZooKeeperHiveClientException e) {
    throw new SQLException(e);
  }
  jdbcUriString=connParams.getJdbcUriString();
  host=connParams.getHost();
  port=connParams.getPort();
  sessConfMap=connParams.getSessionVars();
  hiveConfMap=connParams.getHiveConfs();
  hiveVarMap=connParams.getHiveVars();
  for (  Map.Entry<Object,Object> kv : info.entrySet()) {
    if ((kv.getKey() instanceof String)) {
      String key=(String)kv.getKey();
      if (key.startsWith(HIVE_VAR_PREFIX)) {
        hiveVarMap.put(key.substring(HIVE_VAR_PREFIX.length()),info.getProperty(key));
      }
 else       if (key.startsWith(HIVE_CONF_PREFIX)) {
        hiveConfMap.put(key.substring(HIVE_CONF_PREFIX.length()),info.getProperty(key));
      }
    }
  }
  isEmbeddedMode=connParams.isEmbeddedMode();
  if (isEmbeddedMode) {
    client=new EmbeddedThriftBinaryCLIService();
  }
 else {
    if (info.containsKey(JdbcConnectionParams.AUTH_USER)) {
      sessConfMap.put(JdbcConnectionParams.AUTH_USER,info.getProperty(JdbcConnectionParams.AUTH_USER));
      if (info.containsKey(JdbcConnectionParams.AUTH_PASSWD)) {
        sessConfMap.put(JdbcConnectionParams.AUTH_PASSWD,info.getProperty(JdbcConnectionParams.AUTH_PASSWD));
      }
    }
    if (info.containsKey(JdbcConnectionParams.AUTH_TYPE)) {
      sessConfMap.put(JdbcConnectionParams.AUTH_TYPE,info.getProperty(JdbcConnectionParams.AUTH_TYPE));
    }
    openTransport();
    client=new TCLIService.Client(new TBinaryProtocol(transport));
  }
  supportedProtocols.add(TProtocolVersion.HIVE_CLI_SERVICE_PROTOCOL_V1);
  supportedProtocols.add(TProtocolVersion.HIVE_CLI_SERVICE_PROTOCOL_V2);
  supportedProtocols.add(TProtocolVersion.HIVE_CLI_SERVICE_PROTOCOL_V3);
  supportedProtocols.add(TProtocolVersion.HIVE_CLI_SERVICE_PROTOCOL_V4);
  supportedProtocols.add(TProtocolVersion.HIVE_CLI_SERVICE_PROTOCOL_V5);
  supportedProtocols.add(TProtocolVersion.HIVE_CLI_SERVICE_PROTOCOL_V6);
  supportedProtocols.add(TProtocolVersion.HIVE_CLI_SERVICE_PROTOCOL_V7);
  openSession();
}
