{
  Utils.JdbcConnectionParams connParams=Utils.parseURL(uri);
  if (connParams.isEmbeddedMode()) {
    client=new EmbeddedThriftCLIService();
  }
 else {
    if (info.containsKey(HIVE_AUTH_USER)) {
      connParams.getSessionVars().put(HIVE_AUTH_USER,info.getProperty(HIVE_AUTH_USER));
      if (info.containsKey(HIVE_AUTH_PASSWD)) {
        connParams.getSessionVars().put(HIVE_AUTH_PASSWD,info.getProperty(HIVE_AUTH_PASSWD));
      }
    }
    openTransport(uri,connParams.getHost(),connParams.getPort(),connParams.getSessionVars());
  }
  supportedProtocols.add(TProtocolVersion.HIVE_CLI_SERVICE_PROTOCOL_V1);
  supportedProtocols.add(TProtocolVersion.HIVE_CLI_SERVICE_PROTOCOL_V2);
  supportedProtocols.add(TProtocolVersion.HIVE_CLI_SERVICE_PROTOCOL_V3);
  openSession(uri);
  configureConnection(connParams);
}
