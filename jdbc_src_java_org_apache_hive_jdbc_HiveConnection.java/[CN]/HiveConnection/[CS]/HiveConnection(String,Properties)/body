{
  setupLoginTimeout();
  jdbcURI=uri;
  Utils.JdbcConnectionParams connParams=Utils.parseURL(jdbcURI);
  host=connParams.getHost();
  port=connParams.getPort();
  sessConfMap=connParams.getSessionVars();
  hiveConfMap=connParams.getHiveConfs();
  hiveVarMap=connParams.getHiveVars();
  isEmbeddedMode=connParams.isEmbeddedMode();
  if (isEmbeddedMode) {
    client=new EmbeddedThriftBinaryCLIService();
  }
 else {
    if (info.containsKey(HIVE_AUTH_USER)) {
      sessConfMap.put(HIVE_AUTH_USER,info.getProperty(HIVE_AUTH_USER));
      if (info.containsKey(HIVE_AUTH_PASSWD)) {
        sessConfMap.put(HIVE_AUTH_PASSWD,info.getProperty(HIVE_AUTH_PASSWD));
      }
    }
    openTransport();
  }
  supportedProtocols.add(TProtocolVersion.HIVE_CLI_SERVICE_PROTOCOL_V1);
  supportedProtocols.add(TProtocolVersion.HIVE_CLI_SERVICE_PROTOCOL_V2);
  supportedProtocols.add(TProtocolVersion.HIVE_CLI_SERVICE_PROTOCOL_V3);
  supportedProtocols.add(TProtocolVersion.HIVE_CLI_SERVICE_PROTOCOL_V4);
  supportedProtocols.add(TProtocolVersion.HIVE_CLI_SERVICE_PROTOCOL_V5);
  supportedProtocols.add(TProtocolVersion.HIVE_CLI_SERVICE_PROTOCOL_V6);
  openSession();
  configureConnection(connParams.getDbName());
}
