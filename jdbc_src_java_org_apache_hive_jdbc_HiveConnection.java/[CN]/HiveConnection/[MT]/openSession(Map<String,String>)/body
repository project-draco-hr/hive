{
  TOpenSessionReq openReq=new TOpenSessionReq();
  if (sessVars.containsKey(HiveAuthFactory.HS2_PROXY_USER)) {
    Map<String,String> openConf=new HashMap<String,String>();
    openConf.put(HiveAuthFactory.HS2_PROXY_USER,sessVars.get(HiveAuthFactory.HS2_PROXY_USER));
    openReq.setConfiguration(openConf);
  }
  try {
    TOpenSessionResp openResp=client.OpenSession(openReq);
    Utils.verifySuccess(openResp.getStatus());
    if (!supportedProtocols.contains(openResp.getServerProtocolVersion())) {
      throw new TException("Unsupported Hive2 protocol");
    }
    protocol=openResp.getServerProtocolVersion();
    sessHandle=openResp.getSessionHandle();
  }
 catch (  TException e) {
    LOG.error("Error opening session",e);
    throw new SQLException("Could not establish connection to " + jdbcURI + ": "+ e.getMessage()," 08S01",e);
  }
  isClosed=false;
}
