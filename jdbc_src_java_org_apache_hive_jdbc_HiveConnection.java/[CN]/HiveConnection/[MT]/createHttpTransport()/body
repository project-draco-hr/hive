{
  CloseableHttpClient httpClient;
  String httpPath;
  httpPath=hiveConfMap.get(HiveConf.ConfVars.HIVE_SERVER2_THRIFT_HTTP_PATH.varname);
  if (httpPath == null) {
    httpPath="/";
  }
  if (!httpPath.startsWith("/")) {
    httpPath="/" + httpPath;
  }
  boolean useSsl="true".equalsIgnoreCase(sessConfMap.get(HIVE_USE_SSL));
  httpClient=getHttpClient(useSsl);
  String schemeName=useSsl ? "https" : "http";
  String httpUrl=schemeName + "://" + host+ ":"+ port+ httpPath;
  try {
    transport=new THttpClient(httpUrl,httpClient);
  }
 catch (  TTransportException e) {
    String msg="Could not create http connection to " + jdbcURI + ". "+ e.getMessage();
    throw new SQLException(msg," 08S01",e);
  }
  return transport;
}
