{
  String httpPath;
  httpPath=hiveConfMap.get(HiveConf.ConfVars.HIVE_SERVER2_THRIFT_HTTP_PATH.varname);
  if (httpPath == null) {
    httpPath="/";
  }
  if (!httpPath.startsWith("/")) {
    httpPath="/" + httpPath;
  }
  DefaultHttpClient httpClient=new DefaultHttpClient();
  String httpUrl=hiveConfMap.get(HiveConf.ConfVars.HIVE_SERVER2_TRANSPORT_MODE.varname) + "://" + host+ ":"+ port+ httpPath;
  httpClient.addRequestInterceptor(new HttpBasicAuthInterceptor(getUserName(),getPasswd()));
  try {
    transport=new THttpClient(httpUrl,httpClient);
  }
 catch (  TTransportException e) {
    String msg="Could not create http connection to " + jdbcURI + ". "+ e.getMessage();
    throw new SQLException(msg," 08S01",e);
  }
  return transport;
}
