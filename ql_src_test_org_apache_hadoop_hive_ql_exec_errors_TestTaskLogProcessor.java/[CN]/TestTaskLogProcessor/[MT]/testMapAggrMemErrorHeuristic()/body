{
  JobConf jobConf=new JobConf();
  jobConf.set(HiveConf.ConfVars.HIVEQUERYSTRING.varname,"select * from foo group by moo;");
  final TaskLogProcessor taskLogProcessor=new TaskLogProcessor(jobConf);
  Throwable oome=new OutOfMemoryError("java heap space");
  File log1File=writeTestLog("1",toString(oome));
  taskLogProcessor.addTaskAttemptLogUrl(log1File.toURI().toURL().toString());
  List<ErrorAndSolution> errList=taskLogProcessor.getErrors();
  assertEquals(1,errList.size());
  final ErrorAndSolution eas=errList.get(0);
  String error=eas.getError();
  assertNotNull(error);
  assertTrue(error.contains("memory"));
  String solution=eas.getSolution();
  assertNotNull(solution);
  assertTrue(solution.length() > 0);
  String confName=HiveConf.ConfVars.HIVEMAPAGGRHASHMEMORY.toString();
  assertTrue(solution.contains(confName));
}
