{
  JobConf jobConf=new JobConf();
  jobConf.set(HiveConf.ConfVars.HIVEQUERYSTRING.varname,"select * from foo group by moo;");
  final TaskLogProcessor taskLogProcessor=new TaskLogProcessor(jobConf);
  String errorCode="7874";
  String content="line a\nlineb\n" + "Script failed with code " + errorCode + " line c\nlineD\n";
  File log3File=writeTestLog("1",content);
  taskLogProcessor.addTaskAttemptLogUrl(log3File.toURI().toURL().toString());
  List<ErrorAndSolution> errList=taskLogProcessor.getErrors();
  assertEquals(1,errList.size());
  final ErrorAndSolution eas=errList.get(0);
  String error=eas.getError();
  assertNotNull(error);
  assertTrue(error.indexOf(errorCode) >= 0);
  String solution=eas.getSolution();
  assertNotNull(solution);
  assertTrue(solution.length() > 0);
}
