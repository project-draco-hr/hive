{
  JobConf jobConf=new JobConf();
  jobConf.set(HiveConf.ConfVars.HIVEQUERYSTRING.varname,"select * from foo group by moo;");
  final TaskLogProcessor taskLogProcessor=new TaskLogProcessor(jobConf);
  String badFile1="hdfs://localhost/foo1/moo1/zoo1";
  String badFile2="hdfs://localhost/foo2/moo2/zoo2";
  String content="line a\nlineb\n" + "split: " + badFile1 + " is very bad.\n"+ " line c\nlineD\n"+ "split: "+ badFile2+ " is also very bad.\n"+ " java.io.EOFException: null \n"+ "line E\n";
  File log3File=writeTestLog("1",content);
  taskLogProcessor.addTaskAttemptLogUrl(log3File.toURI().toURL().toString());
  List<ErrorAndSolution> errList=taskLogProcessor.getErrors();
  assertEquals(1,errList.size());
  final ErrorAndSolution eas=errList.get(0);
  String error=eas.getError();
  assertNotNull(error);
  assertTrue(error.contains(badFile1) || error.contains(badFile2));
  String solution=eas.getSolution();
  assertNotNull(solution);
  assertTrue(solution.length() > 0);
}
