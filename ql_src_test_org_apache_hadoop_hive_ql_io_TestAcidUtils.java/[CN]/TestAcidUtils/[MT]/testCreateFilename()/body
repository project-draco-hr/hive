{
  Path p=new Path("/tmp");
  Configuration conf=new Configuration();
  AcidOutputFormat.Options options=new AcidOutputFormat.Options(conf).setOldStyle(true).bucket(1);
  assertEquals("/tmp/000001_0",AcidUtils.createFilename(p,options).toString());
  options.bucket(123);
  assertEquals("/tmp/000123_0",AcidUtils.createFilename(p,options).toString());
  options.bucket(23).minimumTransactionId(100).maximumTransactionId(200).writingBase(true).setOldStyle(false);
  assertEquals("/tmp/base_0000200/bucket_00023",AcidUtils.createFilename(p,options).toString());
  options.writingBase(false);
  assertEquals("/tmp/delta_0000100_0000200_0000/bucket_00023",AcidUtils.createFilename(p,options).toString());
  options.statementId(-1);
  assertEquals("/tmp/delta_0000100_0000200/bucket_00023",AcidUtils.createFilename(p,options).toString());
  options.statementId(7);
  assertEquals("/tmp/delta_0000100_0000200_0007/bucket_00023",AcidUtils.createFilename(p,options).toString());
}
