{
  try {
    EnumSet<FsAction> actions=getFsActions(readRequiredPriv,path);
    actions.addAll(getFsActions(writeRequiredPriv,path));
    if (actions.isEmpty()) {
      return;
    }
    checkPermissions(getConf(),path,actions);
  }
 catch (  AccessControlException ex) {
    throw new AuthorizationException(ex);
  }
catch (  LoginException ex) {
    throw new AuthorizationException(ex);
  }
catch (  IOException ex) {
    throw new HiveException(ex);
  }
}
