{
  Map<String,String> conf=initiateSparkConf(configuration);
  String master=conf.get("spark.master");
  if (master.equals("local") || master.startsWith("local[")) {
    return LocalHiveSparkClient.getInstance(generateSparkConf(conf));
  }
 else {
    return new RemoteHiveSparkClient(conf);
  }
}
