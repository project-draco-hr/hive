{
  if (mapJoinOp.getConf().getAliasBucketFileNameMapping() == null || mapJoinOp.getConf().getAliasBucketFileNameMapping().size() == 0) {
    return false;
  }
  boolean tableEligibleForBucketedSortMergeJoin=true;
  QBJoinTree joinCxt=this.pGraphContext.getMapJoinContext().get(mapJoinOp);
  if (joinCxt == null) {
    return false;
  }
  String[] srcs=joinCxt.getBaseSrc();
  for (int srcPos=0; srcPos < srcs.length; srcPos++) {
    srcs[srcPos]=QB.getAppendedAliasFromId(joinCxt.getId(),srcs[srcPos]);
  }
  List<Order> sortColumnsFirstTable=new ArrayList<Order>();
  for (int pos=0; pos < srcs.length; pos++) {
    tableEligibleForBucketedSortMergeJoin=tableEligibleForBucketedSortMergeJoin && isEligibleForBucketSortMergeJoin(smbJoinContext,pGraphContext,mapJoinOp.getConf().getKeys().get((byte)pos),joinCxt,srcs,pos,sortColumnsFirstTable);
  }
  if (!tableEligibleForBucketedSortMergeJoin) {
    if (MapJoinProcessor.checkMapJoin(mapJoinOp.getConf().getPosBigTable(),mapJoinOp.getConf().getConds()) < 0) {
      throw new SemanticException(ErrorMsg.INVALID_BIGTABLE_MAPJOIN.format(mapJoinOp.getConf().getBigTableAlias()));
    }
    return false;
  }
  smbJoinContext.setSrcs(srcs);
  return true;
}
