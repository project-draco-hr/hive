{
  int srcOffset=0;
  while (srcOffset < len) {
    int toWrite=Math.min(len - srcOffset,wbSize - currentWriteOffset);
    System.arraycopy(b,srcOffset + off,currentWriteBuffer,currentWriteOffset,toWrite);
    currentWriteOffset+=toWrite;
    srcOffset+=toWrite;
    if (currentWriteOffset == wbSize) {
      nextBufferToWrite();
    }
  }
}
