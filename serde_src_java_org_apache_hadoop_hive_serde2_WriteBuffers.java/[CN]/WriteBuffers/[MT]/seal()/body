{
  if (currentWriteOffset < (wbSize * 0.8)) {
    byte[] smallerBuffer=new byte[currentWriteOffset];
    System.arraycopy(currentWriteBuffer,0,smallerBuffer,0,currentWriteOffset);
    writeBuffers.set(currentWriteBufferIndex,smallerBuffer);
  }
  if (currentWriteBufferIndex + 1 < writeBuffers.size()) {
    writeBuffers.subList(currentWriteBufferIndex + 1,writeBuffers.size()).clear();
  }
  currentWriteBuffer=currentReadBuffer=null;
  currentWriteBufferIndex=currentReadBufferIndex=-1;
  currentReadOffset=currentWriteOffset=-1;
}
