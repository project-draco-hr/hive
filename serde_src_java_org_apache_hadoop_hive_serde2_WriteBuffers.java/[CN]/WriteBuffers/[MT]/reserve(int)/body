{
  if (byteCount < 0)   throw new AssertionError("byteCount must be non-negative");
  int currentWriteOffset=writePos.offset + byteCount;
  while (currentWriteOffset > wbSize) {
    nextBufferToWrite();
    currentWriteOffset-=wbSize;
  }
  writePos.offset=currentWriteOffset;
}
