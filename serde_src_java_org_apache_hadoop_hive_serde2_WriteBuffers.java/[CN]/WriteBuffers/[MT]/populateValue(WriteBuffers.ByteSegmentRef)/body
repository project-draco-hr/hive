{
  int index=getBufferIndex(value.getOffset());
  byte[] buffer=writeBuffers.get(index);
  int bufferOffset=getOffset(value.getOffset());
  int length=value.getLength();
  if (bufferOffset + length <= wbSize) {
    value.bytes=buffer;
    value.offset=bufferOffset;
  }
 else {
    value.bytes=new byte[length];
    value.offset=0;
    int destOffset=0;
    while (destOffset < length) {
      if (destOffset > 0) {
        buffer=writeBuffers.get(++index);
        bufferOffset=0;
      }
      int toCopy=Math.min(length - destOffset,wbSize - bufferOffset);
      System.arraycopy(buffer,bufferOffset,value.bytes,destOffset,toCopy);
      destOffset+=toCopy;
    }
  }
}
