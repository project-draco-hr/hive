{
  Configuration conf=opHookContext.getOperator().getConfiguration();
  Collection<HiveProfilerStats> stats=aggrStats.values();
  Iterator<HiveProfilerStats> statsIter=stats.iterator();
  while (statsIter.hasNext()) {
    HiveProfilerStats stat=statsIter.next();
    pub.initialize(conf);
    boolean published=pub.publishStat(null,stat.getStatsMap(),conf);
    LOG.info((published ? "did " : "did not ") + "publish stat for: " + stat.toString());
    pub.closeConnection();
  }
  stats.clear();
}
