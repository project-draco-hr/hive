{
  OperatorHookContext opHookContext=curEntry.getOperatorHookContext();
  long exitTime=System.nanoTime();
  long wallTime=exitTime - curEntry.wallStartTime;
  String opName=opHookContext.getOperatorName();
  OperatorHookContext parentContext=parentEntry != null ? parentEntry.getOperatorHookContext() : null;
  Configuration conf=opHookContext.getOperator().getConfiguration();
  String opId=opHookContext.getOperatorId();
  if (aggrStats.containsKey(opId)) {
    aggrStats.get(opId).updateStats(wallTime,1);
  }
 else {
    HiveProfilerStats stats=new HiveProfilerStats(opHookContext,parentContext,1,wallTime,conf);
    aggrStats.put(opId,stats);
  }
}
