{
  setState(OperationState.RUNNING);
  rowSet=new RowSet();
  try {
    IMetaStoreClient metastoreClient=getParentSession().getMetaStoreClient();
    String schemaPattern=convertSchemaPattern(schemaName);
    for (    String dbName : metastoreClient.getDatabases(schemaPattern)) {
      rowSet.addRow(RESULT_SET_SCHEMA,new Object[]{dbName,DEFAULT_HIVE_CATALOG});
    }
    setState(OperationState.FINISHED);
  }
 catch (  Exception e) {
    setState(OperationState.ERROR);
    throw new HiveSQLException(e);
  }
}
