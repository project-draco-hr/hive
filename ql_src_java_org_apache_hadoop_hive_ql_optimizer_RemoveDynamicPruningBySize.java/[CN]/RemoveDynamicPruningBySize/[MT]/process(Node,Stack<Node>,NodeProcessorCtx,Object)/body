{
  OptimizeTezProcContext context=(OptimizeTezProcContext)procContext;
  AppMasterEventOperator event=(AppMasterEventOperator)nd;
  AppMasterEventDesc desc=event.getConf();
  if (desc.getStatistics().getDataSize() > context.conf.getLongVar(ConfVars.TEZ_DYNAMIC_PARTITION_PRUNING_MAX_DATA_SIZE) && (context.pruningOpsRemovedByPriorOpt.isEmpty() || !context.pruningOpsRemovedByPriorOpt.contains(event))) {
    context.pruningOpsRemovedByPriorOpt.add(event);
    GenTezUtils.getUtils().removeBranch(event);
    LOG.info("Disabling dynamic pruning for: " + ((DynamicPruningEventDesc)desc).getTableScan().getName() + ". Expected data size is too big: "+ desc.getStatistics().getDataSize());
  }
  return false;
}
