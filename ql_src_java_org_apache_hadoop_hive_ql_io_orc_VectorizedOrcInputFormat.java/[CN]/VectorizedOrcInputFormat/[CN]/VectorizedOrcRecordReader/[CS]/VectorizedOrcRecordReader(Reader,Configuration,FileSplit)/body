{
  List<OrcProto.Type> types=file.getTypes();
  boolean[] includedColumns=OrcInputFormat.findIncludedColumns(types,conf);
  String[] columnNames=OrcInputFormat.getIncludedColumnNames(types,includedColumns,conf);
  SearchArgument sarg=OrcInputFormat.createSarg(types,conf);
  this.offset=fileSplit.getStart();
  this.length=fileSplit.getLength();
  this.reader=file.rows(offset,length,includedColumns,sarg,columnNames);
  try {
    rbCtx=new VectorizedRowBatchCtx();
    rbCtx.init(conf,fileSplit);
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
