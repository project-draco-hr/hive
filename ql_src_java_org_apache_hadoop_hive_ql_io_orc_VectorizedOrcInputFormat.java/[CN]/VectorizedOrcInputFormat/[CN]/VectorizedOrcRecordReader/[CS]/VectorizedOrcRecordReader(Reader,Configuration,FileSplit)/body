{
  boolean isAcid=(fileSplit instanceof OrcSplit);
  TypeDescription schema=OrcInputFormat.getDesiredRowTypeDescr(conf,isAcid);
  List<OrcProto.Type> types=file.getTypes();
  Reader.Options options=new Reader.Options();
  options.schema(schema);
  this.offset=fileSplit.getStart();
  this.length=fileSplit.getLength();
  options.range(offset,length);
  options.include(OrcInputFormat.genIncludedColumns(types,conf,true));
  OrcInputFormat.setSearchArgument(options,types,conf,true);
  this.reader=file.rowsOptions(options);
  rbCtx=Utilities.getVectorizedRowBatchCtx(conf);
  columnsToIncludeTruncated=rbCtx.getColumnsToIncludeTruncated(conf);
  int partitionColumnCount=rbCtx.getPartitionColumnCount();
  if (partitionColumnCount > 0) {
    partitionValues=new Object[partitionColumnCount];
    rbCtx.getPartitionValues(rbCtx,conf,fileSplit,partitionValues);
  }
 else {
    partitionValues=null;
  }
}
