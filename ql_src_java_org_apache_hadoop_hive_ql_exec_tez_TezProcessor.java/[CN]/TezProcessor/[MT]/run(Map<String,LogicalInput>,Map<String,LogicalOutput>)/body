{
  perfLogger.PerfLogBegin(CLASS_NAME,PerfLogger.TEZ_RUN_PROCESSOR);
  LOG.info("Running task: " + getContext().getUniqueIdentifier());
  if (isMap) {
    rproc=new MapRecordProcessor(jobConf);
    MRInputLegacy mrInput=getMRInput(inputs);
    try {
      mrInput.init();
    }
 catch (    IOException e) {
      throw new RuntimeException("Failed while initializing MRInput",e);
    }
  }
 else {
    rproc=new ReduceRecordProcessor();
  }
  initializeAndRunProcessor(inputs,outputs);
}
