{
  perfLogger.PerfLogBegin(CLASS_NAME,PerfLogger.TEZ_RUN_PROCESSOR);
  LOG.info("Running map: " + processorContext.getUniqueIdentifier());
  for (  LogicalInput input : inputs.values()) {
    input.start();
  }
  for (  LogicalOutput output : outputs.values()) {
    output.start();
  }
  Map<String,OutputCollector> outMap=new HashMap<String,OutputCollector>();
  for (  String outputName : outputs.keySet()) {
    LOG.info("Handling output: " + outputName);
    KeyValueWriter kvWriter=(KeyValueWriter)outputs.get(outputName).getWriter();
    OutputCollector collector=new KVOutputCollector(kvWriter);
    outMap.put(outputName,collector);
  }
  if (isMap) {
    rproc=new MapRecordProcessor();
  }
 else {
    rproc=new ReduceRecordProcessor();
  }
  MRTaskReporter mrReporter=new MRTaskReporter(processorContext);
  rproc.init(jobConf,mrReporter,inputs,outMap);
  rproc.run();
  perfLogger.PerfLogEnd(CLASS_NAME,PerfLogger.TEZ_RUN_PROCESSOR);
}
