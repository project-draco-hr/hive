{
  perfLogger.PerfLogBegin(CLASS_NAME,PerfLogger.TEZ_RUN_PROCESSOR);
  LOG.info("Running map: " + processorContext.getUniqueIdentifier());
  if (outputs.size() > 1) {
    throw new IOException("Cannot handle more than one output" + ", outputCount=" + outputs.size());
  }
  LogicalOutput out=outputs.values().iterator().next();
  KeyValueWriter kvWriter=(KeyValueWriter)out.getWriter();
  OutputCollector collector=new KVOutputCollector(kvWriter);
  if (isMap) {
    rproc=new MapRecordProcessor();
  }
 else {
    rproc=new ReduceRecordProcessor();
  }
  MRTaskReporter mrReporter=new MRTaskReporter(processorContext);
  rproc.init(jobConf,mrReporter,inputs,collector);
  rproc.run();
  perfLogger.PerfLogEnd(CLASS_NAME,PerfLogger.TEZ_RUN_PROCESSOR);
}
