{
  LOG.info("Running map: " + processorContext.getUniqueIdentifier());
  if (inputs.size() != 1) {
    throw new IOException("Cannot handle multiple inputs " + " inputCount=" + inputs.size());
  }
  if (outputs.size() > 1) {
    throw new IOException("Cannot handle more than one output" + ", outputCount=" + outputs.size());
  }
  LogicalInput in=inputs.values().iterator().next();
  LogicalOutput out=outputs.values().iterator().next();
  KeyValueWriter kvWriter=(KeyValueWriter)out.getWriter();
  OutputCollector collector=new KVOutputCollector(kvWriter);
  if (isMap) {
    rproc=new MapRecordProcessor();
  }
 else {
    rproc=new ReduceRecordProcessor();
  }
  MRTaskReporter mrReporter=new MRTaskReporter(processorContext);
  rproc.init(jobConf,mrReporter,inputs,collector);
  rproc.run();
}
