{
  Throwable originalThrowable=null;
  try {
    MRTaskReporter mrReporter=new MRTaskReporter(getContext());
    rproc.init(mrReporter,inputs,outputs);
    rproc.run();
    perfLogger.PerfLogEnd(CLASS_NAME,PerfLogger.TEZ_RUN_PROCESSOR);
  }
 catch (  Throwable t) {
    originalThrowable=t;
  }
 finally {
    if (originalThrowable != null && originalThrowable instanceof Error) {
      LOG.error(StringUtils.stringifyException(originalThrowable));
      throw new RuntimeException(originalThrowable);
    }
    try {
      if (rproc != null) {
        rproc.close();
      }
    }
 catch (    Throwable t) {
      if (originalThrowable == null) {
        originalThrowable=t;
      }
    }
    if (originalThrowable != null) {
      LOG.error(StringUtils.stringifyException(originalThrowable));
      if (originalThrowable instanceof InterruptedException) {
        throw (InterruptedException)originalThrowable;
      }
 else {
        throw new RuntimeException(originalThrowable);
      }
    }
  }
}
