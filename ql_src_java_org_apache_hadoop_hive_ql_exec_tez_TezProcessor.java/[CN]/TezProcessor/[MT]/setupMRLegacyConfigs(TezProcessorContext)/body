{
  StringBuilder taskAttemptIdBuilder=new StringBuilder("attempt_");
  taskAttemptIdBuilder.append(processorContext.getApplicationId().getClusterTimestamp()).append("_").append(jobIdFormat.format(processorContext.getApplicationId().getId())).append("_");
  if (isMap) {
    taskAttemptIdBuilder.append("m_");
  }
 else {
    taskAttemptIdBuilder.append("r_");
  }
  taskAttemptIdBuilder.append(taskIdFormat.format(processorContext.getTaskIndex())).append("_").append(processorContext.getTaskAttemptNumber());
  String taskAttemptIdStr=taskAttemptIdBuilder.toString();
  this.jobConf.set("mapred.task.id",taskAttemptIdStr);
  this.jobConf.set("mapreduce.task.attempt.id",taskAttemptIdStr);
  this.jobConf.setInt("mapred.task.partition",processorContext.getTaskIndex());
}
