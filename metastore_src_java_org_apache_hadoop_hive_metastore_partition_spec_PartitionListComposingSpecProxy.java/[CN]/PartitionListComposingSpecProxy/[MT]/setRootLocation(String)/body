{
  String oldRootPath=partitionSpec.getRootPath();
  if (oldRootPath == null) {
    throw new MetaException("No common root-path. Can't replace root-path!");
  }
  for (  Partition partition : partitionSpec.getPartitionList().getPartitions()) {
    String location=partition.getSd().getLocation();
    if (location.startsWith(oldRootPath)) {
      partition.getSd().setLocation(location.replace(oldRootPath,newRootPath));
    }
 else {
      throw new MetaException("Common root-path not found. Can't replace root-path!");
    }
  }
}
