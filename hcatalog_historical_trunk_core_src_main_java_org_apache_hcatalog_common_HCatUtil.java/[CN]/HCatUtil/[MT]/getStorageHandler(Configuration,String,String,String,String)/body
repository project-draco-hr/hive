{
  if ((storageHandler == null) || (storageHandler.equals(FosterStorageHandler.class.getName()))) {
    try {
      FosterStorageHandler fosterStorageHandler=new FosterStorageHandler(inputFormat,outputFormat,serDe);
      fosterStorageHandler.setConf(conf);
      return fosterStorageHandler;
    }
 catch (    ClassNotFoundException e) {
      throw new IOException("Failed to load " + "foster storage handler",e);
    }
  }
  try {
    Class<? extends HCatStorageHandler> handlerClass=(Class<? extends HCatStorageHandler>)Class.forName(storageHandler,true,JavaUtils.getClassLoader());
    return (HCatStorageHandler)ReflectionUtils.newInstance(handlerClass,conf);
  }
 catch (  ClassNotFoundException e) {
    throw new IOException("Error in loading storage handler." + e.getMessage(),e);
  }
}
