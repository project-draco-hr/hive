{
  this.sessionId=sessionId;
  this.conf=conf;
  FileSystem.get(conf);
  ShimLoader.getHadoopShims().getUGIForConf(conf);
  Hive.get(conf).getAllDatabases();
  tezScratchDir=createTezDir(sessionId);
  TezConfiguration tezConfig=new TezConfiguration(conf);
  tezConfig.set(TezConfiguration.TEZ_AM_JAVA_OPTS,MRHelpers.getMRAMJavaOpts(conf));
  tezConfig.set(TezConfiguration.TEZ_AM_STAGING_DIR,tezScratchDir.toUri().toString());
  appJarLr=createHiveExecLocalResource();
  Map<String,LocalResource> commonLocalResources=new HashMap<String,LocalResource>();
  commonLocalResources.put(DagUtils.getBaseName(appJarLr),appJarLr);
  AMConfiguration amConfig=new AMConfiguration("default",null,commonLocalResources,tezConfig,null);
  TezSessionConfiguration sessionConfig=new TezSessionConfiguration(amConfig,tezConfig);
  session=new TezSession("HIVE-" + sessionId,sessionConfig);
  LOG.info("Opening new Tez Session (id: " + sessionId + ", scratch dir: "+ tezScratchDir+ ")");
  session.start();
}
