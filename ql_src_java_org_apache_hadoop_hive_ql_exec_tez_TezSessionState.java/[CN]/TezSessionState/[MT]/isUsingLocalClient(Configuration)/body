{
  String mode=HiveConf.getVar(conf,ConfVars.LLAP_CREATE_TOKEN_LOCALLY).toLowerCase();
  boolean isHs2Only="hs2".equals(mode);
  if (!isHs2Only)   return "true".equals(mode);
  SessionState session=SessionState.get();
  if (session == null && LOG.isInfoEnabled()) {
    LOG.warn("There's no session to check if we are in HS2");
  }
  return session != null && session.isHiveServerQuery();
}
