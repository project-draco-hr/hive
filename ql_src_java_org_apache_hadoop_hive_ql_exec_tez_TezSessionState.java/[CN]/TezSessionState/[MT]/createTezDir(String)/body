{
  Path tezDir=new Path(SessionState.get().getHdfsScratchDirURIString(),TEZ_DIR);
  tezDir=new Path(tezDir,sessionId);
  FileSystem fs=tezDir.getFileSystem(conf);
  FsPermission fsPermission=new FsPermission(HiveConf.getVar(conf,HiveConf.ConfVars.SCRATCHDIRPERMISSION));
  fs.mkdirs(tezDir,fsPermission);
  tezDir=DagUtils.validateTargetDir(tezDir,conf).getPath();
  fs.deleteOnExit(tezDir);
  return tezDir;
}
