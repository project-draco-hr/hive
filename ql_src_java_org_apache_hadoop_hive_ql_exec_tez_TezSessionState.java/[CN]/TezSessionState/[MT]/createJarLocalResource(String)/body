{
  Path destDirPath=null;
  FileSystem destFs=null;
  FileStatus destDirStatus=null;
{
    String hiveJarDir=utils.getHiveJarDirectory(conf);
    if (hiveJarDir != null) {
      LOG.info("Hive jar directory is " + hiveJarDir);
      destDirPath=new Path(hiveJarDir);
      destFs=destDirPath.getFileSystem(conf);
      destDirStatus=validateTargetDir(destDirPath,destFs);
    }
  }
  if (destDirStatus == null || !destDirStatus.isDir()) {
    destDirPath=utils.getDefaultDestDir(conf);
    LOG.info("Jar dir is null/directory doesn't exist. Choosing HIVE_INSTALL_DIR - " + destDirPath);
    destFs=destDirPath.getFileSystem(conf);
    destDirStatus=validateTargetDir(destDirPath,destFs);
  }
  if (destDirStatus == null || !destDirStatus.isDir()) {
    throw new IOException(ErrorMsg.NO_VALID_LOCATIONS.getMsg());
  }
  Path localFile=new Path(localJarPath);
  String sha=getSha(localFile);
  String destFileName=localFile.getName();
  destFileName=FilenameUtils.removeExtension(destFileName) + "-" + sha+ FilenameUtils.EXTENSION_SEPARATOR+ FilenameUtils.getExtension(destFileName);
  if (LOG.isDebugEnabled()) {
    LOG.debug("The destination file name for [" + localJarPath + "] is "+ destFileName);
  }
  Path destFile=new Path(destDirPath.toString() + "/" + destFileName);
  return utils.localizeResource(localFile,destFile,conf);
}
