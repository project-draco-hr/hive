{
  HCatSplit hcatSplit=(HCatSplit)split;
  PartInfo partitionInfo=hcatSplit.getPartitionInfo();
  HCatInputStorageDriver storageDriver;
  try {
    storageDriver=getInputDriverInstance(partitionInfo.getInputStorageDriverClass());
  }
 catch (  Exception e) {
    throw new IOException(e);
  }
  initStorageDriver(storageDriver,taskContext,partitionInfo,hcatSplit.getTableSchema());
  InputFormat inputFormat=storageDriver.getInputFormat(partitionInfo.getInputStorageDriverProperties());
  RecordReader recordReader=inputFormat.createRecordReader(hcatSplit.getBaseSplit(),taskContext);
  return new HCatRecordReader(storageDriver,recordReader);
}
