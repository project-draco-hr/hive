{
  final RecordReader reader=new RecordReader(in);
  final OutputStreamOutput output=new OutputStreamOutput(out);
  try {
    while (reader.hasNext()) {
      processor.processNext(reader,output);
    }
  }
  finally {
    try {
      output.close();
    }
  finally {
      reader.close();
    }
  }
}
