{
  String currentQueryId=conf.get(HiveConf.ConfVars.HIVEQUERYID.varname);
  if (!currentQueryId.equals(queryId)) {
    if (!tableContainerMap.isEmpty()) {
synchronized (tableContainerMap) {
        if (!currentQueryId.equals(queryId) && !tableContainerMap.isEmpty()) {
          for (          MapJoinTableContainer tableContainer : tableContainerMap.values()) {
            tableContainer.clear();
          }
          tableContainerMap.clear();
          if (LOG.isDebugEnabled()) {
            LOG.debug("Cleaned up small table cache for query " + queryId);
          }
        }
      }
    }
    queryId=currentQueryId;
  }
}
