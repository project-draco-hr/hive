{
  boolean added=false;
  final Map<String,RexNode> newConditions;
  if (input instanceof HiveFilter) {
    newConditions=splitCondition(((HiveFilter)input).getCondition());
  }
 else {
    newConditions=new HashMap<String,RexNode>();
  }
  for (  int pos : inputKeyPositions) {
    RelDataType keyType=input.getRowType().getFieldList().get(pos).getType();
    if (!keyType.isNullable()) {
      continue;
    }
    RexNode cond=rexBuilder.makeCall(SqlStdOperatorTable.IS_NOT_NULL,rexBuilder.makeInputRef(input,pos));
    String digest=cond.toString();
    if (!newConditions.containsKey(digest)) {
      newConditions.put(digest,cond);
      added=true;
    }
  }
  if (!added) {
    return null;
  }
  return newConditions;
}
