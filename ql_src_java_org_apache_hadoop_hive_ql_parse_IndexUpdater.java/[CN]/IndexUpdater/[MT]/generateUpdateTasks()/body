{
  hive=Hive.get(this.conf);
  for (  LoadTableDesc ltd : loadTableWork) {
    TableDesc td=ltd.getTable();
    Table srcTable=hive.getTable(td.getTableName());
    List<Index> tblIndexes=IndexUtils.getAllIndexes(srcTable,(short)-1);
    Map<String,String> partSpec=ltd.getPartitionSpec();
    if (partSpec == null || partSpec.size() == 0) {
      doIndexUpdate(tblIndexes);
    }
 else {
      doIndexUpdate(tblIndexes,partSpec);
    }
  }
  return tasks;
}
