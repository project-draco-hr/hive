{
  Map<String,String> tableJobProperties=tableDesc.getJobProperties();
  String jobString=tableJobProperties.get(HCatConstants.HCAT_KEY_JOB_INFO);
  try {
    InputJobInfo inputJobInfo=(InputJobInfo)HCatUtil.deserialize(jobString);
    HCatTableInfo tableInfo=inputJobInfo.getTableInfo();
    String qualifiedTableName=HBaseHCatStorageHandler.getFullyQualifiedName(tableInfo);
    jobProperties.put(TableInputFormat.INPUT_TABLE,qualifiedTableName);
    Configuration jobConf=getConf();
    String outputSchema=jobConf.get(HCatConstants.HCAT_KEY_OUTPUT_SCHEMA);
    jobProperties.put(TableInputFormat.SCAN_COLUMNS,getScanColumns(tableInfo,outputSchema));
    String serSnapshot=(String)inputJobInfo.getProperties().get(HBaseConstants.PROPERTY_TABLE_SNAPSHOT_KEY);
    if (serSnapshot == null) {
      Configuration conf=addHbaseResources(jobConf);
      HCatTableSnapshot snapshot=HBaseRevisionManagerUtil.createSnapshot(conf,qualifiedTableName,tableInfo);
      jobProperties.put(HBaseConstants.PROPERTY_TABLE_SNAPSHOT_KEY,HCatUtil.serialize(snapshot));
    }
    addHbaseResources(jobConf,jobProperties);
  }
 catch (  IOException e) {
    throw new IllegalStateException("Error while configuring job properties",e);
  }
}
