{
  PerfLogger perfLogger=PerfLogger.getPerfLogger();
  perfLogger.PerfLogBegin(LOG,PerfLogger.PRUNE_LISTING);
  List<String> partNames=Hive.get().getPartitionNames(tab.getDbName(),tab.getTableName(),(short)-1);
  String defaultPartitionName=conf.getVar(HiveConf.ConfVars.DEFAULTPARTITIONNAME);
  List<FieldSchema> pCols=tab.getPartCols();
  List<String> partCols=new ArrayList<String>(pCols.size());
  for (  FieldSchema pCol : pCols) {
    partCols.add(pCol.getName());
  }
  boolean hasUnknownPartitions=prunePartitionNames(partCols,prunerExpr,vcs,defaultPartitionName,partNames);
  perfLogger.PerfLogEnd(LOG,PerfLogger.PRUNE_LISTING);
  perfLogger.PerfLogBegin(LOG,PerfLogger.PARTITION_RETRIEVING);
  if (!partNames.isEmpty()) {
    partitions.addAll(Hive.get().getPartitionsByNames(tab,partNames));
  }
  perfLogger.PerfLogEnd(LOG,PerfLogger.PARTITION_RETRIEVING);
  return hasUnknownPartitions;
}
