{
  if (expr instanceof ExprNodeConstantDesc) {
    expr=removeTruePredciates(expr);
    if (expr == null || ((ExprNodeConstantDesc)expr).getValue() == null) {
      return null;
    }
 else {
      throw new IllegalStateException("Unexpected non-null ExprNodeConstantDesc: " + expr.getExprString());
    }
  }
 else   if (expr instanceof ExprNodeGenericFuncDesc) {
    GenericUDF udf=((ExprNodeGenericFuncDesc)expr).getGenericUDF();
    boolean isAnd=udf instanceof GenericUDFOPAnd;
    if (isAnd || udf instanceof GenericUDFOPOr) {
      List<ExprNodeDesc> children=expr.getChildren();
      ExprNodeDesc left=removeTruePredciates(children.get(0));
      children.set(0,left == null ? null : compactExpr(left));
      ExprNodeDesc right=removeTruePredciates(children.get(1));
      children.set(1,right == null ? null : compactExpr(right));
      if (children.get(0) == null && children.get(1) == null) {
        return null;
      }
 else       if (children.get(0) == null) {
        return isAnd ? children.get(1) : null;
      }
 else       if (children.get(1) == null) {
        return isAnd ? children.get(0) : null;
      }
    }
    return expr;
  }
 else {
    throw new IllegalStateException("Unexpected type of ExprNodeDesc: " + expr.getExprString());
  }
}
