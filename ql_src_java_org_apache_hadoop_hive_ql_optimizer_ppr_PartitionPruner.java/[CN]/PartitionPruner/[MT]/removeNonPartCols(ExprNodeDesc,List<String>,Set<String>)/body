{
  if (expr instanceof ExprNodeColumnDesc) {
    String column=((ExprNodeColumnDesc)expr).getColumn();
    if (!partCols.contains(column)) {
      return new ExprNodeConstantDesc(expr.getTypeInfo(),null);
    }
    referred.add(column);
  }
  if (expr instanceof ExprNodeGenericFuncDesc) {
    List<ExprNodeDesc> children=expr.getChildren();
    for (int i=0; i < children.size(); ++i) {
      children.set(i,removeNonPartCols(children.get(i),partCols,referred));
    }
  }
  return expr;
}
