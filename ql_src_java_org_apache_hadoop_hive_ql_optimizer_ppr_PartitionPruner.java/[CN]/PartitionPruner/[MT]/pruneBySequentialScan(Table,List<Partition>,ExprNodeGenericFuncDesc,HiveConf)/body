{
  PerfLogger perfLogger=PerfLogger.getPerfLogger();
  perfLogger.PerfLogBegin(CLASS_NAME,PerfLogger.PRUNE_LISTING);
  List<String> partNames=Hive.get().getPartitionNames(tab.getDbName(),tab.getTableName(),(short)-1);
  String defaultPartitionName=conf.getVar(HiveConf.ConfVars.DEFAULTPARTITIONNAME);
  List<String> partCols=extractPartColNames(tab);
  List<PrimitiveTypeInfo> partColTypeInfos=extractPartColTypes(tab);
  boolean hasUnknownPartitions=prunePartitionNames(partCols,partColTypeInfos,prunerExpr,defaultPartitionName,partNames);
  perfLogger.PerfLogEnd(CLASS_NAME,PerfLogger.PRUNE_LISTING);
  perfLogger.PerfLogBegin(CLASS_NAME,PerfLogger.PARTITION_RETRIEVING);
  if (!partNames.isEmpty()) {
    partitions.addAll(Hive.get().getPartitionsByNames(tab,partNames));
  }
  perfLogger.PerfLogEnd(CLASS_NAME,PerfLogger.PARTITION_RETRIEVING);
  return hasUnknownPartitions;
}
