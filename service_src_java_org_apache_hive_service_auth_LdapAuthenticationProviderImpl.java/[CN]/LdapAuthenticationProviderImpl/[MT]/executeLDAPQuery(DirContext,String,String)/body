{
  if (rootDN == null) {
    return null;
  }
  SearchControls searchControls=new SearchControls();
  List<String> list=new ArrayList<String>();
  String[] returnAttributes;
  if (groupMembership_attr != null) {
    returnAttributes=new String[]{groupMembership_attr};
  }
 else {
    returnAttributes=new String[0];
  }
  searchControls.setSearchScope(SearchControls.SUBTREE_SCOPE);
  searchControls.setReturningAttributes(returnAttributes);
  LOG.info("Using a user specified LDAP query for adjudication:" + query + ",baseDN="+ rootDN);
  NamingEnumeration<SearchResult> results=ctx.search(rootDN,query,searchControls);
  SearchResult searchResult=null;
  while (results.hasMoreElements()) {
    searchResult=results.nextElement();
    if (groupMembership_attr != null) {
      Attribute userAttribute=searchResult.getAttributes().get(groupMembership_attr);
      if (userAttribute != null) {
        list.add((String)userAttribute.get());
        continue;
      }
    }
    list.add(searchResult.getNameInNamespace());
    LOG.debug("LDAPAtn:executeLDAPQuery()::Return set size " + list.get(list.size() - 1));
  }
  return list;
}
