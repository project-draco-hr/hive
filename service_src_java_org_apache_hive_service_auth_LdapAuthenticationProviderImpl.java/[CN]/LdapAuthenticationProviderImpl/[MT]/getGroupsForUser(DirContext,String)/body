{
  List<String> groupList=new ArrayList<String>();
  String searchFilter="(" + DN_ATTR + "="+ userDN+ ")";
  SearchControls searchControls=new SearchControls();
  LOG.debug("getGroupsForUser:searchFilter=" + searchFilter);
  String[] attrIDs={"memberOf"};
  searchControls.setSearchScope(SearchControls.SUBTREE_SCOPE);
  searchControls.setReturningAttributes(attrIDs);
  NamingEnumeration<SearchResult> results=ctx.search(userDN.split(",",2)[1],searchFilter,searchControls);
  while (results.hasMoreElements()) {
    NamingEnumeration<? extends Attribute> groups=results.next().getAttributes().getAll();
    while (groups.hasMore()) {
      Attribute attr=groups.next();
      NamingEnumeration<?> list=attr.getAll();
      while (list.hasMore()) {
        groupList.add((String)list.next());
      }
    }
  }
  return groupList;
}
