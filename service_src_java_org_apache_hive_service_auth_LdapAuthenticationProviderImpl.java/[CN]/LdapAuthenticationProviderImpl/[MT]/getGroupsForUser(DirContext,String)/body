{
  List<String> groupList=new ArrayList<String>();
  String user=extractName(userDN);
  String searchFilter="(&(objectClass=" + groupClass_attr + ")(|("+ groupMembership_attr+ "="+ userDN+ ")("+ groupMembership_attr+ "="+ user+ ")))";
  SearchControls searchControls=new SearchControls();
  NamingEnumeration<SearchResult> results=null;
  SearchResult result=null;
  String groupBase=null;
  LOG.debug("getGroupsForUser:searchFilter=" + searchFilter);
  String[] attrIDs=new String[0];
  searchControls.setSearchScope(SearchControls.SUBTREE_SCOPE);
  searchControls.setReturningAttributes(attrIDs);
  ListIterator<String> listIter=groupBases.listIterator();
  while (listIter.hasNext()) {
    try {
      groupBase=listIter.next().split(",",2)[1];
      LOG.debug("Searching for groups under " + groupBase);
      results=ctx.search(groupBase,searchFilter,searchControls);
      while (results.hasMoreElements()) {
        result=results.nextElement();
        LOG.debug("Found Group:" + result.getNameInNamespace());
        groupList.add(result.getNameInNamespace());
      }
    }
 catch (    NamingException e) {
      LOG.warn("Exception searching for user groups",e);
    }
  }
  return groupList;
}
