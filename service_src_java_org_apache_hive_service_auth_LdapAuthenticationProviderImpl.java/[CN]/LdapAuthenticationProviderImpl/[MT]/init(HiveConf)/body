{
  ldapURL=conf.getVar(HiveConf.ConfVars.HIVE_SERVER2_PLAIN_LDAP_URL);
  baseDN=conf.getVar(HiveConf.ConfVars.HIVE_SERVER2_PLAIN_LDAP_BASEDN);
  ldapDomain=conf.getVar(HiveConf.ConfVars.HIVE_SERVER2_PLAIN_LDAP_DOMAIN);
  customQuery=conf.getVar(HiveConf.ConfVars.HIVE_SERVER2_PLAIN_LDAP_CUSTOMLDAPQUERY);
  guid_attr=conf.getVar(HiveConf.ConfVars.HIVE_SERVER2_PLAIN_LDAP_GUIDKEY);
  groupBases=new ArrayList<String>();
  userBases=new ArrayList<String>();
  userFilter=new ArrayList<String>();
  groupFilter=new ArrayList<String>();
  String groupDNPatterns=conf.getVar(HiveConf.ConfVars.HIVE_SERVER2_PLAIN_LDAP_GROUPDNPATTERN);
  String groupFilterVal=conf.getVar(HiveConf.ConfVars.HIVE_SERVER2_PLAIN_LDAP_GROUPFILTER);
  String userDNPatterns=conf.getVar(HiveConf.ConfVars.HIVE_SERVER2_PLAIN_LDAP_USERDNPATTERN);
  String userFilterVal=conf.getVar(HiveConf.ConfVars.HIVE_SERVER2_PLAIN_LDAP_USERFILTER);
  groupMembership_attr=conf.getVar(HiveConf.ConfVars.HIVE_SERVER2_PLAIN_LDAP_GROUPMEMBERSHIP_KEY);
  groupClass_attr=conf.getVar(HiveConf.ConfVars.HIVE_SERVER2_PLAIN_LDAP_GROUPCLASS_KEY);
  if (groupDNPatterns != null && groupDNPatterns.trim().length() > 0) {
    String[] groupTokens=groupDNPatterns.split(":");
    for (int i=0; i < groupTokens.length; i++) {
      if (groupTokens[i].contains(",") && groupTokens[i].contains("=")) {
        groupBases.add(groupTokens[i]);
      }
 else {
        LOG.warn("Unexpected format for " + HiveConf.ConfVars.HIVE_SERVER2_PLAIN_LDAP_GROUPDNPATTERN + "..ignoring "+ groupTokens[i]);
      }
    }
  }
 else   if (baseDN != null) {
    groupBases.add(guid_attr + "=%s," + baseDN);
  }
  if (groupFilterVal != null && groupFilterVal.trim().length() > 0) {
    String[] groups=groupFilterVal.split(",");
    for (int i=0; i < groups.length; i++) {
      if (LOG.isDebugEnabled()) {
        LOG.debug("Filtered group: " + groups[i]);
      }
      groupFilter.add(groups[i]);
    }
  }
  if (userDNPatterns != null && userDNPatterns.trim().length() > 0) {
    String[] userTokens=userDNPatterns.split(":");
    for (int i=0; i < userTokens.length; i++) {
      if (userTokens[i].contains(",") && userTokens[i].contains("=")) {
        userBases.add(userTokens[i]);
      }
 else {
        LOG.warn("Unexpected format for " + HiveConf.ConfVars.HIVE_SERVER2_PLAIN_LDAP_USERDNPATTERN + "..ignoring "+ userTokens[i]);
      }
    }
  }
 else   if (baseDN != null) {
    userBases.add(guid_attr + "=%s," + baseDN);
  }
  if (userFilterVal != null && userFilterVal.trim().length() > 0) {
    String[] users=userFilterVal.split(",");
    for (int i=0; i < users.length; i++) {
      if (LOG.isDebugEnabled()) {
        LOG.debug("Filtered user: " + users[i]);
      }
      userFilter.add(users[i]);
    }
  }
}
