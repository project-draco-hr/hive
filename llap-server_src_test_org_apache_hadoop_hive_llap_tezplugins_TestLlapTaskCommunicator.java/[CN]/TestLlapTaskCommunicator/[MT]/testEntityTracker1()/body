{
  LlapTaskCommunicator.EntityTracker entityTracker=new LlapTaskCommunicator.EntityTracker();
  String host1="host1";
  String host2="host2";
  String host3="host3";
  int port=1451;
  ContainerId containerId101=constructContainerId(101);
  entityTracker.registerContainer(containerId101,host1,port);
  assertEquals(LlapNodeId.getInstance(host1,port),entityTracker.getNodeIdForContainer(containerId101));
  entityTracker.unregisterContainer(containerId101);
  assertNull(entityTracker.getContainerAttemptMapForNode(LlapNodeId.getInstance(host1,port)));
  assertNull(entityTracker.getNodeIdForContainer(containerId101));
  assertEquals(0,entityTracker.nodeMap.size());
  assertEquals(0,entityTracker.attemptToNodeMap.size());
  assertEquals(0,entityTracker.containerToNodeMap.size());
  ContainerId containerId1=constructContainerId(1);
  TezTaskAttemptID taskAttemptId1=constructTaskAttemptId(1);
  entityTracker.registerTaskAttempt(containerId1,taskAttemptId1,host1,port);
  assertEquals(LlapNodeId.getInstance(host1,port),entityTracker.getNodeIdForContainer(containerId1));
  assertEquals(LlapNodeId.getInstance(host1,port),entityTracker.getNodeIdForTaskAttempt(taskAttemptId1));
  entityTracker.unregisterTaskAttempt(taskAttemptId1);
  assertNull(entityTracker.getContainerAttemptMapForNode(LlapNodeId.getInstance(host1,port)));
  assertNull(entityTracker.getNodeIdForContainer(containerId1));
  assertNull(entityTracker.getNodeIdForTaskAttempt(taskAttemptId1));
  assertEquals(0,entityTracker.nodeMap.size());
  assertEquals(0,entityTracker.attemptToNodeMap.size());
  assertEquals(0,entityTracker.containerToNodeMap.size());
  ContainerId containerId201=constructContainerId(201);
  TezTaskAttemptID taskAttemptId201=constructTaskAttemptId(201);
  entityTracker.registerTaskAttempt(containerId201,taskAttemptId201,host1,port);
  assertEquals(LlapNodeId.getInstance(host1,port),entityTracker.getNodeIdForContainer(containerId201));
  assertEquals(LlapNodeId.getInstance(host1,port),entityTracker.getNodeIdForTaskAttempt(taskAttemptId201));
  entityTracker.unregisterContainer(containerId201);
  assertNull(entityTracker.getContainerAttemptMapForNode(LlapNodeId.getInstance(host1,port)));
  assertNull(entityTracker.getNodeIdForContainer(containerId201));
  assertNull(entityTracker.getNodeIdForTaskAttempt(taskAttemptId201));
  assertEquals(0,entityTracker.nodeMap.size());
  assertEquals(0,entityTracker.attemptToNodeMap.size());
  assertEquals(0,entityTracker.containerToNodeMap.size());
  entityTracker.unregisterTaskAttempt(taskAttemptId201);
}
