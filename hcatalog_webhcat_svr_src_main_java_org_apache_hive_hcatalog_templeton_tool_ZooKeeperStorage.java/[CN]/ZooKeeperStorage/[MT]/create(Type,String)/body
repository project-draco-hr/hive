{
  try {
    String[] paths=getPaths(makeZnode(type,id));
    boolean wasCreated=false;
    for (    String znode : paths) {
      try {
        zk.create(znode,new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
        wasCreated=true;
      }
 catch (      KeeperException.NodeExistsException e) {
      }
    }
    if (wasCreated) {
      try {
        if (type.equals(Type.JOB)) {
          JobStateTracker jt=new JobStateTracker(id,zk,false,job_trackingpath);
          jt.create();
        }
      }
 catch (      Exception e) {
        LOG.warn("Error tracking: " + e.getMessage());
        zk.delete(makeZnode(type,id),-1);
      }
    }
    if (zk.exists(makeZnode(type,id),false) == null)     throw new IOException("Unable to create " + makeZnode(type,id));
    if (wasCreated) {
      try {
        saveField(type,id,"created",Long.toString(System.currentTimeMillis()));
      }
 catch (      NotFoundException nfe) {
        throw new IOException("Couldn't write to node " + id,nfe);
      }
    }
  }
 catch (  KeeperException e) {
    throw new IOException("Creating " + id,e);
  }
catch (  InterruptedException e) {
    throw new IOException("Creating " + id,e);
  }
}
