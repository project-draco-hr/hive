{
  RewriteCanApplyCtx canApplyCtx=RewriteCanApplyCtx.getInstance(parseContext);
  canApplyCtx.setAlias(alias);
  canApplyCtx.setBaseTableName(baseTable.getTableName());
  canApplyCtx.populateRewriteVars(topOp);
  Map<Index,String> indexTableMap=getIndexToKeysMap(indexes);
  for (  Map.Entry<Index,String> entry : indexTableMap.entrySet()) {
    Index index=entry.getKey();
    String indexKeyName=entry.getValue();
    if (canApplyCtx.getIndexKey() != null && canApplyCtx.getIndexKey().equals(indexKeyName) && checkIfAllRewriteCriteriaIsMet(canApplyCtx)) {
      canApplyCtx.setAggFunction("_count_of_" + indexKeyName + "");
      canApplyCtx.addTable(canApplyCtx.getBaseTableName(),index.getIndexTableName());
      canApplyCtx.setIndexTableName(index.getIndexTableName());
      tsOpToProcess.put(alias,canApplyCtx);
      return true;
    }
  }
  return false;
}
