{
  List<String> supportedIndexes=new ArrayList<String>();
  supportedIndexes.add(AggregateIndexHandler.class.getName());
  Collection<Operator<? extends OperatorDesc>> topTables=parseContext.getTopOps().values();
  Map<Table,List<Index>> indexes=new HashMap<Table,List<Index>>();
  for (  Operator<? extends OperatorDesc> op : topTables) {
    if (op instanceof TableScanOperator) {
      TableScanOperator tsOP=(TableScanOperator)op;
      List<Index> tblIndexes=IndexUtils.getIndexes(tsOP.getConf().getTableMetadata(),supportedIndexes);
      if (tblIndexes.size() > 0) {
        indexes.put(tsOP.getConf().getTableMetadata(),tblIndexes);
      }
    }
  }
  return indexes;
}
