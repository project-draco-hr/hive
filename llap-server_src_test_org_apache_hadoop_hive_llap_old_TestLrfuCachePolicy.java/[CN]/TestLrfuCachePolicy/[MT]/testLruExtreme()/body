{
  int heapSize=4;
  LOG.info("Testing lambda 1 (LRU)");
  Random rdm=new Random(1234);
  HiveConf conf=new HiveConf();
  ArrayList<WeakBuffer> inserted=new ArrayList<WeakBuffer>(heapSize);
  conf.setFloat(HiveConf.ConfVars.LLAP_LRFU_LAMBDA.varname,1.0f);
  LrfuCachePolicy lru=new LrfuCachePolicy(conf,1,heapSize);
  for (int i=0; i < heapSize; ++i) {
    WeakBuffer buffer=BufferPool.allocateFake();
    assertNull(cache(lru,buffer));
    inserted.add(buffer);
  }
  Collections.shuffle(inserted,rdm);
  for (int i=0; i < inserted.size(); ++i) {
    for (int j=0; j < (inserted.size() - i); ++j) {
      lru.notifyLock(inserted.get(i));
      lru.notifyUnlock(inserted.get(i));
    }
  }
  verifyOrder(lru,inserted);
}
