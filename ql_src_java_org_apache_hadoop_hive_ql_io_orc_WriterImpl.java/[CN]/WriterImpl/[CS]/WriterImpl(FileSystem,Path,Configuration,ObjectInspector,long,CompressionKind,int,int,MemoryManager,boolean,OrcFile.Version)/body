{
  this.fs=fs;
  this.path=path;
  this.conf=conf;
  this.stripeSize=stripeSize;
  this.version=version;
  this.addBlockPadding=addBlockPadding;
  this.blockSize=Math.min(MAX_BLOCK_SIZE,2 * stripeSize);
  this.compress=compress;
  this.bufferSize=bufferSize;
  this.rowIndexStride=rowIndexStride;
  this.memoryManager=memoryManager;
  buildIndex=rowIndexStride > 0;
  codec=createCodec(compress);
  treeWriter=createTreeWriter(inspector,streamFactory,false);
  if (buildIndex && rowIndexStride < MIN_ROW_INDEX_STRIDE) {
    throw new IllegalArgumentException("Row stride must be at least " + MIN_ROW_INDEX_STRIDE);
  }
  memoryManager.addWriter(path,stripeSize,this);
}
