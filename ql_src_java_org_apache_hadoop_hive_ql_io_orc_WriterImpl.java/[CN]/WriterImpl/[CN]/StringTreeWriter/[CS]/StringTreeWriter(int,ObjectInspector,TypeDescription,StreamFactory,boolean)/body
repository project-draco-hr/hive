{
  super(columnId,inspector,schema,writer,nullable);
  this.isDirectV2=isNewWriteFormat(writer);
  stringOutput=writer.createStream(id,OrcProto.Stream.Kind.DICTIONARY_DATA);
  lengthOutput=createIntegerWriter(writer.createStream(id,OrcProto.Stream.Kind.LENGTH),false,isDirectV2,writer);
  rowOutput=createIntegerWriter(writer.createStream(id,OrcProto.Stream.Kind.DATA),false,isDirectV2,writer);
  recordPosition(rowIndexPosition);
  rowIndexValueCount.add(0L);
  buildIndex=writer.buildIndex();
  directStreamOutput=writer.createStream(id,OrcProto.Stream.Kind.DATA);
  directLengthOutput=createIntegerWriter(writer.createStream(id,OrcProto.Stream.Kind.LENGTH),false,isDirectV2,writer);
  Configuration conf=writer.getConfiguration();
  dictionaryKeySizeThreshold=OrcConf.DICTIONARY_KEY_SIZE_THRESHOLD.getDouble(conf);
  strideDictionaryCheck=OrcConf.ROW_INDEX_STRIDE_DICTIONARY_CHECK.getBoolean(conf);
  doneDictionaryCheck=false;
}
