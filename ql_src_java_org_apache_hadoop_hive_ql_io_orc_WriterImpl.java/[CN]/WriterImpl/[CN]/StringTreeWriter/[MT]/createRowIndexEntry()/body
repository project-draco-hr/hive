{
  getStripeStatistics().merge(indexStatistics);
  OrcProto.RowIndexEntry.Builder rowIndexEntry=getRowIndexEntry();
  rowIndexEntry.setStatistics(indexStatistics.serialize());
  indexStatistics.reset();
  OrcProto.RowIndexEntry base=rowIndexEntry.build();
  savedRowIndex.add(base);
  rowIndexEntry.clear();
  addBloomFilterEntry();
  recordPosition(rowIndexPosition);
  rowIndexValueCount.add(Long.valueOf(rows.size()));
  if (strideDictionaryCheck) {
    checkDictionaryEncoding();
  }
  if (!useDictionaryEncoding) {
    if (rows.size() > 0) {
      flushDictionary();
      recordDirectStreamPosition();
    }
 else {
      recordDirectStreamPosition();
      getRowIndex().addEntry(base);
    }
  }
}
