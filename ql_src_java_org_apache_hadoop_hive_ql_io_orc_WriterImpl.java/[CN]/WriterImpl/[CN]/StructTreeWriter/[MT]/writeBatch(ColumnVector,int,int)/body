{
  super.writeBatch(vector,offset,length);
  StructColumnVector vec=(StructColumnVector)vector;
  if (vector.isRepeating) {
    if (vector.noNulls || !vector.isNull[0]) {
      writeFields(vec,childrenWriters,offset,length);
    }
  }
 else   if (vector.noNulls) {
    writeFields(vec,childrenWriters,offset,length);
  }
 else {
    int currentRun=0;
    boolean started=false;
    for (int i=0; i < length; ++i) {
      if (!vec.isNull[i + offset]) {
        if (!started) {
          started=true;
          currentRun=i;
        }
      }
 else       if (started) {
        started=false;
        writeFields(vec,childrenWriters,offset + currentRun,i - currentRun);
      }
    }
    if (started) {
      writeFields(vec,childrenWriters,offset + currentRun,length - currentRun);
    }
  }
}
