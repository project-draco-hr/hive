{
  super(columnId,inspector,schema,writer,nullable);
  List<ObjectInspector> choices=null;
  if (inspector != null) {
    UnionObjectInspector insp=(UnionObjectInspector)inspector;
    choices=insp.getObjectInspectors();
  }
  List<TypeDescription> children=schema.getChildren();
  childrenWriters=new TreeWriter[children.size()];
  for (int i=0; i < childrenWriters.length; ++i) {
    childrenWriters[i]=createTreeWriter(choices != null ? choices.get(i) : null,children.get(i),writer,true);
  }
  tags=new RunLengthByteWriter(writer.createStream(columnId,OrcProto.Stream.Kind.DATA));
  recordPosition(rowIndexPosition);
}
