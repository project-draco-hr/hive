{
  super(columnId,inspector,schema,writer,nullable);
  UnionObjectInspector insp=(UnionObjectInspector)inspector;
  List<ObjectInspector> choices=insp.getObjectInspectors();
  List<TypeDescription> children=schema.getChildren();
  childrenWriters=new TreeWriter[children.size()];
  for (int i=0; i < childrenWriters.length; ++i) {
    childrenWriters[i]=createTreeWriter(choices.get(i),children.get(i),writer,true);
  }
  tags=new RunLengthByteWriter(writer.createStream(columnId,OrcProto.Stream.Kind.DATA));
  recordPosition(rowIndexPosition);
}
