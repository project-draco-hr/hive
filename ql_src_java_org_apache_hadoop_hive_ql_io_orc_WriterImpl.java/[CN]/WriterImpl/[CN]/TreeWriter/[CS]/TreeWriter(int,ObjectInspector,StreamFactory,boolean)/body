{
  this.isCompressed=streamFactory.isCompressed();
  this.id=columnId;
  this.inspector=inspector;
  this.useDirectV2Encoding=true;
  if (nullable) {
    isPresentOutStream=streamFactory.createStream(id,OrcProto.Stream.Kind.PRESENT);
    isPresent=new BitFieldWriter(isPresentOutStream,1);
  }
 else {
    isPresent=null;
  }
  this.foundNulls=false;
  indexStatistics=ColumnStatisticsImpl.create(inspector);
  fileStatistics=ColumnStatisticsImpl.create(inspector);
  childrenWriters=new TreeWriter[0];
  rowIndex=OrcProto.RowIndex.newBuilder();
  rowIndexEntry=OrcProto.RowIndexEntry.newBuilder();
  rowIndexPosition=new RowIndexPositionRecorder(rowIndexEntry);
  if (streamFactory.buildIndex()) {
    rowIndexStream=streamFactory.createStream(id,OrcProto.Stream.Kind.ROW_INDEX);
  }
 else {
    rowIndexStream=null;
  }
}
