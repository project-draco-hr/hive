{
  if (isPresent != null) {
    isPresent.flush();
    if (!foundNulls) {
      isPresentOutStream.suppress();
      if (rowIndexStream != null) {
        removeIsPresentPositions();
      }
    }
  }
  foundNulls=false;
  builder.addColumns(getEncoding());
  if (rowIndexStream != null) {
    if (rowIndex.getEntryCount() != requiredIndexEntries) {
      throw new IllegalArgumentException("Column has wrong number of " + "index entries found: " + rowIndexEntry + " expected: "+ requiredIndexEntries);
    }
    rowIndex.build().writeTo(rowIndexStream);
    rowIndexStream.flush();
  }
  rowIndex.clear();
  rowIndexEntry.clear();
}
