{
  super(columnId,inspector,schema,writer,nullable);
  this.isDirectV2=isNewWriteFormat(writer);
  childrenWriters=new TreeWriter[2];
  List<TypeDescription> children=schema.getChildren();
  ObjectInspector keyInsp=null;
  ObjectInspector valueInsp=null;
  if (inspector != null) {
    MapObjectInspector insp=(MapObjectInspector)inspector;
    keyInsp=insp.getMapKeyObjectInspector();
    valueInsp=insp.getMapValueObjectInspector();
  }
  childrenWriters[0]=createTreeWriter(keyInsp,children.get(0),writer,true);
  childrenWriters[1]=createTreeWriter(valueInsp,children.get(1),writer,true);
  lengths=createIntegerWriter(writer.createStream(columnId,OrcProto.Stream.Kind.LENGTH),false,isDirectV2,writer);
  recordPosition(rowIndexPosition);
}
