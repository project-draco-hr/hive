{
  long availableMem=getMemoryAvailableForORC();
  if (colNames != null) {
    final int numCols=colNames.split(",").length;
    if (numCols > COLUMN_COUNT_THRESHOLD) {
      final int outStreamBuffers=codec == null ? 1 : 2;
      final int maxStreams=5;
      final long miscAllocation=(long)(0.1f * availableMem);
      final long remainingMem=availableMem - miscAllocation;
      int estBufferSize=(int)(remainingMem / (maxStreams * outStreamBuffers * numCols));
      estBufferSize=getClosestBufferSize(estBufferSize,bs);
      if (estBufferSize > bs) {
        estBufferSize=bs;
      }
      LOG.info("WIDE TABLE - Number of columns: " + numCols + " Chosen compression buffer size: "+ estBufferSize);
      return estBufferSize;
    }
  }
  return bs;
}
