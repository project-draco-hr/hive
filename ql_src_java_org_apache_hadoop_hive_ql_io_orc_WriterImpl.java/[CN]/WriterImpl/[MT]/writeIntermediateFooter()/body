{
  flushStripe();
  if (stripesAtLastFlush != stripes.size()) {
    if (callback != null) {
      callback.preFooterWrite(callbackContext);
    }
    int metaLength=writeMetadata(rawWriter.getPos());
    int footLength=writeFooter(rawWriter.getPos() - metaLength);
    rawWriter.writeByte(writePostScript(footLength,metaLength));
    stripesAtLastFlush=stripes.size();
    OrcInputFormat.SHIMS.hflush(rawWriter);
  }
  return rawWriter.getPos();
}
