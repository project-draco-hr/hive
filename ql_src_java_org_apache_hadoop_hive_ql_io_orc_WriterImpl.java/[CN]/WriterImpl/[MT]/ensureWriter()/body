{
  if (rawWriter == null) {
    rawWriter=fs.create(path,false,HDFS_BUFFER_SIZE,fs.getDefaultReplication(),Math.min(stripeSize * 2L,Integer.MAX_VALUE));
    rawWriter.writeBytes(OrcFile.MAGIC);
    headerLength=rawWriter.getPos();
    writer=new OutStream("metadata",bufferSize,codec,new DirectStream(rawWriter));
    protobufWriter=CodedOutputStream.newInstance(writer);
  }
}
