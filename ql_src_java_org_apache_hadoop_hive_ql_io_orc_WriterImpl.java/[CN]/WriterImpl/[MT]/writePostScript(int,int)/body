{
  OrcProto.PostScript.Builder builder=OrcProto.PostScript.newBuilder().setCompression(writeCompressionKind(compress)).setFooterLength(footerLength).setMetadataLength(metadataLength).setMagic(OrcFile.MAGIC).addVersion(version.getMajor()).addVersion(version.getMinor()).setWriterVersion(OrcFile.WriterVersion.HIVE_4243.getId());
  if (compress != CompressionKind.NONE) {
    builder.setCompressionBlockSize(bufferSize);
  }
  OrcProto.PostScript ps=builder.build();
  long startPosn=rawWriter.getPos();
  ps.writeTo(rawWriter);
  long length=rawWriter.getPos() - startPosn;
  if (length > 255) {
    throw new IllegalArgumentException("PostScript too large at " + length);
  }
  return (int)length;
}
