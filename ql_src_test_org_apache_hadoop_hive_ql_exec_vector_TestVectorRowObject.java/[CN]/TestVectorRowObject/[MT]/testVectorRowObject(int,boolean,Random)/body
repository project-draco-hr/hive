{
  String[] emptyScratchTypeNames=new String[0];
  VectorRandomRowSource source=new VectorRandomRowSource();
  source.init(r);
  VectorizedRowBatchCtx batchContext=new VectorizedRowBatchCtx();
  batchContext.init(source.rowStructObjectInspector(),emptyScratchTypeNames);
  VectorizedRowBatch batch=batchContext.createVectorizedRowBatch();
  for (  ColumnVector cv : batch.cols) {
    Arrays.fill(cv.isNull,true);
    cv.noNulls=false;
  }
  VectorAssignRow vectorAssignRow=new VectorAssignRow();
  vectorAssignRow.init(source.typeNames());
  VectorExtractRow vectorExtractRow=new VectorExtractRow();
  vectorExtractRow.init(source.typeNames());
  Object[][] randomRows=source.randomRows(100000);
  if (sort) {
    source.sort(randomRows);
  }
  int firstRandomRowIndex=0;
  for (int i=0; i < randomRows.length; i++) {
    Object[] row=randomRows[i];
    vectorAssignRow.assignRow(batch,batch.size,row);
    batch.size++;
    if (batch.size == batch.DEFAULT_SIZE) {
      examineBatch(batch,vectorExtractRow,randomRows,firstRandomRowIndex);
      firstRandomRowIndex=i + 1;
      batch.reset();
    }
  }
  if (batch.size > 0) {
    examineBatch(batch,vectorExtractRow,randomRows,firstRandomRowIndex);
  }
}
