{
  String[] emptyScratchTypeNames=new String[0];
  RandomRowObjectSource source=new RandomRowObjectSource();
  source.init(r);
  VectorizedRowBatchCtx batchContext=new VectorizedRowBatchCtx();
  batchContext.init(source.rowStructObjectInspector(),emptyScratchTypeNames);
  VectorizedRowBatch batch=batchContext.createVectorizedRowBatch();
  VectorAssignRowSameBatch vectorAssignRow=new VectorAssignRowSameBatch();
  vectorAssignRow.init(source.typeNames());
  vectorAssignRow.setOneBatch(batch);
  VectorExtractRowSameBatch vectorExtractRow=new VectorExtractRowSameBatch();
  vectorExtractRow.init(source.typeNames());
  vectorExtractRow.setOneBatch(batch);
  Object[][] randomRows=source.randomRows(100000);
  int firstRandomRowIndex=0;
  for (int i=0; i < randomRows.length; i++) {
    Object[] row=randomRows[i];
    vectorAssignRow.assignRow(batch.size,row);
    batch.size++;
    if (batch.size == batch.DEFAULT_SIZE) {
      examineBatch(batch,vectorExtractRow,randomRows,firstRandomRowIndex);
      firstRandomRowIndex=i + 1;
      batch.reset();
    }
  }
  if (batch.size > 0) {
    examineBatch(batch,vectorExtractRow,randomRows,firstRandomRowIndex);
  }
}
