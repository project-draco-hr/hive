{
  if (useMemoizedRoot && rootNode != null && rootNode.parent == null && rootNode.hasValidMemoizedString()) {
    return rootNode;
  }
  ASTNode retNode=this;
  while (retNode.parent != null) {
    retNode=(ASTNode)retNode.parent;
  }
  rootNode=retNode;
  if (!rootNode.isValidASTStr) {
    rootNode.astStr=new StringBuffer();
    rootNode.toStringTree(rootNode);
    rootNode.isValidASTStr=true;
  }
  return retNode;
}
