{
  List<String> candidateSiblings=new ArrayList<>();
  if (System.getProperty("hive.root") != null) {
    try {
      candidateSiblings.add(new File(System.getProperty("hive.root")).getCanonicalPath());
    }
 catch (    IOException e) {
      throw new RuntimeException("error getting hive.root",e);
    }
  }
  candidateSiblings.add(new File(".").getAbsolutePath());
  for (  String string : candidateSiblings) {
    File curr=new File(string);
    do {
      Set<String> lls=Sets.newHashSet(curr.list());
      if (lls.contains("itests") && lls.contains("ql") && lls.contains("metastore")) {
        System.out.println("detected hiveRoot: " + curr);
        return QTestUtil.ensurePathEndsInSlash(curr.getAbsolutePath());
      }
      curr=curr.getParentFile();
    }
 while (curr != null);
  }
  throw new RuntimeException("unable to find hiveRoot");
}
