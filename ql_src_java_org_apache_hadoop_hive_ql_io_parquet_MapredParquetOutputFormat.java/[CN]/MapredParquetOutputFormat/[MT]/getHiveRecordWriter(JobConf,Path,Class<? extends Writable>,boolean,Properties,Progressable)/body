{
  LOG.info("creating new record writer..." + this);
  final String columnNameProperty=tableProperties.getProperty(IOConstants.COLUMNS);
  final String columnTypeProperty=tableProperties.getProperty(IOConstants.COLUMNS_TYPES);
  List<String> columnNames;
  List<TypeInfo> columnTypes;
  if (columnNameProperty.length() == 0) {
    columnNames=new ArrayList<String>();
  }
 else {
    columnNames=Arrays.asList(columnNameProperty.split(","));
  }
  if (columnTypeProperty.length() == 0) {
    columnTypes=new ArrayList<TypeInfo>();
  }
 else {
    columnTypes=TypeInfoUtils.getTypeInfosFromTypeString(columnTypeProperty);
  }
  DataWritableWriteSupport.setSchema(HiveSchemaConverter.convert(columnNames,columnTypes),jobConf);
  return getParquerRecordWriterWrapper(realOutputFormat,jobConf,finalOutPath.toString(),progress,tableProperties);
}
