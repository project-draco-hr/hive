{
  Map<SparkTran,JavaPairRDD<HiveKey,BytesWritable>> resultRDDs=new HashMap<SparkTran,JavaPairRDD<HiveKey,BytesWritable>>();
  for (  SparkTran tran : rootTrans) {
    if (!(tran instanceof MapTran)) {
      throw new IllegalStateException("root transformations must be MapTran!");
    }
    JavaPairRDD<BytesWritable,BytesWritable> input=mapInputs.get(tran);
    if (input == null) {
      throw new IllegalStateException("input is missing for transformation!");
    }
    JavaPairRDD<HiveKey,BytesWritable> rdd=tran.transform(input);
    while (getChildren(tran).size() > 0) {
      SparkTran childTran=getChildren(tran).get(0);
      if (childTran instanceof UnionTran && this.getParents(childTran).size() > ((UnionTran)childTran).getOtherInputList().size() + 1) {
        ((UnionTran)childTran).addOtherInput(rdd);
        break;
      }
      rdd=childTran.transform(rdd);
      tran=childTran;
    }
    if (!resultRDDs.containsKey(tran) && getChildren(tran).isEmpty()) {
      resultRDDs.put(tran,rdd);
    }
  }
  for (  JavaPairRDD<HiveKey,BytesWritable> resultRDD : resultRDDs.values()) {
    resultRDD.foreach(HiveVoidFunction.getInstance());
  }
}
