{
  session=new JdbcSessionState(new HiveConf(SessionState.class));
  session.in=null;
  session.out=null;
  session.err=null;
  SessionState.start(session);
  if (!uri.startsWith(URI_PREFIX)) {
    throw new Exception("Invalid URL: " + uri);
  }
  uri=uri.substring(URI_PREFIX.length());
  if (uri.isEmpty()) {
    client=new HiveServer.HiveServerHandler();
  }
 else {
    String[] parts=uri.split("/");
    String[] hostport=parts[0].split(":");
    String databasename="default";
    int port=10000;
    String host=hostport[0];
    try {
      databasename=parts[1];
      port=Integer.parseInt(hostport[1]);
    }
 catch (    Exception e) {
    }
    transport=new TSocket(host,port);
    TProtocol protocol=new TBinaryProtocol(transport);
    client=new HiveClient(protocol);
    transport.open();
  }
  isClosed=false;
}
