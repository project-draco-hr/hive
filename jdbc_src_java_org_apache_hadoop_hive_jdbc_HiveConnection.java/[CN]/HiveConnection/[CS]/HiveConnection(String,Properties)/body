{
  session=new JdbcSessionState(new HiveConf(SessionState.class));
  session.in=null;
  session.out=null;
  session.err=null;
  SessionState.start(session);
  String originalUri=uri;
  if (!uri.startsWith(URI_PREFIX)) {
    throw new SQLException("Invalid URL: " + uri,"08S01");
  }
  uri=uri.substring(URI_PREFIX.length());
  if (uri.isEmpty()) {
    try {
      client=new HiveServer.HiveServerHandler();
    }
 catch (    MetaException e) {
      throw new SQLException("Error accessing Hive metastore: " + e.getMessage(),"08S01");
    }
  }
 else {
    String[] parts=uri.split("/");
    String[] hostport=parts[0].split(":");
    String databasename="default";
    int port=10000;
    String host=hostport[0];
    try {
      databasename=parts[1];
      port=Integer.parseInt(hostport[1]);
    }
 catch (    Exception e) {
    }
    transport=new TSocket(host,port);
    TProtocol protocol=new TBinaryProtocol(transport);
    client=new HiveClient(protocol);
    try {
      transport.open();
    }
 catch (    TTransportException e) {
      throw new SQLException("Could not establish connecton to " + originalUri + ": "+ e.getMessage(),"08S01");
    }
  }
  isClosed=false;
}
