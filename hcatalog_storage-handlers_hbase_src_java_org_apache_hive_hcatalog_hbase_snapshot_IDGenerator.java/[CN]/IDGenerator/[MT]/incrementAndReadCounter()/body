{
  long curId, usedId;
  try {
    Stat stat=new Stat();
    byte[] data=zookeeper.getData(this.zNodeDataLoc,false,stat);
    usedId=Long.parseLong((new String(data,Charset.forName("UTF-8"))));
    curId=usedId + 1;
    String lastUsedID=String.valueOf(curId);
    zookeeper.setData(this.zNodeDataLoc,lastUsedID.getBytes(Charset.forName("UTF-8")),-1);
  }
 catch (  KeeperException e) {
    LOG.warn("Exception while incrementing revision id.",e);
    throw new IOException("Exception while incrementing revision id. ",e);
  }
catch (  InterruptedException e) {
    LOG.warn("Exception while incrementing revision id.",e);
    throw new IOException("Exception while incrementing revision id. ",e);
  }
  return curId;
}
