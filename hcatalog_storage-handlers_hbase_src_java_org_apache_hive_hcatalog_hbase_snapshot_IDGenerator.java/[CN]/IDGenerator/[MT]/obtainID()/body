{
  WriteLock wLock=new WriteLock(zookeeper,zNodeLockBasePath,Ids.OPEN_ACL_UNSAFE);
  wLock.setLockListener(this);
  try {
    boolean lockGrabbed=wLock.lock();
    if (lockGrabbed == false) {
      throw new IOException("Unable to obtain lock to obtain id.");
    }
 else {
      id=incrementAndReadCounter();
    }
  }
 catch (  KeeperException e) {
    LOG.warn("Exception while obtaining lock for ID.",e);
    throw new IOException("Exception while obtaining lock for ID.",e);
  }
catch (  InterruptedException e) {
    LOG.warn("Exception while obtaining lock for ID.",e);
    throw new IOException("Exception while obtaining lock for ID.",e);
  }
 finally {
    wLock.unlock();
  }
  return id;
}
