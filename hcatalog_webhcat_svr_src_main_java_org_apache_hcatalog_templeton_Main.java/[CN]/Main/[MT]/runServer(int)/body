{
  if (UserGroupInformation.isSecurityEnabled()) {
    UserGroupInformation.loginUserFromKeytab(conf.kerberosPrincipal(),conf.kerberosKeytab());
  }
  Server server=new Server(port);
  ServletContextHandler root=new ServletContextHandler(server,"/");
  FilterHolder fHolder=makeAuthFilter();
  root.addFilter(fHolder,"/" + SERVLET_PATH + "/v1/ddl/*",FilterMapping.REQUEST);
  root.addFilter(fHolder,"/" + SERVLET_PATH + "/v1/pig/*",FilterMapping.REQUEST);
  root.addFilter(fHolder,"/" + SERVLET_PATH + "/v1/hive/*",FilterMapping.REQUEST);
  root.addFilter(fHolder,"/" + SERVLET_PATH + "/v1/queue/*",FilterMapping.REQUEST);
  root.addFilter(fHolder,"/" + SERVLET_PATH + "/v1/mapreduce/*",FilterMapping.REQUEST);
  root.addFilter(fHolder,"/" + SERVLET_PATH + "/v1/status/*",FilterMapping.REQUEST);
  root.addFilter(fHolder,"/" + SERVLET_PATH + "/v1/version/*",FilterMapping.REQUEST);
  ServletHolder h=new ServletHolder(new ServletContainer(makeJerseyConfig()));
  root.addServlet(h,"/" + SERVLET_PATH + "/*");
  addRedirects(server);
  server.start();
  return server;
}
