{
  long colProjSize=inputSplit.getLength();
  if (inputSplit instanceof ColumnarSplit) {
    colProjSize=((ColumnarSplit)inputSplit).getColumnarProjectionSize();
    if (isDebugEnabled) {
      LOG.debug("Estimated column projection size: " + colProjSize);
    }
  }
 else   if (inputSplit instanceof HiveInputFormat.HiveInputSplit) {
    InputSplit innerSplit=((HiveInputFormat.HiveInputSplit)inputSplit).getInputSplit();
    if (innerSplit instanceof ColumnarSplit) {
      colProjSize=((ColumnarSplit)innerSplit).getColumnarProjectionSize();
      if (isDebugEnabled) {
        LOG.debug("Estimated column projection size: " + colProjSize);
      }
    }
  }
  if (colProjSize <= 0) {
    return Integer.MAX_VALUE;
  }
  return colProjSize;
}
