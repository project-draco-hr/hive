{
  if (inputSizeEstimated) {
    return;
  }
  totalInputFileSize=inputSummary.getLength();
  totalInputNumFiles=inputSummary.getFileCount();
  if (work.getNameToSplitSample() == null || work.getNameToSplitSample().isEmpty()) {
    inputSizeEstimated=true;
    return;
  }
  double highestSamplePercentage=0;
  boolean allSample=false;
  for (  String alias : work.getAliasToWork().keySet()) {
    if (work.getNameToSplitSample().containsKey(alias)) {
      allSample=true;
      double rate=work.getNameToSplitSample().get(alias).getPercent();
      if (rate > highestSamplePercentage) {
        highestSamplePercentage=rate;
      }
    }
 else {
      allSample=false;
      break;
    }
  }
  if (allSample) {
    totalInputFileSize=Math.min((long)(totalInputFileSize * highestSamplePercentage / 100D),totalInputFileSize);
    totalInputNumFiles=Math.min((long)(totalInputNumFiles * highestSamplePercentage / 100D),totalInputNumFiles);
  }
  inputSizeEstimated=true;
}
