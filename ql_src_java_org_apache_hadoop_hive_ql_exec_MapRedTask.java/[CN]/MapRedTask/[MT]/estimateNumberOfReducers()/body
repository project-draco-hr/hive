{
  long bytesPerReducer=conf.getLongVar(HiveConf.ConfVars.BYTESPERREDUCER);
  int maxReducers=conf.getIntVar(HiveConf.ConfVars.MAXREDUCERS);
  if (inputSummary == null) {
    inputSummary=Utilities.getInputSummary(driverContext.getCtx(),work,null);
  }
  long totalInputFileSize=inputSummary.getLength();
  LOG.info("BytesPerReducer=" + bytesPerReducer + " maxReducers="+ maxReducers+ " totalInputFileSize="+ totalInputFileSize);
  int reducers=(int)((totalInputFileSize + bytesPerReducer - 1) / bytesPerReducer);
  reducers=Math.max(1,reducers);
  reducers=Math.min(maxReducers,reducers);
  return reducers;
}
