{
  Path p=hadoopFsPath(dirName,conf,user);
  FileSystem fs=p.getFileSystem(conf);
  if (!fs.exists(p)) {
    return Collections.emptyList();
  }
  List<FileStatus> children=ShimLoader.getHadoopShims().listLocatedStatus(fs,p,null);
  if (!isset(children)) {
    return Collections.emptyList();
  }
  List<Path> files=new ArrayList<Path>();
  for (  FileStatus stat : children) {
    files.add(stat.getPath());
  }
  return files;
}
