{
  String stripeSize=tableProperties.getProperty(OrcFile.STRIPE_SIZE,OrcFile.DEFAULT_STRIPE_SIZE);
  String compression=tableProperties.getProperty(OrcFile.COMPRESSION,OrcFile.DEFAULT_COMPRESSION);
  String compressionSize=tableProperties.getProperty(OrcFile.COMPRESSION_BLOCK_SIZE,OrcFile.DEFAULT_COMPRESSION_BLOCK_SIZE);
  String rowIndexStride=tableProperties.getProperty(OrcFile.ROW_INDEX_STRIDE,OrcFile.DEFAULT_ROW_INDEX_STRIDE);
  if ("false".equals(tableProperties.getProperty(OrcFile.ENABLE_INDEXES))) {
    rowIndexStride="0";
  }
  return new OrcRecordWriter(path.getFileSystem(conf),path,conf,stripeSize,compression,compressionSize,rowIndexStride);
}
