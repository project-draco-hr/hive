{
  OrcFile.WriterOptions options=OrcFile.writerOptions(conf);
  if (tableProperties.containsKey(OrcFile.STRIPE_SIZE)) {
    options.stripeSize(Long.parseLong(tableProperties.getProperty(OrcFile.STRIPE_SIZE)));
  }
  if (tableProperties.containsKey(OrcFile.COMPRESSION)) {
    options.compress(CompressionKind.valueOf(tableProperties.getProperty(OrcFile.COMPRESSION)));
  }
  if (tableProperties.containsKey(OrcFile.COMPRESSION_BLOCK_SIZE)) {
    options.bufferSize(Integer.parseInt(tableProperties.getProperty(OrcFile.COMPRESSION_BLOCK_SIZE)));
  }
  if (tableProperties.containsKey(OrcFile.ROW_INDEX_STRIDE)) {
    options.rowIndexStride(Integer.parseInt(tableProperties.getProperty(OrcFile.ROW_INDEX_STRIDE)));
  }
  if (tableProperties.containsKey(OrcFile.ENABLE_INDEXES)) {
    if ("false".equals(tableProperties.getProperty(OrcFile.ENABLE_INDEXES))) {
      options.rowIndexStride(0);
    }
  }
  if (tableProperties.containsKey(OrcFile.BLOCK_PADDING)) {
    options.blockPadding(Boolean.parseBoolean(tableProperties.getProperty(OrcFile.BLOCK_PADDING)));
  }
  return new OrcRecordWriter(path,options);
}
