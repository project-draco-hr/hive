{
  OrcFile.WriterOptions options=OrcFile.writerOptions(conf);
  String propVal;
  if ((propVal=getSettingFromPropsFallingBackToConf(OrcFile.STRIPE_SIZE,props,conf)) != null) {
    options.stripeSize(Long.parseLong(propVal));
  }
  if ((propVal=getSettingFromPropsFallingBackToConf(OrcFile.COMPRESSION,props,conf)) != null) {
    options.compress(CompressionKind.valueOf(propVal));
  }
  if ((propVal=getSettingFromPropsFallingBackToConf(OrcFile.COMPRESSION_BLOCK_SIZE,props,conf)) != null) {
    options.bufferSize(Integer.parseInt(propVal));
  }
  if ((propVal=getSettingFromPropsFallingBackToConf(OrcFile.ROW_INDEX_STRIDE,props,conf)) != null) {
    options.rowIndexStride(Integer.parseInt(propVal));
  }
  if ((propVal=getSettingFromPropsFallingBackToConf(OrcFile.ENABLE_INDEXES,props,conf)) != null) {
    if ("false".equalsIgnoreCase(propVal)) {
      options.rowIndexStride(0);
    }
  }
  if ((propVal=getSettingFromPropsFallingBackToConf(OrcFile.BLOCK_PADDING,props,conf)) != null) {
    options.blockPadding(Boolean.parseBoolean(propVal));
  }
  return options;
}
