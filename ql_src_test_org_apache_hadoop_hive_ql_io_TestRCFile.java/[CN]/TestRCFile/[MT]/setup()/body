{
  conf=new Configuration();
  ColumnProjectionUtils.setReadAllColumns(conf);
  fs=FileSystem.getLocal(conf);
  dir=new Path(System.getProperty("test.data.dir",".") + "/mapred");
  file=new Path(dir,"test_rcfile");
  cleanup();
  serDe=new ColumnarSerDe();
  tbl=createProperties();
  serDe.initialize(conf,tbl);
  try {
    bytesArray=new byte[][]{"123".getBytes("UTF-8"),"456".getBytes("UTF-8"),"789".getBytes("UTF-8"),"1000".getBytes("UTF-8"),"5.3".getBytes("UTF-8"),"hive and hadoop".getBytes("UTF-8"),new byte[0],"NULL".getBytes("UTF-8")};
    s=new BytesRefArrayWritable(bytesArray.length);
    s.set(0,new BytesRefWritable("123".getBytes("UTF-8")));
    s.set(1,new BytesRefWritable("456".getBytes("UTF-8")));
    s.set(2,new BytesRefWritable("789".getBytes("UTF-8")));
    s.set(3,new BytesRefWritable("1000".getBytes("UTF-8")));
    s.set(4,new BytesRefWritable("5.3".getBytes("UTF-8")));
    s.set(5,new BytesRefWritable("hive and hadoop".getBytes("UTF-8")));
    s.set(6,new BytesRefWritable("NULL".getBytes("UTF-8")));
    s.set(7,new BytesRefWritable("NULL".getBytes("UTF-8")));
    patialS.set(0,new BytesRefWritable("NULL".getBytes("UTF-8")));
    patialS.set(1,new BytesRefWritable("NULL".getBytes("UTF-8")));
    patialS.set(2,new BytesRefWritable("789".getBytes("UTF-8")));
    patialS.set(3,new BytesRefWritable("1000".getBytes("UTF-8")));
    patialS.set(4,new BytesRefWritable("NULL".getBytes("UTF-8")));
    patialS.set(5,new BytesRefWritable("NULL".getBytes("UTF-8")));
    patialS.set(6,new BytesRefWritable("NULL".getBytes("UTF-8")));
    patialS.set(7,new BytesRefWritable("NULL".getBytes("UTF-8")));
  }
 catch (  UnsupportedEncodingException e) {
    throw new RuntimeException(e);
  }
}
