{
  if (parentSession.isOperationLogEnabled()) {
    File operationLogFile=new File(parentSession.getOperationLogSessionDir(),opHandle.getHandleIdentifier().toString());
    isOperationLogEnabled=true;
    try {
      if (operationLogFile.exists()) {
        LOG.warn("The operation log file should not exist, but it is already there: " + operationLogFile.getAbsolutePath());
        operationLogFile.delete();
      }
      if (!operationLogFile.getParentFile().exists()) {
        LOG.warn("Operations log directory for this session does not exist, it could have been deleted " + "externally. Recreating the directory for future queries in this session but the older operation " + "logs for this session are no longer available");
        if (!operationLogFile.getParentFile().mkdir()) {
          LOG.warn("Log directory for this session could not be created, disabling " + "operation logs: " + operationLogFile.getParentFile().getAbsolutePath());
          isOperationLogEnabled=false;
          return;
        }
      }
      if (!operationLogFile.createNewFile()) {
        if (!operationLogFile.canRead() || !operationLogFile.canWrite()) {
          LOG.warn("The already existed operation log file cannot be recreated, " + "and it cannot be read or written: " + operationLogFile.getAbsolutePath());
          isOperationLogEnabled=false;
          return;
        }
      }
    }
 catch (    Exception e) {
      LOG.warn("Unable to create operation log file: " + operationLogFile.getAbsolutePath(),e);
      isOperationLogEnabled=false;
      return;
    }
    try {
      operationLog=new OperationLog(opHandle.toString(),operationLogFile,parentSession.getHiveConf());
    }
 catch (    FileNotFoundException e) {
      LOG.warn("Unable to instantiate OperationLog object for operation: " + opHandle,e);
      isOperationLogEnabled=false;
      return;
    }
    OperationLog.setCurrentOperationLog(operationLog);
  }
}
