{
  when(mockPartitionHelper.getPathForPartition(PARTITION_A)).thenReturn(PATH_A);
  when(mockPartitionHelper.getPathForPartition(PARTITION_B)).thenReturn(PATH_B);
  coordinator.insert(PARTITION_A,RECORD);
  coordinator.insert(PARTITION_B,RECORD);
  verify(mockPartitionHelper).createPartitionIfNotExists(PARTITION_A);
  verify(mockPartitionHelper).createPartitionIfNotExists(PARTITION_B);
  verify(mockMutatorFactory).newMutator(any(OrcOutputFormat.class),eq(TRANSACTION_ID),eq(PATH_A),eq(BUCKET_ID));
  verify(mockMutatorFactory).newMutator(any(OrcOutputFormat.class),eq(TRANSACTION_ID),eq(PATH_B),eq(BUCKET_ID));
  verify(mockMutator,times(2)).insert(RECORD);
}
