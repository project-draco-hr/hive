{
  when(mockRecordInspector.extractRecordIdentifier(RECORD)).thenReturn(ROW__ID_B0_R0,ROW__ID_B1_R0);
  when(mockBucketIdResolver.computeBucketId(RECORD)).thenReturn(0,1);
  coordinator.update(UNPARTITIONED,RECORD);
  coordinator.delete(UNPARTITIONED,RECORD);
  verify(mockPartitionHelper).createPartitionIfNotExists(UNPARTITIONED);
  verify(mockMutatorFactory).newMutator(any(OrcOutputFormat.class),eq(TRANSACTION_ID),eq(PATH_A),eq(BUCKET_ID));
  verify(mockMutatorFactory).newMutator(any(OrcOutputFormat.class),eq(TRANSACTION_ID),eq(PATH_A),eq(BUCKET_ID + 1));
  verify(mockMutator).update(RECORD);
  verify(mockMutator).delete(RECORD);
}
