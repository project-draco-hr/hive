{
  ParseContext parseContext=context.parseContext;
  boolean isInsertTable=GenMapRedUtils.isInsertInto(parseContext,fileSink);
  HiveConf hconf=parseContext.getConf();
  boolean chDir=GenMapRedUtils.isMergeRequired(context.moveTask,hconf,fileSink,context.currentTask,isInsertTable);
  Path finalName=GenMapRedUtils.createMoveTask(context.currentTask,chDir,fileSink,parseContext,context.moveTask,hconf,context.dependencyTask);
  if (chDir) {
    logger.info("using CombineHiveInputformat for the merge job");
    GenMapRedUtils.createMRWorkForMergingFiles(fileSink,finalName,context.dependencyTask,context.moveTask,hconf,context.currentTask);
  }
  FetchTask fetchTask=parseContext.getFetchTask();
  if (fetchTask != null && context.currentTask.getNumChild() == 0) {
    if (fetchTask.isFetchFrom(fileSink.getConf())) {
      context.currentTask.setFetchSource(true);
    }
  }
}
