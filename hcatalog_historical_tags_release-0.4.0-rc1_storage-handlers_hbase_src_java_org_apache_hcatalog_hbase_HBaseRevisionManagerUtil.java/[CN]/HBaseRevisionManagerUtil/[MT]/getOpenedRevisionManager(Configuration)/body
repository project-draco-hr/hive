{
  Properties properties=new Properties();
  String zkHostList=jobConf.get(HConstants.ZOOKEEPER_QUORUM);
  int port=jobConf.getInt("hbase.zookeeper.property.clientPort",HConstants.DEFAULT_ZOOKEPER_CLIENT_PORT);
  if (zkHostList != null) {
    String[] splits=zkHostList.split(",");
    StringBuffer sb=new StringBuffer();
    for (    String split : splits) {
      sb.append(split);
      sb.append(':');
      sb.append(port);
      sb.append(',');
    }
    sb.deleteCharAt(sb.length() - 1);
    properties.put(ZKBasedRevisionManager.HOSTLIST,sb.toString());
  }
  String dataDir=jobConf.get(ZKBasedRevisionManager.DATADIR);
  if (dataDir != null) {
    properties.put(ZKBasedRevisionManager.DATADIR,dataDir);
  }
  String rmClassName=jobConf.get(RevisionManager.REVISION_MGR_IMPL_CLASS,ZKBasedRevisionManager.class.getName());
  properties.put(RevisionManager.REVISION_MGR_IMPL_CLASS,rmClassName);
  RevisionManager revisionManger=RevisionManagerFactory.getRevisionManager(properties);
  revisionManger.open();
  return revisionManger;
}
