{
  Transaction txn;
  RevisionManager rm=null;
  try {
    rm=HBaseRevisionManagerUtil.getOpenedRevisionManager(jobConf);
    String hBaseColumns=tableInfo.getStorerInfo().getProperties().getProperty(HBaseConstants.PROPERTY_COLUMN_MAPPING_KEY);
    String[] splits=hBaseColumns.split("[,:]");
    Set<String> families=new HashSet<String>();
    for (int i=0; i < splits.length; i+=2) {
      if (!splits[i].isEmpty())       families.add(splits[i]);
    }
    txn=rm.beginWriteTransaction(qualifiedTableName,new ArrayList<String>(families));
  }
  finally {
    HBaseRevisionManagerUtil.closeRevisionManagerQuietly(rm);
  }
  return txn;
}
