{
  ObjectInspector inspector;
synchronized (TestOrcSerDeStats.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(ListStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(10000).bufferSize(10000));
  for (int row=0; row < 5000; row++) {
    List<String> test=new ArrayList<String>();
    for (int i=0; i < 1000; i++) {
      test.add("hi");
    }
    writer.addRow(new ListStruct(test));
  }
  writer.close();
  assertEquals(5000,writer.getNumberOfRows());
  assertEquals(430000000,writer.getRawDataSize());
  Reader reader=OrcFile.createReader(fs,testFilePath);
  assertEquals(5000,reader.getNumberOfRows());
  assertEquals(430000000,reader.getRawDataSize());
  assertEquals(430000000,reader.getRawDataSizeOfColumns(Lists.newArrayList("list1")));
}
