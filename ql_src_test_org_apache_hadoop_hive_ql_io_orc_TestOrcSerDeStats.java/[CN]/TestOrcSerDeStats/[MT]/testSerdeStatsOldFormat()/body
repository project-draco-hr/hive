{
  Path oldFilePath=new Path(HiveTestUtils.getFileFromClasspath("orc-file-11-format.orc"));
  Reader reader=OrcFile.createReader(fs,oldFilePath);
  int stripeCount=0;
  int rowCount=0;
  long currentOffset=-1;
  for (  StripeInformation stripe : reader.getStripes()) {
    stripeCount+=1;
    rowCount+=stripe.getNumberOfRows();
    if (currentOffset < 0) {
      currentOffset=stripe.getOffset() + stripe.getIndexLength() + stripe.getDataLength()+ stripe.getFooterLength();
    }
 else {
      assertEquals(currentOffset,stripe.getOffset());
      currentOffset+=stripe.getIndexLength() + stripe.getDataLength() + stripe.getFooterLength();
    }
  }
  assertEquals(reader.getNumberOfRows(),rowCount);
  assertEquals(6300000,reader.getRawDataSize());
  assertEquals(2,stripeCount);
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(7500,stats[1].getNumberOfValues());
  assertEquals(3750,((BooleanColumnStatistics)stats[1]).getFalseCount());
  assertEquals(3750,((BooleanColumnStatistics)stats[1]).getTrueCount());
  assertEquals("count: 7500 true: 3750",stats[1].toString());
  assertEquals(2048,((IntegerColumnStatistics)stats[3]).getMaximum());
  assertEquals(1024,((IntegerColumnStatistics)stats[3]).getMinimum());
  assertEquals(true,((IntegerColumnStatistics)stats[3]).isSumDefined());
  assertEquals(11520000,((IntegerColumnStatistics)stats[3]).getSum());
  assertEquals("count: 7500 min: 1024 max: 2048 sum: 11520000",stats[3].toString());
  assertEquals(Long.MAX_VALUE,((IntegerColumnStatistics)stats[5]).getMaximum());
  assertEquals(Long.MAX_VALUE,((IntegerColumnStatistics)stats[5]).getMinimum());
  assertEquals(false,((IntegerColumnStatistics)stats[5]).isSumDefined());
  assertEquals("count: 7500 min: 9223372036854775807 max: 9223372036854775807",stats[5].toString());
  assertEquals(-15.0,((DoubleColumnStatistics)stats[7]).getMinimum());
  assertEquals(-5.0,((DoubleColumnStatistics)stats[7]).getMaximum());
  assertEquals(-75000.0,((DoubleColumnStatistics)stats[7]).getSum(),0.00001);
  assertEquals("count: 7500 min: -15.0 max: -5.0 sum: -75000.0",stats[7].toString());
  assertEquals("bye",((StringColumnStatistics)stats[9]).getMinimum());
  assertEquals("hi",((StringColumnStatistics)stats[9]).getMaximum());
  assertEquals(0,((StringColumnStatistics)stats[9]).getSum());
  assertEquals("count: 7500 min: bye max: hi sum: 0",stats[9].toString());
  assertEquals("count: 7500",stats[8].toString());
  assertEquals(5,((BinaryColumnStatistics)stats[8]).getSum());
}
