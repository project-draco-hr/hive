{
  PrimitiveCategory primitiveCategory=typeSpec.getPrimitiveCategory();
  BaseTypeParams primitiveTypeParams=typeSpec.getTypeParams();
  if (primitiveTypeParams == null) {
    return getPrimitiveWritableObjectInspector(primitiveCategory);
  }
 else {
    PrimitiveObjectInspector oi=cachedParameterizedPrimitiveWritableObjectInspectorCache.getObjectInspector(typeSpec);
    if (oi == null) {
switch (primitiveCategory) {
case VARCHAR:
        PrimitiveTypeEntry typeEntry=PrimitiveObjectInspectorUtils.getTypeEntryFromTypeSpecs(primitiveCategory,primitiveTypeParams);
      oi=new WritableHiveVarcharObjectInspector(typeEntry);
    oi.setTypeParams(primitiveTypeParams);
  cachedParameterizedPrimitiveWritableObjectInspectorCache.setObjectInspector(oi);
break;
default :
throw new RuntimeException("Primitve type " + primitiveCategory + " should not take parameters");
}
}
return (AbstractPrimitiveWritableObjectInspector)oi;
}
}
