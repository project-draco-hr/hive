{
  AbstractPrimitiveWritableObjectInspector result=cachedPrimitiveWritableInspectorCache.get(typeInfo);
  if (result != null) {
    return result;
  }
switch (typeInfo.getPrimitiveCategory()) {
case CHAR:
    result=new WritableHiveCharObjectInspector((CharTypeInfo)typeInfo);
  break;
case VARCHAR:
result=new WritableHiveVarcharObjectInspector((VarcharTypeInfo)typeInfo);
break;
case DECIMAL:
result=new WritableHiveDecimalObjectInspector((DecimalTypeInfo)typeInfo);
break;
default :
throw new RuntimeException("Failed to create object inspector for " + typeInfo);
}
AbstractPrimitiveWritableObjectInspector prev=cachedPrimitiveWritableInspectorCache.putIfAbsent(typeInfo,result);
if (prev != null) {
result=prev;
}
return result;
}
