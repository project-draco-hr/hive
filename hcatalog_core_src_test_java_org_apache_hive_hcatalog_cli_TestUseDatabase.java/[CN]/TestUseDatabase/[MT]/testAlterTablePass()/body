{
  hcatDriver.run("create database " + dbName);
  hcatDriver.run("use " + dbName);
  hcatDriver.run("create table " + tblName + " (a int) partitioned by (b string) stored as RCFILE");
  CommandProcessorResponse response;
  String tmpDir=System.getProperty("test.tmp.dir");
  File dir=new File(tmpDir + "/hive-junit-" + System.nanoTime());
  response=hcatDriver.run("alter table " + tblName + " add partition (b='2') location '"+ dir.getAbsolutePath()+ "'");
  assertEquals(0,response.getResponseCode());
  assertNull(response.getErrorMessage());
  response=hcatDriver.run("alter table " + tblName + " set fileformat INPUTFORMAT 'org.apache.hadoop.hive.ql.io.RCFileInputFormat' OUTPUTFORMAT "+ "'org.apache.hadoop.hive.ql.io.RCFileOutputFormat' inputdriver 'mydriver' outputdriver 'yourdriver'");
  assertEquals(0,response.getResponseCode());
  assertNull(response.getErrorMessage());
  hcatDriver.run("drop table " + tblName);
  hcatDriver.run("drop database " + dbName);
}
