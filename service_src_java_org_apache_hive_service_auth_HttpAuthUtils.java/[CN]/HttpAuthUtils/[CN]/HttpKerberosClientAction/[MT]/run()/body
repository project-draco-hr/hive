{
  Oid mechOid=new Oid("1.2.840.113554.1.2.2");
  Oid krb5PrincipalOid=new Oid("1.2.840.113554.1.2.2.1");
  GSSManager manager=GSSManager.getInstance();
  GSSName clientName=manager.createName(clientUserName,GSSName.NT_USER_NAME);
  GSSName serverName=manager.createName(serverPrincipal,krb5PrincipalOid);
  GSSCredential clientCreds=manager.createCredential(clientName,GSSCredential.DEFAULT_LIFETIME,mechOid,GSSCredential.INITIATE_ONLY);
  GSSContext gssContext=manager.createContext(serverName,mechOid,clientCreds,GSSContext.DEFAULT_LIFETIME);
  gssContext.requestMutualAuth(false);
  byte[] inToken=new byte[0];
  byte[] outToken=gssContext.initSecContext(inToken,0,inToken.length);
  gssContext.dispose();
  return new String(base64codec.encode(outToken));
}
