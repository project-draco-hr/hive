{
  StringBuilder whereClause=new StringBuilder(" where ");
  boolean predPresent=false;
  StringBuilder groupByClause=new StringBuilder(" group by ");
  boolean aggPresent=false;
  for (  String partKey : partSpec.keySet()) {
    String value;
    if ((value=partSpec.get(partKey)) != null) {
      if (!predPresent) {
        predPresent=true;
      }
 else {
        whereClause.append(" and ");
      }
      whereClause.append(partKey);
      whereClause.append(" = ");
      if (getColTypeOf(partKey).equalsIgnoreCase("string")) {
        whereClause.append("'");
      }
      whereClause.append(value);
      if (getColTypeOf(partKey).equalsIgnoreCase("string")) {
        whereClause.append("'");
      }
    }
  }
  for (  FieldSchema fs : tbl.getPartitionKeys()) {
    if (!aggPresent) {
      aggPresent=true;
    }
 else {
      groupByClause.append(",");
    }
    groupByClause.append(fs.getName());
  }
  return predPresent ? whereClause.append(groupByClause) : groupByClause;
}
