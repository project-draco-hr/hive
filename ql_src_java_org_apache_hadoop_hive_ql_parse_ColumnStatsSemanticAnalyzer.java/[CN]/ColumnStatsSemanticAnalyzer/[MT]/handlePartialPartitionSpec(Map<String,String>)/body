{
  int partValsSpecified=0;
  for (  String partKey : partSpec.keySet()) {
    partValsSpecified+=partSpec.get(partKey) == null ? 0 : 1;
  }
  try {
    if ((partValsSpecified == tbl.getPartitionKeys().size()) && (db.getPartition(tbl,partSpec,false,null,false) == null)) {
      throw new SemanticException(ErrorMsg.COLUMNSTATSCOLLECTOR_INVALID_PARTITION.getMsg() + " : " + partSpec);
    }
  }
 catch (  HiveException he) {
    throw new SemanticException(ErrorMsg.COLUMNSTATSCOLLECTOR_INVALID_PARTITION.getMsg() + " : " + partSpec);
  }
  List<String> partKeys=Utilities.getColumnNamesFromFieldSchema(tbl.getPartitionKeys());
  for (  String partKey : partKeys) {
    if (!partSpec.containsKey(partKey)) {
      partSpec.put(partKey,null);
    }
  }
  for (  String partKey : partSpec.keySet()) {
    if (!partKeys.contains(partKey)) {
      throw new SemanticException(ErrorMsg.COLUMNSTATSCOLLECTOR_INVALID_PART_KEY.getMsg() + " : " + partKey);
    }
  }
}
