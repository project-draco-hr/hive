{
  super(conf);
  super.processNoScanCommand(tree);
  super.processPartialScanCommand(tree);
  if (shouldRewrite(tree)) {
    tbl=getTable(tree);
    colNames=getColumnName(tree);
    originalTree=tree;
    boolean isPartitionStats=isPartitionLevelStats(tree);
    Map<String,String> partSpec=null;
    checkForPartitionColumns(colNames,Utilities.getColumnNamesFromFieldSchema(tbl.getPartitionKeys()));
    validateSpecifiedColumnNames(colNames);
    if (isPartitionStats) {
      isTableLevel=false;
      partSpec=getPartKeyValuePairsFromAST(tree);
      handlePartialPartitionSpec(partSpec);
    }
 else {
      isTableLevel=true;
    }
    colType=getColumnTypes(colNames);
    int numBitVectors=getNumBitVectorsForNDVEstimation(conf);
    rewrittenQuery=genRewrittenQuery(colNames,numBitVectors,partSpec,isPartitionStats);
    rewrittenTree=genRewrittenTree(rewrittenQuery);
  }
 else {
    originalTree=rewrittenTree=tree;
    rewrittenQuery=null;
    isRewritten=false;
  }
}
