{
  super(conf,false);
  super.processNoScanCommand(tree);
  super.processPartialScanCommand(tree);
  if (shouldRewrite(tree)) {
    tbl=getTable(tree);
    colNames=getColumnName(tree);
    originalTree=tree;
    boolean isPartitionStats=isPartitionLevelStats(tree);
    PartitionList partList=null;
    checkForPartitionColumns(colNames,Utilities.getColumnNamesFromFieldSchema(tbl.getPartitionKeys()));
    validateSpecifiedColumnNames(colNames);
    if (isPartitionStats) {
      isTableLevel=false;
      partList=getPartKeyValuePairsFromAST(tree);
      validatePartitionClause(partList);
      partName=constructPartitionName(partList);
      colType=getPartitionColumnType(partName,colNames);
    }
 else {
      isTableLevel=true;
      colType=getTableColumnType(colNames);
    }
    int numBitVectors=getNumBitVectorsForNDVEstimation(conf);
    rewrittenQuery=genRewrittenQuery(colNames,numBitVectors,partList,isPartitionStats);
    rewrittenTree=genRewrittenTree(rewrittenQuery);
  }
 else {
    originalTree=rewrittenTree=tree;
    rewrittenQuery=null;
    isRewritten=false;
  }
}
