{
  super(conf);
  super.processNoScanCommand(tree);
  super.processPartialScanCommand(tree);
  if (shouldRewrite(tree)) {
    tableName=new String(getTableName(tree));
    colNames=getColumnName(tree);
    int numCols=getNumColumns(tree);
    originalTree=tree;
    boolean isPartitionStats=isPartitionLevelStats(tree);
    PartitionList partList=null;
    checkForPartitionColumns(colNames,getPartitionKeys(tableName));
    if (isPartitionStats) {
      isTableLevel=false;
      partList=getPartKeyValuePairsFromAST(tree);
      validatePartitionClause(tableName,partList);
      partName=constructPartitionName(tableName,partList);
      colType=getPartitionColumnType(tableName,partName,colNames,numCols);
    }
 else {
      isTableLevel=true;
      colType=getTableColumnType(tableName,colNames,numCols);
    }
    int numBitVectors=getNumBitVectorsForNDVEstimation(conf);
    rewrittenQuery=genRewrittenQuery(colNames,numBitVectors,partList,isPartitionStats);
    rewrittenTree=genRewrittenTree(rewrittenQuery);
  }
 else {
    originalTree=rewrittenTree=tree;
    rewrittenQuery=null;
    isRewritten=false;
  }
}
