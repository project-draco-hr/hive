{
  List<String> incompatibleCols=new ArrayList<String>();
  int maxCols=Math.min(oldCols.size(),newCols.size());
  for (int i=0; i < maxCols; i++) {
    if (!areColTypesCompatible(oldCols.get(i).getType(),newCols.get(i).getType())) {
      incompatibleCols.add(newCols.get(i).getName());
    }
  }
  if (!incompatibleCols.isEmpty()) {
    throw new InvalidOperationException("The following columns have types incompatible with the existing " + "columns in their respective positions :\n" + StringUtils.join(",",incompatibleCols));
  }
}
