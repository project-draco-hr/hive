{
  if (!HiveConf.getBoolVar(hiveConf,HiveConf.ConfVars.HIVESTATSAUTOGATHER)) {
    return false;
  }
  if (MetaStoreUtils.isView(tbl)) {
    return false;
  }
  if (oldPart == null && newPart == null) {
    return true;
  }
  if ((newPart == null) || (newPart.getParameters() == null) || !containsAllFastStats(newPart.getParameters())) {
    return true;
  }
  if ((oldPart != null) && (oldPart.getParameters() != null)) {
    for (    String stat : StatsSetupConst.getStatsFastCollection()) {
      if (oldPart.getParameters().containsKey(stat)) {
        Long oldStat=Long.parseLong(oldPart.getParameters().get(stat));
        Long newStat=Long.parseLong(newPart.getParameters().get(stat));
        if (oldStat != newStat) {
          return true;
        }
      }
    }
  }
  return false;
}
