{
  int retries=0;
  Exception exc=null;
  while (true) {
    try {
      Socket socket=new Socket();
      socket.connect(new InetSocketAddress(port),5000);
      socket.close();
      return;
    }
 catch (    Exception e) {
      if (retries++ > 60) {
        exc=e;
        break;
      }
      Thread.sleep(1000);
    }
  }
  LOG.error("Unable to connect to metastore server: " + exc.getMessage());
  LOG.info("Printing all thread stack traces for debugging before throwing exception.");
  LOG.info(getAllThreadStacksAsString());
  throw exc;
}
