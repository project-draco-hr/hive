{
  Map<String,String> params=tbl.getParameters();
  boolean updated=false;
  if (forceRecompute || params == null || !containsAllFastStats(params)) {
    if (params == null) {
      params=new HashMap<String,String>();
    }
    if (!newDir) {
      LOG.info("Updating table stats fast for " + tbl.getTableName());
      FileStatus[] fileStatus=wh.getFileStatusesForUnpartitionedTable(db,tbl);
      params.put(StatsSetupConst.NUM_FILES,Integer.toString(fileStatus.length));
      long tableSize=0L;
      for (      FileStatus status : fileStatus) {
        tableSize+=status.getLen();
      }
      params.put(StatsSetupConst.TOTAL_SIZE,Long.toString(tableSize));
      LOG.info("Updated size of table " + tbl.getTableName() + " to "+ Long.toString(tableSize));
      if (params.containsKey(StatsSetupConst.ROW_COUNT) || params.containsKey(StatsSetupConst.RAW_DATA_SIZE)) {
      }
    }
    tbl.setParameters(params);
    updated=true;
  }
  return updated;
}
