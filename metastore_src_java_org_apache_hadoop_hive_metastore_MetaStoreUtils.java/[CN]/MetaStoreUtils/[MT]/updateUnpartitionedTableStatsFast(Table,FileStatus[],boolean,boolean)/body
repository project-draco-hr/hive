{
  Map<String,String> params=tbl.getParameters();
  if ((params != null) && params.containsKey(StatsSetupConst.DO_NOT_UPDATE_STATS)) {
    boolean doNotUpdateStats=Boolean.valueOf(params.get(StatsSetupConst.DO_NOT_UPDATE_STATS));
    params.remove(StatsSetupConst.DO_NOT_UPDATE_STATS);
    tbl.setParameters(params);
    if (doNotUpdateStats) {
      return false;
    }
  }
  boolean updated=false;
  if (forceRecompute || params == null || !containsAllFastStats(params)) {
    if (params == null) {
      params=new HashMap<String,String>();
    }
    if (!newDir) {
      LOG.info("Updating table stats fast for " + tbl.getTableName());
      populateQuickStats(fileStatus,params);
      LOG.info("Updated size of table " + tbl.getTableName() + " to "+ params.get(StatsSetupConst.TOTAL_SIZE));
      if (!params.containsKey(StatsSetupConst.STATS_GENERATED_VIA_STATS_TASK)) {
        for (        String stat : StatsSetupConst.statsRequireCompute) {
          params.put(stat,"-1");
        }
        params.put(StatsSetupConst.COLUMN_STATS_ACCURATE,StatsSetupConst.FALSE);
      }
 else {
        params.remove(StatsSetupConst.STATS_GENERATED_VIA_STATS_TASK);
        params.put(StatsSetupConst.COLUMN_STATS_ACCURATE,StatsSetupConst.TRUE);
      }
    }
    tbl.setParameters(params);
    updated=true;
  }
  return updated;
}
