{
  Map<String,String> params=part.getParameters();
  boolean updated=false;
  if (forceRecompute || params == null || !containsAllFastStats(params)) {
    if (params == null) {
      params=new HashMap<String,String>();
    }
    if (!madeDir) {
      LOG.warn("Updating partition stats fast for: " + part.getTableName());
      FileStatus[] fileStatus=wh.getFileStatusesForLocation(part.getLocation());
      populateQuickStats(fileStatus,params);
      LOG.warn("Updated size to " + params.get(StatsSetupConst.TOTAL_SIZE));
      if (environmentContext != null && environmentContext.isSetProperties() && StatsSetupConst.TASK.equals(environmentContext.getProperties().get(StatsSetupConst.STATS_GENERATED))) {
        StatsSetupConst.setBasicStatsState(params,StatsSetupConst.TRUE);
      }
 else {
        StatsSetupConst.setBasicStatsState(params,StatsSetupConst.FALSE);
      }
    }
    part.setParameters(params);
    updated=true;
  }
  return updated;
}
