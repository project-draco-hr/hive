{
  ServerSocket socket1=null;
  ServerSocket socket2=null;
  try {
    socket1=new ServerSocket(0);
    socket2=new ServerSocket(0);
    if (socket1.getLocalPort() != portToExclude) {
      return socket1.getLocalPort();
    }
    return socket2.getLocalPort();
  }
  finally {
    if (socket1 != null) {
      socket1.close();
    }
    if (socket2 != null) {
      socket2.close();
    }
  }
}
