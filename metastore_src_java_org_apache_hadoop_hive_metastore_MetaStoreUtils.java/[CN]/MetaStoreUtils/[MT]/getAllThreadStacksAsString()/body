{
  Map<Thread,StackTraceElement[]> threadStacks=Thread.getAllStackTraces();
  StringBuilder sb=new StringBuilder();
  for (  Map.Entry<Thread,StackTraceElement[]> entry : threadStacks.entrySet()) {
    Thread t=entry.getKey();
    sb.append(System.lineSeparator());
    sb.append("Name: ").append(t.getName()).append(" State: " + t.getState());
    addStackString(entry.getValue(),sb);
  }
  return sb.toString();
}
