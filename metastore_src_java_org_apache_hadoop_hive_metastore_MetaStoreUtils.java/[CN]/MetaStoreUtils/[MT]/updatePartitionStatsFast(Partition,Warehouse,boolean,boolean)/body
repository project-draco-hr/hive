{
  Map<String,String> params=part.getParameters();
  boolean updated=false;
  if (forceRecompute || params == null || !containsAllFastStats(params)) {
    if (params == null) {
      params=new HashMap<String,String>();
    }
    if (!madeDir) {
      LOG.warn("Updating partition stats fast for: " + part.getTableName());
      FileStatus[] fileStatus=wh.getFileStatusesForSD(part.getSd());
      params.put(StatsSetupConst.NUM_FILES,Integer.toString(fileStatus.length));
      long partSize=0L;
      for (int i=0; i < fileStatus.length; i++) {
        partSize+=fileStatus[i].getLen();
      }
      params.put(StatsSetupConst.TOTAL_SIZE,Long.toString(partSize));
      LOG.warn("Updated size to " + Long.toString(partSize));
      if (!params.containsKey(StatsSetupConst.STATS_GENERATED_VIA_STATS_TASK)) {
        for (        String stat : StatsSetupConst.statsRequireCompute) {
          params.put(stat,"-1");
        }
        params.put(StatsSetupConst.COLUMN_STATS_ACCURATE,StatsSetupConst.FALSE);
      }
 else {
        params.remove(StatsSetupConst.STATS_GENERATED_VIA_STATS_TASK);
        params.put(StatsSetupConst.COLUMN_STATS_ACCURATE,StatsSetupConst.TRUE);
      }
    }
    part.setParameters(params);
    updated=true;
  }
  return updated;
}
