{
  Configuration conf=new Configuration();
  List<Integer> rowIndexCols=null;
  Options opts=createOptions();
  CommandLine cli=new GnuParser().parse(opts,args);
  if (cli.hasOption('h')) {
    HelpFormatter formatter=new HelpFormatter();
    formatter.printHelp("orcfiledump",opts);
    return;
  }
  boolean dumpData=cli.hasOption('d');
  if (cli.hasOption("rowindex")) {
    String[] colStrs=cli.getOptionValue("rowindex").split(",");
    rowIndexCols=new ArrayList<Integer>(colStrs.length);
    for (    String colStr : colStrs) {
      rowIndexCols.add(Integer.parseInt(colStr));
    }
  }
  String[] files=cli.getArgs();
  if (dumpData)   printData(Arrays.asList(files),conf);
 else   printMetaData(Arrays.asList(files),conf,rowIndexCols);
}
