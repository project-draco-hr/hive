{
  Configuration conf=new Configuration();
  List<Integer> rowIndexCols=null;
  Options opts=createOptions();
  CommandLine cli=new GnuParser().parse(opts,args);
  if (cli.hasOption('h')) {
    HelpFormatter formatter=new HelpFormatter();
    formatter.printHelp("orcfiledump",opts);
    return;
  }
  boolean dumpData=cli.hasOption('d');
  if (cli.hasOption("r")) {
    String[] colStrs=cli.getOptionValue("r").split(",");
    rowIndexCols=new ArrayList<Integer>(colStrs.length);
    for (    String colStr : colStrs) {
      rowIndexCols.add(Integer.parseInt(colStr));
    }
  }
  boolean printTimeZone=cli.hasOption('t');
  boolean jsonFormat=cli.hasOption('j');
  String[] files=cli.getArgs();
  if (files.length == 0) {
    System.err.println("Error : ORC files are not specified");
    return;
  }
  List<String> filesInPath=Lists.newArrayList();
  for (  String filename : files) {
    Path path=new Path(filename);
    filesInPath.addAll(getAllFilesInPath(path,conf));
  }
  if (dumpData) {
    printData(filesInPath,conf);
  }
 else {
    if (jsonFormat) {
      boolean prettyPrint=cli.hasOption('p');
      JsonFileDump.printJsonMetaData(filesInPath,conf,rowIndexCols,prettyPrint,printTimeZone);
    }
 else {
      printMetaData(filesInPath,conf,rowIndexCols,printTimeZone);
    }
  }
}
