{
  txnHandler.openTxns(new OpenTxnRequest(3,"me","localhost"));
  txnHandler.abortTxn(new AbortTxnRequest(1));
  txnHandler.commitTxn(new CommitTxnRequest(2));
  GetOpenTxnsInfoResponse txnsInfo=txnHandler.getOpenTxnsInfo();
  assertEquals(3L,txnsInfo.getTxn_high_water_mark());
  assertEquals(2,txnsInfo.getOpen_txns().size());
  assertEquals(1L,txnsInfo.getOpen_txns().get(0).getId());
  assertEquals(TxnState.ABORTED,txnsInfo.getOpen_txns().get(0).getState());
  assertEquals(3L,txnsInfo.getOpen_txns().get(1).getId());
  assertEquals(TxnState.OPEN,txnsInfo.getOpen_txns().get(1).getState());
  GetOpenTxnsResponse txns=txnHandler.getOpenTxns();
  assertEquals(3L,txns.getTxn_high_water_mark());
  assertEquals(2,txns.getOpen_txns().size());
  boolean[] saw=new boolean[4];
  for (int i=0; i < saw.length; i++)   saw[i]=false;
  for (  Long tid : txns.getOpen_txns()) {
    saw[tid.intValue()]=true;
  }
  assertTrue(saw[1]);
  assertFalse(saw[2]);
  assertTrue(saw[3]);
}
