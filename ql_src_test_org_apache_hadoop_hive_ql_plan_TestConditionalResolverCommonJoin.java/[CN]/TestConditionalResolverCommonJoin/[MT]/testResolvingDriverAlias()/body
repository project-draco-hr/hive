{
  ConditionalResolverCommonJoin resolver=new ConditionalResolverCommonJoin();
  HashMap<String,ArrayList<String>> pathToAliases=new HashMap<String,ArrayList<String>>();
  pathToAliases.put("path1",new ArrayList<String>(Arrays.asList("alias1","alias2")));
  pathToAliases.put("path2",new ArrayList<String>(Arrays.asList("alias3")));
  HashMap<String,Long> aliasToKnownSize=new HashMap<String,Long>();
  aliasToKnownSize.put("alias1",1024l);
  aliasToKnownSize.put("alias2",2048l);
  aliasToKnownSize.put("alias3",4096l);
  HashMap<String,Task<? extends Serializable>> aliasToTask=new HashMap<String,Task<? extends Serializable>>();
  aliasToTask.put("alias2",null);
  aliasToTask.put("alias3",null);
  ConditionalResolverCommonJoin.ConditionalResolverCommonJoinCtx ctx=new ConditionalResolverCommonJoin.ConditionalResolverCommonJoinCtx();
  ctx.setPathToAliases(pathToAliases);
  ctx.setAliasToTask(aliasToTask);
  ctx.setAliasToKnownSize(aliasToKnownSize);
  HiveConf conf=new HiveConf();
  conf.setLongVar(HiveConf.ConfVars.HIVESMALLTABLESFILESIZE,4096);
  String resolved=resolver.resolveMapJoinTask(ctx,conf);
  Assert.assertEquals("alias3",resolved);
  conf.setLongVar(HiveConf.ConfVars.HIVESMALLTABLESFILESIZE,65536);
  resolved=resolver.resolveMapJoinTask(ctx,conf);
  Assert.assertEquals("alias3",resolved);
  conf.setLongVar(HiveConf.ConfVars.HIVESMALLTABLESFILESIZE,2048);
  resolved=resolver.resolveMapJoinTask(ctx,conf);
  Assert.assertNull(resolved);
}
