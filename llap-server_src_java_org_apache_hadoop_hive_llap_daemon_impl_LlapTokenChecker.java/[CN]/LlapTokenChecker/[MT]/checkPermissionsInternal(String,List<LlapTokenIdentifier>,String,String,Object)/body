{
  if (kerberosName != null && StringUtils.isBlank(appId) && kerberosName.equals(userName)) {
    return;
  }
  if (tokens != null) {
    for (    LlapTokenIdentifier llapId : tokens) {
      String tokenUser=llapId.getOwner().toString(), tokenAppId=llapId.getAppId();
      if (checkTokenPermissions(userName,appId,tokenUser,tokenAppId))       return;
    }
  }
  throw new SecurityException("Unauthorized to access " + userName + ", "+ appId.hashCode()+ " ("+ hint+ ")");
}
