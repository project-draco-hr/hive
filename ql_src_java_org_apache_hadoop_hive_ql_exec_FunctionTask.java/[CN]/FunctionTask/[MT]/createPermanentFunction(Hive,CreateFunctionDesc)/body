{
  String[] qualifiedNameParts=FunctionUtils.getQualifiedFunctionNameParts(createFunctionDesc.getFunctionName());
  String dbName=qualifiedNameParts[0];
  String funcName=qualifiedNameParts[1];
  String registeredName=FunctionUtils.qualifyFunctionName(funcName,dbName);
  String className=createFunctionDesc.getClassName();
  List<ResourceUri> resources=createFunctionDesc.getResources();
  checkLocalFunctionResources(db,createFunctionDesc.getResources());
  FunctionInfo registered=FunctionRegistry.registerPermanentFunction(registeredName,className,true,toFunctionResource(resources));
  if (registered == null) {
    console.printError("Failed to register " + registeredName + " using class "+ createFunctionDesc.getClassName());
    return 1;
  }
  Function func=new Function(funcName,dbName,className,SessionState.get().getUserName(),PrincipalType.USER,(int)(System.currentTimeMillis() / 1000),org.apache.hadoop.hive.metastore.api.FunctionType.JAVA,resources);
  db.createFunction(func);
  return 0;
}
