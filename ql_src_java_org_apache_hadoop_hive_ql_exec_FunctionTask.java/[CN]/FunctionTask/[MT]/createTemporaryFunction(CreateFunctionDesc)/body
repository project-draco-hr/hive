{
  try {
    FunctionResource[] resources=toFunctionResource(createFunctionDesc.getResources());
    addFunctionResources(resources);
    Class<?> udfClass=getUdfClass(createFunctionDesc);
    FunctionInfo registered=FunctionRegistry.registerTemporaryUDF(createFunctionDesc.getFunctionName(),udfClass,resources);
    if (registered != null) {
      return 0;
    }
    console.printError("FAILED: Class " + createFunctionDesc.getClassName() + " does not implement UDF, GenericUDF, or UDAF");
    return 1;
  }
 catch (  HiveException e) {
    console.printError("FAILED: " + e.toString());
    LOG.info("create function: " + StringUtils.stringifyException(e));
    return 1;
  }
catch (  ClassNotFoundException e) {
    console.printError("FAILED: Class " + createFunctionDesc.getClassName() + " not found");
    LOG.info("create function: " + StringUtils.stringifyException(e));
    return 1;
  }
}
