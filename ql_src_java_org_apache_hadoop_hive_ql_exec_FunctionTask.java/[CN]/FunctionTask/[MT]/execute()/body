{
  createFunctionDesc createFunctionDesc=work.getCreateFunctionDesc();
  if (createFunctionDesc != null) {
    try {
      Class<?> udfClass=getUdfClass(createFunctionDesc);
      if (UDF.class.isAssignableFrom(udfClass)) {
        FunctionRegistry.registerUDF(createFunctionDesc.getFunctionName(),(Class<? extends UDF>)udfClass,OperatorType.PREFIX,false);
        return 0;
      }
 else       if (GenericUDF.class.isAssignableFrom(udfClass)) {
        FunctionRegistry.registerGenericUDF(createFunctionDesc.getFunctionName(),(Class<? extends GenericUDF>)udfClass);
        return 0;
      }
 else       if (UDAF.class.isAssignableFrom(udfClass)) {
        FunctionRegistry.registerUDAF(createFunctionDesc.getFunctionName(),(Class<? extends UDAF>)udfClass);
        return 0;
      }
      return 1;
    }
 catch (    ClassNotFoundException e) {
      LOG.info("create function: " + StringUtils.stringifyException(e));
      return 1;
    }
  }
  return 0;
}
