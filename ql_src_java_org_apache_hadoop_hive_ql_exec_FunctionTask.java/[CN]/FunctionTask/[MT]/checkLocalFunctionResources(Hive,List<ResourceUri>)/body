{
  if (resources != null && resources.size() > 0) {
    try {
      String localFsScheme=FileSystem.getLocal(db.getConf()).getUri().getScheme();
      String configuredFsScheme=FileSystem.get(db.getConf()).getUri().getScheme();
      if (configuredFsScheme.equals(localFsScheme)) {
        return;
      }
      for (      ResourceUri res : resources) {
        String resUri=res.getUri();
        if (!SessionState.canDownloadResource(resUri)) {
          throw new HiveException("Hive warehouse is non-local, but " + res.getUri() + " specifies file on local filesystem. "+ "Resources on non-local warehouse should specify a non-local scheme/path");
        }
      }
    }
 catch (    HiveException e) {
      throw e;
    }
catch (    Exception e) {
      LOG.error(e);
      throw new HiveException(e);
    }
  }
}
