{
  if (Double.isNaN(timestampSecondsWithFractionalNanoseconds)) {
    timestampSecondsWithFractionalNanoseconds=0;
  }
  long seconds=(long)timestampSecondsWithFractionalNanoseconds;
  BigDecimal bd;
  bd=new BigDecimal(String.valueOf(timestampSecondsWithFractionalNanoseconds));
  bd=bd.subtract(new BigDecimal(seconds));
  bd=bd.multiply(BIG_NANOSECONDS_PER_SECOND);
  int nanos=bd.intValue();
  long millis=seconds * 1000;
  if (nanos < 0) {
    millis-=1000;
    nanos+=1000000000;
  }
  scratchTimestamp.setTime(millis);
  scratchTimestamp.setNanos(nanos);
  updateFromTimestamp(scratchTimestamp);
  return this;
}
