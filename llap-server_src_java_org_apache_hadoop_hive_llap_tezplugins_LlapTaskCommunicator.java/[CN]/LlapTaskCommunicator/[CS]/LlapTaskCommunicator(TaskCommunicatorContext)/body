{
  super(taskCommunicatorContext);
  umbilical=new LlapTaskUmbilicalProtocolImpl(getUmbilical());
  SubmitWorkRequestProto.Builder baseBuilder=SubmitWorkRequestProto.newBuilder();
  baseBuilder.setUser(System.getenv(ApplicationConstants.Environment.USER.name()));
  baseBuilder.setApplicationIdString(taskCommunicatorContext.getApplicationAttemptId().getApplicationId().toString());
  baseBuilder.setAppAttemptNumber(taskCommunicatorContext.getApplicationAttemptId().getAttemptId());
  baseBuilder.setTokenIdentifier(getTokenIdentifier());
  BASE_SUBMIT_WORK_REQUEST=baseBuilder.build();
  credentialMap=new ConcurrentHashMap<>();
  sourceStateTracker=new SourceStateTracker(getTaskCommunicatorContext(),this);
}
