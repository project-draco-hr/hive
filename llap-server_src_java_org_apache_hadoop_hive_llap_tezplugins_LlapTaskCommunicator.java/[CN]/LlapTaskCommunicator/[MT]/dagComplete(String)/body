{
  QueryCompleteRequestProto request=QueryCompleteRequestProto.newBuilder().setDagName(dagName).setDeleteDelay(deleteDelayOnDagComplete).build();
  for (  final LlapNodeId llapNodeId : nodesForQuery) {
    LOG.info("Sending dagComplete message for {}, to {}",dagName,llapNodeId);
    communicator.sendQueryComplete(request,llapNodeId.getHostname(),llapNodeId.getPort(),new TaskCommunicator.ExecuteRequestCallback<LlapDaemonProtocolProtos.QueryCompleteResponseProto>(){
      @Override public void setResponse(      LlapDaemonProtocolProtos.QueryCompleteResponseProto response){
      }
      @Override public void indicateError(      Throwable t){
        LOG.warn("Failed to indicate dag complete dagId={} to node {}",dagName,llapNodeId);
      }
    }
);
  }
  nodesForQuery.clear();
}
