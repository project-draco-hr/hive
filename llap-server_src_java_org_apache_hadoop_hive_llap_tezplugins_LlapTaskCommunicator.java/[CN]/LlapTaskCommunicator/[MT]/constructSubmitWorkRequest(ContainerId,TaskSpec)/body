{
  SubmitWorkRequestProto.Builder builder=SubmitWorkRequestProto.newBuilder(BASE_SUBMIT_WORK_REQUEST);
  builder.setContainerIdString(containerId.toString());
  builder.setAmHost(getAddress().getHostName());
  builder.setAmPort(getAddress().getPort());
  Credentials taskCredentials=new Credentials();
  taskCredentials.addAll(getTaskCommunicatorContext().getCredentials());
  ByteBuffer credentialsBinary=credentialMap.get(taskSpec.getDAGName());
  if (credentialsBinary == null) {
    credentialsBinary=serializeCredentials(getTaskCommunicatorContext().getCredentials());
    credentialMap.putIfAbsent(taskSpec.getDAGName(),credentialsBinary.duplicate());
  }
 else {
    credentialsBinary=credentialsBinary.duplicate();
  }
  builder.setCredentialsBinary(ByteString.copyFrom(credentialsBinary));
  builder.setFragmentSpec(Converters.convertTaskSpecToProto(taskSpec));
  return builder.build();
}
