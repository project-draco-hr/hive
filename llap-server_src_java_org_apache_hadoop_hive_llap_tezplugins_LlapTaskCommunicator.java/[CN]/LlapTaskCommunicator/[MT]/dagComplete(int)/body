{
  QueryCompleteRequestProto request=QueryCompleteRequestProto.newBuilder().setQueryIdentifier(constructQueryIdentifierProto(dagIdentifier)).setDeleteDelay(deleteDelayOnDagComplete).build();
  for (  final LlapNodeId llapNodeId : nodesForQuery) {
    LOG.info("Sending dagComplete message for {}, to {}",dagIdentifier,llapNodeId);
    communicator.sendQueryComplete(request,llapNodeId.getHostname(),llapNodeId.getPort(),new LlapDaemonProtocolClientProxy.ExecuteRequestCallback<LlapDaemonProtocolProtos.QueryCompleteResponseProto>(){
      @Override public void setResponse(      LlapDaemonProtocolProtos.QueryCompleteResponseProto response){
      }
      @Override public void indicateError(      Throwable t){
        LOG.warn("Failed to indicate dag complete dagId={} to node {}",dagIdentifier,llapNodeId);
      }
    }
);
  }
  nodesForQuery.clear();
}
