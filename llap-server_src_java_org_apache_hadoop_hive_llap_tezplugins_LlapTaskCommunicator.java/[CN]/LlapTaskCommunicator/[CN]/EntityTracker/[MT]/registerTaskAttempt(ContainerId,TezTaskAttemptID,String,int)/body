{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Registering " + containerId + ", "+ taskAttemptId+ " for node: "+ host+ ":"+ port);
  }
  LlapNodeId llapNodeId=LlapNodeId.getInstance(host,port);
  attemptToNodeMap.putIfAbsent(taskAttemptId,llapNodeId);
  BiMap<ContainerId,TezTaskAttemptID> tmpMap=HashBiMap.create();
  BiMap<ContainerId,TezTaskAttemptID> old=nodeMap.putIfAbsent(llapNodeId,tmpMap);
  BiMap<ContainerId,TezTaskAttemptID> usedInstance;
  usedInstance=old == null ? tmpMap : old;
synchronized (usedInstance) {
    usedInstance.put(containerId,taskAttemptId);
  }
  nodeMap.putIfAbsent(llapNodeId,usedInstance);
}
