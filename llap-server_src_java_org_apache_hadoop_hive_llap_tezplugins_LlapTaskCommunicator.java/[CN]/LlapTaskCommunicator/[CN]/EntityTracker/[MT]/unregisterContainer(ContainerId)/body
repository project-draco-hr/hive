{
  LlapNodeId llapNodeId=containerToNodeMap.remove(containerId);
  if (llapNodeId == null) {
    return;
  }
  BiMap<ContainerId,TezTaskAttemptID> bMap=nodeMap.get(llapNodeId);
  TezTaskAttemptID matched=null;
  if (bMap != null) {
synchronized (bMap) {
      matched=bMap.remove(containerId);
    }
    if (bMap.isEmpty()) {
      nodeMap.remove(llapNodeId);
    }
  }
  if (matched != null) {
    attemptToNodeMap.remove(matched);
  }
}
