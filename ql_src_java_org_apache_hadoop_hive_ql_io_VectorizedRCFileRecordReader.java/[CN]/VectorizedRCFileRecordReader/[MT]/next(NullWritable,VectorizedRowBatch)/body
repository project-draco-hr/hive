{
  VectorizedBatchUtil.setNoNullFields(value);
  buffer.reset();
  value.selectedInUse=false;
  for (int i=0; i < value.numCols; i++) {
    value.cols[i].isRepeating=false;
  }
  int i=0;
  try {
    for (; i < VectorizedRowBatch.DEFAULT_SIZE; i++) {
      more=next(keyCache);
      if (more) {
        if (addPartitionCols) {
          rbCtx.addPartitionColsToBatch(value);
          addPartitionCols=false;
        }
        in.getCurrentRow(colsCache);
        rbCtx.addRowToBatch(i,(Writable)colsCache,value,buffer);
      }
 else {
        break;
      }
    }
  }
 catch (  Exception e) {
    new RuntimeException("Error while getting next row",e);
  }
  value.size=i;
  return more;
}
