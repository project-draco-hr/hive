{
  String idNode=PathUtil.getRevisionIDNode(this.baseDir,tableName);
  ensurePathExists(idNode,Bytes.toBytes("0"),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  String lockNode=PathUtil.getLockManagementNode(idNode);
  ensurePathExists(lockNode,null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  IDGenerator idf=new IDGenerator(getSession(),tableName,idNode);
  long id=idf.obtainID();
  return id;
}
