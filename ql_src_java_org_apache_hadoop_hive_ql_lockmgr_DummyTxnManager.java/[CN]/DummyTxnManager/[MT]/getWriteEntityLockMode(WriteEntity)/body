{
  HiveLockMode lockMode=we.isComplete() ? HiveLockMode.EXCLUSIVE : HiveLockMode.SHARED;
switch (we.getWriteType()) {
case DDL_EXCLUSIVE:
    return HiveLockMode.EXCLUSIVE;
case DDL_SHARED:
  return HiveLockMode.SHARED;
case DDL_NO_LOCK:
return null;
default :
return lockMode;
}
}
