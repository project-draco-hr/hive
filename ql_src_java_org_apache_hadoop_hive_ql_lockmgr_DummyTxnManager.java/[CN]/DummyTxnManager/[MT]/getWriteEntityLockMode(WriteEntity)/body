{
  HiveLockMode lockMode=we.isComplete() ? HiveLockMode.EXCLUSIVE : HiveLockMode.SHARED;
  WriteEntity.WriteType writeType=we.getWriteType();
  if (writeType == null) {
    return lockMode;
  }
switch (writeType) {
case DDL_EXCLUSIVE:
    return HiveLockMode.EXCLUSIVE;
case DDL_SHARED:
  return HiveLockMode.SHARED;
case DDL_NO_LOCK:
return null;
default :
return lockMode;
}
}
