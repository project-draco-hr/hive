{
  DynamicSerDeTypeBase keyType=getKeyType();
  DynamicSerDeTypeBase valueType=getValueType();
  WriteNullsProtocol nullProtocol=(oprot instanceof WriteNullsProtocol) ? (WriteNullsProtocol)oprot : null;
  assert(oi.getCategory() == ObjectInspector.Category.MAP);
  MapObjectInspector moi=(MapObjectInspector)oi;
  ObjectInspector koi=moi.getMapKeyObjectInspector();
  ObjectInspector voi=moi.getMapValueObjectInspector();
  Map<?,?> map=moi.getMap(o);
  serializeMap=new TMap(keyType.getType(),valueType.getType(),map.size());
  oprot.writeMapBegin(serializeMap);
  for (  Object element : map.entrySet()) {
    Map.Entry it=(Map.Entry)element;
    Object key=it.getKey();
    Object value=it.getValue();
    keyType.serialize(key,koi,oprot);
    if (value == null) {
      assert(nullProtocol != null);
      nullProtocol.writeNull();
    }
 else {
      valueType.serialize(value,voi,oprot);
    }
  }
  oprot.writeMapEnd();
}
