{
  DynamicSerDeTypeBase keyType=this.getKeyType();
  DynamicSerDeTypeBase valueType=this.getValueType();
  org.apache.hadoop.hive.serde2.thrift.WriteNullsProtocol nullProtocol=(oprot instanceof org.apache.hadoop.hive.serde2.thrift.WriteNullsProtocol) ? (org.apache.hadoop.hive.serde2.thrift.WriteNullsProtocol)oprot : null;
  assert(oi.getCategory() == ObjectInspector.Category.MAP);
  MapObjectInspector moi=(MapObjectInspector)oi;
  ObjectInspector koi=moi.getMapKeyObjectInspector();
  ObjectInspector voi=moi.getMapValueObjectInspector();
  Map<?,?> map=moi.getMap(o);
  serializeMap=new TMap(keyType.getType(),valueType.getType(),map.size());
  oprot.writeMapBegin(serializeMap);
  for (Iterator i=map.entrySet().iterator(); i.hasNext(); ) {
    Map.Entry it=(Map.Entry)i.next();
    Object key=it.getKey();
    Object value=it.getValue();
    keyType.serialize(key,koi,oprot);
    if (value == null) {
      assert(nullProtocol != null);
      nullProtocol.writeNull();
    }
 else {
      valueType.serialize(value,voi,oprot);
    }
  }
  oprot.writeMapEnd();
}
