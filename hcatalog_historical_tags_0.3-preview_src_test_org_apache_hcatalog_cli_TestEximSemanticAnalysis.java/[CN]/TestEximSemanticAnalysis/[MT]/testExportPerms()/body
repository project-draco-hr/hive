{
  hcatDriver.run("drop table junit_sem_analysis");
  CommandProcessorResponse response=hcatDriver.run("create table junit_sem_analysis (a int) partitioned by (b string) stored as RCFILE");
  assertEquals(0,response.getResponseCode());
  Path whPath=wh.getTablePath(Hive.get(hcatConf).getDatabase("default"),"junit_sem_analysis");
  cluster.getFileSystem().setPermission(whPath,FsPermission.valueOf("-rwxrwx-wx"));
  cluster.getFileSystem().setOwner(whPath,"nosuchuser","nosuchgroup");
  Runtime.getRuntime().exec("rm -rf /tmp/hcat");
  response=hcatDriver.run("export table junit_sem_analysis to 'pfile://local:9080/tmp/hcat/exports/junit_sem_analysis'");
  assertEquals(10,response.getResponseCode());
  assertEquals("FAILED: Error in semantic analysis: org.apache.hcatalog.common.HCatException : 3000 : Permission denied",response.getErrorMessage());
  Runtime.getRuntime().exec("rm -rf /tmp/hcat");
  response=hcatDriver.run("drop table junit_sem_analysis");
  if (response.getResponseCode() != 0) {
    System.err.println(response.getErrorMessage());
    fail("Drop table failed");
  }
}
