{
  RexNode typeSafeRex=rex;
  if ((typeSafeRex instanceof RexCall) && HiveCalciteUtil.isComparisonOp((RexCall)typeSafeRex)) {
    RexBuilder rb=cluster.getRexBuilder();
    List<RexNode> fixedPredElems=new ArrayList<RexNode>();
    RelDataType commonType=cluster.getTypeFactory().leastRestrictive(RexUtil.types(((RexCall)rex).getOperands()));
    for (    RexNode rn : ((RexCall)rex).getOperands()) {
      fixedPredElems.add(rb.ensureType(commonType,rn,true));
    }
    typeSafeRex=rb.makeCall(((RexCall)typeSafeRex).getOperator(),fixedPredElems);
  }
  return typeSafeRex;
}
