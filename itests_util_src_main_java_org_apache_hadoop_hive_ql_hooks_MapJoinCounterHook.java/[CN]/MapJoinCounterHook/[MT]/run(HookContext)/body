{
  HiveConf conf=hookContext.getConf();
  boolean enableConvert=HiveConf.getBoolVar(conf,HiveConf.ConfVars.HIVECONVERTJOIN);
  if (!enableConvert) {
    return;
  }
  QueryPlan plan=hookContext.getQueryPlan();
  String queryID=plan.getQueryId();
  int commonJoin=0;
  int hintedMapJoin=0;
  int convertedMapJoin=0;
  int hintedMapJoinLocal=0;
  int convertedMapJoinLocal=0;
  int backupCommonJoin=0;
  List<TaskRunner> list=hookContext.getCompleteTaskList();
  for (  TaskRunner tskRunner : list) {
    Task tsk=tskRunner.getTask();
    int tag=tsk.getTaskTag();
switch (tag) {
case Task.COMMON_JOIN:
      commonJoin++;
    break;
case Task.HINTED_MAPJOIN:
  hintedMapJoin++;
break;
case Task.HINTED_MAPJOIN_LOCAL:
hintedMapJoinLocal++;
break;
case Task.CONVERTED_MAPJOIN:
convertedMapJoin++;
break;
case Task.CONVERTED_MAPJOIN_LOCAL:
convertedMapJoinLocal++;
break;
case Task.BACKUP_COMMON_JOIN:
backupCommonJoin++;
break;
}
}
LogHelper console=SessionState.getConsole();
console.printError("[MapJoinCounter PostHook] COMMON_JOIN: " + commonJoin + " HINTED_MAPJOIN: "+ hintedMapJoin+ " HINTED_MAPJOIN_LOCAL: "+ hintedMapJoinLocal+ " CONVERTED_MAPJOIN: "+ convertedMapJoin+ " CONVERTED_MAPJOIN_LOCAL: "+ convertedMapJoinLocal+ " BACKUP_COMMON_JOIN: "+ backupCommonJoin);
}
