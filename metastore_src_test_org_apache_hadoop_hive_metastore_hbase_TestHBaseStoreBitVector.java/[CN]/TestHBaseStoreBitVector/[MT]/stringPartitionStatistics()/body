{
  createMockTableAndPartition(STRING_TYPE,STRING_VAL);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockPartColStatsDesc(PART_KEY,STRING_VAL);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=stringColStatsObjs.get(0);
  StringColumnStatsData stringData=obj.getStatsData().getStringStats();
  stats.addToStatsObj(obj);
  List<String> parVals=new ArrayList<String>();
  parVals.add(STRING_VAL);
  store.updatePartitionColumnStatistics(stats,parVals);
  List<String> partNames=new ArrayList<String>();
  partNames.add(desc.getPartName());
  List<String> colNames=new ArrayList<String>();
  colNames.add(obj.getColName());
  List<ColumnStatistics> statsFromDB=store.getPartitionColumnStatistics(DB,TBL,partNames,colNames);
  Assert.assertEquals(1,statsFromDB.size());
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.get(0).getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.get(0).getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.get(0).getStatsDesc().getTableName());
  Assert.assertFalse(statsFromDB.get(0).getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.get(0).getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.get(0).getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.STRING_STATS,dataFromDB.getSetField());
  StringColumnStatsData stringDataFromDB=dataFromDB.getStringStats();
  Assert.assertEquals(stringData.getMaxColLen(),stringDataFromDB.getMaxColLen());
  Assert.assertEquals(stringData.getAvgColLen(),stringDataFromDB.getAvgColLen(),0.01);
  Assert.assertEquals(stringData.getNumNulls(),stringDataFromDB.getNumNulls());
  Assert.assertEquals(stringData.getNumDVs(),stringDataFromDB.getNumDVs());
  Assert.assertEquals(stringData.getBitVectors(),stringDataFromDB.getBitVectors());
}
