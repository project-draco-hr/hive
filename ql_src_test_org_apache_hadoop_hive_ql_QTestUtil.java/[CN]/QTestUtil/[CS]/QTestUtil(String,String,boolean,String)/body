{
  this.outDir=outDir;
  this.logDir=logDir;
  conf=new HiveConf(Driver.class);
  this.miniMr=miniMr;
  this.hadoopVer=getHadoopMainVersion(hadoopVer);
  qMap=new TreeMap<String,String>();
  qSkipSet=new HashSet<String>();
  if (miniMr) {
    dfs=ShimLoader.getHadoopShims().getMiniDfs(conf,4,true,null);
    FileSystem fs=dfs.getFileSystem();
    mr=new MiniMRCluster(4,fs.getUri().toString(),1);
  }
  initConf();
  testFiles=conf.get("test.data.files").replace('\\','/').replace("c:","");
  String ow=System.getProperty("test.output.overwrite");
  overWrite=false;
  if ((ow != null) && ow.equalsIgnoreCase("true")) {
    overWrite=true;
  }
  setup=new QTestSetup();
  setup.preTest(conf);
  init();
}
