{
  this.outDir=outDir;
  this.logDir=logDir;
  conf=new HiveConf(Driver.class);
  this.miniMr=(clusterType == MiniClusterType.mr);
  this.hadoopVer=getHadoopMainVersion(hadoopVer);
  qMap=new TreeMap<String,String>();
  qSkipSet=new HashSet<String>();
  qSortSet=new HashSet<String>();
  HadoopShims shims=null;
switch (clusterType) {
case mr:
    shims=ShimLoader.getHadoopShims();
  break;
case tez:
if (!hadoopVer.equals("23")) {
  throw new Exception("Unsupported version of hadoop for tez. Please use " + "-Dhadoop.mr.rev=23 on the command line");
}
shims=(HadoopShims)new TezShims();
break;
case none:
break;
default :
throw new Exception("Unrecognized cluster type");
}
if (shims != null) {
dfs=shims.getMiniDfs(conf,4,true,null);
FileSystem fs=dfs.getFileSystem();
mr=shims.getMiniMrCluster(conf,4,getHdfsUriString(fs.getUri().toString()),1);
}
initConf();
String dataDir=conf.get("test.data.files");
if (dataDir == null) {
dataDir=new File(".").getAbsolutePath() + "/data/files";
}
testFiles=dataDir;
overWrite="true".equalsIgnoreCase(System.getProperty("test.output.overwrite"));
setup=new QTestSetup();
setup.preTest(conf);
init();
}
