{
  ArrayList<String> diffCommandArgs=new ArrayList<String>();
  diffCommandArgs.add("diff");
  diffCommandArgs.add("-a");
  if (ignoreWhiteSpace || Shell.WINDOWS) {
    diffCommandArgs.add("-b");
  }
  if (Shell.WINDOWS) {
    diffCommandArgs.add("--strip-trailing-cr");
    diffCommandArgs.add("-B");
  }
  diffCommandArgs.add(Shell.WINDOWS ? getQuotedString(inFileName) : inFileName);
  diffCommandArgs.add(Shell.WINDOWS ? getQuotedString(outFileName) : outFileName);
  String[] cmdArray=(String[])diffCommandArgs.toArray(new String[diffCommandArgs.size()]);
  System.out.println(org.apache.commons.lang.StringUtils.join(cmdArray,' '));
  Process executor=Runtime.getRuntime().exec(cmdArray);
  StreamPrinter outPrinter=new StreamPrinter(executor.getInputStream(),null,SessionState.getConsole().getChildOutStream());
  StreamPrinter errPrinter=new StreamPrinter(executor.getErrorStream(),null,SessionState.getConsole().getChildErrStream());
  outPrinter.start();
  errPrinter.start();
  return executor.waitFor();
}
