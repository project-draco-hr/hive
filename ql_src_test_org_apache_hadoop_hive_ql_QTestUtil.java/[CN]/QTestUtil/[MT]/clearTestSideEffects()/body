{
  for (  String dbName : db.getAllDatabases()) {
    db.setCurrentDatabase(dbName);
    for (    String tblName : db.getAllTables()) {
      if (!DEFAULT_DATABASE_NAME.equals(dbName) || !srcTables.contains(tblName)) {
        db.dropTable(dbName,tblName);
      }
    }
    if (!DEFAULT_DATABASE_NAME.equals(dbName)) {
      db.dropDatabase(dbName);
    }
  }
  db.setCurrentDatabase(DEFAULT_DATABASE_NAME);
  List<String> roleNames=db.getAllRoleNames();
  for (  String roleName : roleNames) {
    db.dropRole(roleName);
  }
  conf=new HiveConf(Driver.class);
  initConf();
  setup.preTest(conf);
}
