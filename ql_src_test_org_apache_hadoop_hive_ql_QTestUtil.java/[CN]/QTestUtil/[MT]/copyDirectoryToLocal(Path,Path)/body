{
  FileSystem srcFs=src.getFileSystem(conf);
  FileSystem destFs=dest.getFileSystem(conf);
  if (srcFs.exists(src)) {
    FileStatus[] files=srcFs.listStatus(src);
    for (int i=0; i < files.length; i++) {
      String name=files[i].getPath().getName();
      Path dfs_path=files[i].getPath();
      Path local_path=new Path(dest,name);
      if (srcTables.contains(name)) {
        continue;
      }
      if (files[i].isDir()) {
        if (!destFs.exists(local_path)) {
          destFs.mkdirs(local_path);
        }
        copyDirectoryToLocal(dfs_path,local_path);
      }
 else {
        srcFs.copyToLocalFile(dfs_path,local_path);
      }
    }
  }
}
