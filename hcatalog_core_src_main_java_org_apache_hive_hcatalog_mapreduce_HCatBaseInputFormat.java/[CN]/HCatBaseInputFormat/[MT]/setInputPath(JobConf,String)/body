{
  int length=location.length();
  int curlyOpen=0;
  int pathStart=0;
  boolean globPattern=false;
  List<String> pathStrings=new ArrayList<String>();
  for (int i=0; i < length; i++) {
    char ch=location.charAt(i);
switch (ch) {
case '{':
{
        curlyOpen++;
        if (!globPattern) {
          globPattern=true;
        }
        break;
      }
case '}':
{
      curlyOpen--;
      if (curlyOpen == 0 && globPattern) {
        globPattern=false;
      }
      break;
    }
case ',':
{
    if (!globPattern) {
      pathStrings.add(location.substring(pathStart,i));
      pathStart=i + 1;
    }
    break;
  }
}
}
pathStrings.add(location.substring(pathStart,length));
Path[] paths=StringUtils.stringToPath(pathStrings.toArray(new String[0]));
String separator="";
StringBuilder str=new StringBuilder();
for (Path path : paths) {
FileSystem fs=path.getFileSystem(jobConf);
final String qualifiedPath=fs.makeQualified(path).toString();
str.append(separator).append(StringUtils.escapeString(qualifiedPath));
separator=StringUtils.COMMA_STR;
}
jobConf.set("mapred.input.dir",str.toString());
}
