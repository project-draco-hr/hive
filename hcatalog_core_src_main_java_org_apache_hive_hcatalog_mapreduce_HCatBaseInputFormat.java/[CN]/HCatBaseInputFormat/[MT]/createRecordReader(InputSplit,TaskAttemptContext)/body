{
  HCatSplit hcatSplit=InternalUtil.castToHCatSplit(split);
  PartInfo partitionInfo=hcatSplit.getPartitionInfo();
  if (partitionInfo.getTableInfo() == null) {
    partitionInfo.setTableInfo(((InputJobInfo)HCatUtil.deserialize(taskContext.getConfiguration().get(HCatConstants.HCAT_KEY_JOB_INFO))).getTableInfo());
  }
  JobContext jobContext=taskContext;
  Configuration conf=jobContext.getConfiguration();
  HiveStorageHandler storageHandler=HCatUtil.getStorageHandler(conf,partitionInfo);
  JobConf jobConf=HCatUtil.getJobConfFromContext(jobContext);
  Map<String,String> jobProperties=partitionInfo.getJobProperties();
  HCatUtil.copyJobPropertiesToJobConf(jobProperties,jobConf);
  Map<String,Object> valuesNotInDataCols=getColValsNotInDataColumns(getOutputSchema(conf),partitionInfo);
  return new HCatRecordReader(storageHandler,valuesNotInDataCols);
}
