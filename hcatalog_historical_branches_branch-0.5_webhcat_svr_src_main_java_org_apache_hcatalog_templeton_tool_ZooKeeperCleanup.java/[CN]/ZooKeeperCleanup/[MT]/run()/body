{
  ZooKeeper zk=null;
  List<String> nodes=null;
  isRunning=true;
  while (!stop) {
    try {
      try {
        zk=ZooKeeperStorage.zkOpen(appConf);
        nodes=getChildList(zk);
        for (        String node : nodes) {
          boolean deleted=checkAndDelete(node,zk);
          if (!deleted) {
            break;
          }
        }
        zk.close();
      }
 catch (      Exception e) {
        LOG.error("Cleanup cycle failed: " + e.getMessage());
      }
 finally {
        if (zk != null) {
          try {
            zk.close();
          }
 catch (          InterruptedException e) {
          }
        }
      }
      long sleepMillis=(long)(Math.random() * interval);
      LOG.info("Next execution: " + new Date(new Date().getTime() + sleepMillis));
      Thread.sleep(sleepMillis);
    }
 catch (    Exception e) {
      isRunning=false;
      LOG.error("Cleanup failed: " + e.getMessage(),e);
    }
  }
  isRunning=false;
}
