{
  if (perfLogger.get() == null || resetPerfLogger) {
    if (SessionState.get() == null) {
      perfLogger.set(new PerfLogger());
    }
 else {
      HiveConf conf=SessionState.get().getConf();
      try {
        perfLogger.set((PerfLogger)ReflectionUtils.newInstance(conf.getClassByName(conf.getVar(ConfVars.HIVE_PERF_LOGGER)),conf));
      }
 catch (      ClassNotFoundException e) {
        LOG.error("Performance Logger Class not found:" + e.getMessage());
        perfLogger.set(new PerfLogger());
      }
    }
  }
  return perfLogger.get();
}
