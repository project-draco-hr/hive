{
  BytesWritable keyBytesWritable=new BytesWritable(key,key.length);
  if (keyValueMap.containsKey(keyBytesWritable)) {
    int index=keyValueMap.get(keyBytesWritable);
    array[index].add(value,valueRow);
  }
 else {
    if (count >= array.length) {
      FastRowHashMapElement[] newArray=new FastRowHashMapElement[array.length * 2];
      System.arraycopy(array,0,newArray,0,count);
      array=newArray;
    }
    array[count]=new FastRowHashMapElement(key,keyRow,value,valueRow);
    keyValueMap.put(keyBytesWritable,count);
    count++;
  }
}
