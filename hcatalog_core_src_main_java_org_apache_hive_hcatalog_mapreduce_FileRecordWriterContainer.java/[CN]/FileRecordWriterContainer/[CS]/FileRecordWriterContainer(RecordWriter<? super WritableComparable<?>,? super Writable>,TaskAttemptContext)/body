{
  super(context,baseWriter);
  this.context=context;
  jobInfo=HCatOutputFormat.getJobInfo(context.getConfiguration());
  storageHandler=HCatUtil.getStorageHandler(context.getConfiguration(),jobInfo.getTableInfo().getStorerInfo());
  serDe=ReflectionUtils.newInstance(storageHandler.getSerDeClass(),context.getConfiguration());
  objectInspector=InternalUtil.createStructObjectInspector(jobInfo.getOutputSchema());
  try {
    InternalUtil.initializeOutputSerDe(serDe,context.getConfiguration(),jobInfo);
  }
 catch (  SerDeException e) {
    throw new IOException("Failed to inialize SerDe",e);
  }
  partColsToDel=jobInfo.getPosOfPartCols();
  if (partColsToDel == null) {
    throw new HCatException("It seems that setSchema() is not called on " + "HCatOutputFormat. Please make sure that method is called.");
  }
}
