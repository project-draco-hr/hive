{
  if (arguments.length != 2) {
    throw new UDFArgumentLengthException("date_add() requires 2 argument, got " + arguments.length);
  }
  if (arguments[0].getCategory() != ObjectInspector.Category.PRIMITIVE) {
    throw new UDFArgumentTypeException(0,"Only primitive type arguments are accepted but " + arguments[0].getTypeName() + " is passed. as first arguments");
  }
  if (arguments[1].getCategory() != ObjectInspector.Category.PRIMITIVE) {
    throw new UDFArgumentTypeException(1,"Only primitive type arguments are accepted but " + arguments[1].getTypeName() + " is passed. as second arguments");
  }
  inputType1=((PrimitiveObjectInspector)arguments[0]).getPrimitiveCategory();
  ObjectInspector outputOI=PrimitiveObjectInspectorFactory.writableStringObjectInspector;
switch (inputType1) {
case STRING:
case VARCHAR:
case CHAR:
    inputType1=PrimitiveCategory.STRING;
  dateConverter=ObjectInspectorConverters.getConverter((PrimitiveObjectInspector)arguments[0],PrimitiveObjectInspectorFactory.writableStringObjectInspector);
break;
case TIMESTAMP:
dateConverter=new TimestampConverter((PrimitiveObjectInspector)arguments[0],PrimitiveObjectInspectorFactory.writableTimestampObjectInspector);
break;
case DATE:
dateConverter=ObjectInspectorConverters.getConverter((PrimitiveObjectInspector)arguments[0],PrimitiveObjectInspectorFactory.writableDateObjectInspector);
break;
default :
throw new UDFArgumentException(" DATE_ADD() only takes STRING/TIMESTAMP/DATEWRITABLE types as first argument, got " + inputType1);
}
inputType2=((PrimitiveObjectInspector)arguments[1]).getPrimitiveCategory();
switch (inputType2) {
case BYTE:
daysConverter=ObjectInspectorConverters.getConverter((PrimitiveObjectInspector)arguments[1],PrimitiveObjectInspectorFactory.writableByteObjectInspector);
break;
case SHORT:
daysConverter=ObjectInspectorConverters.getConverter((PrimitiveObjectInspector)arguments[1],PrimitiveObjectInspectorFactory.writableShortObjectInspector);
break;
case INT:
daysConverter=ObjectInspectorConverters.getConverter((PrimitiveObjectInspector)arguments[1],PrimitiveObjectInspectorFactory.writableIntObjectInspector);
break;
default :
throw new UDFArgumentException(" DATE_ADD() only takes TINYINT/SMALLINT/INT types as second argument, got " + inputType2);
}
return outputOI;
}
