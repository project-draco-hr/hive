{
  Utilities.copyTablePropertiesToConf(table,conf);
  if (tableScan != null) {
    pushFilters(conf,tableScan);
  }
  FileInputFormat.setInputPaths(conf,dirs.toArray(new Path[dirs.size()]));
  conf.setInputFormat(inputFormat.getClass());
  int headerCount=0;
  int footerCount=0;
  if (table != null) {
    headerCount=Utilities.getHeaderCount(table);
    footerCount=Utilities.getFooterCount(table,conf);
    if (headerCount != 0 || footerCount != 0) {
      HiveConf.setLongVar(conf,ConfVars.MAPREDMINSPLITSIZE,Long.MAX_VALUE);
    }
  }
  InputSplit[] iss=inputFormat.getSplits(conf,splits);
  for (  InputSplit is : iss) {
    result.add(new HiveInputSplit(is,inputFormatClass.getName()));
  }
}
