{
  jobConf.unset(TableScanDesc.FILTER_TEXT_CONF_STR);
  jobConf.unset(TableScanDesc.FILTER_EXPR_CONF_STR);
  Utilities.unsetSchemaEvolution(jobConf);
  TableScanDesc scanDesc=tableScan.getConf();
  if (scanDesc == null) {
    return;
  }
  Utilities.addTableSchemaToConf(jobConf,tableScan);
  Utilities.setColumnNameList(jobConf,tableScan);
  Utilities.setColumnTypeList(jobConf,tableScan);
  ExprNodeGenericFuncDesc filterExpr=(ExprNodeGenericFuncDesc)scanDesc.getFilterExpr();
  if (filterExpr == null) {
    return;
  }
  String serializedFilterObj=scanDesc.getSerializedFilterObject();
  String serializedFilterExpr=scanDesc.getSerializedFilterExpr();
  boolean hasObj=serializedFilterObj != null, hasExpr=serializedFilterExpr != null;
  if (!hasObj) {
    Serializable filterObject=scanDesc.getFilterObject();
    if (filterObject != null) {
      serializedFilterObj=SerializationUtilities.serializeObject(filterObject);
    }
  }
  if (serializedFilterObj != null) {
    jobConf.set(TableScanDesc.FILTER_OBJECT_CONF_STR,serializedFilterObj);
  }
  if (!hasExpr) {
    serializedFilterExpr=SerializationUtilities.serializeExpression(filterExpr);
  }
  String filterText=filterExpr.getExprString();
  if (LOG.isDebugEnabled()) {
    LOG.debug("Pushdown initiated with filterText = " + filterText + ", filterExpr = "+ filterExpr+ ", serializedFilterExpr = "+ serializedFilterExpr+ " ("+ (hasExpr ? "desc" : "new")+ ")"+ (serializedFilterObj == null ? "" : (", serializedFilterObj = " + serializedFilterObj + " ("+ (hasObj ? "desc" : "new")+ ")")));
  }
  jobConf.set(TableScanDesc.FILTER_TEXT_CONF_STR,filterText);
  jobConf.set(TableScanDesc.FILTER_EXPR_CONF_STR,serializedFilterExpr);
}
