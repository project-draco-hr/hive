{
  if (!HiveConf.getBoolVar(conf,ConfVars.LLAP_IO_ENABLED,LlapProxy.isDaemon())) {
    return inputFormat;
  }
  boolean isSupported=inputFormat instanceof LlapWrappableInputFormatInterface;
  boolean isVectorized=Utilities.getUseVectorizedInputFileFormat(conf);
  if (!isSupported || !isVectorized) {
    LOG.info("Not using llap for " + inputFormat + ": supported = "+ isSupported+ ", vectorized = "+ isVectorized);
    return inputFormat;
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Wrapping " + inputFormat);
  }
  @SuppressWarnings("unchecked") LlapIo<VectorizedRowBatch> llapIo=LlapProxy.getIo();
  if (llapIo == null) {
    LOG.info("Not using LLAP IO because it is not initialized");
    return inputFormat;
  }
  return castInputFormat(llapIo.getInputFormat(inputFormat));
}
