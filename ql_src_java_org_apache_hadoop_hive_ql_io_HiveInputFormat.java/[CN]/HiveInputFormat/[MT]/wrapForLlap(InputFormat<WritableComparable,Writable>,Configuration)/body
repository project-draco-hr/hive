{
  if (!HiveConf.getBoolVar(conf,ConfVars.LLAP_ENABLED)) {
    return inputFormat;
  }
  boolean isSupported=inputFormat instanceof LlapWrappableInputFormatInterface, isVector=Utilities.isVectorMode(conf);
  if (!isSupported || !isVector) {
    LOG.info("Not using llap for " + inputFormat + ": "+ isSupported+ ", "+ isVector);
    return inputFormat;
  }
  LOG.info("Wrapping " + inputFormat);
  @SuppressWarnings("unchecked") LlapIo<VectorizedRowBatch> llapIo=LlapIoProxy.getOrCreateIo(conf);
  return castInputFormat(llapIo.getInputFormat(inputFormat));
}
