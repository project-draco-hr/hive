{
  if (!HiveConf.getBoolVar(conf,ConfVars.LLAP_IO_ENABLED)) {
    return inputFormat;
  }
  boolean isSupported=inputFormat instanceof LlapWrappableInputFormatInterface, isVector=Utilities.isVectorMode(conf);
  if (!isSupported || !isVector) {
    LOG.info("Not using llap for " + inputFormat + ": "+ isSupported+ ", "+ isVector);
    return inputFormat;
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Wrapping " + inputFormat);
  }
  @SuppressWarnings("unchecked") LlapIo<VectorizedRowBatch> llapIo=LlapProxy.getIo();
  if (llapIo == null) {
    LOG.info("Not using LLAP IO because it is not initialized");
    return inputFormat;
  }
  return castInputFormat(llapIo.getInputFormat(inputFormat));
}
