{
  if (inputFormats == null) {
    inputFormats=new HashMap<Class,InputFormat<WritableComparable,Writable>>();
  }
  if (!inputFormats.containsKey(inputFormatClass)) {
    try {
      InputFormat<WritableComparable,Writable> newInstance=(InputFormat<WritableComparable,Writable>)ReflectionUtils.newInstance(inputFormatClass,job);
      inputFormats.put(inputFormatClass,newInstance);
    }
 catch (    Exception e) {
      throw new IOException("Cannot create an instance of InputFormat class " + inputFormatClass.getName() + " as specified in mapredWork!",e);
    }
  }
  return inputFormats.get(inputFormatClass);
}
