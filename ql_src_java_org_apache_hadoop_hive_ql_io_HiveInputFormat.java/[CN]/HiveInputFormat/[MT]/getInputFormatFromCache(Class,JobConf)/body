{
  InputFormat<WritableComparable,Writable> instance=inputFormats.get(inputFormatClass);
  if (instance == null) {
    try {
      instance=(InputFormat<WritableComparable,Writable>)ReflectionUtils.newInstance(inputFormatClass,job);
      String inputFormatName=inputFormatClass.getName().toLowerCase();
      if (!inputFormatName.contains("hbase")) {
        inputFormats.put(inputFormatClass,instance);
      }
    }
 catch (    Exception e) {
      throw new IOException("Cannot create an instance of InputFormat class " + inputFormatClass.getName() + " as specified in mapredWork!",e);
    }
  }
  return instance;
}
