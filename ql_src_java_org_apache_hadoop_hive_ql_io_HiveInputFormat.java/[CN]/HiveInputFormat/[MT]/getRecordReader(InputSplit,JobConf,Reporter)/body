{
  HiveInputSplit hsplit=(HiveInputSplit)split;
  InputSplit inputSplit=hsplit.getInputSplit();
  String inputFormatClassName=null;
  Class inputFormatClass=null;
  try {
    inputFormatClassName=hsplit.inputFormatClassName();
    inputFormatClass=job.getClassByName(inputFormatClassName);
  }
 catch (  Exception e) {
    throw new IOException("cannot find class " + inputFormatClassName);
  }
  InputFormat inputFormat=getInputFormatFromCache(inputFormatClass,job);
  return new HiveRecordReader(inputFormat.getRecordReader(inputSplit,job,reporter));
}
