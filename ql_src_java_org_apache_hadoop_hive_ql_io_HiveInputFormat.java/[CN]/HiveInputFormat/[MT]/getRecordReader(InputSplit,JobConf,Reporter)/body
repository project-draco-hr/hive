{
  HiveInputSplit hsplit=(HiveInputSplit)split;
  InputSplit inputSplit=hsplit.getInputSplit();
  String inputFormatClassName=null;
  Class inputFormatClass=null;
  try {
    inputFormatClassName=hsplit.inputFormatClassName();
    inputFormatClass=job.getClassByName(inputFormatClassName);
  }
 catch (  Exception e) {
    throw new IOException("cannot find class " + inputFormatClassName);
  }
  JobConf cloneJobConf=new JobConf(job);
  initColumnsNeeded(cloneJobConf,inputFormatClass,hsplit.getPath().toString(),hsplit.getPath().toUri().getPath());
  InputFormat inputFormat=getInputFormatFromCache(inputFormatClass,cloneJobConf);
  Path[] paths=FileInputFormat.getInputPaths(job);
  PartitionDesc part=getPartitionDescFromPath(pathToPartitionInfo,paths[0]);
  Utilities.copyTableJobPropertiesToConf(part.getTableDesc(),cloneJobConf);
  return new HiveRecordReader(inputFormat.getRecordReader(inputSplit,cloneJobConf,reporter));
}
