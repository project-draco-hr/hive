{
  HiveInputSplit hsplit=(HiveInputSplit)split;
  InputSplit inputSplit=hsplit.getInputSplit();
  String inputFormatClassName=null;
  Class inputFormatClass=null;
  try {
    inputFormatClassName=hsplit.inputFormatClassName();
    inputFormatClass=job.getClassByName(inputFormatClassName);
  }
 catch (  Exception e) {
    throw new IOException("cannot find class " + inputFormatClassName,e);
  }
  if (this.mrwork == null || pathToPartitionInfo == null) {
    init(job);
  }
  boolean nonNative=false;
  PartitionDesc part=pathToPartitionInfo.get(hsplit.getPath().toString());
  if ((part != null) && (part.getTableDesc() != null)) {
    Utilities.copyTableJobPropertiesToConf(part.getTableDesc(),job);
    nonNative=part.getTableDesc().isNonNative();
  }
  pushProjectionsAndFilters(job,inputFormatClass,hsplit.getPath().toString(),hsplit.getPath().toUri().getPath(),nonNative);
  InputFormat inputFormat=getInputFormatFromCache(inputFormatClass,job);
  RecordReader innerReader=null;
  try {
    innerReader=inputFormat.getRecordReader(inputSplit,job,reporter);
  }
 catch (  Exception e) {
    innerReader=HiveIOExceptionHandlerUtil.handleRecordReaderCreationException(e,job);
  }
  HiveRecordReader<K,V> rr=new HiveRecordReader(innerReader,job);
  rr.initIOContext(hsplit,job,inputFormatClass,innerReader);
  return rr;
}
