{
  if (mrwork == null || pathToPartitionInfo == null) {
    if (HiveConf.getVar(job,HiveConf.ConfVars.HIVE_EXECUTION_ENGINE).equals("tez")) {
      mrwork=(MapWork)Utilities.getMergeWork(job);
      if (mrwork == null) {
        mrwork=Utilities.getMapWork(job);
      }
    }
 else {
      mrwork=Utilities.getMapWork(job);
    }
    if (HiveConf.getVar(job,HiveConf.ConfVars.HIVE_EXECUTION_ENGINE).equals("spark") && HiveConf.getBoolVar(job,HiveConf.ConfVars.SPARK_DYNAMIC_PARTITION_PRUNING)) {
      SparkDynamicPartitionPruner pruner=new SparkDynamicPartitionPruner();
      try {
        pruner.prune(mrwork,job);
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
    }
    pathToPartitionInfo=mrwork.getPathToPartitionInfo();
  }
}
