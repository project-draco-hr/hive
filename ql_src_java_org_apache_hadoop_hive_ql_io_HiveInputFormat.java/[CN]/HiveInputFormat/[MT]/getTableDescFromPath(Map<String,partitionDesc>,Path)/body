{
  partitionDesc partDesc=pathToPartitionInfo.get(dir.toString());
  if (partDesc == null) {
    partDesc=pathToPartitionInfo.get(dir.toUri().getPath());
  }
  if (partDesc == null) {
    throw new IOException("cannot find dir = " + dir.toString() + " in partToPartitionInfo!");
  }
  tableDesc table=partDesc.getTableDesc();
  if (table == null) {
    throw new IOException("Input " + dir.toString() + " does not have associated InputFormat in mapredWork!");
  }
  return table;
}
