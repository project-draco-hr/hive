{
  if (!dirty.isEmpty()) {
    commit();
  }
  txnMgr.shutdown();
  if (transactionsDisabled) {
    txnMgr.removeLogFile();
  }
  if (!inTxn.isEmpty()) {
    showList(inTxn.values().iterator());
    throw new Error("In transaction not empty");
  }
  if (!dirty.isEmpty()) {
    System.out.println("ERROR: dirty blocks at close time");
    showList(dirty.values().iterator());
    throw new Error("Dirty blocks at close time");
  }
  if (!inUse.isEmpty()) {
    System.out.println("ERROR: inUse blocks at close time");
    showList(inUse.values().iterator());
    throw new Error("inUse blocks at close time");
  }
  file.close();
  file=null;
}
