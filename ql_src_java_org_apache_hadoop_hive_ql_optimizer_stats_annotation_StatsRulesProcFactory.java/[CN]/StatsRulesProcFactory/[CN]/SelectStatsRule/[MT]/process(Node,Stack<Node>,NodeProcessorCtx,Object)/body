{
  SelectOperator sop=(SelectOperator)nd;
  Operator<? extends OperatorDesc> parent=sop.getParentOperators().get(0);
  Statistics parentStats=parent.getStatistics();
  AnnotateStatsProcCtx aspCtx=(AnnotateStatsProcCtx)procCtx;
  HiveConf conf=aspCtx.getConf();
  Statistics stats=null;
  if (parentStats != null) {
    try {
      stats=parentStats.clone();
    }
 catch (    CloneNotSupportedException e) {
      throw new SemanticException(ErrorMsg.STATISTICS_CLONING_FAILED.getMsg());
    }
  }
  try {
    if (satisfyPrecondition(parentStats)) {
      List<ColStatistics> colStats=StatsUtils.getColStatisticsFromExprMap(conf,parentStats,sop.getColumnExprMap(),sop.getSchema());
      stats.setColumnStats(colStats);
      if (!sop.getConf().isSelectStar() && !sop.getConf().isSelStarNoCompute()) {
        long dataSize=StatsUtils.getDataSizeFromColumnStats(stats.getNumRows(),colStats);
        stats.setDataSize(StatsUtils.getMaxIfOverflow(dataSize));
      }
      sop.setStatistics(stats);
      if (isDebugEnabled) {
        LOG.debug("[0] STATS-" + sop.toString() + ": "+ stats.extendedToString());
      }
    }
 else {
      if (parentStats != null) {
        sop.setStatistics(parentStats.clone());
        if (isDebugEnabled) {
          LOG.debug("[1] STATS-" + sop.toString() + ": "+ parentStats.extendedToString());
        }
      }
    }
  }
 catch (  CloneNotSupportedException e) {
    throw new SemanticException(ErrorMsg.STATISTICS_CLONING_FAILED.getMsg());
  }
  return null;
}
