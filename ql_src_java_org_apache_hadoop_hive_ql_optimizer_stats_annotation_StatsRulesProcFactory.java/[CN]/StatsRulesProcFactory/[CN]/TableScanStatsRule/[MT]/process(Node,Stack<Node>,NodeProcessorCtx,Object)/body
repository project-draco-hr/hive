{
  TableScanOperator tsop=(TableScanOperator)nd;
  AnnotateStatsProcCtx aspCtx=(AnnotateStatsProcCtx)procCtx;
  PrunedPartitionList partList=null;
  try {
    partList=aspCtx.getParseContext().getPrunedPartitions(tsop.getName(),tsop);
  }
 catch (  HiveException e1) {
    throw new SemanticException(e1);
  }
  Table table=aspCtx.getParseContext().getTopToTable().get(tsop);
  Statistics stats=StatsUtils.collectStatistics(aspCtx.getConf(),partList,table,tsop);
  try {
    tsop.setStatistics(stats.clone());
  }
 catch (  CloneNotSupportedException e) {
    throw new SemanticException(ErrorMsg.STATISTICS_CLONING_FAILED.getMsg());
  }
  return null;
}
