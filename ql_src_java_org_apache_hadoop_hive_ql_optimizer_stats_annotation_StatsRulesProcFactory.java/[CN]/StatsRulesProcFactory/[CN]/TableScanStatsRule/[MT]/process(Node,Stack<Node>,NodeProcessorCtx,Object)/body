{
  TableScanOperator tsop=(TableScanOperator)nd;
  AnnotateStatsProcCtx aspCtx=(AnnotateStatsProcCtx)procCtx;
  PrunedPartitionList partList=aspCtx.getParseContext().getPrunedPartitions(tsop.getName(),tsop);
  Table table=aspCtx.getParseContext().getTopToTable().get(tsop);
  try {
    Statistics stats=StatsUtils.collectStatistics(aspCtx.getConf(),partList,table,tsop);
    tsop.setStatistics(stats.clone());
    if (LOG.isDebugEnabled()) {
      LOG.debug("[0] STATS-" + tsop.toString() + ": "+ stats.extendedToString());
    }
  }
 catch (  CloneNotSupportedException e) {
    throw new SemanticException(ErrorMsg.STATISTICS_CLONING_FAILED.getMsg());
  }
catch (  HiveException e) {
    LOG.debug(e);
    throw new SemanticException(e);
  }
  return null;
}
