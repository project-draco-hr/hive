{
  if (fields == null || cachedRowInspector != rowInspector) {
    cachedRowInspector=(StructObjectInspector)rowInspector;
    fieldNames=expr.getColumn().split("\\.",-1);
    fields=new StructField[fieldNames.length];
    fieldsObjectInspector=new ObjectInspector[fieldNames.length];
    fields[0]=cachedRowInspector.getStructFieldRef(fieldNames[0]);
    fieldsObjectInspector[0]=fields[0].getFieldObjectInspector();
    for (int i=1; i < fieldNames.length; i++) {
      fields[i]=((StructObjectInspector)fieldsObjectInspector[i - 1]).getStructFieldRef(fieldNames[i]);
      fieldsObjectInspector[i]=fields[i].getFieldObjectInspector();
    }
  }
  return fieldsObjectInspector[fieldsObjectInspector.length - 1];
}
