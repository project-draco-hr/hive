{
  Deque<PTFInputDef> ptfChain=new ArrayDeque<PTFInputDef>();
  PTFInputDef currentDef=tblFnDef;
  while (currentDef != null) {
    ptfChain.push(currentDef);
    currentDef=currentDef.getInput();
  }
  while (!ptfChain.isEmpty()) {
    currentDef=ptfChain.pop();
    if (currentDef instanceof PTFQueryInputDef) {
      initialize((PTFQueryInputDef)currentDef,inputOI);
    }
 else     if (currentDef instanceof WindowTableFunctionDef) {
      initializeWindowing((WindowTableFunctionDef)currentDef);
    }
 else {
      initialize((PartitionedTableFunctionDef)currentDef);
    }
  }
}
