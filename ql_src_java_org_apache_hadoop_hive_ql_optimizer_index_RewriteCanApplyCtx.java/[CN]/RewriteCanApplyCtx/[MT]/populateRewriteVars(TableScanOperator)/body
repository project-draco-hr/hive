{
  Map<Rule,NodeProcessor> opRules=new LinkedHashMap<Rule,NodeProcessor>();
  opRules.put(new RuleRegExp("R1",TableScanOperator.getOperatorName() + "%[(" + SelectOperator.getOperatorName()+ "%)|("+ FilterOperator.getOperatorName()+ "%)]*"+ GroupByOperator.getOperatorName()+ "%["+ FilterOperator.getOperatorName()+ "%]*"+ ReduceSinkOperator.getOperatorName()+ "%["+ FilterOperator.getOperatorName()+ "%]*"+ GroupByOperator.getOperatorName()+ "%"),RewriteCanApplyProcFactory.canApplyOnTableScanOperator(topOp));
  Dispatcher disp=new DefaultRuleDispatcher(getDefaultProc(),opRules,this);
  GraphWalker ogw=new PreOrderWalker(disp);
  List<Node> topNodes=new ArrayList<Node>();
  topNodes.add(topOp);
  try {
    ogw.startWalking(topNodes,null);
  }
 catch (  SemanticException e) {
    LOG.error("Exception in walking operator tree. Rewrite variables not populated");
    LOG.error(org.apache.hadoop.util.StringUtils.stringifyException(e));
    throw new SemanticException(e.getMessage(),e);
  }
}
