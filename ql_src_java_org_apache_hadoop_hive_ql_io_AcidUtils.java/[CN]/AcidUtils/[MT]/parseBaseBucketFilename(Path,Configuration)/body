{
  AcidOutputFormat.Options result=new AcidOutputFormat.Options(conf);
  String filename=bucketFile.getName();
  result.writingBase(true);
  if (ORIGINAL_PATTERN.matcher(filename).matches()) {
    int bucket=Integer.parseInt(filename.substring(0,filename.indexOf('_')));
    result.setOldStyle(true).minimumTransactionId(0).maximumTransactionId(0).bucket(bucket);
  }
 else   if (filename.startsWith(BUCKET_PREFIX)) {
    int bucket=Integer.parseInt(filename.substring(filename.indexOf('_') + 1));
    result.setOldStyle(false).minimumTransactionId(0).maximumTransactionId(parseBase(bucketFile.getParent())).bucket(bucket);
  }
 else {
    result.setOldStyle(true).bucket(-1).minimumTransactionId(0).maximumTransactionId(0);
  }
  return result;
}
