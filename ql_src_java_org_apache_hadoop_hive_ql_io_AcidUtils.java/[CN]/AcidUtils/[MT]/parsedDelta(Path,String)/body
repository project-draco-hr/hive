{
  String filename=deltaDir.getName();
  boolean isDeleteDelta=deltaPrefix.equals(DELETE_DELTA_PREFIX);
  if (filename.startsWith(deltaPrefix)) {
    String rest=filename.substring(deltaPrefix.length());
    int split=rest.indexOf('_');
    int split2=rest.indexOf('_',split + 1);
    long min=Long.parseLong(rest.substring(0,split));
    long max=split2 == -1 ? Long.parseLong(rest.substring(split + 1)) : Long.parseLong(rest.substring(split + 1,split2));
    if (split2 == -1) {
      return new ParsedDelta(min,max,null,isDeleteDelta);
    }
    int statementId=Integer.parseInt(rest.substring(split2 + 1));
    return new ParsedDelta(min,max,null,statementId,isDeleteDelta);
  }
  throw new IllegalArgumentException(deltaDir + " does not start with " + deltaPrefix);
}
