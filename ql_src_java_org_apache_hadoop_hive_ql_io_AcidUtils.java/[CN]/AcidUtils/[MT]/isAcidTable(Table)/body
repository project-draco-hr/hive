{
  if (table == null) {
    return false;
  }
  String tableIsTransactional=table.getProperty(hive_metastoreConstants.TABLE_IS_TRANSACTIONAL);
  if (tableIsTransactional == null) {
    tableIsTransactional=table.getProperty(hive_metastoreConstants.TABLE_IS_TRANSACTIONAL.toUpperCase());
  }
  if (tableIsTransactional == null || !tableIsTransactional.equalsIgnoreCase("true")) {
    return false;
  }
  List<String> bucketCols=table.getBucketCols();
  if (bucketCols == null || bucketCols.isEmpty()) {
    return false;
  }
  Class<? extends InputFormat> inputFormatClass=table.getInputFormatClass();
  Class<? extends OutputFormat> outputFormatClass=table.getOutputFormatClass();
  if (inputFormatClass == null || outputFormatClass == null || !AcidInputFormat.class.isAssignableFrom(inputFormatClass) || !AcidOutputFormat.class.isAssignableFrom(outputFormatClass)) {
    return false;
  }
  return true;
}
