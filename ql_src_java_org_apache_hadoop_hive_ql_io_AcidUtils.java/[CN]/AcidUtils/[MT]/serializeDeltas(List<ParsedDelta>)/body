{
  List<AcidInputFormat.DeltaMetaData> result=new ArrayList<>(deltas.size());
  AcidInputFormat.DeltaMetaData last=null;
  for (  ParsedDelta parsedDelta : deltas) {
    if (last != null && last.getMinTxnId() == parsedDelta.getMinTransaction() && last.getMaxTxnId() == parsedDelta.getMaxTransaction()) {
      last.getStmtIds().add(parsedDelta.getStatementId());
      continue;
    }
    last=new AcidInputFormat.DeltaMetaData(parsedDelta.getMinTransaction(),parsedDelta.getMaxTransaction(),new ArrayList<Integer>());
    result.add(last);
    if (parsedDelta.statementId >= 0) {
      last.getStmtIds().add(parsedDelta.getStatementId());
    }
  }
  return result;
}
