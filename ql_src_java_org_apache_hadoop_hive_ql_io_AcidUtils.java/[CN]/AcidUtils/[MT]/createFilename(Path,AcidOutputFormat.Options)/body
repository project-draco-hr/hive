{
  String subdir;
  if (options.getOldStyle()) {
    return new Path(directory,String.format(LEGACY_FILE_BUCKET_DIGITS,options.getBucket()) + "_0");
  }
 else   if (options.isWritingBase()) {
    subdir=BASE_PREFIX + String.format(DELTA_DIGITS,options.getMaximumTransactionId());
  }
 else   if (options.getStatementId() == -1) {
    subdir=options.isWritingDeleteDelta() ? deleteDeltaSubdir(options.getMinimumTransactionId(),options.getMaximumTransactionId()) : deltaSubdir(options.getMinimumTransactionId(),options.getMaximumTransactionId());
  }
 else {
    subdir=options.isWritingDeleteDelta() ? deleteDeltaSubdir(options.getMinimumTransactionId(),options.getMaximumTransactionId(),options.getStatementId()) : deltaSubdir(options.getMinimumTransactionId(),options.getMaximumTransactionId(),options.getStatementId());
  }
  return createBucketFile(new Path(directory,subdir),options.getBucket());
}
