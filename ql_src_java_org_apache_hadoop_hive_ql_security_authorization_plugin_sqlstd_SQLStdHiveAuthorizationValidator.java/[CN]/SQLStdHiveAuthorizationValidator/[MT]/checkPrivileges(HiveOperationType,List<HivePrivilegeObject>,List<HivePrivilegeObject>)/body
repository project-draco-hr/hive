{
  if (LOG.isDebugEnabled()) {
    String msg="Checking privileges for operation " + hiveOpType + " by user "+ authenticator.getUserName()+ " on "+ " input objects "+ inputHObjs+ " and output objects "+ outputHObjs;
    LOG.debug(msg);
  }
  String userName=authenticator.getUserName();
  IMetaStoreClient metastoreClient=metastoreClientFactory.getHiveMetastoreClient();
  SQLPrivTypeGrant[] inputPrivs=Operation2Privilege.getInputPrivs(hiveOpType);
  checkPrivileges(inputPrivs,inputHObjs,metastoreClient,userName);
  SQLPrivTypeGrant[] outputPrivs=Operation2Privilege.getOutputPrivs(hiveOpType);
  checkPrivileges(outputPrivs,outputHObjs,metastoreClient,userName);
}
