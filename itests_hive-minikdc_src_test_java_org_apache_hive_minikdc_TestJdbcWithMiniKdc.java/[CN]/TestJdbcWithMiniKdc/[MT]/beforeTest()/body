{
  Class.forName(MiniHS2.getJdbcDriverName());
  confOverlay.put(ConfVars.HIVE_SERVER2_SESSION_HOOK.varname,SessionHookTest.class.getName());
  HiveConf hiveConf=new HiveConf();
  miniHiveKdc=MiniHiveKdc.getMiniHiveKdc(hiveConf);
  String hivePrincipal=miniHiveKdc.getFullyQualifiedServicePrincipal(MiniHiveKdc.HIVE_SERVICE_PRINCIPAL);
  String hiveKeytab=miniHiveKdc.getKeyTabFile(miniHiveKdc.getServicePrincipalForUser(MiniHiveKdc.HIVE_SERVICE_PRINCIPAL));
  miniHS2=new MiniHS2.Builder().withConf(new HiveConf()).withMiniKdc(hivePrincipal,hiveKeytab).build();
  miniHS2.start(confOverlay);
}
