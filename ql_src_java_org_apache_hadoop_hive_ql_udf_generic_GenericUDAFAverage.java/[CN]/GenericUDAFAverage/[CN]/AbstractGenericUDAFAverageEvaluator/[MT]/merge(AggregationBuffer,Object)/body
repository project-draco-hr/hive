{
  if (partial != null) {
    if (isWindowingDistinct()) {
      throw new HiveException("Distinct windowing UDAF doesn't support merge and terminatePartial");
    }
 else {
      doMerge((AverageAggregationBuffer<TYPE>)aggregation,countFieldOI.get(soi.getStructFieldData(partial,countField)),sumFieldOI,soi.getStructFieldData(partial,sumField));
    }
  }
}
