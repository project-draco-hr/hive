{
  int prec=inputOI.precision();
  int scale=inputOI.scale();
  if (mode == Mode.FINAL || mode == Mode.COMPLETE) {
    int intPart=prec - scale;
    scale=Math.min(scale + 4,HiveDecimal.MAX_SCALE - intPart);
    return TypeInfoFactory.getDecimalTypeInfo(intPart + scale,scale);
  }
 else {
    return GenericUDAFAverage.deriveSumFieldTypeInfo(prec,scale);
  }
}
