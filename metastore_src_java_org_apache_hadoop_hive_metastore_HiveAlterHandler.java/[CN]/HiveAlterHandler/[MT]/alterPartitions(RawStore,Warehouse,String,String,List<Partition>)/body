{
  List<Partition> oldParts=new ArrayList<Partition>();
  List<List<String>> partValsList=new ArrayList<List<String>>();
  try {
    for (    Partition tmpPart : new_parts) {
      if (tmpPart.getParameters() == null || tmpPart.getParameters().get(Constants.DDL_TIME) == null || Integer.parseInt(tmpPart.getParameters().get(Constants.DDL_TIME)) == 0) {
        tmpPart.putToParameters(Constants.DDL_TIME,Long.toString(System.currentTimeMillis() / 1000));
      }
      Partition oldTmpPart=msdb.getPartition(dbname,name,tmpPart.getValues());
      oldParts.add(oldTmpPart);
      partValsList.add(tmpPart.getValues());
    }
    msdb.alterPartitions(dbname,name,partValsList,new_parts);
  }
 catch (  InvalidObjectException e) {
    throw new InvalidOperationException("alter is not possible");
  }
catch (  NoSuchObjectException e) {
    throw new InvalidOperationException("alter is not possible");
  }
  return oldParts;
}
