{
  HiveSemanticAnalyzerHookContextImpl ctx=(HiveSemanticAnalyzerHookContextImpl)context;
  HiveConf conf=(HiveConf)ctx.getConf();
  String hiveInputFormat=conf.getVar(HiveConf.ConfVars.HIVEINPUTFORMAT);
  if (!hiveInputFormat.equals(COMBINE_HIVE_INPUT_FORMAT)) {
    return ast;
  }
  long mapredMinSplitSize=conf.getLongVar(HiveConf.ConfVars.MAPREDMINSPLITSIZE);
  conf.setLong(CONF_MAPRED_MIN_SPLIT_PER_NODE,mapredMinSplitSize);
  conf.setLong(CONF_MAPRED_MIN_SPLIT_PER_RACK,mapredMinSplitSize);
  long maxSplit=conf.getLong(CONF_MAPRED_MAX_SPLIT_SIZE,(long)-1);
  if (mapredMinSplitSize > maxSplit) {
    conf.setLong(CONF_MAPRED_MAX_SPLIT_SIZE,mapredMinSplitSize);
  }
  return ast;
}
