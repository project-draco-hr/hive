{
  if (task instanceof SparkTask) {
    SparkWork work=((SparkTask)task).getWork();
    List<BaseWork> all=work.getAllWork();
    for (    BaseWork w : all) {
      if (w instanceof MapWork) {
        MapWork mapWork=(MapWork)w;
        HashMap<String,Operator<? extends OperatorDesc>> opMap=mapWork.getAliasToWork();
        if (!opMap.isEmpty()) {
          for (          Operator<? extends OperatorDesc> op : opMap.values()) {
            setInputFormat(mapWork,op);
          }
        }
      }
    }
  }
 else   if (task instanceof ConditionalTask) {
    List<Task<? extends Serializable>> listTasks=((ConditionalTask)task).getListTasks();
    for (    Task<? extends Serializable> tsk : listTasks) {
      setInputFormat(tsk);
    }
  }
  if (task.getChildTasks() != null) {
    for (    Task<? extends Serializable> childTask : task.getChildTasks()) {
      setInputFormat(childTask);
    }
  }
}
