{
  PhysicalRowId free=null;
  PageCursor curs=new PageCursor(pageman,Magic.FREELOGIDS_PAGE);
  long freePage=0;
  while (curs.next() != 0) {
    freePage=curs.getCurrent();
    BlockIo curBlock=file.get(freePage);
    FreeLogicalRowIdPage fp=FreeLogicalRowIdPage.getFreeLogicalRowIdPageView(curBlock);
    int slot=fp.getFirstFree();
    if (slot != -1) {
      free=fp.alloc(slot);
      break;
    }
    file.release(curBlock);
  }
  if (free == null) {
    freePage=pageman.allocate(Magic.FREELOGIDS_PAGE);
    BlockIo curBlock=file.get(freePage);
    FreeLogicalRowIdPage fp=FreeLogicalRowIdPage.getFreeLogicalRowIdPageView(curBlock);
    free=fp.alloc(0);
  }
  free.setBlock(rowid.getBlock());
  free.setOffset(rowid.getOffset());
  file.release(freePage,true);
}
