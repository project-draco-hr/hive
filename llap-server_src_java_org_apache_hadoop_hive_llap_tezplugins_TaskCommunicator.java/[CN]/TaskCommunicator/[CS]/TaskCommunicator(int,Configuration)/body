{
  super(TaskCommunicator.class.getSimpleName());
  ExecutorService localExecutor=Executors.newFixedThreadPool(numThreads,new ThreadFactoryBuilder().setNameFormat("TaskCommunicator #%2d").build());
  this.hostProxies=new ConcurrentHashMap<>();
  executor=MoreExecutors.listeningDecorator(localExecutor);
  this.socketFactory=NetUtils.getDefaultSocketFactory(conf);
  long connectionTimeout=conf.getLong(LlapConfiguration.LLAP_TASK_COMMUNICATOR_CONNECTION_TIMEOUT_MILLIS,LlapConfiguration.LLAP_TASK_COMMUNICATOR_CONNECTION_TIMEOUT_MILLIS_DEFAULT);
  long retrySleep=conf.getLong(LlapConfiguration.LLAP_TASK_COMMUNICATOR_CONNECTION_SLEEP_BETWEEN_RETRIES_MILLIS,LlapConfiguration.LLAP_TASK_COMMUNICATOR_CONNECTION_SLEEP_BETWEEN_RETRIES_MILLIS_DEFAULT);
  this.retryPolicy=RetryPolicies.retryUpToMaximumTimeWithFixedSleep(connectionTimeout,retrySleep,TimeUnit.MILLISECONDS);
  LOG.info("Setting up taskCommunicator with" + "numThreads=" + numThreads + "retryTime(millis)="+ connectionTimeout+ "retrySleep(millis)="+ retrySleep);
}
