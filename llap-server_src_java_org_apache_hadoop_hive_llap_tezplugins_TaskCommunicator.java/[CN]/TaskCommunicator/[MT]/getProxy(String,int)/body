{
  String hostId=getHostIdentifier(hostname,port);
  LlapDaemonProtocolBlockingPB proxy=hostProxies.get(hostId);
  if (proxy == null) {
    proxy=new LlapDaemonProtocolClientImpl(getConfig(),hostname,port,retryPolicy,socketFactory);
    LlapDaemonProtocolBlockingPB proxyOld=hostProxies.putIfAbsent(hostId,proxy);
    if (proxyOld != null) {
      proxy=proxyOld;
    }
  }
  return proxy;
}
