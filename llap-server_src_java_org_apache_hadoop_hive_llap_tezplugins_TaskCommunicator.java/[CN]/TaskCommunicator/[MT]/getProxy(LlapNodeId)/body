{
  String hostId=getHostIdentifier(nodeId.getHostname(),nodeId.getPort());
  LlapDaemonProtocolBlockingPB proxy=hostProxies.get(hostId);
  if (proxy == null) {
    proxy=new LlapDaemonProtocolClientImpl(getConfig(),nodeId.getHostname(),nodeId.getPort(),retryPolicy,socketFactory);
    LlapDaemonProtocolBlockingPB proxyOld=hostProxies.putIfAbsent(hostId,proxy);
    if (proxyOld != null) {
      proxy=proxyOld;
    }
  }
  return proxy;
}
