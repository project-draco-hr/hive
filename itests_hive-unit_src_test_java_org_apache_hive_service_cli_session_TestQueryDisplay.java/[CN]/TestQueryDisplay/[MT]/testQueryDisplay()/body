{
  HiveSession session=sessionManager.createSession(new SessionHandle(TProtocolVersion.HIVE_CLI_SERVICE_PROTOCOL_V8),TProtocolVersion.HIVE_CLI_SERVICE_PROTOCOL_V8,"testuser","","",new HashMap<String,String>(),false,"");
  SessionState.start(conf);
  OperationHandle opHandle1=session.executeStatement("show databases",null);
  SessionState.start(conf);
  OperationHandle opHandle2=session.executeStatement("show tables",null);
  List<SQLOperationDisplay> liveSqlOperations, historicSqlOperations;
  liveSqlOperations=sessionManager.getOperationManager().getLiveSqlOperations();
  historicSqlOperations=sessionManager.getOperationManager().getHistoricalSQLOperations();
  Assert.assertEquals(liveSqlOperations.size(),2);
  Assert.assertEquals(historicSqlOperations.size(),0);
  verifyDDL(liveSqlOperations.get(0),"show databases",opHandle1.getHandleIdentifier().toString(),false);
  verifyDDL(liveSqlOperations.get(1),"show tables",opHandle2.getHandleIdentifier().toString(),false);
  session.closeOperation(opHandle1);
  liveSqlOperations=sessionManager.getOperationManager().getLiveSqlOperations();
  historicSqlOperations=sessionManager.getOperationManager().getHistoricalSQLOperations();
  Assert.assertEquals(liveSqlOperations.size(),1);
  Assert.assertEquals(historicSqlOperations.size(),1);
  verifyDDL(historicSqlOperations.get(0),"show databases",opHandle1.getHandleIdentifier().toString(),true);
  verifyDDL(liveSqlOperations.get(0),"show tables",opHandle2.getHandleIdentifier().toString(),false);
  session.closeOperation(opHandle2);
  liveSqlOperations=sessionManager.getOperationManager().getLiveSqlOperations();
  historicSqlOperations=sessionManager.getOperationManager().getHistoricalSQLOperations();
  Assert.assertEquals(liveSqlOperations.size(),0);
  Assert.assertEquals(historicSqlOperations.size(),2);
  verifyDDL(historicSqlOperations.get(1),"show databases",opHandle1.getHandleIdentifier().toString(),true);
  verifyDDL(historicSqlOperations.get(0),"show tables",opHandle2.getHandleIdentifier().toString(),true);
  session.close();
}
