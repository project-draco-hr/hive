{
  StorageDescriptor sd=table.getSd();
  if (sd.getBucketColsSize() < 1) {
    return false;
  }
  try {
    Class inputFormatClass=Class.forName(sd.getInputFormat());
    Class outputFormatClass=Class.forName(sd.getOutputFormat());
    if (inputFormatClass == null || outputFormatClass == null || !Class.forName("org.apache.hadoop.hive.ql.io.AcidInputFormat").isAssignableFrom(inputFormatClass) || !Class.forName("org.apache.hadoop.hive.ql.io.AcidOutputFormat").isAssignableFrom(outputFormatClass)) {
      return false;
    }
  }
 catch (  ClassNotFoundException e) {
    throw new MetaException("Invalid input/output format for table");
  }
  return true;
}
