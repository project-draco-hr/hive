{
  if (root.getOperator() == ExpressionTree.Operator.LEAF) {
    return new ExpressionTree(leafReorder[root.getLeaf()]);
  }
 else   if (root.getChildren() != null) {
    List<ExpressionTree> children=root.getChildren();
    for (int i=0; i < children.size(); ++i) {
      children.set(i,rewriteLeaves(children.get(i),leafReorder));
    }
  }
  return root;
}
