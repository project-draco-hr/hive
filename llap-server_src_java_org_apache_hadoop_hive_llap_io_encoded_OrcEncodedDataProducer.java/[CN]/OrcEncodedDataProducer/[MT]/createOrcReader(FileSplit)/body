{
  FileSystem fs=cachedFs;
  Path path=fileSplit.getPath();
  if ("pfile".equals(path.toUri().getScheme())) {
    fs=path.getFileSystem(conf);
  }
  if (metadataCache == null) {
    metadataCache=new OrcMetadataCache(cachedFs,path,conf);
  }
  return OrcFile.createReader(path,OrcFile.readerOptions(conf).filesystem(fs));
}
