{
  if (rel instanceof HiveJoinRel) {
    HiveJoinRel hjRel=(HiveJoinRel)rel;
    if (hjRel.isLeftSemiJoin()) {
      return RelMetadataQuery.getDistinctRowCount(hjRel.getLeft(),groupKey,rel.getCluster().getRexBuilder().makeLiteral(true));
    }
 else {
      return RelMdUtil.getJoinDistinctRowCount(rel,rel.getJoinType(),groupKey,predicate,true);
    }
  }
  return RelMetadataQuery.getDistinctRowCount(rel,groupKey,predicate);
}
