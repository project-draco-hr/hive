{
  Location retval=null;
  PageCursor curs=new PageCursor(_pageman,Magic.FREEPHYSIDS_PAGE);
  while (curs.next() != 0) {
    FreePhysicalRowIdPage fp=FreePhysicalRowIdPage.getFreePhysicalRowIdPageView(_file.get(curs.getCurrent()));
    int slot=fp.getFirstLargerThan(size);
    if (slot != -1) {
      retval=new Location(fp.get(slot));
      int slotsize=fp.get(slot).getSize();
      fp.free(slot);
      if (fp.getCount() == 0) {
        _file.release(curs.getCurrent(),false);
        _pageman.free(Magic.FREEPHYSIDS_PAGE,curs.getCurrent());
      }
 else {
        _file.release(curs.getCurrent(),true);
      }
      return retval;
    }
 else {
      _file.release(curs.getCurrent(),false);
    }
  }
  return null;
}
