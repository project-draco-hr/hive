{
  int maxPrefixLength=HiveConf.getIntVar(conf,HIVE_STATS_KEY_PREFIX_MAX_LENGTH);
  if (HiveConf.getVar(conf,HIVESTATSDBCLASS).equalsIgnoreCase(StatDB.counter.name())) {
    int groupNameMax=conf.getInt("mapreduce.job.counters.group.name.max",128);
    maxPrefixLength=maxPrefixLength < 0 ? groupNameMax : Math.min(maxPrefixLength,groupNameMax);
  }
  if (maxPrefixLength > 0) {
    int reserve=HiveConf.getIntVar(conf,HIVE_STATS_KEY_PREFIX_RESERVE_LENGTH);
    return reserve < 0 ? maxPrefixLength : maxPrefixLength - reserve;
  }
  return maxPrefixLength;
}
