{
  if (originalHs.size() != splits.length) {
    String s="Expected [";
    for (    FsWithHash fwh : originalHs) {
      s+=toString(fwh.fs) + ", ";
    }
    s+="], actual [";
    for (    InputSplit fs : splits) {
      s+=toString((FileSplit)fs) + ", ";
    }
    fail(s + "]");
  }
  for (int i=0; i < splits.length; ++i) {
    FileSplit fs=(FileSplit)splits[i];
    if (!originalHs.contains(new FsWithHash((FileSplit)splits[i]))) {
      String s=" in [";
      for (      FsWithHash fwh : originalHs) {
        s+=toString(fwh.fs) + ", ";
      }
      fail("Cannot find " + toString(fs) + s);
    }
  }
}
