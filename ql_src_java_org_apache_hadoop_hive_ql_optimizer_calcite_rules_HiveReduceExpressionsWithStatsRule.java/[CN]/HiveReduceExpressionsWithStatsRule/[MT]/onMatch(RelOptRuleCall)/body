{
  final Filter filter=call.rel(0);
  final RexBuilder rexBuilder=filter.getCluster().getRexBuilder();
  final RelMetadataQuery metadataProvider=RelMetadataQuery.instance();
  RexNode newFilterCondition=RexUtil.pullFactors(rexBuilder,filter.getCondition());
  RexReplacer replacer=new RexReplacer(filter,rexBuilder,metadataProvider);
  newFilterCondition=replacer.apply(newFilterCondition);
  if (!filter.getCondition().toString().equals(newFilterCondition.toString())) {
    Filter newFilter=filter.copy(filter.getTraitSet(),filter.getInput(),newFilterCondition);
    call.transformTo(newFilter);
  }
}
