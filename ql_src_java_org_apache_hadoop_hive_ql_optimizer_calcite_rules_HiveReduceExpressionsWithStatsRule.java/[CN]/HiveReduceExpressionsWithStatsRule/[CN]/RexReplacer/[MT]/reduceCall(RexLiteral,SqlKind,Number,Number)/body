{
  if (max != null && min != null) {
    BigDecimal maxVal=new BigDecimal(max.floatValue());
    BigDecimal minVal=new BigDecimal(min.floatValue());
    RexLiteral maxLiteral=rexBuilder.makeExactLiteral(maxVal,literal.getType());
    RexLiteral minLiteral=rexBuilder.makeExactLiteral(minVal,literal.getType());
    if (kind == SqlKind.EQUALS) {
      if (minLiteral.getValue().compareTo(literal.getValue()) > 0 || maxLiteral.getValue().compareTo(literal.getValue()) < 0) {
        return rexBuilder.makeLiteral(false);
      }
    }
    if (kind == SqlKind.GREATER_THAN) {
      if (minLiteral.getValue().compareTo(literal.getValue()) > 0) {
        return rexBuilder.makeLiteral(true);
      }
 else       if (maxLiteral.getValue().compareTo(literal.getValue()) <= 0) {
        return rexBuilder.makeLiteral(false);
      }
    }
 else     if (kind == SqlKind.GREATER_THAN_OR_EQUAL) {
      if (minLiteral.getValue().compareTo(literal.getValue()) >= 0) {
        return rexBuilder.makeLiteral(true);
      }
 else       if (maxLiteral.getValue().compareTo(literal.getValue()) < 0) {
        return rexBuilder.makeLiteral(false);
      }
    }
 else     if (kind == SqlKind.LESS_THAN) {
      if (minLiteral.getValue().compareTo(literal.getValue()) >= 0) {
        return rexBuilder.makeLiteral(false);
      }
 else       if (maxLiteral.getValue().compareTo(literal.getValue()) < 0) {
        return rexBuilder.makeLiteral(true);
      }
    }
 else     if (kind == SqlKind.LESS_THAN_OR_EQUAL) {
      if (minLiteral.getValue().compareTo(literal.getValue()) > 0) {
        return rexBuilder.makeLiteral(false);
      }
 else       if (maxLiteral.getValue().compareTo(literal.getValue()) <= 0) {
        return rexBuilder.makeLiteral(true);
      }
    }
  }
  return null;
}
