{
  if (hasDomain(user) || isDn(user)) {
    return Collections.singletonList(user);
  }
  String ldapDomain=conf.getVar(HiveConf.ConfVars.HIVE_SERVER2_PLAIN_LDAP_DOMAIN);
  if (StringUtils.isNotBlank(ldapDomain)) {
    return Collections.singletonList(user + "@" + ldapDomain);
  }
  List<String> userPatterns=parseDnPatterns(conf,HiveConf.ConfVars.HIVE_SERVER2_PLAIN_LDAP_USERDNPATTERN);
  if (userPatterns.isEmpty()) {
    return Collections.singletonList(user);
  }
  List<String> candidatePrincipals=new ArrayList<>();
  for (  String userPattern : userPatterns) {
    candidatePrincipals.add(userPattern.replaceAll("%s",user));
  }
  return candidatePrincipals;
}
