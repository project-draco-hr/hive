{
  runStatementOnDriver("set autocommit true");
  CommandProcessorResponse cpr=runStatementOnDriverNegative("start transaction");
  Assert.assertEquals("Error didn't match: " + cpr,ErrorMsg.OP_NOT_ALLOWED_IN_AUTOCOMMIT.getErrorCode(),cpr.getErrorCode());
  runStatementOnDriver("set autocommit false");
  runStatementOnDriver("start transaction");
  CommandProcessorResponse cpr2=runStatementOnDriverNegative("create table foo(x int, y int)");
  Assert.assertEquals("Expected DDL to fail in an open txn",ErrorMsg.OP_NOT_ALLOWED_IN_TXN.getErrorCode(),cpr2.getErrorCode());
  runStatementOnDriver("set autocommit true");
  CommandProcessorResponse cpr3=runStatementOnDriverNegative("update " + Table.ACIDTBL + " set a = 1 where b != 1");
  Assert.assertEquals("Expected update of bucket column to fail","FAILED: SemanticException [Error 10302]: Updating values of bucketing columns is not supported.  Column a.",cpr3.getErrorMessage());
  cpr3=runStatementOnDriverNegative("commit work");
  Assert.assertEquals("Error didn't match: " + cpr3,ErrorMsg.OP_NOT_ALLOWED_IN_AUTOCOMMIT.getErrorCode(),cpr.getErrorCode());
  cpr3=runStatementOnDriverNegative("rollback work");
  Assert.assertEquals("Error didn't match: " + cpr3,ErrorMsg.OP_NOT_ALLOWED_IN_AUTOCOMMIT.getErrorCode(),cpr.getErrorCode());
  runStatementOnDriver("set autocommit false");
  cpr3=runStatementOnDriverNegative("commit");
  Assert.assertEquals("Error didn't match: " + cpr3,ErrorMsg.OP_NOT_ALLOWED_IN_AUTOCOMMIT.getErrorCode(),cpr.getErrorCode());
  cpr3=runStatementOnDriverNegative("rollback");
  Assert.assertEquals("Error didn't match: " + cpr3,ErrorMsg.OP_NOT_ALLOWED_IN_AUTOCOMMIT.getErrorCode(),cpr.getErrorCode());
  runStatementOnDriver("start transaction");
  cpr3=runStatementOnDriverNegative("start transaction");
  Assert.assertEquals("Expected start transaction to fail",ErrorMsg.OP_NOT_ALLOWED_IN_TXN.getErrorCode(),cpr3.getErrorCode());
  runStatementOnDriver("start transaction");
  runStatementOnDriver("insert into " + Table.ACIDTBL + "(a,b) values(1,2)");
  List<String> rs0=runStatementOnDriver("select a,b from " + Table.ACIDTBL + " order by a,b");
  Assert.assertEquals("Can't see my own write",1,rs0.size());
  runStatementOnDriver("set autocommit true");
  rs0=runStatementOnDriver("select a,b from " + Table.ACIDTBL + " order by a,b");
  Assert.assertEquals("Can't see my own write",1,rs0.size());
}
