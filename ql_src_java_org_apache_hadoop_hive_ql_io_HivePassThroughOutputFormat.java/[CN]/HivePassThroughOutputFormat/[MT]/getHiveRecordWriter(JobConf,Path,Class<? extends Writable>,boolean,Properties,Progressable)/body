{
  if (this.initialized == false) {
    createActualOF();
  }
  if (this.actualOutputFormat instanceof HiveOutputFormat) {
    return ((HiveOutputFormat<K,V>)this.actualOutputFormat).getHiveRecordWriter(jc,finalOutPath,valueClass,isCompressed,tableProperties,progress);
  }
 else {
    FileSystem fs=finalOutPath.getFileSystem(jc);
    HivePassThroughRecordWriter hivepassthroughrecordwriter=new HivePassThroughRecordWriter(this.actualOutputFormat.getRecordWriter(fs,jc,null,progress));
    return hivepassthroughrecordwriter;
  }
}
