{
  if (actualOutputFormat instanceof HiveOutputFormat) {
    return ((HiveOutputFormat<K,V>)actualOutputFormat).getHiveRecordWriter(jc,finalOutPath,valueClass,isCompressed,tableProperties,progress);
  }
  FileSystem fs=finalOutPath.getFileSystem(jc);
  RecordWriter<?,?> recordWriter=actualOutputFormat.getRecordWriter(fs,jc,null,progress);
  return new HivePassThroughRecordWriter(recordWriter);
}
