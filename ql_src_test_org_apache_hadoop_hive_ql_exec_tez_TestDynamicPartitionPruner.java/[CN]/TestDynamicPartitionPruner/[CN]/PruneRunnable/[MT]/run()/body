{
  try {
    lock.lock();
    try {
      while (!started.get()) {
        startCondition.await();
      }
    }
  finally {
      lock.unlock();
    }
    pruner.prune();
    lock.lock();
    try {
      ended.set(true);
      endCondition.signal();
    }
  finally {
      lock.unlock();
    }
  }
 catch (  SerDeException|IOException|InterruptedException|HiveException e) {
    inError.set(true);
  }
}
