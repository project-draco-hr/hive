{
  LlapInputSplit llapSplit=(LlapInputSplit)split;
  String host=split.getLocations()[0];
  String id="foobar";
  HiveConf conf=new HiveConf();
  Socket socket=new Socket(host,conf.getIntVar(HiveConf.ConfVars.LLAP_DAEMON_OUTPUT_SERVICE_PORT));
  LOG.debug("Socket connected");
  socket.getOutputStream().write(id.getBytes());
  socket.getOutputStream().write(0);
  socket.getOutputStream().flush();
  LOG.debug("Registered id: " + id);
  return new LlapRecordReader(socket.getInputStream(),llapSplit.getSchema(),Text.class);
}
