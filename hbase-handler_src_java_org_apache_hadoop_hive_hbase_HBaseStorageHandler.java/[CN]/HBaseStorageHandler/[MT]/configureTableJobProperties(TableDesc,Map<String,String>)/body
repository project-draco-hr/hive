{
  Properties tableProperties=tableDesc.getProperties();
  jobProperties.put(HBaseSerDe.HBASE_COLUMNS_MAPPING,tableProperties.getProperty(HBaseSerDe.HBASE_COLUMNS_MAPPING));
  jobProperties.put(HBaseSerDe.HBASE_COLUMNS_REGEX_MATCHING,tableProperties.getProperty(HBaseSerDe.HBASE_COLUMNS_REGEX_MATCHING,"true"));
  jobProperties.put(HBaseSerDe.HBASE_TABLE_DEFAULT_STORAGE_TYPE,tableProperties.getProperty(HBaseSerDe.HBASE_TABLE_DEFAULT_STORAGE_TYPE,"string"));
  String scanCache=tableProperties.getProperty(HBaseSerDe.HBASE_SCAN_CACHE);
  if (scanCache != null) {
    jobProperties.put(HBaseSerDe.HBASE_SCAN_CACHE,scanCache);
  }
  String scanCacheBlocks=tableProperties.getProperty(HBaseSerDe.HBASE_SCAN_CACHEBLOCKS);
  if (scanCacheBlocks != null) {
    jobProperties.put(HBaseSerDe.HBASE_SCAN_CACHEBLOCKS,scanCacheBlocks);
  }
  String scanBatch=tableProperties.getProperty(HBaseSerDe.HBASE_SCAN_BATCH);
  if (scanBatch != null) {
    jobProperties.put(HBaseSerDe.HBASE_SCAN_BATCH,scanBatch);
  }
  String tableName=tableProperties.getProperty(HBaseSerDe.HBASE_TABLE_NAME);
  if (tableName == null) {
    tableName=tableProperties.getProperty(hive_metastoreConstants.META_TABLE_NAME);
    tableName=tableName.toLowerCase();
    if (tableName.startsWith(DEFAULT_PREFIX)) {
      tableName=tableName.substring(DEFAULT_PREFIX.length());
    }
  }
  jobProperties.put(HBaseSerDe.HBASE_TABLE_NAME,tableName);
  Configuration jobConf=getJobConf();
  addHBaseResources(jobConf,jobProperties);
  if (this.configureInputJobProps) {
    for (    String k : jobProperties.keySet()) {
      jobConf.set(k,jobProperties.get(k));
    }
    try {
      addHBaseDelegationToken(jobConf);
    }
 catch (    IOException e) {
      throw new IllegalStateException("Error while configuring input job properties",e);
    }
  }
 else {
    if (isHBaseGenerateHFiles(jobConf)) {
      String path=HiveHFileOutputFormat.getFamilyPath(jobConf,tableProperties);
      if (path == null || path.isEmpty()) {
        throw new RuntimeException("Please set " + HiveHFileOutputFormat.HFILE_FAMILY_PATH + " to target location for HFiles");
      }
      jobProperties.put("mapred.output.dir",path);
    }
 else {
      jobProperties.put(TableOutputFormat.OUTPUT_TABLE,tableName);
    }
  }
}
