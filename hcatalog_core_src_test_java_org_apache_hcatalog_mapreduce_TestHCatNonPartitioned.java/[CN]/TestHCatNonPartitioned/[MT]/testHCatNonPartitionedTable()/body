{
  Map<String,String> partitionMap=new HashMap<String,String>();
  runMRCreate(null,partitionColumns,writeRecords,10,true);
  IOException exc=null;
  try {
    runMRCreate(null,partitionColumns,writeRecords,20,true);
  }
 catch (  IOException e) {
    exc=e;
  }
  assertTrue(exc != null);
  assertTrue(exc instanceof HCatException);
  assertEquals(ErrorType.ERROR_NON_EMPTY_TABLE,((HCatException)exc).getErrorType());
  exc=null;
  partitionMap.clear();
  partitionMap.put("px","p1value2");
  try {
    runMRCreate(partitionMap,partitionColumns,writeRecords,20,true);
  }
 catch (  IOException e) {
    exc=e;
  }
  assertTrue(exc != null);
  assertTrue(exc instanceof HCatException);
  assertEquals(ErrorType.ERROR_INVALID_PARTITION_VALUES,((HCatException)exc).getErrorType());
  runMRRead(10);
  hiveReadTest();
}
