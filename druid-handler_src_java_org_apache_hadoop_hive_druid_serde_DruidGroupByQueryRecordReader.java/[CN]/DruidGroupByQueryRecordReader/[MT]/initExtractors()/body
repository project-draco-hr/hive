{
  extractors=new Extract[query.getAggregatorSpecs().size() + query.getPostAggregatorSpecs().size()];
  int counter=0;
  for (int i=0; i < query.getAggregatorSpecs().size(); i++, counter++) {
    AggregatorFactory af=query.getAggregatorSpecs().get(i);
switch (af.getTypeName().toUpperCase()) {
case DruidSerDeUtils.FLOAT_TYPE:
      extractors[counter]=Extract.FLOAT;
    break;
case DruidSerDeUtils.LONG_TYPE:
  extractors[counter]=Extract.LONG;
break;
default :
throw new IOException("Type not supported");
}
}
for (int i=0; i < query.getPostAggregatorSpecs().size(); i++, counter++) {
extractors[counter]=Extract.FLOAT;
}
}
