{
  Object ret=null;
  int retriesMade=0;
  TException caughtException=null;
  while (true) {
    try {
      reloginExpiringKeytabUser();
      if (retriesMade > 0) {
        base.reconnect();
      }
      if (metaCallTimeMap == null) {
        ret=method.invoke(base,args);
      }
 else {
        long startTime=System.currentTimeMillis();
        ret=method.invoke(base,args);
        long timeTaken=System.currentTimeMillis() - startTime;
        addMethodTime(method,timeTaken);
      }
      break;
    }
 catch (    UndeclaredThrowableException e) {
      throw e.getCause();
    }
catch (    InvocationTargetException e) {
      if ((e.getCause() instanceof TApplicationException) || (e.getCause() instanceof TProtocolException) || (e.getCause() instanceof TTransportException)) {
        caughtException=(TException)e.getCause();
      }
 else       if ((e.getCause() instanceof MetaException) && e.getCause().getMessage().matches("(?s).*(JDO[a-zA-Z]*|TApplication|TProtocol|TTransport)Exception.*")) {
        caughtException=(MetaException)e.getCause();
      }
 else {
        throw e.getCause();
      }
    }
catch (    MetaException e) {
      if (e.getMessage().matches("(?s).*(IO|TTransport)Exception.*"))       ;
      caughtException=e;
    }
    if (retriesMade >= retryLimit) {
      throw caughtException;
    }
    retriesMade++;
    LOG.warn("MetaStoreClient lost connection. Attempting to reconnect.",caughtException);
    Thread.sleep(retryDelaySeconds * 1000);
  }
  return ret;
}
