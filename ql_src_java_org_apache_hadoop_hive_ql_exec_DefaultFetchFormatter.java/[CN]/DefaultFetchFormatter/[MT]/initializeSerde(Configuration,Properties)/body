{
  String serdeName=HiveConf.getVar(conf,HiveConf.ConfVars.HIVEFETCHOUTPUTSERDE);
  Class<? extends SerDe> serdeClass=Class.forName(serdeName,true,JavaUtils.getClassLoader()).asSubclass(SerDe.class);
  SerDe serde=ReflectionUtils.newInstance(serdeClass,null);
  Properties serdeProps=new Properties();
  if (serde instanceof DelimitedJSONSerDe) {
    serdeProps.put(SERIALIZATION_FORMAT,props.getProperty(SERIALIZATION_FORMAT));
    serdeProps.put(SERIALIZATION_NULL_FORMAT,props.getProperty(SERIALIZATION_NULL_FORMAT));
  }
  serde.initialize(conf,serdeProps);
  return serde;
}
