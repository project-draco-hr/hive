{
  Type type=hcatFS.getType();
switch (type) {
case STRUCT:
    return ((Tuple)pigObj).getAll();
case ARRAY:
  DataBag pigBag=(DataBag)pigObj;
HCatFieldSchema tupFS=hcatFS.getArrayElementSchema().get(0);
boolean needTuple=tupFS.getType() == Type.STRUCT;
List<Object> bagContents=new ArrayList<Object>((int)pigBag.size());
Iterator<Tuple> bagItr=pigBag.iterator();
while (bagItr.hasNext()) {
bagContents.add(needTuple ? getJavaObj(bagItr.next(),tupFS) : bagItr.next().get(0));
}
return bagContents;
default :
return pigObj;
}
}
