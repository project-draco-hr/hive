{
switch (node.getKind()) {
case INPUT_REF:
    return new RelFieldCollation(((RexInputRef)node).getIndex(),direction,Util.first(nullDirection,direction.defaultNullDirection()));
case DESCENDING:
  return collation(((RexCall)node).getOperands().get(0),RelFieldCollation.Direction.DESCENDING,nullDirection,extraNodes);
case NULLS_FIRST:
return collation(((RexCall)node).getOperands().get(0),direction,RelFieldCollation.NullDirection.FIRST,extraNodes);
case NULLS_LAST:
return collation(((RexCall)node).getOperands().get(0),direction,RelFieldCollation.NullDirection.LAST,extraNodes);
default :
final int fieldIndex=extraNodes.size();
extraNodes.add(node);
return new RelFieldCollation(fieldIndex,direction,Util.first(nullDirection,direction.defaultNullDirection()));
}
}
