{
  try {
    metadataTag=in.readInt();
    MapJoinObjectCtx ctx=MapJoinOperator.getMapMetadata().get(Integer.valueOf(metadataTag));
    int sz=in.readInt();
    Vector<ArrayList<Object>> res=new Vector<ArrayList<Object>>();
    for (int pos=0; pos < sz; pos++) {
      ArrayList<Object> memObj=new ArrayList<Object>();
      val.readFields(in);
      StructObjectInspector objIns=(StructObjectInspector)ctx.getDeserObjInspector();
      LazyStruct lazyObj=(LazyStruct)(((LazyObject)ctx.getDeserializer().deserialize(val)).getObject());
      List<? extends StructField> listFields=objIns.getAllStructFieldRefs();
      for (      StructField fld : listFields) {
        memObj.add(objIns.getStructFieldData(lazyObj,fld));
      }
      res.add(memObj);
    }
    obj=res;
  }
 catch (  Exception e) {
    throw new IOException(e.getMessage());
  }
}
