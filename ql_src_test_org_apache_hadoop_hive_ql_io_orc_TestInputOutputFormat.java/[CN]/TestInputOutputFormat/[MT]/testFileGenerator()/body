{
  OrcInputFormat.Context context=new OrcInputFormat.Context(conf);
  MockFileSystem fs=new MockFileSystem(conf,new MockFile("mock:/a/b/part-00",1000,new byte[0]),new MockFile("mock:/a/b/part-01",1000,new byte[0]),new MockFile("mock:/a/b/_part-02",1000,new byte[0]),new MockFile("mock:/a/b/.part-03",1000,new byte[0]),new MockFile("mock:/a/b/part-04",1000,new byte[0]));
  OrcInputFormat.FileGenerator gen=new OrcInputFormat.FileGenerator(context,fs,new MockPath(fs,"mock:/a/b"));
  SplitStrategy splitStrategy=gen.call();
  assertEquals(true,splitStrategy instanceof OrcInputFormat.BISplitStrategy);
  conf.set("mapreduce.input.fileinputformat.split.maxsize","500");
  context=new OrcInputFormat.Context(conf);
  fs=new MockFileSystem(conf,new MockFile("mock:/a/b/part-00",1000,new byte[1000]),new MockFile("mock:/a/b/part-01",1000,new byte[1000]),new MockFile("mock:/a/b/_part-02",1000,new byte[1000]),new MockFile("mock:/a/b/.part-03",1000,new byte[1000]),new MockFile("mock:/a/b/part-04",1000,new byte[1000]));
  gen=new OrcInputFormat.FileGenerator(context,fs,new MockPath(fs,"mock:/a/b"));
  splitStrategy=gen.call();
  assertEquals(true,splitStrategy instanceof OrcInputFormat.ETLSplitStrategy);
}
