{
  Properties properties=new Properties();
  HiveOutputFormat<?,?> outFormat=new OrcOutputFormat();
  org.apache.hadoop.hive.ql.exec.FileSinkOperator.RecordWriter writer=outFormat.getHiveRecordWriter(conf,testFilePath,MyRow.class,true,properties,Reporter.NULL);
  writer.close(true);
  properties.setProperty("columns","x,y");
  properties.setProperty("columns.types","int:int");
  SerDe serde=new OrcSerde();
  SerDeUtils.initializeSerDe(serde,conf,properties,null);
  InputFormat<?,?> in=new OrcInputFormat();
  FileInputFormat.setInputPaths(conf,testFilePath.toString());
  InputSplit[] splits=in.getSplits(conf,1);
  assertTrue(0 == splits.length);
  assertEquals(null,serde.getSerDeStats());
}
