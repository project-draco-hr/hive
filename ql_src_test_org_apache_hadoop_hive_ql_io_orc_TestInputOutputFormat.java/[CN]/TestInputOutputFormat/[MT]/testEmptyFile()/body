{
  JobConf job=new JobConf(conf);
  Properties properties=new Properties();
  HiveOutputFormat<?,?> outFormat=new OrcOutputFormat();
  FileSinkOperator.RecordWriter writer=outFormat.getHiveRecordWriter(conf,testFilePath,MyRow.class,true,properties,Reporter.NULL);
  writer.close(true);
  properties.setProperty("columns","x,y");
  properties.setProperty("columns.types","int:int");
  SerDe serde=new OrcSerde();
  serde.initialize(conf,properties);
  InputFormat<?,?> in=new OrcInputFormat();
  FileInputFormat.setInputPaths(conf,testFilePath.toString());
  InputSplit[] splits=in.getSplits(conf,1);
  assertEquals(0,splits.length);
  assertEquals(null,serde.getSerDeStats());
}
