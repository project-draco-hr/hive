{
  Properties properties=new Properties();
  HiveOutputFormat<?,?> outFormat=new OrcOutputFormat();
  org.apache.hadoop.hive.ql.exec.FileSinkOperator.RecordWriter writer=outFormat.getHiveRecordWriter(conf,testFilePath,MyRow.class,true,properties,Reporter.NULL);
  writer.write(new OrcSerde().serialize(null,null));
  writer.close(true);
  InputFormat<?,?> in=new OrcInputFormat();
  fs.setPermission(testFilePath,FsPermission.createImmutable((short)0333));
  FileInputFormat.setInputPaths(conf,testFilePath.toString());
  try {
    in.getSplits(conf,1);
  }
 catch (  RuntimeException e) {
    assertEquals(true,e.getMessage().contains("Permission denied"));
    throw e;
  }
}
