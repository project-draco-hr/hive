{
  TezContext tezContext=(TezContext)MapredContext.get();
  Map<Integer,String> parentToInput=desc.getParentToInput();
  int hashTableThreshold=HiveConf.getIntVar(hconf,HiveConf.ConfVars.HIVEHASHTABLETHRESHOLD);
  float hashTableLoadFactor=HiveConf.getFloatVar(hconf,HiveConf.ConfVars.HIVEHASHTABLELOADFACTOR);
  boolean useLazyRows=HiveConf.getBoolVar(hconf,HiveConf.ConfVars.HIVEMAPJOINLAZYHASHTABLE);
  if (!HiveConf.getBoolVar(hconf,HiveConf.ConfVars.HIVEMAPJOINUSEOPTIMIZEDKEYS)) {
    lastKey=new MapJoinKeyObject();
  }
  Output output=new Output();
  for (int pos=0; pos < mapJoinTables.length; pos++) {
    if (pos == desc.getPosBigTable()) {
      continue;
    }
    LogicalInput input=tezContext.getInput(parentToInput.get(pos));
    try {
      KeyValueReader kvReader=(KeyValueReader)input.getReader();
      MapJoinTableContainer tableContainer=new HashMapWrapper(hashTableThreshold,hashTableLoadFactor);
      while (kvReader.next()) {
        lastKey=MapJoinKey.read(output,lastKey,mapJoinTableSerdes[pos].getKeyContext(),(Writable)kvReader.getCurrentKey(),false);
        LazyFlatRowContainer values=(LazyFlatRowContainer)tableContainer.get(lastKey);
        if (values == null) {
          values=new LazyFlatRowContainer();
          tableContainer.put(lastKey,values);
        }
        values.add(mapJoinTableSerdes[pos].getValueContext(),(BytesWritable)kvReader.getCurrentValue(),useLazyRows);
      }
      mapJoinTables[pos]=tableContainer;
    }
 catch (    IOException e) {
      throw new HiveException(e);
    }
catch (    SerDeException e) {
      throw new HiveException(e);
    }
catch (    Exception e) {
      throw new HiveException(e);
    }
  }
  if (lastKey == null) {
    lastKey=new MapJoinKeyObject();
  }
}
