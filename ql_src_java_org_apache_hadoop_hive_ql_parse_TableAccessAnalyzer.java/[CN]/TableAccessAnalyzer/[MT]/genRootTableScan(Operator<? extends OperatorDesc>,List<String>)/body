{
  Operator<? extends OperatorDesc> currOp=op;
  List<String> currColNames=keyNames;
  List<Operator<? extends OperatorDesc>> parentOps=null;
  while (true) {
    parentOps=currOp.getParentOperators();
    if ((parentOps == null) || (parentOps.isEmpty())) {
      return (TableScanOperator)currOp;
    }
    if (parentOps.size() > 1 || !(currOp.columnNamesRowResolvedCanBeObtained())) {
      return null;
    }
 else {
      if (!TableAccessAnalyzer.genColNameMap(currOp,currColNames)) {
        return null;
      }
      currOp=parentOps.get(0);
    }
  }
}
