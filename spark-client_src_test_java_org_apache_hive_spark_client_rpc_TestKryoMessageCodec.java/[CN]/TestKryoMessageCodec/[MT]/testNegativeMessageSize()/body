{
  KryoMessageCodec codec=new KryoMessageCodec(1024);
  ByteBuf buf=newBuffer();
  buf.writeInt(-1);
  try {
    List<Object> out=Lists.newArrayList();
    codec.decode(null,buf,out);
    fail("Should have failed to decode message with negative size.");
  }
 catch (  IllegalArgumentException e) {
    assertTrue(e.getMessage().indexOf("must be positive") > 0);
  }
}
