{
  ByteBuf buf=newBuffer();
  Object[] messages={"msg1","msg2"};
  int[] indices=new int[messages.length];
  KryoMessageCodec codec=new KryoMessageCodec(0);
  for (int i=0; i < messages.length; i++) {
    codec.encode(null,messages[i],buf);
    indices[i]=buf.writerIndex();
  }
  List<Object> objects=Lists.newArrayList();
  codec.decode(null,buf.slice(0,indices[0] - 1),objects);
  assertEquals(0,objects.size());
  codec.decode(null,buf.slice(0,indices[0] + 1),objects);
  assertEquals(1,objects.size());
}
