{
  long now=System.currentTimeMillis();
  String dbname="default";
  String tableName="statstable";
  String binarycol="bincol";
  long binMaxLen=123412987L;
  double binAvgLen=76.98;
  long binNulls=976998797L;
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=new ColumnStatisticsDesc();
  desc.setLastAnalyzed(now);
  desc.setDbName(dbname);
  desc.setTableName(tableName);
  desc.setIsTblLevel(true);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=new ColumnStatisticsObj();
  obj.setColName(binarycol);
  obj.setColType("binary");
  ColumnStatisticsData data=new ColumnStatisticsData();
  BinaryColumnStatsData binData=new BinaryColumnStatsData();
  binData.setMaxColLen(binMaxLen);
  binData.setAvgColLen(binAvgLen);
  binData.setNumNulls(binNulls);
  data.setBinaryStats(binData);
  obj.setStatsData(data);
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  stats=store.getTableColumnStatistics(dbname,tableName,Arrays.asList(binarycol));
  Assert.assertEquals(now,stats.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(dbname,stats.getStatsDesc().getDbName());
  Assert.assertEquals(tableName,stats.getStatsDesc().getTableName());
  Assert.assertTrue(stats.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,stats.getStatsObjSize());
  ColumnStatisticsData colData=obj.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.BINARY_STATS,colData.getSetField());
  binData=colData.getBinaryStats();
  Assert.assertEquals(binMaxLen,binData.getMaxColLen());
  Assert.assertEquals(binAvgLen,binData.getAvgColLen(),0.01);
  Assert.assertEquals(binNulls,binData.getNumNulls());
}
