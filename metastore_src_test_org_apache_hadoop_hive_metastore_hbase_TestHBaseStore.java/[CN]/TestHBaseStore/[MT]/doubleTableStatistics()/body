{
  long now=System.currentTimeMillis();
  String dbname="default";
  String tableName="statstable";
  String doublecol="doublecol";
  double doubleHigh=123423.23423;
  double doubleLow=0.00001234233;
  long doubleNulls=92;
  long doubleDVs=1234123421L;
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=new ColumnStatisticsDesc();
  desc.setLastAnalyzed(now);
  desc.setDbName(dbname);
  desc.setTableName(tableName);
  desc.setIsTblLevel(true);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=new ColumnStatisticsObj();
  obj.setColName(doublecol);
  obj.setColType("double");
  ColumnStatisticsData data=new ColumnStatisticsData();
  DoubleColumnStatsData doubleData=new DoubleColumnStatsData();
  doubleData.setHighValue(doubleHigh);
  doubleData.setLowValue(doubleLow);
  doubleData.setNumNulls(doubleNulls);
  doubleData.setNumDVs(doubleDVs);
  data.setDoubleStats(doubleData);
  obj.setStatsData(data);
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  stats=store.getTableColumnStatistics(dbname,tableName,Arrays.asList(doublecol));
  Assert.assertEquals(now,stats.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(dbname,stats.getStatsDesc().getDbName());
  Assert.assertEquals(tableName,stats.getStatsDesc().getTableName());
  Assert.assertTrue(stats.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,stats.getStatsObjSize());
  ColumnStatisticsData colData=obj.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.DOUBLE_STATS,colData.getSetField());
  doubleData=colData.getDoubleStats();
  Assert.assertEquals(doubleHigh,doubleData.getHighValue(),0.01);
  Assert.assertEquals(doubleLow,doubleData.getLowValue(),0.01);
  Assert.assertEquals(doubleNulls,doubleData.getNumNulls());
  Assert.assertEquals(doubleDVs,doubleData.getNumDVs());
}
