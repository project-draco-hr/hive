{
  long now=System.currentTimeMillis();
  String dbname="default";
  String tableName="statstable";
  String stringcol="stringcol";
  long strMaxLen=1234;
  double strAvgLen=32.3;
  long strNulls=987;
  long strDVs=906;
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=new ColumnStatisticsDesc();
  desc.setLastAnalyzed(now);
  desc.setDbName(dbname);
  desc.setTableName(tableName);
  desc.setIsTblLevel(true);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=new ColumnStatisticsObj();
  obj.setColName(stringcol);
  obj.setColType("string");
  ColumnStatisticsData data=new ColumnStatisticsData();
  StringColumnStatsData strData=new StringColumnStatsData();
  strData.setMaxColLen(strMaxLen);
  strData.setAvgColLen(strAvgLen);
  strData.setNumNulls(strNulls);
  strData.setNumDVs(strDVs);
  data.setStringStats(strData);
  obj.setStatsData(data);
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  stats=store.getTableColumnStatistics(dbname,tableName,Arrays.asList(stringcol));
  Assert.assertEquals(now,stats.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(dbname,stats.getStatsDesc().getDbName());
  Assert.assertEquals(tableName,stats.getStatsDesc().getTableName());
  Assert.assertTrue(stats.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,stats.getStatsObjSize());
  ColumnStatisticsData colData=obj.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.STRING_STATS,colData.getSetField());
  strData=colData.getStringStats();
  Assert.assertEquals(strMaxLen,strData.getMaxColLen());
  Assert.assertEquals(strAvgLen,strData.getAvgColLen(),0.01);
  Assert.assertEquals(strNulls,strData.getNumNulls());
  Assert.assertEquals(strDVs,strData.getNumDVs());
}
