{
  long now=System.currentTimeMillis();
  String dbname="default";
  String tableName="statstable";
  String longcol="longcol";
  long longHigh=120938479124L;
  long longLow=-12341243213412124L;
  long longNulls=23;
  long longDVs=213L;
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=new ColumnStatisticsDesc();
  desc.setLastAnalyzed(now);
  desc.setDbName(dbname);
  desc.setTableName(tableName);
  desc.setIsTblLevel(true);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=new ColumnStatisticsObj();
  obj.setColName(longcol);
  obj.setColType("long");
  ColumnStatisticsData data=new ColumnStatisticsData();
  LongColumnStatsData longData=new LongColumnStatsData();
  longData.setHighValue(longHigh);
  longData.setLowValue(longLow);
  longData.setNumNulls(longNulls);
  longData.setNumDVs(longDVs);
  data.setLongStats(longData);
  obj.setStatsData(data);
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  stats=store.getTableColumnStatistics(dbname,tableName,Arrays.asList(longcol));
  Assert.assertEquals(now,stats.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(dbname,stats.getStatsDesc().getDbName());
  Assert.assertEquals(tableName,stats.getStatsDesc().getTableName());
  Assert.assertTrue(stats.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,stats.getStatsObjSize());
  ColumnStatisticsData colData=obj.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.LONG_STATS,colData.getSetField());
  longData=colData.getLongStats();
  Assert.assertEquals(longHigh,longData.getHighValue());
  Assert.assertEquals(longLow,longData.getLowValue());
  Assert.assertEquals(longNulls,longData.getNumNulls());
  Assert.assertEquals(longDVs,longData.getNumDVs());
}
