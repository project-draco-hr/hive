{
  long now=System.currentTimeMillis();
  String dbname="default";
  String tableName="statstable";
  String decimalcol="deccol";
  Decimal decHigh=new Decimal();
  decHigh.setScale((short)3);
  decHigh.setUnscaled("3876".getBytes());
  Decimal decLow=new Decimal();
  decLow.setScale((short)3);
  decLow.setUnscaled("38".getBytes());
  long decNulls=13;
  long decDVs=923947293L;
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=new ColumnStatisticsDesc();
  desc.setLastAnalyzed(now);
  desc.setDbName(dbname);
  desc.setTableName(tableName);
  desc.setIsTblLevel(true);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=new ColumnStatisticsObj();
  obj.setColName(decimalcol);
  obj.setColType("decimal(5,3)");
  ColumnStatisticsData data=new ColumnStatisticsData();
  DecimalColumnStatsData decData=new DecimalColumnStatsData();
  decData.setHighValue(decHigh);
  decData.setLowValue(decLow);
  decData.setNumNulls(decNulls);
  decData.setNumDVs(decDVs);
  data.setDecimalStats(decData);
  obj.setStatsData(data);
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  stats=store.getTableColumnStatistics(dbname,tableName,Arrays.asList(decimalcol));
  Assert.assertEquals(now,stats.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(dbname,stats.getStatsDesc().getDbName());
  Assert.assertEquals(tableName,stats.getStatsDesc().getTableName());
  Assert.assertTrue(stats.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,stats.getStatsObjSize());
  ColumnStatisticsData colData=obj.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.DECIMAL_STATS,colData.getSetField());
  decData=colData.getDecimalStats();
  Assert.assertEquals(decHigh,decData.getHighValue());
  Assert.assertEquals(decLow,decData.getLowValue());
  Assert.assertEquals(decNulls,decData.getNumNulls());
  Assert.assertEquals(decDVs,decData.getNumDVs());
}
