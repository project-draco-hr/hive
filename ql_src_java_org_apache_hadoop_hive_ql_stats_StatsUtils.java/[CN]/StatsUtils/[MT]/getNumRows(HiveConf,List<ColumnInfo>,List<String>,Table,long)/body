{
  long nr=getNumRows(table);
  if (nr <= 0) {
    int avgRowSize=estimateRowSizeFromSchema(conf,schema,neededColumns);
    if (avgRowSize > 0) {
      if (LOG.isDebugEnabled()) {
        LOG.debug("Estimated average row size: " + avgRowSize);
      }
      nr=ds / avgRowSize;
    }
  }
  return nr == 0 ? 1 : nr;
}
