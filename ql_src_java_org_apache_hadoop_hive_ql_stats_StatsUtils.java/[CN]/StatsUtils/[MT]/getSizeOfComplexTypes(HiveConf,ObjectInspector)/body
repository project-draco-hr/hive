{
  long result=0;
  int length=0;
  int listEntries=HiveConf.getIntVar(conf,HiveConf.ConfVars.HIVE_STATS_LIST_NUM_ENTRIES);
  int mapEntries=HiveConf.getIntVar(conf,HiveConf.ConfVars.HIVE_STATS_MAP_NUM_ENTRIES);
switch (oi.getCategory()) {
case PRIMITIVE:
    String colType=oi.getTypeName();
  if (colType.equalsIgnoreCase(serdeConstants.STRING_TYPE_NAME) || colType.startsWith(serdeConstants.VARCHAR_TYPE_NAME) || colType.startsWith(serdeConstants.CHAR_TYPE_NAME)) {
    int avgColLen=(int)getAvgColLenOfVariableLengthTypes(conf,oi,colType);
    result+=JavaDataModel.get().lengthForStringOfLength(avgColLen);
  }
 else   if (colType.equalsIgnoreCase(serdeConstants.BINARY_TYPE_NAME)) {
    int avgColLen=(int)getAvgColLenOfVariableLengthTypes(conf,oi,colType);
    result+=JavaDataModel.get().lengthForByteArrayOfSize(avgColLen);
  }
 else {
    result+=getAvgColLenOfFixedLengthTypes(colType);
  }
break;
case LIST:
if (oi instanceof StandardConstantListObjectInspector) {
StandardConstantListObjectInspector scloi=(StandardConstantListObjectInspector)oi;
length=scloi.getWritableConstantValue().size();
ObjectInspector leoi=scloi.getListElementObjectInspector();
if (leoi.getCategory().equals(ObjectInspector.Category.PRIMITIVE)) {
  result+=getSizeOfPrimitiveTypeArraysFromType(leoi.getTypeName(),length);
}
 else {
  result+=JavaDataModel.get().lengthForObjectArrayOfSize(length);
}
}
 else {
StandardListObjectInspector sloi=(StandardListObjectInspector)oi;
long elemSize=getSizeOfComplexTypes(conf,sloi.getListElementObjectInspector());
result+=JavaDataModel.get().arrayList() + (listEntries * elemSize);
}
break;
case MAP:
if (oi instanceof StandardConstantMapObjectInspector) {
StandardConstantMapObjectInspector scmoi=(StandardConstantMapObjectInspector)oi;
result+=getSizeOfMap(scmoi);
}
 else {
StandardMapObjectInspector smoi=(StandardMapObjectInspector)oi;
result+=getSizeOfComplexTypes(conf,smoi.getMapKeyObjectInspector());
result+=getSizeOfComplexTypes(conf,smoi.getMapValueObjectInspector());
result+=JavaDataModel.get().hashMap(mapEntries);
}
break;
case STRUCT:
StructObjectInspector soi=(StructObjectInspector)oi;
result+=JavaDataModel.get().object();
result+=soi.getAllStructFieldRefs().size() * JavaDataModel.get().ref();
for (StructField field : soi.getAllStructFieldRefs()) {
result+=getSizeOfComplexTypes(conf,field.getFieldObjectInspector());
}
break;
case UNION:
UnionObjectInspector uoi=(UnionObjectInspector)oi;
result+=JavaDataModel.get().object();
result+=uoi.getObjectInspectors().size() * JavaDataModel.get().primitive1();
for (ObjectInspector foi : uoi.getObjectInspectors()) {
result+=getSizeOfComplexTypes(conf,foi);
}
break;
default :
break;
}
return result;
}
