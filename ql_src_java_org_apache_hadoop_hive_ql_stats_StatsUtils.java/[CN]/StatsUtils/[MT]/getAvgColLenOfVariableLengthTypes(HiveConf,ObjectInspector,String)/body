{
  long configVarLen=HiveConf.getIntVar(conf,HiveConf.ConfVars.HIVE_STATS_MAX_VARIABLE_LENGTH);
  if (colType.equalsIgnoreCase(serdeConstants.STRING_TYPE_NAME)) {
    if (oi instanceof ConstantObjectInspector) {
      ConstantObjectInspector coi=(ConstantObjectInspector)oi;
      Object constantValue=coi.getWritableConstantValue();
      return constantValue == null ? 0 : constantValue.toString().length();
    }
 else     if (oi instanceof StringObjectInspector) {
      return configVarLen;
    }
  }
 else   if (colType.startsWith(serdeConstants.VARCHAR_TYPE_NAME)) {
    if (oi instanceof ConstantObjectInspector) {
      ConstantObjectInspector coi=(ConstantObjectInspector)oi;
      Object constantValue=coi.getWritableConstantValue();
      return constantValue == null ? 0 : constantValue.toString().length();
    }
 else     if (oi instanceof HiveVarcharObjectInspector) {
      VarcharTypeInfo type=(VarcharTypeInfo)((HiveVarcharObjectInspector)oi).getTypeInfo();
      return type.getLength();
    }
  }
 else   if (colType.startsWith(serdeConstants.CHAR_TYPE_NAME)) {
    if (oi instanceof ConstantObjectInspector) {
      ConstantObjectInspector coi=(ConstantObjectInspector)oi;
      Object constantValue=coi.getWritableConstantValue();
      return constantValue == null ? 0 : constantValue.toString().length();
    }
 else     if (oi instanceof HiveCharObjectInspector) {
      CharTypeInfo type=(CharTypeInfo)((HiveCharObjectInspector)oi).getTypeInfo();
      return type.getLength();
    }
  }
 else   if (colType.equalsIgnoreCase(serdeConstants.BINARY_TYPE_NAME)) {
    if (oi instanceof ConstantObjectInspector) {
      ConstantObjectInspector coi=(ConstantObjectInspector)oi;
      BytesWritable constantValue=(BytesWritable)coi.getWritableConstantValue();
      return constantValue == null ? 0 : constantValue.getLength();
    }
 else     if (oi instanceof BinaryObjectInspector) {
      return configVarLen;
    }
  }
 else {
    return getSizeOfComplexTypes(conf,oi);
  }
  return 0;
}
