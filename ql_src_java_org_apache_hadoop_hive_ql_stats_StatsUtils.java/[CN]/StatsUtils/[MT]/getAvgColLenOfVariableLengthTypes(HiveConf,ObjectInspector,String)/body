{
  long configVarLen=HiveConf.getIntVar(conf,HiveConf.ConfVars.HIVE_STATS_MAX_VARIABLE_LENGTH);
  if (colType.equalsIgnoreCase(serdeConstants.STRING_TYPE_NAME)) {
    if (oi instanceof ConstantObjectInspector) {
      ConstantObjectInspector coi=(ConstantObjectInspector)oi;
      if (coi.getWritableConstantValue() == null) {
        return 0;
      }
      return coi.getWritableConstantValue().toString().length();
    }
 else     if (oi instanceof WritableConstantStringObjectInspector) {
      WritableConstantStringObjectInspector wcsoi=(WritableConstantStringObjectInspector)oi;
      return wcsoi.getWritableConstantValue().toString().length();
    }
 else     if (oi instanceof WritableStringObjectInspector) {
      return configVarLen;
    }
  }
 else   if (colType.startsWith(serdeConstants.VARCHAR_TYPE_NAME)) {
    if (oi instanceof ConstantObjectInspector) {
      ConstantObjectInspector coi=(ConstantObjectInspector)oi;
      if (coi.getWritableConstantValue() == null) {
        return 0;
      }
      return coi.getWritableConstantValue().toString().length();
    }
 else     if (oi instanceof WritableConstantHiveVarcharObjectInspector) {
      WritableConstantHiveVarcharObjectInspector wcsoi=(WritableConstantHiveVarcharObjectInspector)oi;
      return wcsoi.getWritableConstantValue().toString().length();
    }
 else     if (oi instanceof WritableHiveVarcharObjectInspector) {
      return ((WritableHiveVarcharObjectInspector)oi).getMaxLength();
    }
  }
 else   if (colType.startsWith(serdeConstants.CHAR_TYPE_NAME)) {
    if (oi instanceof ConstantObjectInspector) {
      ConstantObjectInspector coi=(ConstantObjectInspector)oi;
      if (coi.getWritableConstantValue() == null) {
        return 0;
      }
      return coi.getWritableConstantValue().toString().length();
    }
 else     if (oi instanceof WritableConstantHiveCharObjectInspector) {
      WritableConstantHiveCharObjectInspector wcsoi=(WritableConstantHiveCharObjectInspector)oi;
      return wcsoi.getWritableConstantValue().toString().length();
    }
 else     if (oi instanceof WritableHiveCharObjectInspector) {
      return ((WritableHiveCharObjectInspector)oi).getMaxLength();
    }
  }
 else   if (colType.equalsIgnoreCase(serdeConstants.BINARY_TYPE_NAME)) {
    if (oi instanceof ConstantObjectInspector) {
      ConstantObjectInspector coi=(ConstantObjectInspector)oi;
      if (coi.getWritableConstantValue() == null) {
        return 0;
      }
      BytesWritable bw=((BytesWritable)coi.getWritableConstantValue());
      return bw.getLength();
    }
 else     if (oi instanceof WritableConstantBinaryObjectInspector) {
      WritableConstantBinaryObjectInspector wcboi=(WritableConstantBinaryObjectInspector)oi;
      return wcboi.getWritableConstantValue().getLength();
    }
 else     if (oi instanceof WritableBinaryObjectInspector) {
      return configVarLen;
    }
  }
 else {
    return getSizeOfComplexTypes(conf,oi);
  }
  return 0;
}
