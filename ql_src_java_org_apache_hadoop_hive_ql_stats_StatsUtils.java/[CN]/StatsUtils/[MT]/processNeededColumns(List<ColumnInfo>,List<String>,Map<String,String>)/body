{
  for (  ColumnInfo col : schema) {
    if (col.isHiddenVirtualCol())     continue;
    colToTabAlias.put(col.getInternalName(),col.getTabAlias());
  }
  List<String> neededColsInTable=null;
  int limit=neededColumns.size();
  for (int i=0; i < limit; ++i) {
    if (colToTabAlias.containsKey(neededColumns.get(i)))     continue;
    if (neededColsInTable == null) {
      neededColsInTable=Lists.newArrayList(neededColumns);
    }
    neededColsInTable.remove(i--);
    --limit;
  }
  return (neededColsInTable == null) ? neededColumns : neededColsInTable;
}
