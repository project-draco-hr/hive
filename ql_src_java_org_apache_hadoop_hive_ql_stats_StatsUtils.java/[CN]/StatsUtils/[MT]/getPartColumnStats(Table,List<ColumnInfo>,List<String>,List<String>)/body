{
  String dbName=table.getDbName();
  String tabName=table.getTableName();
  Map<String,String> colToTabAlias=new HashMap<String,String>(schema.size());
  List<String> neededColsInTable=processNeededColumns(schema,neededColumns,colToTabAlias);
  Map<String,List<ColStatistics>> stats=null;
  try {
    Map<String,List<ColumnStatisticsObj>> colStat=Hive.get().getPartitionColumnStatistics(dbName,tabName,partNames,neededColsInTable);
    stats=new HashMap<String,List<ColStatistics>>(colStat.size());
    for (    Map.Entry<String,List<ColumnStatisticsObj>> entry : colStat.entrySet()) {
      List<ColStatistics> partStat=new ArrayList<ColStatistics>(entry.getValue().size());
      for (      ColumnStatisticsObj statObj : entry.getValue()) {
        ColStatistics cs=getColStatistics(statObj,tabName,statObj.getColName());
        cs.setTableAlias(colToTabAlias.get(cs.getColumnName()));
        partStat.add(cs);
      }
      stats.put(entry.getKey(),partStat);
    }
  }
 catch (  HiveException e) {
    LOG.error("Failed to retrieve partitions statistics: ",e);
    stats=null;
  }
  return stats;
}
