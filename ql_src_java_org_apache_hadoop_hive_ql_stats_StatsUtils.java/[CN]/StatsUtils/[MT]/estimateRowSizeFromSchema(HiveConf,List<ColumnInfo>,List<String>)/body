{
  int avgRowSize=0;
  for (  String neededCol : neededColumns) {
    ColumnInfo ci=getColumnInfoForColumn(neededCol,schema);
    if (ci == null) {
      continue;
    }
    ObjectInspector oi=ci.getObjectInspector();
    String colTypeLowerCase=ci.getTypeName().toLowerCase();
    if (colTypeLowerCase.equals(serdeConstants.STRING_TYPE_NAME) || colTypeLowerCase.equals(serdeConstants.BINARY_TYPE_NAME) || colTypeLowerCase.startsWith(serdeConstants.VARCHAR_TYPE_NAME)|| colTypeLowerCase.startsWith(serdeConstants.CHAR_TYPE_NAME)|| colTypeLowerCase.startsWith(serdeConstants.LIST_TYPE_NAME)|| colTypeLowerCase.startsWith(serdeConstants.MAP_TYPE_NAME)|| colTypeLowerCase.startsWith(serdeConstants.STRUCT_TYPE_NAME)|| colTypeLowerCase.startsWith(serdeConstants.UNION_TYPE_NAME)) {
      avgRowSize+=getAvgColLenOfVariableLengthTypes(conf,oi,colTypeLowerCase);
    }
 else {
      avgRowSize+=getAvgColLenOfFixedLengthTypes(colTypeLowerCase);
    }
  }
  return avgRowSize;
}
