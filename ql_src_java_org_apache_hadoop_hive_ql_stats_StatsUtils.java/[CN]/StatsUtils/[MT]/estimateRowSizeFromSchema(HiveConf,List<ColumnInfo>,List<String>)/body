{
  int avgRowSize=0;
  for (  String neededCol : neededColumns) {
    ColumnInfo ci=getColumnInfoForColumn(neededCol,schema);
    ObjectInspector oi=ci.getObjectInspector();
    String colType=ci.getTypeName();
    if (colType.equalsIgnoreCase(serdeConstants.STRING_TYPE_NAME) || colType.equalsIgnoreCase(serdeConstants.BINARY_TYPE_NAME) || colType.startsWith(serdeConstants.VARCHAR_TYPE_NAME)|| colType.startsWith(serdeConstants.CHAR_TYPE_NAME)|| colType.startsWith(serdeConstants.LIST_TYPE_NAME)|| colType.startsWith(serdeConstants.MAP_TYPE_NAME)|| colType.startsWith(serdeConstants.STRUCT_TYPE_NAME)|| colType.startsWith(serdeConstants.UNION_TYPE_NAME)) {
      avgRowSize+=getAvgColLenOfVariableLengthTypes(conf,oi,colType);
    }
 else {
      avgRowSize+=getAvgColLenOfFixedLengthTypes(colType);
    }
  }
  return avgRowSize;
}
