{
  if (!counter && partition == null) {
    return work.getAggKey();
  }
  StringBuilder prefix=new StringBuilder();
  if (counter) {
    prefix.append(table.getDbName()).append('.').append(table.getTableName());
  }
 else {
    prefix.append(work.getAggKey());
  }
  if (partition != null) {
    return Utilities.join(prefix.toString(),Warehouse.makePartPath(partition.getSpec()));
  }
  return prefix.toString();
}
