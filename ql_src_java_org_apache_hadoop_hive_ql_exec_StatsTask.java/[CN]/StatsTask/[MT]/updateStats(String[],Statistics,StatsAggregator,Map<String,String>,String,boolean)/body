{
  String value;
  Long longValue;
  for (  String statType : statsList) {
    value=statsAggregator.aggregateStats(aggKey,statType);
    if (value != null) {
      longValue=Long.parseLong(value);
      if (work.getLoadTableDesc() != null && !work.getLoadTableDesc().getReplace()) {
        String originalValue=parameters.get(statType);
        if (originalValue != null) {
          longValue+=Long.parseLong(originalValue);
        }
      }
      stats.setStat(statType,longValue);
    }
 else {
      if (atomic) {
        throw new HiveException("StatsAggregator failed to get statistics.");
      }
    }
  }
}
