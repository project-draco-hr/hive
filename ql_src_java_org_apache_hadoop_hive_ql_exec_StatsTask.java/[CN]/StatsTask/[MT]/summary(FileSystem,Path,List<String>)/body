{
  long numFiles=0L;
  long tableSize=0L;
  Pattern pattern=toPattern(skewCols);
  for (  FileStatus status : Utilities.getFileStatusRecurse(path,skewCols.size() + 1,fs)) {
    if (status.isDir()) {
      continue;
    }
    String relative=toRelativePath(path,status.getPath());
    if (relative == null) {
      continue;
    }
    if (relative.startsWith(ListBucketingPrunerUtils.HIVE_LIST_BUCKETING_DEFAULT_DIR_NAME) || pattern.matcher(relative).matches()) {
      tableSize+=status.getLen();
      numFiles++;
    }
  }
  return new long[]{numFiles,tableSize};
}
