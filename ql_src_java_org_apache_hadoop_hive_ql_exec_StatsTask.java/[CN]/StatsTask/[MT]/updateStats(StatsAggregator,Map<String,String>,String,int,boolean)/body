{
  String aggKey=Utilities.getHashedStatsPrefix(prefix,maxPrefixLength);
  for (  String statType : StatsSetupConst.statsRequireCompute) {
    String value=statsAggregator.aggregateStats(aggKey,statType);
    if (value != null && !value.isEmpty()) {
      long longValue=Long.parseLong(value);
      if (work.getLoadTableDesc() != null && !work.getLoadTableDesc().getReplace()) {
        String originalValue=parameters.get(statType);
        if (originalValue != null && !originalValue.equals("-1")) {
          longValue+=Long.parseLong(originalValue);
        }
      }
      parameters.put(statType,String.valueOf(longValue));
    }
 else {
      if (atomic) {
        throw new HiveException(ErrorMsg.STATSAGGREGATOR_MISSED_SOMESTATS,statType);
      }
    }
  }
}
