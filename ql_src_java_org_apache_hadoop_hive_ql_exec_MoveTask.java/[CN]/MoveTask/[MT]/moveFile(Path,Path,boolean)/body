{
  FileSystem fs=sourcePath.getFileSystem(conf);
  if (isDfsDir) {
    String mesg="Moving data to: " + targetPath.toString();
    String mesg_detail=" from " + sourcePath.toString();
    console.printInfo(mesg,mesg_detail);
    fs.delete(targetPath,true);
    if (fs.exists(sourcePath)) {
      Path deletePath=null;
      if (HiveConf.getBoolVar(conf,HiveConf.ConfVars.HIVE_INSERT_INTO_MULTILEVEL_DIRS)) {
        deletePath=createTargetPath(targetPath,fs);
      }
      if (!fs.rename(sourcePath,targetPath)) {
        try {
          if (deletePath != null) {
            fs.delete(deletePath,true);
          }
        }
 catch (        IOException e) {
          LOG.info("Unable to delete the path created for facilitating rename" + deletePath);
        }
        throw new HiveException("Unable to rename: " + sourcePath + " to: "+ targetPath);
      }
    }
 else     if (!fs.mkdirs(targetPath)) {
      throw new HiveException("Unable to make directory: " + targetPath);
    }
  }
 else {
    String mesg="Copying data to local directory " + targetPath.toString();
    String mesg_detail=" from " + sourcePath.toString();
    console.printInfo(mesg,mesg_detail);
    LocalFileSystem dstFs=FileSystem.getLocal(conf);
    if (dstFs.delete(targetPath,true) || !dstFs.exists(targetPath)) {
      console.printInfo(mesg,mesg_detail);
      if (fs.exists(sourcePath)) {
        fs.copyToLocalFile(sourcePath,targetPath);
      }
 else {
        if (!dstFs.mkdirs(targetPath)) {
          throw new HiveException("Unable to make local directory: " + targetPath);
        }
      }
    }
 else {
      throw new AccessControlException("Unable to delete the existing destination directory: " + targetPath);
    }
  }
}
