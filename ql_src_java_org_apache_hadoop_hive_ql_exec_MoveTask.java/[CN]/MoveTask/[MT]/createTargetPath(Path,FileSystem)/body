{
  Path deletePath=null;
  Path mkDirPath=targetPath.getParent();
  if (mkDirPath != null && !fs.exists(mkDirPath)) {
    Path actualPath=mkDirPath;
    while (actualPath != null && !fs.exists(actualPath)) {
      deletePath=actualPath;
      actualPath=actualPath.getParent();
    }
    fs.mkdirs(mkDirPath);
    if (HiveConf.getBoolVar(conf,HiveConf.ConfVars.HIVE_WAREHOUSE_SUBDIR_INHERIT_PERMS)) {
      fs.setPermission(mkDirPath,fs.getFileStatus(actualPath).getPermission());
    }
  }
  return deletePath;
}
