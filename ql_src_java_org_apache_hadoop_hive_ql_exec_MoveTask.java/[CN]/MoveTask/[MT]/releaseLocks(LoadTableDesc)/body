{
  if (!conf.getBoolVar(HiveConf.ConfVars.HIVE_SUPPORT_CONCURRENCY)) {
    return;
  }
  Context ctx=driverContext.getCtx();
  HiveLockManager lockMgr=ctx.getHiveLockMgr();
  WriteEntity output=ctx.getLoadTableOutputMap().get(ltd);
  List<HiveLockObj> lockObjects=ctx.getOutputLockObjects().get(output);
  if (lockObjects == null) {
    return;
  }
  for (  HiveLockObj lockObj : lockObjects) {
    List<HiveLock> locks=lockMgr.getLocks(lockObj.getObj(),false,true);
    for (    HiveLock lock : locks) {
      if (lock.getHiveLockMode() == lockObj.getMode()) {
        LOG.info("about to release lock for output: " + output.toString() + " lock: "+ lock.getHiveLockObject().getName());
        lockMgr.unlock(lock);
        ctx.getHiveLocks().remove(lock);
      }
    }
  }
}
