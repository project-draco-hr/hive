{
  if (dstFs.exists(targetPath)) {
    if (dstFs.isDirectory(targetPath)) {
      FileStatus[] destFiles=dstFs.listStatus(targetPath);
      for (      FileStatus destFile : destFiles) {
        if (!dstFs.delete(destFile.getPath(),true)) {
          throw new IOException("Unable to clean the destination directory: " + targetPath);
        }
      }
    }
 else {
      throw new HiveException("Target " + targetPath + " is not a local directory.");
    }
  }
 else {
    if (!FileUtils.mkdir(dstFs,targetPath,false,conf)) {
      throw new HiveException("Failed to create local target directory " + targetPath);
    }
  }
  if (fs.exists(sourcePath)) {
    FileStatus[] srcs=fs.listStatus(sourcePath,FileUtils.HIDDEN_FILES_PATH_FILTER);
    for (    FileStatus status : srcs) {
      fs.copyToLocalFile(status.getPath(),targetPath);
    }
  }
}
