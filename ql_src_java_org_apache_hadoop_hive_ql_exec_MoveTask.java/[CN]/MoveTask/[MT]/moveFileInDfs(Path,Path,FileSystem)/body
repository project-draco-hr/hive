{
  if (fs.exists(sourcePath)) {
    Path deletePath=null;
    if (HiveConf.getBoolVar(conf,HiveConf.ConfVars.HIVE_INSERT_INTO_MULTILEVEL_DIRS)) {
      deletePath=createTargetPath(targetPath,fs);
    }
    Hive.clearDestForSubDirSrc(conf,targetPath,sourcePath,false);
    if (!Hive.moveFile(conf,sourcePath,targetPath,true,false)) {
      try {
        if (deletePath != null) {
          fs.delete(deletePath,true);
        }
      }
 catch (      IOException e) {
        LOG.info("Unable to delete the path created for facilitating rename" + deletePath);
      }
      throw new HiveException("Unable to rename: " + sourcePath + " to: "+ targetPath);
    }
  }
 else   if (!fs.mkdirs(targetPath)) {
    throw new HiveException("Unable to make directory: " + targetPath);
  }
}
