{
  Map<String[],Integer> tests=new HashMap<String[],Integer>();
  tests.put(new String[]{"testhivejdbcdrivertable",null},2);
  tests.put(new String[]{"testhivejdbc%",null},6);
  tests.put(new String[]{"%jdbcdrivertable",null},2);
  tests.put(new String[]{"%jdbcdrivertable%","key"},1);
  tests.put(new String[]{"%jdbcdrivertable%","ke_"},1);
  tests.put(new String[]{"%jdbcdrivertable%","ke%"},1);
  for (  String[] checkPattern : tests.keySet()) {
    ResultSet rs=(ResultSet)con.getMetaData().getColumns(null,null,checkPattern[0],checkPattern[1]);
    int cnt=0;
    while (rs.next()) {
      String columnname=rs.getString("COLUMN_NAME");
      int ordinalPos=rs.getInt("ORDINAL_POSITION");
switch (cnt) {
case 0:
        assertEquals("Wrong column name found","key",columnname);
      assertEquals("Wrong ordinal position found",ordinalPos,1);
    break;
case 1:
  assertEquals("Wrong column name found","value",columnname);
assertEquals("Wrong ordinal position found",ordinalPos,2);
break;
default :
break;
}
cnt++;
}
rs.close();
assertEquals("Found less columns then we test for.",tests.get(checkPattern).intValue(),cnt);
}
}
