{
  mockBeeline=new BeelineMock();
  mockResultSet=mock(ResultSet.class);
  ResultSetMetaData mockResultSetMetaData=mock(ResultSetMetaData.class);
  when(mockResultSetMetaData.getColumnCount()).thenReturn(2);
  when(mockResultSetMetaData.getColumnLabel(1)).thenReturn("Key");
  when(mockResultSetMetaData.getColumnLabel(2)).thenReturn("Value");
  when(mockResultSet.getMetaData()).thenReturn(mockResultSetMetaData);
  mockRow=new TestBufferedRows.MockRow();
  when(mockResultSet.next()).thenAnswer(new Answer<Boolean>(){
    private int mockRowDataIndex=0;
    @Override public Boolean answer(    final InvocationOnMock invocation){
      if (mockRowDataIndex < mockRowData.length) {
        mockRow.setCurrentRowData(mockRowData[mockRowDataIndex]);
        mockRowDataIndex++;
        return true;
      }
 else {
        return false;
      }
    }
  }
);
  when(mockResultSet.getString(Matchers.anyInt())).thenAnswer(new Answer<String>(){
    @Override public String answer(    final InvocationOnMock invocation){
      Object[] args=invocation.getArguments();
      int index=((Integer)args[0]);
      return mockRow.getColumn(index);
    }
  }
);
}
