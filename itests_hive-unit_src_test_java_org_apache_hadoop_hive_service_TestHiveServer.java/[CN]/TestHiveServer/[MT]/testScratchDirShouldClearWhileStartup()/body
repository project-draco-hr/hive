{
  FileSystem fs=FileSystem.get(conf);
  Path scratchDirPath=new Path(HiveConf.getVar(conf,HiveConf.ConfVars.SCRATCHDIR));
  boolean fileExists=fs.exists(scratchDirPath);
  if (!fileExists) {
    fileExists=fs.mkdirs(scratchDirPath);
  }
  try {
    conf.setBoolVar(HiveConf.ConfVars.HIVE_START_CLEANUP_SCRATCHDIR,true);
    ServerUtils.cleanUpScratchDir(conf);
  }
  finally {
    conf.setBoolVar(HiveConf.ConfVars.HIVE_START_CLEANUP_SCRATCHDIR,false);
  }
  assertFalse("Scratch dir is available after startup",fs.exists(scratchDirPath));
}
