{
  String pathStr=path.toUri().getPath();
  if (fileSystem instanceof DistributedFileSystem) {
    return SHIMS.getFileId(fileSystem,pathStr);
  }
  if (!allowSynthetic)   return null;
  int nameHash=pathStr.hashCode();
  FileStatus fs=fileSystem.getFileStatus(path);
  long fileSize=fs.getLen(), modTime=fs.getModificationTime();
  int fileSizeHash=(int)(fileSize ^ (fileSize >>> 32)), modTimeHash=(int)(modTime ^ (modTime >>> 32)), combinedHash=modTimeHash ^ fileSizeHash;
  long id=(((long)nameHash & 0xffffffffL) << 32) | ((long)combinedHash & 0xffffffffL);
  LOG.warn("Cannot get unique file ID from " + fileSystem.getClass().getSimpleName() + "; using "+ id+ "("+ pathStr+ ","+ nameHash+ ","+ fileSize+ ")");
  return id;
}
