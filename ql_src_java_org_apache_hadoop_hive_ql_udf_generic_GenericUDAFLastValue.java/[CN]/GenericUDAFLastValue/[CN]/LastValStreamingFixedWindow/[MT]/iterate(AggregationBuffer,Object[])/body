{
  State s=(State)agg;
  LastValueBuffer lb=(LastValueBuffer)s.wrappedBuf;
  if (lb.firstRow) {
    wrappedEval.iterate(lb,parameters);
  }
  Object o=ObjectInspectorUtils.copyToStandardObject(parameters[0],inputOI(),ObjectInspectorCopyOption.WRITABLE);
  if (!lb.skipNulls || o != null) {
    s.lastValue=o;
    s.lastIdx=s.numRows;
  }
 else   if (lb.skipNulls && s.lastIdx != -1) {
    if (s.numPreceding != BoundarySpec.UNBOUNDED_AMOUNT && s.numRows > s.lastIdx + s.numPreceding + s.numFollowing) {
      s.lastValue=null;
      s.lastIdx=-1;
    }
  }
  if (s.numRows >= (s.numFollowing)) {
    s.results.add(s.lastValue);
  }
  s.numRows++;
}
