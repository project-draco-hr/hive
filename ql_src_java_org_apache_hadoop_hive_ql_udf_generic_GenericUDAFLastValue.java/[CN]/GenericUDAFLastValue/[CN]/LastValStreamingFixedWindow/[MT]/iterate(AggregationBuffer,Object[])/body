{
  State s=(State)agg;
  LastValueBuffer lb=(LastValueBuffer)s.wrappedBuf;
  if (lb.firstRow) {
    wrappedEval.iterate(lb,parameters);
    for (int i=wFrameDef.getEnd().getRelativeOffset(); i < 0; i++) {
      s.results.add(null);
    }
  }
  Object o=ObjectInspectorUtils.copyToStandardObject(parameters[0],inputOI(),ObjectInspectorCopyOption.WRITABLE);
  if (!lb.skipNulls || o != null) {
    s.lastValue=o;
    s.lastIdx=s.numRows;
  }
 else   if (lb.skipNulls && s.lastIdx != -1) {
    if (!wFrameDef.isStartUnbounded() && s.numRows >= s.lastIdx + wFrameDef.getWindowSize()) {
      s.lastValue=null;
      s.lastIdx=-1;
    }
  }
  if (s.numRows >= wFrameDef.getEnd().getRelativeOffset()) {
    s.results.add(s.lastValue);
  }
  s.numRows++;
}
