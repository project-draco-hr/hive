{
  State s=(State)agg;
  LastValueBuffer lb=(LastValueBuffer)s.wrappedBuf;
  if (lb.skipNulls && s.lastIdx != -1) {
    if (s.numPreceding != BoundarySpec.UNBOUNDED_AMOUNT && s.numRows > s.lastIdx + s.numPreceding + s.numFollowing) {
      s.lastValue=null;
      s.lastIdx=-1;
    }
  }
  for (int i=0; i < s.numFollowing; i++) {
    s.results.add(s.lastValue);
  }
  return null;
}
