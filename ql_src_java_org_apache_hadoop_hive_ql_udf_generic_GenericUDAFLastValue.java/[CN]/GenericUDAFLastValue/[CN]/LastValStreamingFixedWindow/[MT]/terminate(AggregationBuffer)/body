{
  State s=(State)agg;
  LastValueBuffer lb=(LastValueBuffer)s.wrappedBuf;
  if (lb.skipNulls && s.lastIdx != -1) {
    if (numPreceding != BoundarySpec.UNBOUNDED_AMOUNT && s.numRows > s.lastIdx + numPreceding + numFollowing) {
      s.lastValue=null;
      s.lastIdx=-1;
    }
  }
  for (int i=0; i < numFollowing; i++) {
    s.results.add(s.lastValue);
  }
  return null;
}
