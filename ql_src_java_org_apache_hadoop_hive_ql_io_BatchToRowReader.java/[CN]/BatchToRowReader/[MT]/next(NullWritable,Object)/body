{
  if (!ensureBatch()) {
    return false;
  }
  @SuppressWarnings("unchecked") StructType value=(StructType)previous;
  for (int i=0; i < schema.size(); ++i) {
    if (!included[i])     continue;
    try {
      setStructCol(value,i,nextValue(batch.cols[i],rowInBatch,schema.get(i),getStructCol(value,i)));
    }
 catch (    Throwable t) {
      LOG.error("Error at row " + rowInBatch + "/"+ batch.size+ ", column "+ i+ "/"+ schema.size()+ " "+ batch.cols[i],t);
      throw (t instanceof IOException) ? (IOException)t : new IOException(t);
    }
  }
  ++rowInBatch;
  return true;
}
