{
  sessionConfExt=(sessionConfExt == null ? "" : sessionConfExt);
  hiveConfExt=(hiveConfExt == null ? "" : hiveConfExt);
  if (sessionConfExt.startsWith(";")) {
    sessionConfExt=sessionConfExt.substring(1);
  }
  if (isUseMiniKdc()) {
    sessionConfExt="principal=" + serverPrincipal + ";"+ sessionConfExt;
  }
  if (isHttpTransportMode()) {
    sessionConfExt="transportMode=http;httpPath=cliservice" + ";" + sessionConfExt;
  }
  String baseJdbcURL;
  if (isDynamicServiceDiscovery()) {
    sessionConfExt="serviceDiscoveryMode=zooKeeper;zooKeeperNamespace=" + getServerConf().getVar(HiveConf.ConfVars.HIVE_SERVER2_ZOOKEEPER_NAMESPACE) + ";"+ sessionConfExt;
    baseJdbcURL=getZKBaseJdbcURL();
  }
 else {
    baseJdbcURL=getBaseJdbcURL();
  }
  baseJdbcURL=baseJdbcURL + dbName;
  if (!sessionConfExt.isEmpty()) {
    baseJdbcURL=baseJdbcURL + ";" + sessionConfExt;
  }
  if ((hiveConfExt != null) && (!hiveConfExt.trim().isEmpty())) {
    baseJdbcURL=baseJdbcURL + "?" + hiveConfExt;
  }
  return baseJdbcURL;
}
