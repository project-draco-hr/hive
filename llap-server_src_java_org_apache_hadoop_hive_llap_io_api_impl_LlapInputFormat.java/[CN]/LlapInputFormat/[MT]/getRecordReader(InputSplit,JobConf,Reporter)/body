{
  boolean useLlapIo=true;
  if (split instanceof LlapAwareSplit) {
    useLlapIo=((LlapAwareSplit)split).canUseLlapIo();
  }
  if (!useLlapIo) {
    LlapIoImpl.LOG.warn("Not using LLAP IO for an unsupported split: " + split);
    @SuppressWarnings("unchecked") RecordReader<NullWritable,VectorizedRowBatch> rr=sourceInputFormat.getRecordReader(split,job,reporter);
    return rr;
  }
  boolean isVectorMode=Utilities.isVectorMode(job);
  if (!isVectorMode) {
    LlapIoImpl.LOG.error("No LLAP IO in non-vectorized mode");
    throw new UnsupportedOperationException("No LLAP IO in non-vectorized mode");
  }
  FileSplit fileSplit=(FileSplit)split;
  reporter.setStatus(fileSplit.toString());
  try {
    List<Integer> includedCols=ColumnProjectionUtils.isReadAllColumns(job) ? null : ColumnProjectionUtils.getReadColumnIDs(job);
    return new LlapRecordReader(job,fileSplit,includedCols,hostName);
  }
 catch (  Exception ex) {
    throw new IOException(ex);
  }
}
