{
  boolean isVectorMode=Utilities.isVectorMode(job);
  if (!isVectorMode) {
    LlapIoImpl.LOG.error("No llap in non-vectorized mode");
    throw new UnsupportedOperationException("No llap in non-vectorized mode");
  }
  FileSplit fileSplit=(FileSplit)split;
  reporter.setStatus(fileSplit.toString());
  try {
    List<Integer> includedCols=ColumnProjectionUtils.isReadAllColumns(job) ? null : ColumnProjectionUtils.getReadColumnIDs(job);
    if (includedCols.isEmpty()) {
      includedCols=null;
    }
    return new LlapRecordReader(job,fileSplit,includedCols);
  }
 catch (  Exception ex) {
    throw new IOException(ex);
  }
}
