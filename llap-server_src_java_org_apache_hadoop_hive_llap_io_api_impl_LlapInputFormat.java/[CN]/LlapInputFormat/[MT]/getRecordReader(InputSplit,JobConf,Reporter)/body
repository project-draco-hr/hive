{
  boolean isVectorMode=Utilities.isVectorMode(job);
  if (!isVectorMode) {
    LOG.error("No llap in non-vectorized mode; falling back to original");
    throw new UnsupportedOperationException("No llap in non-vectorized mode");
  }
  FileSplit fileSplit=(FileSplit)split;
  reporter.setStatus(fileSplit.toString());
  try {
    List<Integer> includedCols=ColumnProjectionUtils.isReadAllColumns(job) ? null : ColumnProjectionUtils.getReadColumnIDs(job);
    if (includedCols.isEmpty()) {
      includedCols=null;
    }
    VectorReader reader=llapIo.getReader(fileSplit,includedCols,SearchArgumentFactory.createFromConf(job));
    return new LlapRecordReader(reader,job,fileSplit);
  }
 catch (  Exception ex) {
    throw new IOException(ex);
  }
}
