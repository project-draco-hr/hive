{
  this.split=split;
  this.columnIds=includedCols;
  this.sarg=ConvertAstToSearchArg.createFromConf(job);
  this.columnNames=ColumnProjectionUtils.getReadColumnNames(job);
  String fragmentId=LlapTezUtils.getFragmentId(job);
  TezCounters taskCounters=null;
  if (fragmentId != null) {
    taskCounters=FragmentCountersMap.getCountersForFragment(fragmentId);
    LOG.info("Received fragment id: {}",fragmentId);
  }
 else {
    LOG.warn("Not using tez counters as fragment id string is null");
  }
  this.counters=new QueryFragmentCounters(job,taskCounters);
  this.counters.setDesc(QueryFragmentCounters.Desc.MACHINE,hostName);
  MapWork mapWork=Utilities.getMapWork(job);
  VectorizedRowBatchCtx ctx=mapWork.getVectorizedRowBatchCtx();
  rbCtx=ctx != null ? ctx : createFakeVrbCtx(mapWork);
  int partitionColumnCount=rbCtx.getPartitionColumnCount();
  if (partitionColumnCount > 0) {
    partitionValues=new Object[partitionColumnCount];
    VectorizedRowBatchCtx.getPartitionValues(rbCtx,job,split,partitionValues);
  }
 else {
    partitionValues=null;
  }
  startRead();
}
