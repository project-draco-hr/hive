{
  TezHeartbeatResponse response=new TezHeartbeatResponse();
  TezTaskAttemptID taskAttemptId=request.getCurrentTaskAttemptID();
  LOG.info("ZZZ: DBG: Received heartbeat from taskAttemptId: " + taskAttemptId.toString());
  List<TezEvent> tezEvents=pendingEvents.remove(taskAttemptId.toString());
  if (tezEvents == null) {
    tezEvents=Collections.emptyList();
  }
  response.setLastRequestId(request.getRequestId());
  response.setNextFromEventId(0);
  response.setNextPreRoutedEventId(0);
  response.setEvents(tezEvents);
  return response;
}
