{
  Preconditions.checkArgument(submitWorkRequestProto.getUsingTezAm() == false);
  pendingEvents.putIfAbsent(submitWorkRequestProto.getFragmentSpec().getFragmentIdentifierString(),tezEvents);
  communicator.sendSubmitWork(submitWorkRequestProto,llapHost,llapPort,new LlapProtocolClientProxy.ExecuteRequestCallback<LlapDaemonProtocolProtos.SubmitWorkResponseProto>(){
    @Override public void setResponse(    LlapDaemonProtocolProtos.SubmitWorkResponseProto response){
      if (response.hasSubmissionState()) {
        if (response.getSubmissionState().equals(LlapDaemonProtocolProtos.SubmissionStateProto.REJECTED)) {
          LOG.info("Fragment: " + submitWorkRequestProto.getFragmentSpec().getFragmentIdentifierString() + " rejected. Server Busy.");
          return;
        }
      }
    }
    @Override public void indicateError(    Throwable t){
      LOG.error("Failed to submit: " + submitWorkRequestProto.getFragmentSpec().getFragmentIdentifierString(),t);
    }
  }
);
}
