{
  Preconditions.checkArgument(submitWorkRequestProto.getUsingTezAm() == false);
  LOG.warn("ZZZ: DBG: " + " Submitting fragment: " + submitWorkRequestProto.getFragmentSpec().getFragmentIdentifierString() + " on host: "+ llapHost+ ", port="+ llapPort);
  LOG.info("ZZZ: DBG: Received {} events for {}",tezEvents.size(),submitWorkRequestProto.getFragmentSpec().getFragmentIdentifierString());
  pendingEvents.putIfAbsent(submitWorkRequestProto.getFragmentSpec().getFragmentIdentifierString(),tezEvents);
  communicator.sendSubmitWork(submitWorkRequestProto,llapHost,llapPort,new LlapProtocolClientProxy.ExecuteRequestCallback<LlapDaemonProtocolProtos.SubmitWorkResponseProto>(){
    @Override public void setResponse(    LlapDaemonProtocolProtos.SubmitWorkResponseProto response){
      if (response.hasSubmissionState()) {
        if (response.getSubmissionState().equals(LlapDaemonProtocolProtos.SubmissionStateProto.REJECTED)) {
          LOG.info("Fragment: " + submitWorkRequestProto.getFragmentSpec().getFragmentIdentifierString() + " rejected. Server Busy.");
          return;
        }
      }
      LOG.info("DBG: Submitted " + submitWorkRequestProto.getFragmentSpec().getFragmentIdentifierString());
    }
    @Override public void indicateError(    Throwable t){
      LOG.error("Failed to submit: " + submitWorkRequestProto.getFragmentSpec().getFragmentIdentifierString(),t);
    }
  }
);
}
