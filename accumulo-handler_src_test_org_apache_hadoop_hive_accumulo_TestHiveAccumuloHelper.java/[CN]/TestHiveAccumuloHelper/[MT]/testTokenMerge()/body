{
  final Text service=new Text("service");
  Token<?> token=Mockito.mock(Token.class);
  JobConf jobConf=new JobConf();
  Mockito.when(token.getService()).thenReturn(service);
  try {
    helper.mergeTokenIntoJobConf(jobConf,token);
  }
 catch (  IOException e) {
    log.info("Ignoring exception, likely coming from Hadoop 1",e);
    return;
  }
  Collection<Token<?>> tokens=jobConf.getCredentials().getAllTokens();
  assertEquals(1,tokens.size());
  assertEquals(service,tokens.iterator().next().getService());
}
