{
  try {
    if (topLevelFields == null) {
      try {
        if (ho.isPrimitive()) {
          topLevelFields=HiveObject.nlist;
          isPrimitive=true;
        }
 else {
          topLevelFields=ho.getFields();
          isPrimitive=false;
        }
      }
 catch (      HiveException e) {
        throw new RuntimeException("Cannot get Fields from HiveObject");
      }
    }
    if (isPrimitive) {
      os.write(ho.getJavaObject().toString().getBytes("UTF-8"));
    }
 else {
      boolean first=true;
      int i=-1;
      for (      SerDeField onef : topLevelFields) {
        i++;
        if (!first) {
          os.write(separator);
        }
 else {
          first=false;
        }
        HiveObject nho=ho.get(onef);
        if (nho == null)         continue;
        os.write(nho.toString().getBytes("UTF-8"));
      }
    }
    if (isTopLevel) {
      os.write(terminator);
    }
  }
 catch (  HiveException e) {
    writeErrorCount++;
  }
}
