{
  String dbName="default";
  String tableName="getPartitionsByFilter";
  int startTime=(int)(System.currentTimeMillis() / 1000);
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int","nocomment"));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  List<FieldSchema> partCols=new ArrayList<FieldSchema>();
  partCols.add(new FieldSchema("ds","string",""));
  partCols.add(new FieldSchema("region","string",""));
  Table table=new Table(tableName,dbName,"me",startTime,startTime,0,sd,partCols,emptyParameters,null,null,null);
  store.createTable(table);
  String[][] partVals=new String[][]{{"20010101","north america"},{"20010101","europe"},{"20010102","north america"},{"20010102","europe"},{"20010103","north america"}};
  for (  String[] pv : partVals) {
    List<String> vals=new ArrayList<String>();
    for (    String v : pv)     vals.add(v);
    StorageDescriptor psd=new StorageDescriptor(sd);
    psd.setLocation("file:/tmp/ds=" + pv[0] + "/region="+ pv[1]);
    Partition part=new Partition(vals,dbName,tableName,startTime,startTime,psd,emptyParameters);
    store.addPartition(part);
  }
  List<Partition> parts=null;
  parts=store.getPartitionsByFilter(dbName,tableName,"ds > '20010101'",(short)-1);
  checkPartVals(parts,"[20010102, north america]","[20010102, europe]","[20010103, north america]");
  parts=store.getPartitionsByFilter(dbName,tableName,"ds >= '20010102'",(short)-1);
  checkPartVals(parts,"[20010102, north america]","[20010102, europe]","[20010103, north america]");
  parts=store.getPartitionsByFilter(dbName,tableName,"ds >= '20010102' and region = 'europe' ",(short)-1);
  checkPartVals(parts,"[20010102, north america]","[20010102, europe]","[20010103, north america]");
  parts=store.getPartitionsByFilter(dbName,tableName,"ds >= '20010101' and ds < '20010102'",(short)-1);
  checkPartVals(parts,"[20010101, north america]","[20010101, europe]");
  parts=store.getPartitionsByFilter(dbName,tableName,"ds = '20010102' or ds < '20010103'",(short)-1);
  checkPartVals(parts,"[20010101, north america]","[20010101, europe]","[20010102, north america]","[20010102, europe]");
  parts=store.getPartitionsByFilter(dbName,tableName,"ds = '20010102' and (ds = '20010102' or region = 'europe')",(short)-1);
  checkPartVals(parts,"[20010102, north america]","[20010102, europe]");
  parts=store.getPartitionsByFilter(dbName,tableName,"region = 'europe'",(short)-1);
  checkPartVals(parts,"[20010101, north america]","[20010101, europe]","[20010102, north america]","[20010102, europe]","[20010103, north america]");
}
