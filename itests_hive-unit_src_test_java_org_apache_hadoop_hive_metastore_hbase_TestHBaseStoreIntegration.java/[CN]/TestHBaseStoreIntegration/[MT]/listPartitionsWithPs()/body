{
  String dbName="default";
  String tableName="listPartsPs";
  int startTime=(int)(System.currentTimeMillis() / 1000);
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int","nocomment"));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  List<FieldSchema> partCols=new ArrayList<FieldSchema>();
  partCols.add(new FieldSchema("ds","string",""));
  partCols.add(new FieldSchema("region","string",""));
  Table table=new Table(tableName,dbName,"me",startTime,startTime,0,sd,partCols,emptyParameters,null,null,null);
  store.createTable(table);
  String[][] partVals=new String[][]{{"today","north america"},{"today","europe"},{"tomorrow","north america"},{"tomorrow","europe"}};
  for (  String[] pv : partVals) {
    List<String> vals=new ArrayList<String>();
    for (    String v : pv)     vals.add(v);
    StorageDescriptor psd=new StorageDescriptor(sd);
    psd.setLocation("file:/tmp/ds=" + pv[0] + "/region="+ pv[1]);
    Partition part=new Partition(vals,dbName,tableName,startTime,startTime,psd,emptyParameters);
    store.addPartition(part);
  }
  List<String> partitionNames=store.listPartitionNamesPs(dbName,tableName,Arrays.asList(partVals[0]),(short)-1);
  Assert.assertEquals(1,partitionNames.size());
  Assert.assertEquals("ds=today/region=north america",partitionNames.get(0));
  partitionNames=store.listPartitionNamesPs(dbName,tableName,Arrays.asList(partVals[0][0]),(short)-1);
  Assert.assertEquals(2,partitionNames.size());
  String[] names=partitionNames.toArray(new String[partitionNames.size()]);
  Arrays.sort(names);
  Assert.assertArrayEquals(new String[]{"ds=today/region=europe","ds=today/region=north america"},names);
  partitionNames=store.listPartitionNamesPs(dbName,tableName,Arrays.asList("today","*"),(short)-1);
  Assert.assertEquals(2,partitionNames.size());
  names=partitionNames.toArray(new String[partitionNames.size()]);
  Arrays.sort(names);
  Assert.assertArrayEquals(new String[]{"ds=today/region=europe","ds=today/region=north america"},names);
  partitionNames=store.listPartitionNamesPs(dbName,tableName,Arrays.asList("*","europe"),(short)-1);
  Assert.assertEquals(2,partitionNames.size());
  names=partitionNames.toArray(new String[partitionNames.size()]);
  Arrays.sort(names);
  Assert.assertArrayEquals(new String[]{"ds=today/region=europe","ds=tomorrow/region=europe"},names);
}
