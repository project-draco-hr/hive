{
  HiveEndPoint endPt=new HiveEndPoint(metaStoreURI,dbName,tblName,partitionVals);
  StreamingConnection connection=endPt.newConnection(false,null);
  connection.close();
  endPt=new HiveEndPoint(metaStoreURI,dbName2,tblName2,null);
  endPt.newConnection(false,null).close();
  try {
    endPt=new HiveEndPoint(metaStoreURI,dbName,tblName,null);
    connection=endPt.newConnection(true);
    Assert.assertTrue("ConnectionError was not thrown",false);
    connection.close();
  }
 catch (  ConnectionError e) {
    String errMsg="doesn't specify any partitions for partitioned table";
    Assert.assertTrue(e.toString().endsWith(errMsg));
  }
  try {
    endPt=new HiveEndPoint(metaStoreURI,dbName2,tblName2,partitionVals);
    connection=endPt.newConnection(false);
    Assert.assertTrue("ConnectionError was not thrown",false);
    connection.close();
  }
 catch (  ConnectionError e) {
    String errMsg="specifies partitions for unpartitioned table";
    Assert.assertTrue(e.toString().endsWith(errMsg));
  }
}
