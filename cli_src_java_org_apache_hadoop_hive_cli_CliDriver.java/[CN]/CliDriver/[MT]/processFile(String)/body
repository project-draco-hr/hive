{
  Path path=new Path(fileName);
  FileSystem fs;
  if (!path.toUri().isAbsolute()) {
    fs=FileSystem.getLocal(conf);
    path=fs.makeQualified(path);
  }
 else {
    fs=FileSystem.get(path.toUri(),conf);
  }
  BufferedReader bufferReader=null;
  int rc=0;
  try {
    bufferReader=new BufferedReader(new InputStreamReader(fs.open(path)));
    rc=processReader(bufferReader);
  }
  finally {
    IOUtils.closeStream(bufferReader);
  }
  return rc;
}
