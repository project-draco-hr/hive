{
  int lastRet=0, ret=0;
  for (  String oneCmd : line.split(";")) {
    if (StringUtils.isBlank(oneCmd))     continue;
    ret=processCmd(removeComments(oneCmd));
    lastRet=ret;
    boolean ignoreErrors=HiveConf.getBoolVar(conf,HiveConf.ConfVars.CLIIGNOREERRORS);
    if (ret != 0 && !ignoreErrors) {
      return ret;
    }
  }
  return lastRet;
}
