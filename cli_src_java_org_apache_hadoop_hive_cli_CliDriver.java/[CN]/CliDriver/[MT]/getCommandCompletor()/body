{
  SimpleCompletor sc=new SimpleCompletor(new String[0]);
  for (  String s : FunctionRegistry.getFunctionNames()) {
    if (s.matches("[a-z_]+")) {
      sc.addCandidateString(s + "(");
    }
 else {
      sc.addCandidateString(s);
    }
  }
  for (  String s : HiveParser.getKeywords()) {
    sc.addCandidateString(s);
    sc.addCandidateString(s.toLowerCase());
  }
  ArgumentDelimiter delim=new AbstractArgumentDelimiter(){
    @Override public boolean isDelimiterChar(    String buffer,    int pos){
      char c=buffer.charAt(pos);
      return (Character.isWhitespace(c) || c == '(' || c == ')' || c == '[' || c == ']');
    }
  }
;
  final ArgumentCompletor ac=new ArgumentCompletor(sc,delim);
  ac.setStrict(false);
  Completor completor=new Completor(){
    public int complete(    String buffer,    int offset,    List completions){
      List<String> comp=(List<String>)completions;
      int ret=ac.complete(buffer,offset,completions);
      if (completions.size() == 1) {
        if (comp.get(0).endsWith("( ")) {
          comp.set(0,comp.get(0).trim());
        }
      }
      return ret;
    }
  }
;
  HiveConf.ConfVars[] confs=HiveConf.ConfVars.values();
  String[] vars=new String[confs.length];
  for (int i=0; i < vars.length; i++) {
    vars[i]=confs[i].varname;
  }
  SimpleCompletor conf=new SimpleCompletor(vars);
  conf.setDelimiter(".");
  SimpleCompletor set=new SimpleCompletor("set"){
    @Override public int complete(    String buffer,    int cursor,    List clist){
      return buffer != null && buffer.equals("set") ? super.complete(buffer,cursor,clist) : -1;
    }
  }
;
  ArgumentCompletor propCompletor=new ArgumentCompletor(new Completor[]{set,conf}){
    @Override @SuppressWarnings("unchecked") public int complete(    String buffer,    int offset,    List completions){
      int ret=super.complete(buffer,offset,completions);
      if (completions.size() == 1) {
        completions.set(0,((String)completions.get(0)).trim());
      }
      return ret;
    }
  }
;
  return new Completor[]{propCompletor,completor};
}
