{
  try {
    String fullSchema=client.getSchema();
    String[] schemaParts=fullSchema.split("#");
    if (schemaParts.length > 2) {
      columnNames=Arrays.asList(schemaParts[1].split(","));
      columnTypes=Arrays.asList(schemaParts[2].split(":"));
    }
    ds=new DynamicSerDe();
    Properties dsp=new Properties();
    dsp.setProperty(Constants.SERIALIZATION_FORMAT,org.apache.hadoop.hive.serde2.thrift.TCTLSeparatedProtocol.class.getName());
    dsp.setProperty(org.apache.hadoop.hive.metastore.api.Constants.META_TABLE_NAME,"result");
    dsp.setProperty(Constants.SERIALIZATION_DDL,schemaParts[0]);
    dsp.setProperty(Constants.SERIALIZATION_LIB,ds.getClass().toString());
    dsp.setProperty(Constants.FIELD_DELIM,"9");
    ds.initialize(new Configuration(),dsp);
  }
 catch (  Exception ex) {
    ex.printStackTrace();
    System.exit(1);
  }
}
