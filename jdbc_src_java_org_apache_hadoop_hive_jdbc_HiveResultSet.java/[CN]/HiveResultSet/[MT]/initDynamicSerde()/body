{
  try {
    Schema fullSchema=client.getThriftSchema();
    List<FieldSchema> schema=fullSchema.getFieldSchemas();
    columnNames=new ArrayList<String>();
    columnTypes=new ArrayList<String>();
    String serDDL;
    if ((schema != null) && (!schema.isEmpty())) {
      serDDL=new String("struct result { ");
      for (int pos=0; pos < schema.size(); pos++) {
        if (pos != 0)         serDDL=serDDL.concat(",");
        serDDL=serDDL.concat(schema.get(pos).getType());
        serDDL=serDDL.concat(" ");
        serDDL=serDDL.concat(schema.get(pos).getName());
      }
      serDDL=serDDL.concat("}");
    }
 else     serDDL=new String("struct result { string empty }");
    ds=new DynamicSerDe();
    Properties dsp=new Properties();
    dsp.setProperty(Constants.SERIALIZATION_FORMAT,org.apache.hadoop.hive.serde2.thrift.TCTLSeparatedProtocol.class.getName());
    dsp.setProperty(org.apache.hadoop.hive.metastore.api.Constants.META_TABLE_NAME,"result");
    dsp.setProperty(Constants.SERIALIZATION_DDL,serDDL);
    dsp.setProperty(Constants.SERIALIZATION_LIB,ds.getClass().toString());
    dsp.setProperty(Constants.FIELD_DELIM,"9");
    ds.initialize(new Configuration(),dsp);
  }
 catch (  Exception ex) {
    ex.printStackTrace();
    System.exit(1);
  }
}
