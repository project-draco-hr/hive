{
  NamingEnumeration<SearchResult> searchResult=mockNamingEnumeration("CN=User1,OU=org1,DC=foo,DC=bar");
  when(ctx.search(anyString(),anyString(),any(SearchControls.class))).thenReturn(searchResult).thenThrow(NamingException.class);
  search=new LdapSearch(conf,ctx);
  String expected="CN=User1,OU=org1,DC=foo,DC=bar";
  String actual=search.findUserDn("CN=User1,OU=org1");
  assertEquals(expected,actual);
}
