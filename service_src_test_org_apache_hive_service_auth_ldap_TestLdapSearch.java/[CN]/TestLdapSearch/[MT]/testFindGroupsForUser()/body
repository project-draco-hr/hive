{
  conf.setVar(HiveConf.ConfVars.HIVE_SERVER2_PLAIN_LDAP_GROUPDNPATTERN,"CN=%s,OU=org1,DC=foo,DC=bar");
  NamingEnumeration<SearchResult> groupsResult=mockNamingEnumeration("CN=Group1,OU=org1,DC=foo,DC=bar");
  when(ctx.search(eq("OU=org1,DC=foo,DC=bar"),contains("User1"),any(SearchControls.class))).thenReturn(groupsResult);
  search=new LdapSearch(conf,ctx);
  List<String> expected=Arrays.asList("CN=Group1,OU=org1,DC=foo,DC=bar");
  List<String> actual=search.findGroupsForUser("CN=User1,OU=org1,DC=foo,DC=bar");
  assertEquals(expected,actual);
}
