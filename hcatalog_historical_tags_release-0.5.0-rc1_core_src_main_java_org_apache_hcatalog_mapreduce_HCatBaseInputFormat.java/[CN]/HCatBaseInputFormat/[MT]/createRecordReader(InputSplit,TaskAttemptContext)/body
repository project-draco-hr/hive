{
  HCatSplit hcatSplit=InternalUtil.castToHCatSplit(split);
  PartInfo partitionInfo=hcatSplit.getPartitionInfo();
  JobContext jobContext=taskContext;
  Configuration conf=jobContext.getConfiguration();
  HCatStorageHandler storageHandler=HCatUtil.getStorageHandler(conf,partitionInfo);
  JobConf jobConf=HCatUtil.getJobConfFromContext(jobContext);
  Map<String,String> jobProperties=partitionInfo.getJobProperties();
  HCatUtil.copyJobPropertiesToJobConf(jobProperties,jobConf);
  Map<String,String> valuesNotInDataCols=getColValsNotInDataColumns(getOutputSchema(conf),partitionInfo);
  return new HCatRecordReader(storageHandler,valuesNotInDataCols);
}
