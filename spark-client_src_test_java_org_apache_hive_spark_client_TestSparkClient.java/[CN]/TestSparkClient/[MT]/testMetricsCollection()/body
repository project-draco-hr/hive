{
  runTest(true,new TestFunction(){
    @Override public void call(    SparkClient client) throws Exception {
      JobHandle<Integer> future=client.submit(new AsyncSparkJob());
      future.get(TIMEOUT,TimeUnit.SECONDS);
      MetricsCollection metrics=future.getMetrics();
      assertEquals(1,metrics.getJobIds().size());
      assertTrue(metrics.getAllMetrics().executorRunTime > 0L);
      JobHandle<Integer> future2=client.submit(new AsyncSparkJob());
      future2.get(TIMEOUT,TimeUnit.SECONDS);
      MetricsCollection metrics2=future2.getMetrics();
      assertEquals(1,metrics2.getJobIds().size());
      assertFalse(Objects.equal(metrics.getJobIds(),metrics2.getJobIds()));
      assertTrue(metrics2.getAllMetrics().executorRunTime > 0L);
    }
  }
);
}
