{
  runTest(true,new TestFunction(){
    @Override public void call(    SparkClient client) throws Exception {
      JobHandle.Listener<String> listener=newListener();
      JobHandle<String> handle=client.submit(new SimpleJob());
      handle.addListener(listener);
      assertEquals("hello",handle.get(TIMEOUT,TimeUnit.SECONDS));
      assertFalse(((JobHandleImpl<String>)handle).changeState(JobHandle.State.SENT));
      verify(listener).onJobQueued(handle);
      verify(listener).onJobStarted(handle);
      verify(listener).onJobSucceeded(same(handle),eq(handle.get()));
    }
  }
);
}
