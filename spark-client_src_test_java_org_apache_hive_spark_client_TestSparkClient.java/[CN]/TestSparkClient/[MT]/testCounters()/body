{
  runTest(true,new TestFunction(){
    @Override public void call(    SparkClient client) throws Exception {
      JobHandle<?> job=client.submit(new CounterIncrementJob());
      job.get(TIMEOUT,TimeUnit.SECONDS);
      SparkCounters counters=job.getSparkCounters();
      assertNotNull(counters);
      long expected=1 + 2 + 3+ 4+ 5;
      assertEquals(expected,counters.getCounter("group1","counter1").getValue());
      assertEquals(expected,counters.getCounter("group2","counter2").getValue());
    }
  }
);
}
