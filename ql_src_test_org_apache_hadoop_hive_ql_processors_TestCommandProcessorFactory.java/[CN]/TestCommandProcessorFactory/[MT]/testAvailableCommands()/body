{
  enableTestOnlyCmd(conf);
  SessionState.start(conf);
  for (  HiveCommand command : HiveCommand.values()) {
    String cmd=command.name();
    String cmdInLowerCase=cmd.toLowerCase();
    Assert.assertNotNull("Cmd " + cmd + " not return null",CommandProcessorFactory.getForHiveCommandInternal(new String[]{cmd},conf,command.isOnlyForTesting()));
    Assert.assertNotNull("Cmd " + cmd + " not return null",CommandProcessorFactory.getForHiveCommandInternal(new String[]{cmdInLowerCase},conf,command.isOnlyForTesting()));
  }
  conf.set(HiveConf.ConfVars.HIVE_SECURITY_COMMAND_WHITELIST.toString(),"");
  for (  HiveCommand command : HiveCommand.values()) {
    String cmd=command.name();
    try {
      CommandProcessorFactory.getForHiveCommandInternal(new String[]{cmd},conf,command.isOnlyForTesting());
      Assert.fail("Expected SQLException for " + cmd + " as available commands is empty");
    }
 catch (    SQLException e) {
      Assert.assertEquals("Insufficient privileges to execute " + cmd,e.getMessage());
      Assert.assertEquals("42000",e.getSQLState());
    }
  }
}
