{
  SessionState.start(conf);
  for (  HiveCommand command : HiveCommand.values()) {
    String cmd=command.name();
    Assert.assertNotNull("Cmd " + cmd + " not return null",CommandProcessorFactory.getForHiveCommand(cmd,conf));
  }
  for (  HiveCommand command : HiveCommand.values()) {
    String cmd=command.name().toLowerCase();
    Assert.assertNotNull("Cmd " + cmd + " not return null",CommandProcessorFactory.getForHiveCommand(cmd,conf));
  }
  conf.set(HiveConf.ConfVars.HIVE_SECURITY_COMMAND_WHITELIST.toString(),"");
  for (  HiveCommand command : HiveCommand.values()) {
    String cmd=command.name();
    try {
      CommandProcessorFactory.getForHiveCommand(cmd,conf);
      Assert.fail("Expected SQLException for " + cmd + " as available commands is empty");
    }
 catch (    SQLException e) {
      Assert.assertEquals("Insufficient privileges to execute " + cmd,e.getMessage());
      Assert.assertEquals("42000",e.getSQLState());
    }
  }
}
