{
  final Map<String,String> metadata=readContext.getReadSupportMetadata();
  if (metadata == null) {
    throw new IllegalStateException("ReadContext not initialized properly. " + "Don't know the Hive Schema.");
  }
  final MessageType tableSchema=resolveSchemaAccess(MessageTypeParser.parseMessageType(metadata.get(HIVE_SCHEMA_KEY)),fileSchema,configuration);
  return new DataWritableRecordConverter(readContext.getRequestedSchema(),tableSchema);
}
