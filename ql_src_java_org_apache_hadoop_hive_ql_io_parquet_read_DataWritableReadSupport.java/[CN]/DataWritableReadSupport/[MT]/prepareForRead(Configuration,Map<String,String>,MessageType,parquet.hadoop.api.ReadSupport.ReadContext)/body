{
  final Map<String,String> metadata=readContext.getReadSupportMetadata();
  if (metadata == null) {
    throw new IllegalStateException("ReadContext not initialized properly. " + "Don't know the Hive Schema.");
  }
  return new DataWritableRecordConverter(readContext.getRequestedSchema(),metadata);
}
