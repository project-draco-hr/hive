{
  final Map<String,String> metadata=readContext.getReadSupportMetadata();
  if (metadata == null) {
    throw new IllegalStateException("ReadContext not initialized properly. " + "Don't know the Hive Schema.");
  }
  String key=HiveConf.ConfVars.HIVE_PARQUET_TIMESTAMP_SKIP_CONVERSION.varname;
  if (!metadata.containsKey(key)) {
    metadata.put(key,String.valueOf(HiveConf.getBoolVar(configuration,HiveConf.ConfVars.HIVE_PARQUET_TIMESTAMP_SKIP_CONVERSION)));
  }
  return new DataWritableRecordConverter(readContext.getRequestedSchema(),metadata);
}
