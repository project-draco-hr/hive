{
  String columnNames=configuration.get(IOConstants.COLUMNS);
  Map<String,String> contextMetadata=new HashMap<String,String>();
  boolean indexAccess=configuration.getBoolean(PARQUET_COLUMN_INDEX_ACCESS,false);
  if (columnNames != null) {
    List<String> columnNamesList=getColumnNames(columnNames);
    MessageType tableSchema;
    if (indexAccess) {
      List<Integer> indexSequence=new ArrayList<Integer>();
      for (int i=0; i < columnNamesList.size(); i++) {
        indexSequence.add(i);
      }
      tableSchema=getSchemaByIndex(fileSchema,columnNamesList,indexSequence);
    }
 else {
      String columnTypes=configuration.get(IOConstants.COLUMNS_TYPES);
      List<TypeInfo> columnTypesList=getColumnTypes(columnTypes);
      tableSchema=getSchemaByName(fileSchema,columnNamesList,columnTypesList);
    }
    contextMetadata.put(HIVE_TABLE_AS_PARQUET_SCHEMA,tableSchema.toString());
    List<Integer> indexColumnsWanted=ColumnProjectionUtils.getReadColumnIDs(configuration);
    MessageType requestedSchemaByUser=getSchemaByIndex(tableSchema,columnNamesList,indexColumnsWanted);
    return new ReadContext(requestedSchemaByUser,contextMetadata);
  }
 else {
    contextMetadata.put(HIVE_TABLE_AS_PARQUET_SCHEMA,fileSchema.toString());
    return new ReadContext(fileSchema,contextMetadata);
  }
}
