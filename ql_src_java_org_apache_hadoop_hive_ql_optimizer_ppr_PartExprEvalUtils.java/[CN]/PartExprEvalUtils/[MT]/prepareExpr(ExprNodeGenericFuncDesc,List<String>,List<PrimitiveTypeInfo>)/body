{
  List<ObjectInspector> partObjectInspectors=new ArrayList<ObjectInspector>();
  for (int i=0; i < partNames.size(); i++) {
    partObjectInspectors.add(PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(partColumnTypeInfos.get(i)));
  }
  StructObjectInspector objectInspector=ObjectInspectorFactory.getStandardStructObjectInspector(partNames,partObjectInspectors);
  ExprNodeEvaluator evaluator=ExprNodeEvaluatorFactory.get(expr);
  ObjectInspector evaluateResultOI=evaluator.initialize(objectInspector);
  return ObjectPair.create((PrimitiveObjectInspector)evaluateResultOI,evaluator);
}
