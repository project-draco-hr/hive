{
  boolean hasVC=vcs != null && !vcs.isEmpty();
  Object[] rowWithPart=new Object[hasVC ? 3 : 2];
  ArrayList<String> partNames=new ArrayList<String>();
  ArrayList<String> partValues=new ArrayList<String>();
  ArrayList<ObjectInspector> partObjectInspectors=new ArrayList<ObjectInspector>();
  for (  Map.Entry<String,String> entry : partSpec.entrySet()) {
    partNames.add(entry.getKey());
    partValues.add(entry.getValue());
    partObjectInspectors.add(PrimitiveObjectInspectorFactory.javaStringObjectInspector);
  }
  StructObjectInspector partObjectInspector=ObjectInspectorFactory.getStandardStructObjectInspector(partNames,partObjectInspectors);
  rowWithPart[1]=partValues;
  ArrayList<StructObjectInspector> ois=new ArrayList<StructObjectInspector>(2);
  ois.add(rowObjectInspector);
  ois.add(partObjectInspector);
  if (hasVC) {
    ois.add(VirtualColumn.getVCSObjectInspector(vcs));
  }
  StructObjectInspector rowWithPartObjectInspector=ObjectInspectorFactory.getUnionStructObjectInspector(ois);
  ExprNodeEvaluator evaluator=ExprNodeEvaluatorFactory.get(expr);
  ObjectInspector evaluateResultOI=evaluator.initialize(rowWithPartObjectInspector);
  Object evaluateResultO=evaluator.evaluate(rowWithPart);
  return ((PrimitiveObjectInspector)evaluateResultOI).getPrimitiveJavaObject(evaluateResultO);
}
