{
  List<ObjectInspector> partObjectInspectors=new ArrayList<ObjectInspector>();
  for (int i=0; i < partNames.size(); i++) {
    partObjectInspectors.add(PrimitiveObjectInspectorFactory.javaStringObjectInspector);
  }
  StructObjectInspector partObjectInspector=ObjectInspectorFactory.getStandardStructObjectInspector(partNames,partObjectInspectors);
  List<StructObjectInspector> ois=new ArrayList<StructObjectInspector>(2);
  ois.add(rowObjectInspector);
  ois.add(partObjectInspector);
  StructObjectInspector rowWithPartObjectInspector=ObjectInspectorFactory.getUnionStructObjectInspector(ois);
  ExprNodeEvaluator evaluator=ExprNodeEvaluatorFactory.get(expr);
  ObjectInspector evaluateResultOI=evaluator.initialize(rowWithPartObjectInspector);
  Map<PrimitiveObjectInspector,ExprNodeEvaluator> result=new HashMap<PrimitiveObjectInspector,ExprNodeEvaluator>();
  result.put((PrimitiveObjectInspector)evaluateResultOI,evaluator);
  return result;
}
