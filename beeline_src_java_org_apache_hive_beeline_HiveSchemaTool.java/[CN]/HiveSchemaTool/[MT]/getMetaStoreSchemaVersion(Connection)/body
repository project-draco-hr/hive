{
  String versionQuery;
  if (HiveSchemaHelper.getDbCommandParser(dbType).needsQuotedIdentifier()) {
    versionQuery="select t.\"SCHEMA_VERSION\" from \"VERSION\" t";
  }
 else {
    versionQuery="select t.SCHEMA_VERSION from VERSION t";
  }
  try {
    Statement stmt=metastoreConn.createStatement();
    ResultSet res=stmt.executeQuery(versionQuery);
    if (!res.next()) {
      throw new HiveMetaException("Didn't find version data in metastore");
    }
    String currentSchemaVersion=res.getString(1);
    metastoreConn.close();
    return currentSchemaVersion;
  }
 catch (  SQLException e) {
    throw new HiveMetaException("Failed to get schema version.",e);
  }
}
