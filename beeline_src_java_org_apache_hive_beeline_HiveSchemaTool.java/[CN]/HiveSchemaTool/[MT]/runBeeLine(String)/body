{
  List<String> argList=new ArrayList<String>();
  argList.add("-u");
  argList.add(HiveSchemaHelper.getValidConfVar(ConfVars.METASTORECONNECTURLKEY,hiveConf));
  argList.add("-d");
  argList.add(HiveSchemaHelper.getValidConfVar(ConfVars.METASTORE_CONNECTION_DRIVER,hiveConf));
  argList.add("-n");
  argList.add(userName);
  argList.add("-p");
  argList.add(passWord);
  argList.add("-f");
  argList.add(sqlScriptFile);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Going to invoke file that contains:");
    FileReader fr=new FileReader(sqlScriptFile);
    BufferedReader reader=new BufferedReader(fr);
    String line;
    while ((line=reader.readLine()) != null) {
      LOG.debug("script: " + line);
    }
  }
  BeeLine beeLine=new BeeLine();
  if (!verbose) {
    beeLine.setOutputStream(new PrintStream(new NullOutputStream()));
    beeLine.getOpts().setSilent(true);
  }
  beeLine.getOpts().setAllowMultiLineCommand(false);
  beeLine.getOpts().setIsolation("TRANSACTION_READ_COMMITTED");
  beeLine.getOpts().setEntireLineAsCommand(true);
  LOG.debug("Going to run command <" + StringUtils.join(argList," ") + ">");
  int status=beeLine.begin(argList.toArray(new String[0]),null);
  if (status != 0) {
    throw new IOException("Schema script failed, errorcode " + status);
  }
}
