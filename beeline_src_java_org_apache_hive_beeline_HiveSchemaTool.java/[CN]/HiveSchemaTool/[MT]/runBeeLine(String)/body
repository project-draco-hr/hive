{
  List<String> argList=new ArrayList<String>();
  argList.add("-u");
  argList.add(getValidConfVar(ConfVars.METASTORECONNECTURLKEY));
  argList.add("-d");
  argList.add(getValidConfVar(ConfVars.METASTORE_CONNECTION_DRIVER));
  argList.add("-n");
  argList.add(userName);
  argList.add("-p");
  argList.add(passWord);
  argList.add("-f");
  argList.add(sqlScriptFile);
  BeeLine beeLine=new BeeLine();
  if (!verbose) {
    beeLine.setOutputStream(new PrintStream(new NullOutputStream()));
    beeLine.getOpts().setSilent(true);
  }
  beeLine.getOpts().setAllowMultiLineCommand(false);
  int status=beeLine.begin(argList.toArray(new String[0]),null);
  if (status != 0) {
    throw new IOException("Schema script failed, errorcode " + status);
  }
}
