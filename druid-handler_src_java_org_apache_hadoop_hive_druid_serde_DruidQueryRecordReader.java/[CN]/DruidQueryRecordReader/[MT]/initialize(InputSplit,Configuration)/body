{
  HiveDruidSplit hiveDruidSplit=(HiveDruidSplit)split;
  query=createQuery(hiveDruidSplit.getDruidQuery());
  if (LOG.isInfoEnabled()) {
    LOG.info("Retrieving from druid using query:\n " + query);
  }
  HttpClient client=HttpClientInit.createClient(HttpClientConfig.builder().build(),new Lifecycle());
  InputStream response=DruidStorageHandlerUtils.submitRequest(client,DruidStorageHandlerUtils.createRequest(hiveDruidSplit.getAddress(),query));
  List<R> resultsList;
  try {
    resultsList=createResultsList(response);
  }
 catch (  IOException e) {
    response.close();
    throw e;
  }
  if (resultsList == null || resultsList.isEmpty()) {
    return;
  }
  results=resultsList.iterator();
}
