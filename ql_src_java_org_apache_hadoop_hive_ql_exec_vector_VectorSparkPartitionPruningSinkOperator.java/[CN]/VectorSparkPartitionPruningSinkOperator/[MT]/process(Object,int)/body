{
  VectorizedRowBatch batch=(VectorizedRowBatch)data;
  if (firstBatch) {
    vectorExtractRowDynBatch=new VectorExtractRowDynBatch();
    vectorExtractRowDynBatch.init((StructObjectInspector)inputObjInspectors[0],vContext.getProjectedColumns());
    singleRow=new Object[vectorExtractRowDynBatch.getCount()];
    firstBatch=false;
  }
  vectorExtractRowDynBatch.setBatchOnEntry(batch);
  ObjectInspector rowInspector=inputObjInspectors[0];
  try {
    Writable writableRow;
    for (int logical=0; logical < batch.size; logical++) {
      int batchIndex=batch.selectedInUse ? batch.selected[logical] : logical;
      vectorExtractRowDynBatch.extractRow(batchIndex,singleRow);
      writableRow=serializer.serialize(singleRow,rowInspector);
      writableRow.write(buffer);
    }
  }
 catch (  Exception e) {
    throw new HiveException(e);
  }
  vectorExtractRowDynBatch.forgetBatchOnExit();
}
