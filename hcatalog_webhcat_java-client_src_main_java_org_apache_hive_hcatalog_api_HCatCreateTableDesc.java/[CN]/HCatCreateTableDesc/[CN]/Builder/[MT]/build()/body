{
  if (this.dbName == null) {
    LOG.info("Database name found null. Setting db to :" + MetaStoreUtils.DEFAULT_DATABASE_NAME);
    this.dbName=MetaStoreUtils.DEFAULT_DATABASE_NAME;
  }
  HCatCreateTableDesc desc=new HCatCreateTableDesc(this.dbName,this.tableName,this.cols);
  desc.ifNotExists=this.ifNotExists;
  desc.isExternal=this.isExternal;
  desc.comment=this.comment;
  desc.partCols=this.partCols;
  desc.bucketCols=this.bucketCols;
  desc.numBuckets=this.numBuckets;
  desc.location=this.location;
  desc.tblProps=this.tblProps;
  desc.sortCols=this.sortCols;
  desc.serde=null;
  if (!StringUtils.isEmpty(fileFormat)) {
    desc.fileFormat=fileFormat;
    if ("SequenceFile".equalsIgnoreCase(fileFormat)) {
      desc.inputformat=SequenceFileInputFormat.class.getName();
      desc.outputformat=SequenceFileOutputFormat.class.getName();
    }
 else     if ("RCFile".equalsIgnoreCase(fileFormat)) {
      desc.inputformat=RCFileInputFormat.class.getName();
      desc.outputformat=RCFileOutputFormat.class.getName();
      desc.serde=ColumnarSerDe.class.getName();
    }
    desc.storageHandler=StringUtils.EMPTY;
  }
 else   if (!StringUtils.isEmpty(storageHandler)) {
    desc.storageHandler=storageHandler;
  }
 else {
    desc.fileFormat="TextFile";
    LOG.info("Using text file format for the table.");
    desc.inputformat=TextInputFormat.class.getName();
    LOG.info("Table input format:" + desc.inputformat);
    desc.outputformat=IgnoreKeyTextOutputFormat.class.getName();
    LOG.info("Table output format:" + desc.outputformat);
  }
  return desc;
}
