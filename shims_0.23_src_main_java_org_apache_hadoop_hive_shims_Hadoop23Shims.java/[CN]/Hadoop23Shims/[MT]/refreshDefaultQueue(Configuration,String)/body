{
  String requestedQueue=YarnConfiguration.DEFAULT_QUEUE_NAME;
  if (StringUtils.isNotBlank(userName) && isFairScheduler(conf)) {
    AllocationConfiguration allocConf=new AllocationConfiguration(conf);
    QueuePlacementPolicy queuePolicy=allocConf.getPlacementPolicy();
    if (queuePolicy != null) {
      requestedQueue=queuePolicy.assignAppToQueue(requestedQueue,userName);
      if (StringUtils.isNotBlank(requestedQueue)) {
        LOG.debug("Setting queue name to " + requestedQueue + " for user "+ userName);
        conf.set(MR2_JOB_QUEUE_PROPERTY,requestedQueue);
      }
    }
  }
}
