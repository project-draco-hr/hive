{
  int rc;
  String[] params={"-update","-skipcrccheck",src.toString(),dst.toString()};
  try {
    Class clazzDistCp=Class.forName("org.apache.hadoop.tools.DistCp");
    Constructor c=clazzDistCp.getConstructor();
    c.setAccessible(true);
    Tool distcp=(Tool)c.newInstance();
    distcp.setConf(conf);
    rc=distcp.run(params);
  }
 catch (  ClassNotFoundException e) {
    throw new IOException("Cannot find DistCp class package: " + e.getMessage());
  }
catch (  NoSuchMethodException e) {
    throw new IOException("Cannot get DistCp constructor: " + e.getMessage());
  }
catch (  Exception e) {
    throw new IOException("Cannot execute DistCp process: " + e,e);
  }
  return (0 == rc);
}
