{
  if (local) {
    conf.setBoolean("tez.local.mode",true);
    conf.set("fs.defaultFS","file:///");
    conf.setBoolean("tez.runtime.optimize.local.fetch",true);
    conf.setInt("tez.am.inline.task.execution.max-tasks",6);
    conf.set("tez.staging-dir",tezDir);
    conf.setBoolean("tez.ignore.lib.uris",true);
    conf.setInt("tez.runtime.io.sort.mb",10);
    conf.setInt("tez.runtime.unordered.output.buffer.size-mb",20);
    conf.setFloat("tez.runtime.shuffle.fetch.buffer.percent",0.2f);
    conf.setFloat("tez.runtime.shuffle.memory.limit.percent",0.2f);
    conf.setFloat("tez.runtime.task.input.post-merge.buffer.percent",0f);
    return null;
  }
  return new MiniTezShim(conf,numberOfTaskTrackers,nameNode,numDir);
}
