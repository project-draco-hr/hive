{
  boolean zcr=false;
  boolean storage=false;
  boolean fastread=false;
  try {
    Class.forName("org.apache.hadoop.fs.CacheFlag",false,ShimLoader.class.getClassLoader());
    zcr=true;
  }
 catch (  ClassNotFoundException ce) {
  }
  if (zcr) {
    try {
      Class.forName("org.apache.hadoop.hdfs.protocol.BlockStoragePolicy",false,ShimLoader.class.getClassLoader());
      storage=true;
    }
 catch (    ClassNotFoundException ce) {
    }
  }
  if (storage) {
    for (    Method m : Text.class.getMethods()) {
      if ("readWithKnownLength".equals(m.getName())) {
        fastread=true;
      }
    }
  }
  this.storagePolicy=storage;
  this.zeroCopy=zcr;
  this.fastread=fastread;
}
