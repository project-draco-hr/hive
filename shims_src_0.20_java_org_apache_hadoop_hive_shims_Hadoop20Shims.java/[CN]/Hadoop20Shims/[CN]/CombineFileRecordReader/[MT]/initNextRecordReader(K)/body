{
  if (curReader != null) {
    curReader.close();
    curReader=null;
    if (idx > 0) {
      progress+=split.getLength(idx - 1);
    }
  }
  if (idx == split.getNumPaths() || (isShrinked && progress > shrinkedLength)) {
    return false;
  }
  try {
    curReader=rrConstructor.newInstance(new Object[]{split,jc,reporter,Integer.valueOf(idx)});
    if (key != null) {
      K newKey=curReader.createKey();
      ((CombineHiveKey)key).setKey(newKey);
    }
    jc.set("map.input.file",split.getPath(idx).toString());
    jc.setLong("map.input.start",split.getOffset(idx));
    jc.setLong("map.input.length",split.getLength(idx));
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
  idx++;
  return true;
}
