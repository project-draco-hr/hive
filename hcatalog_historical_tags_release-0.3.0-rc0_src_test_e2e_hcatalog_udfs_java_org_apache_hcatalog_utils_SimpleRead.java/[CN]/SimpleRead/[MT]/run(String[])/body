{
  Configuration conf=getConf();
  args=new GenericOptionsParser(conf,args).getRemainingArgs();
  String serverUri=args[0];
  String tableName=args[1];
  String outputDir=args[2];
  String dbName=null;
  String principalID=System.getProperty(HCatConstants.HCAT_METASTORE_PRINCIPAL);
  if (principalID != null)   conf.set(HCatConstants.HCAT_METASTORE_PRINCIPAL,principalID);
  Job job=new Job(conf,"SimpleRead");
  HCatInputFormat.setInput(job,InputJobInfo.create(dbName,tableName,null,serverUri,principalID));
  job.setInputFormatClass(HCatInputFormat.class);
  job.setOutputFormatClass(TextOutputFormat.class);
  job.setJarByClass(SimpleRead.class);
  job.setMapperClass(Map.class);
  job.setOutputKeyClass(Text.class);
  job.setOutputValueClass(DoubleWritable.class);
  FileOutputFormat.setOutputPath(job,new Path(outputDir));
  return (job.waitForCompletion(true) ? 0 : 1);
}
