{
  if (dbName == null || "".equalsIgnoreCase(dbName)) {
    dbName=MetaStoreUtils.DEFAULT_DATABASE_NAME;
  }
  try {
    if (tableName == null || "".equals(tableName)) {
      List<String> tables=hive.getTablesForDb(dbName,".*");
      for (      String currentTableName : tables) {
        checkTable(dbName,currentTableName,null,result);
      }
      findUnknownTables(dbName,tables,result);
    }
 else     if (partitions == null || partitions.isEmpty()) {
      checkTable(dbName,tableName,null,result);
    }
 else {
      checkTable(dbName,tableName,partitions,result);
    }
    Collections.sort(result.getPartitionsNotInMs());
    Collections.sort(result.getPartitionsNotOnFs());
    Collections.sort(result.getTablesNotInMs());
    Collections.sort(result.getTablesNotOnFs());
  }
 catch (  MetaException e) {
    throw new HiveException(e);
  }
catch (  TException e) {
    throw new HiveException(e);
  }
}
