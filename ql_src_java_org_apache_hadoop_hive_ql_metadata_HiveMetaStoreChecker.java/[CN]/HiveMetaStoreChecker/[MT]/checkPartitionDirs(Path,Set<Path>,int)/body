{
  ConcurrentLinkedQueue<Path> basePaths=new ConcurrentLinkedQueue<>();
  basePaths.add(basePath);
  Set<Path> dirSet=Collections.newSetFromMap(new ConcurrentHashMap<Path,Boolean>());
  final ExecutorService pool=conf.getInt(ConfVars.HIVE_MOVE_FILES_THREAD_COUNT.varname,25) > 0 ? Executors.newFixedThreadPool(conf.getInt(ConfVars.HIVE_MOVE_FILES_THREAD_COUNT.varname,25),new ThreadFactoryBuilder().setDaemon(true).setNameFormat("MSCK-GetPaths-%d").build()) : null;
  if (pool == null) {
    LOG.debug("Not-using threaded version of MSCK-GetPaths");
  }
 else {
    LOG.debug("Using threaded version of MSCK-GetPaths with number of threads " + ((ThreadPoolExecutor)pool).getPoolSize());
  }
  checkPartitionDirs(pool,basePaths,dirSet,basePath.getFileSystem(conf),maxDepth,maxDepth);
  pool.shutdown();
  allDirs.addAll(dirSet);
}
