{
  Table table=null;
  try {
    table=hive.getTable(dbName,tableName);
  }
 catch (  HiveException e) {
    result.getTablesNotInMs().add(tableName);
    return;
  }
  List<Partition> parts=new ArrayList<Partition>();
  boolean findUnknownPartitions=true;
  if (table.isPartitioned()) {
    if (partitions == null || partitions.isEmpty()) {
      parts=hive.getPartitions(table);
    }
 else {
      findUnknownPartitions=false;
      for (      Map<String,String> map : partitions) {
        Partition part=hive.getPartition(table,map,false);
        if (part == null) {
          PartitionResult pr=new PartitionResult();
          pr.setTableName(tableName);
          pr.setPartitionName(Warehouse.makePartPath(map));
          result.getPartitionsNotInMs().add(pr);
        }
 else {
          parts.add(part);
        }
      }
    }
  }
  checkTable(table,parts,findUnknownPartitions,result);
}
