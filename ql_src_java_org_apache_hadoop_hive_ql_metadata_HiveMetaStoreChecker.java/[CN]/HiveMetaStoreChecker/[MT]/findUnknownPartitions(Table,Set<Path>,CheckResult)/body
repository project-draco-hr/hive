{
  Path tablePath=table.getPath();
  Set<Path> allPartDirs=new HashSet<Path>();
  getAllLeafDirs(tablePath,allPartDirs);
  allPartDirs.remove(tablePath);
  allPartDirs.removeAll(partPaths);
  for (  Path partPath : allPartDirs) {
    FileSystem fs=partPath.getFileSystem(conf);
    String partitionName=getPartitionName(fs.makeQualified(tablePath),partPath);
    if (partitionName != null) {
      PartitionResult pr=new PartitionResult();
      pr.setPartitionName(partitionName);
      pr.setTableName(table.getTableName());
      result.getPartitionsNotInMs().add(pr);
    }
  }
}
