{
  Path tablePath=table.getPath();
  if (!fs.exists(tablePath)) {
    result.getTablesNotOnFs().add(table.getName());
    return;
  }
  Set<Path> partPaths=new HashSet<Path>();
  for (  Partition partition : parts) {
    if (partition == null) {
      continue;
    }
    Path partPath=partition.getPartitionPath();
    if (!fs.exists(partPath)) {
      PartitionResult pr=new PartitionResult();
      pr.setPartitionName(partition.getName());
      pr.setTableName(partition.getTable().getName());
      result.getPartitionsNotOnFs().add(pr);
    }
    for (int i=0; i < partition.getSpec().size(); i++) {
      partPaths.add(partPath.makeQualified(fs));
      partPath=partPath.getParent();
    }
  }
  if (findUnknownPartitions) {
    findUnknownPartitions(table,partPaths,result);
  }
}
