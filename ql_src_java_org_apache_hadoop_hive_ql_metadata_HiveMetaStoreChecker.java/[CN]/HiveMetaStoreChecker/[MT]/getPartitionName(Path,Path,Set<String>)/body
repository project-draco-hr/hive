{
  String result=null;
  Path currPath=partitionPath;
  LOG.debug("tablePath:" + tablePath + ", partCols: "+ partCols);
  while (currPath != null && !tablePath.equals(currPath)) {
    String[] parts=currPath.getName().split("=");
    if (parts != null && parts.length > 0) {
      if (parts.length != 2) {
        LOG.warn(currPath.getName() + " is not a valid partition name");
        return result;
      }
      String partitionName=parts[0];
      if (partCols.contains(partitionName)) {
        if (result == null) {
          result=currPath.getName();
        }
 else {
          result=currPath.getName() + Path.SEPARATOR + result;
        }
      }
    }
    currPath=currPath.getParent();
    LOG.debug("currPath=" + currPath);
  }
  return result;
}
