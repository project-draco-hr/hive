{
  List<InputDataInformationEvent> taskEvents=new ArrayList<InputDataInformationEvent>();
  LOG.info("We have a routing table and we are going to set the destination tasks for the" + " multi mr inputs. " + bucketToTaskMap);
  Integer[] numSplitsForTask=new Integer[taskCount];
  for (  Entry<Integer,Collection<InputSplit>> entry : bucketToGroupedSplitMap.asMap().entrySet()) {
    Collection<Integer> destTasks=bucketToTaskMap.get(entry.getKey());
    for (    Integer task : destTasks) {
      int count=0;
      for (      InputSplit split : entry.getValue()) {
        count++;
        MRSplitProto serializedSplit=MRInputHelpers.createSplitProto(split);
        InputDataInformationEvent diEvent=InputDataInformationEvent.createWithSerializedPayload(task,serializedSplit.toByteString().asReadOnlyByteBuffer());
        diEvent.setTargetIndex(task);
        taskEvents.add(diEvent);
      }
      numSplitsForTask[task]=count;
    }
  }
  inputNameInputSpecMap.put(inputName,InputSpecUpdate.createPerTaskInputSpecUpdate(Arrays.asList(numSplitsForTask)));
  LOG.info("For input name: " + inputName + " task events size is "+ taskEvents.size());
  context.addRootInputEvents(inputName,taskEvents);
}
