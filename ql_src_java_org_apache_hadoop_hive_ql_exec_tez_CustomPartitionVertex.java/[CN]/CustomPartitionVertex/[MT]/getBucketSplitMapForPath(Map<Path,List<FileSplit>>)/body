{
  int bucketNum=0;
  int fsCount=0;
  Multimap<Integer,InputSplit> bucketToInitialSplitMap=ArrayListMultimap.<Integer,InputSplit>create();
  for (  Map.Entry<Path,List<FileSplit>> entry : pathFileSplitsMap.entrySet()) {
    int bucketId=bucketNum % numBuckets;
    for (    FileSplit fsplit : entry.getValue()) {
      fsCount++;
      bucketToInitialSplitMap.put(bucketId,fsplit);
    }
    bucketNum++;
  }
  LOG.info("Total number of splits counted: " + fsCount + " and total files encountered: "+ pathFileSplitsMap.size());
  return bucketToInitialSplitMap;
}
