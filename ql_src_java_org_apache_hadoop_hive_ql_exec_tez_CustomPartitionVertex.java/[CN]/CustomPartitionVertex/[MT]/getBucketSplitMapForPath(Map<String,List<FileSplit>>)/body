{
  int bucketNum=0;
  Multimap<Integer,InputSplit> bucketToInitialSplitMap=ArrayListMultimap.<Integer,InputSplit>create();
  for (  Map.Entry<String,List<FileSplit>> entry : pathFileSplitsMap.entrySet()) {
    int bucketId=bucketNum % numBuckets;
    for (    FileSplit fsplit : entry.getValue()) {
      bucketToInitialSplitMap.put(bucketId,fsplit);
    }
    bucketNum++;
  }
  if (bucketNum < numBuckets) {
    int loopedBucketId=0;
    for (; bucketNum < numBuckets; bucketNum++) {
      for (      InputSplit fsplit : bucketToInitialSplitMap.get(loopedBucketId)) {
        bucketToInitialSplitMap.put(bucketNum,fsplit);
      }
      loopedBucketId++;
    }
  }
  return bucketToInitialSplitMap;
}
