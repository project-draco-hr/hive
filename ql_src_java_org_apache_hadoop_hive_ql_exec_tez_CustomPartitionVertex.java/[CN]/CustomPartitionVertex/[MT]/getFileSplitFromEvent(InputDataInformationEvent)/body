{
  InputSplit inputSplit=null;
  if (event.getDeserializedUserPayload() != null) {
    inputSplit=(InputSplit)event.getDeserializedUserPayload();
  }
 else {
    MRSplitProto splitProto=MRSplitProto.parseFrom(ByteString.copyFrom(event.getUserPayload()));
    SerializationFactory serializationFactory=new SerializationFactory(new Configuration());
    inputSplit=MRInputHelpers.createOldFormatSplitFromUserPayload(splitProto,serializationFactory);
  }
  if (!(inputSplit instanceof FileSplit)) {
    throw new UnsupportedOperationException("Cannot handle splits other than FileSplit for the moment");
  }
  return (FileSplit)inputSplit;
}
