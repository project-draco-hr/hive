{
  TypeDescription fileSchema=TypeDescription.createStruct().addField("f1",TypeDescription.createString());
  SchemaEvolution schemaEvolution=new SchemaEvolution(fileSchema,null);
  assertTrue(schemaEvolution.isPPDSafeConversion(0));
  assertFalse(schemaEvolution.hasConversion());
  TypeDescription readerSchema=TypeDescription.createStruct().addField("f1",TypeDescription.createChar());
  schemaEvolution=new SchemaEvolution(fileSchema,readerSchema,null);
  assertTrue(schemaEvolution.hasConversion());
  assertFalse(schemaEvolution.isPPDSafeConversion(0));
  assertFalse(schemaEvolution.isPPDSafeConversion(1));
  readerSchema=TypeDescription.createStruct().addField("f1",TypeDescription.createVarchar());
  schemaEvolution=new SchemaEvolution(fileSchema,readerSchema,null);
  assertTrue(schemaEvolution.hasConversion());
  assertFalse(schemaEvolution.isPPDSafeConversion(0));
  assertTrue(schemaEvolution.isPPDSafeConversion(1));
  fileSchema=TypeDescription.createStruct().addField("f1",TypeDescription.createChar());
  schemaEvolution=new SchemaEvolution(fileSchema,null);
  assertTrue(schemaEvolution.isPPDSafeConversion(0));
  assertFalse(schemaEvolution.hasConversion());
  readerSchema=TypeDescription.createStruct().addField("f1",TypeDescription.createString());
  schemaEvolution=new SchemaEvolution(fileSchema,readerSchema,null);
  assertTrue(schemaEvolution.hasConversion());
  assertFalse(schemaEvolution.isPPDSafeConversion(0));
  assertFalse(schemaEvolution.isPPDSafeConversion(1));
  readerSchema=TypeDescription.createStruct().addField("f1",TypeDescription.createVarchar());
  schemaEvolution=new SchemaEvolution(fileSchema,readerSchema,null);
  assertTrue(schemaEvolution.hasConversion());
  assertFalse(schemaEvolution.isPPDSafeConversion(0));
  assertFalse(schemaEvolution.isPPDSafeConversion(1));
  fileSchema=TypeDescription.createStruct().addField("f1",TypeDescription.createVarchar());
  schemaEvolution=new SchemaEvolution(fileSchema,null);
  assertTrue(schemaEvolution.isPPDSafeConversion(0));
  assertFalse(schemaEvolution.hasConversion());
  readerSchema=TypeDescription.createStruct().addField("f1",TypeDescription.createString());
  schemaEvolution=new SchemaEvolution(fileSchema,readerSchema,null);
  assertTrue(schemaEvolution.hasConversion());
  assertFalse(schemaEvolution.isPPDSafeConversion(0));
  assertTrue(schemaEvolution.isPPDSafeConversion(1));
  readerSchema=TypeDescription.createStruct().addField("f1",TypeDescription.createChar());
  schemaEvolution=new SchemaEvolution(fileSchema,readerSchema,null);
  assertTrue(schemaEvolution.hasConversion());
  assertFalse(schemaEvolution.isPPDSafeConversion(0));
  assertFalse(schemaEvolution.isPPDSafeConversion(1));
  readerSchema=TypeDescription.createStruct().addField("f1",TypeDescription.createDecimal());
  schemaEvolution=new SchemaEvolution(fileSchema,readerSchema,null);
  assertTrue(schemaEvolution.hasConversion());
  assertFalse(schemaEvolution.isPPDSafeConversion(0));
  assertFalse(schemaEvolution.isPPDSafeConversion(1));
  readerSchema=TypeDescription.createStruct().addField("f1",TypeDescription.createDate());
  schemaEvolution=new SchemaEvolution(fileSchema,readerSchema,null);
  assertTrue(schemaEvolution.hasConversion());
  assertFalse(schemaEvolution.isPPDSafeConversion(0));
  assertFalse(schemaEvolution.isPPDSafeConversion(1));
  readerSchema=TypeDescription.createStruct().addField("f1",TypeDescription.createInt());
  schemaEvolution=new SchemaEvolution(fileSchema,readerSchema,null);
  assertTrue(schemaEvolution.hasConversion());
  assertFalse(schemaEvolution.isPPDSafeConversion(0));
  assertFalse(schemaEvolution.isPPDSafeConversion(1));
}
