{
  HCatSchema schema=HCatUtil.extractSchemaFromStorageDescriptor(sd);
  String inputStorageDriverClass=null;
  Properties howlProperties=new Properties();
  if (parameters.containsKey(HCatConstants.HCAT_ISD_CLASS)) {
    inputStorageDriverClass=parameters.get(HCatConstants.HCAT_ISD_CLASS);
  }
 else {
    if ((sd.getInputFormat() != null) && (sd.getInputFormat().equals(HCatConstants.HIVE_RCFILE_IF_CLASS))) {
      inputStorageDriverClass=HCatConstants.HCAT_RCFILE_ISD_CLASS;
    }
 else {
      throw new IOException("No input storage driver classname found, cannot read partition");
    }
  }
  for (  String key : parameters.keySet()) {
    if (key.startsWith(HCAT_KEY_PREFIX)) {
      howlProperties.put(key,parameters.get(key));
    }
  }
  return new PartInfo(schema,inputStorageDriverClass,sd.getLocation(),howlProperties);
}
