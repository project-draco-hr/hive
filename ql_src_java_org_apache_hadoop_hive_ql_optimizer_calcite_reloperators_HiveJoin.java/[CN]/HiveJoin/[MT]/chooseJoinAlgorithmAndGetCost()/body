{
  chooseStreamingSide();
  checkInputsCorrectOrder();
  Set<JoinAlgorithm> possibleAlgorithms=obtainJoinAlgorithms();
  RelOptCost selfCost=null;
  for (  JoinAlgorithm possibleAlgorithm : possibleAlgorithms) {
switch (possibleAlgorithm) {
case COMMON_JOIN:
      RelOptCost commonJoinCost=computeSelfCostCommonJoin();
    if (LOG.isDebugEnabled()) {
      LOG.debug("COMMONJOIN possible");
      LOG.debug("COMMONJOIN cost: " + commonJoinCost);
    }
  if (selfCost == null || commonJoinCost.isLt(selfCost)) {
    this.joinAlgorithm=JoinAlgorithm.COMMON_JOIN;
    selfCost=commonJoinCost;
  }
break;
case MAP_JOIN:
RelOptCost mapJoinCost=computeSelfCostMapJoin();
if (LOG.isDebugEnabled()) {
LOG.debug("MAPJOIN possible");
LOG.debug("MAPJOIN cost: " + mapJoinCost);
}
if (selfCost == null || mapJoinCost.isLt(selfCost)) {
this.joinAlgorithm=JoinAlgorithm.MAP_JOIN;
selfCost=mapJoinCost;
}
break;
case BUCKET_JOIN:
RelOptCost bucketJoinCost=computeSelfCostBucketJoin();
if (LOG.isDebugEnabled()) {
LOG.debug("BUCKETJOIN possible");
LOG.debug("BUCKETJOIN cost: " + bucketJoinCost);
}
if (selfCost == null || bucketJoinCost.isLt(selfCost)) {
this.joinAlgorithm=JoinAlgorithm.BUCKET_JOIN;
selfCost=bucketJoinCost;
}
break;
case SMB_JOIN:
RelOptCost smbJoinCost=computeSelfCostSMBJoin();
if (LOG.isDebugEnabled()) {
LOG.debug("SMBJOIN possible");
LOG.debug("SMBJOIN cost: " + smbJoinCost);
}
if (selfCost == null || smbJoinCost.isLt(selfCost)) {
this.joinAlgorithm=JoinAlgorithm.SMB_JOIN;
selfCost=smbJoinCost;
}
break;
default :
}
}
return selfCost;
}
