{
  long lockId=((DbHiveLock)hiveLock).lockId;
  try {
    LOG.debug("Unlocking " + hiveLock);
    client.unlock(lockId);
    boolean removed=locks.remove(hiveLock);
    LOG.debug("Removed a lock " + removed);
  }
 catch (  NoSuchLockException e) {
    LOG.error("Metastore could find no record of lock " + JavaUtils.lockIdToString(lockId));
    throw new LockException(e,ErrorMsg.LOCK_NO_SUCH_LOCK,JavaUtils.lockIdToString(lockId));
  }
catch (  TxnOpenException e) {
    throw new RuntimeException("Attempt to unlock lock " + JavaUtils.lockIdToString(lockId) + "associated with an open transaction, "+ e.getMessage(),e);
  }
catch (  TException e) {
    throw new LockException(ErrorMsg.METASTORE_COMMUNICATION_FAILED.getMsg(),e);
  }
}
