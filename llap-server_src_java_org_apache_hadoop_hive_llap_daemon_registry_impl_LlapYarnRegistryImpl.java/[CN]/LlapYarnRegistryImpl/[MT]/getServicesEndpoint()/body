{
  final int servicePort=conf.getInt(LlapConfiguration.LLAP_DAEMON_SERVICE_PORT,LlapConfiguration.LLAP_DAEMON_SERVICE_PORT_DEFAULT);
  final boolean isSSL=conf.getBoolean(LlapConfiguration.LLAP_DAEMON_SERVICE_SSL,LlapConfiguration.LLAP_DAEMON_SERVICE_SSL_DEFAULT);
  final String scheme=isSSL ? "https" : "http";
  final URL serviceURL;
  try {
    serviceURL=new URL(scheme,hostname,servicePort,"");
    return RegistryTypeUtils.webEndpoint("services",serviceURL.toURI());
  }
 catch (  MalformedURLException e) {
    throw new TezUncheckedException(e);
  }
catch (  URISyntaxException e) {
    throw new TezUncheckedException("llap service URI for " + hostname + " is invalid",e);
  }
}
