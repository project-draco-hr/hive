{
  LOG.info("Llap Registry is enabled with registryid: " + instanceName);
  this.conf=new Configuration(conf);
  this.instanceName=instanceName;
  conf.addResource(YarnConfiguration.YARN_SITE_CONFIGURATION_FILE);
  client=(RegistryOperationsService)RegistryOperationsFactory.createInstance(conf);
  encoder=new RegistryUtils.ServiceRecordMarshal();
  refreshDelay=conf.getInt(LlapConfiguration.LLAP_DAEMON_SERVICE_REFRESH_INTERVAL,LlapConfiguration.LLAP_DAEMON_SERVICE_REFRESH_INTERVAL_DEFAULT);
  Preconditions.checkArgument(refreshDelay > 0,"Refresh delay for registry has to be positive = %d",refreshDelay);
}
