{
  LOG.info("Llap Registry is enabled with registryid: " + instanceName);
  this.conf=new Configuration(conf);
  conf.addResource(YarnConfiguration.YARN_SITE_CONFIGURATION_FILE);
  client=(RegistryOperationsService)RegistryOperationsFactory.createInstance(conf);
  encoder=new RegistryUtils.ServiceRecordMarshal();
  this.path=RegistryPathUtils.join(RegistryUtils.componentPath(RegistryUtils.currentUser(),SERVICE_CLASS,instanceName,"workers"),"worker-");
  refreshDelay=conf.getInt(LlapConfiguration.LLAP_DAEMON_SERVICE_REFRESH_INTERVAL,LlapConfiguration.LLAP_DAEMON_SERVICE_REFRESH_INTERVAL_DEFAULT);
  this.isDaemon=isDaemon;
  Preconditions.checkArgument(refreshDelay > 0,"Refresh delay for registry has to be positive = %d",refreshDelay);
}
