{
  try {
    Token<LlapTokenIdentifier> token=secretManager.createLlapToken(appId,user);
    if (LOG.isInfoEnabled()) {
      LOG.info("Created a LLAP delegation token locally: " + token);
    }
    return token;
  }
 catch (  Exception ex) {
    throw new IOException("Failed to create LLAP token locally. You might need to set " + ConfVars.LLAP_CREATE_TOKEN_LOCALLY.varname + " to false, or make sure you can access secure ZK paths.",ex);
  }
}
