{
  FileSystem destFS=dest.getFileSystem(conf);
  if (!(destFS instanceof DistributedFileSystem)) {
    throw new IOException(ErrorMsg.INVALID_HDFS_URI.format(dest.toString()));
  }
  if (src != null) {
    if (!checkPreExisting(src,dest,conf)) {
      destFS.copyFromLocalFile(false,true,src,dest);
    }
  }
  return createLocalResource(destFS,dest,LocalResourceType.FILE,LocalResourceVisibility.APPLICATION);
}
