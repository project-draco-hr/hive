{
  ProcessorDescriptor prewarmProcDescriptor=ProcessorDescriptor.create(HivePreWarmProcessor.class.getName());
  prewarmProcDescriptor.setUserPayload(TezUtils.createUserPayloadFromConf(conf));
  PreWarmVertex prewarmVertex=PreWarmVertex.create("prewarm",prewarmProcDescriptor,numContainers,getContainerResource(conf));
  Map<String,LocalResource> combinedResources=new HashMap<String,LocalResource>();
  if (localResources != null) {
    combinedResources.putAll(localResources);
  }
  prewarmVertex.addTaskLocalFiles(localResources);
  prewarmVertex.setTaskLaunchCmdOpts(getContainerJavaOpts(conf));
  prewarmVertex.setTaskEnvironment(getContainerEnvironment(conf,false));
  return prewarmVertex;
}
