{
  ProcessorDescriptor prewarmProcDescriptor=new ProcessorDescriptor(HivePreWarmProcessor.class.getName());
  prewarmProcDescriptor.setUserPayload(MRHelpers.createUserPayloadFromConf(conf));
  PreWarmVertex prewarmVertex=new PreWarmVertex("prewarm",prewarmProcDescriptor,numContainers,getContainerResource(conf));
  Map<String,LocalResource> combinedResources=new HashMap<String,LocalResource>();
  if (localResources != null) {
    combinedResources.putAll(localResources);
  }
  prewarmVertex.setTaskLocalFiles(localResources);
  prewarmVertex.setTaskLaunchCmdOpts(getContainerJavaOpts(conf));
  prewarmVertex.setTaskEnvironment(getContainerEnvironment(conf,false));
  return prewarmVertex;
}
