{
  MultiStageMRConfToTezTranslator.translateVertexConfToTez(wConf,vConf);
  v.getProcessorDescriptor().setUserPayload(MRHelpers.createUserPayloadFromConf(vConf));
  w.getProcessorDescriptor().setUserPayload(MRHelpers.createUserPayloadFromConf(wConf));
  DataMovementType dataMovementType;
  Class logicalInputClass;
  Class logicalOutputClass;
switch (edgeType) {
case BROADCAST_EDGE:
    dataMovementType=DataMovementType.BROADCAST;
  logicalOutputClass=OnFileUnorderedKVOutput.class;
logicalInputClass=ShuffledUnorderedKVInput.class;
break;
case SIMPLE_EDGE:
default :
dataMovementType=DataMovementType.SCATTER_GATHER;
logicalOutputClass=OnFileSortedOutput.class;
logicalInputClass=ShuffledMergedInputLegacy.class;
break;
}
EdgeProperty edgeProperty=new EdgeProperty(dataMovementType,DataSourceType.PERSISTED,SchedulingType.SEQUENTIAL,new OutputDescriptor(logicalOutputClass.getName()),new InputDescriptor(logicalInputClass.getName()));
return new Edge(v,w,edgeProperty);
}
