{
  String javaOpts=HiveConf.getVar(conf,HiveConf.ConfVars.HIVETEZJAVAOPTS);
  String logLevel=HiveConf.getVar(conf,HiveConf.ConfVars.HIVETEZLOGLEVEL);
  List<String> logProps=Lists.newArrayList();
  TezUtils.addLog4jSystemProperties(logLevel,logProps);
  StringBuilder sb=new StringBuilder();
  for (  String str : logProps) {
    sb.append(str).append(" ");
  }
  logLevel=sb.toString();
  if (HiveConf.getIntVar(conf,HiveConf.ConfVars.HIVETEZCONTAINERSIZE) > 0) {
    if (javaOpts != null) {
      return javaOpts + " " + logLevel;
    }
 else {
      return logLevel;
    }
  }
 else {
    if (javaOpts != null && !javaOpts.isEmpty()) {
      LOG.warn(HiveConf.ConfVars.HIVETEZJAVAOPTS + " will be ignored because " + HiveConf.ConfVars.HIVETEZCONTAINERSIZE+ " is not set!");
    }
    return logLevel + " " + MRHelpers.getJavaOptsForMRMapper(conf);
  }
}
