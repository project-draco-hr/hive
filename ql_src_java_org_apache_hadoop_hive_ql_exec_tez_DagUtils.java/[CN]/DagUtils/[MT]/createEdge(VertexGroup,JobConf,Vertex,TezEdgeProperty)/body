{
  Class mergeInputClass;
  LOG.info("Creating Edge between " + group.getGroupName() + " and "+ w.getVertexName());
  w.getProcessorDescriptor().setUserPayload(MRHelpers.createUserPayloadFromConf(wConf));
  EdgeType edgeType=edgeProp.getEdgeType();
switch (edgeType) {
case BROADCAST_EDGE:
    mergeInputClass=ConcatenatedMergedKeyValueInput.class;
  break;
case CUSTOM_EDGE:
mergeInputClass=ConcatenatedMergedKeyValueInput.class;
int numBuckets=edgeProp.getNumBuckets();
VertexManagerPluginDescriptor desc=new VertexManagerPluginDescriptor(CustomPartitionVertex.class.getName());
byte[] userPayload=ByteBuffer.allocate(4).putInt(numBuckets).array();
desc.setUserPayload(userPayload);
w.setVertexManagerPlugin(desc);
break;
case CUSTOM_SIMPLE_EDGE:
mergeInputClass=ConcatenatedMergedKeyValueInput.class;
break;
case SIMPLE_EDGE:
default :
mergeInputClass=TezMergedLogicalInput.class;
break;
}
return new GroupInputEdge(group,w,createEdgeProperty(edgeProp),new InputDescriptor(mergeInputClass.getName()));
}
