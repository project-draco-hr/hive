{
  conf.set(Utilities.INPUT_NAME,reduceWork.getName());
  Utilities.setReduceWork(conf,reduceWork,mrScratchDir,false);
  Utilities.createTmpDirs(conf,reduceWork);
  String serviceName=findServiceName(reduceWork);
  Vertex reducer=Vertex.create(reduceWork.getName(),ProcessorDescriptor.create(ReduceTezProcessor.class.getName()).setUserPayload(TezUtils.createUserPayloadFromConf(conf)),reduceWork.isAutoReduceParallelism() ? reduceWork.getMaxReduceTasks() : reduceWork.getNumReduceTasks(),getContainerResource(conf)).setConf(TezConfiguration.TEZ_AM_VERTEX_TASK_SCHEDULER_NAME,serviceName).setConf(TezConfiguration.TEZ_AM_VERTEX_CONTAINER_LAUNCHER_NAME,serviceName).setConf(TezConfiguration.TEZ_AM_VERTEX_TASK_COMMUNICATOR_NAME,serviceName);
  reducer.setTaskEnvironment(getContainerEnvironment(conf,false));
  reducer.setTaskLaunchCmdOpts(getContainerJavaOpts(conf));
  Map<String,LocalResource> localResources=new HashMap<String,LocalResource>();
  localResources.put(getBaseName(appJarLr),appJarLr);
  for (  LocalResource lr : additionalLr) {
    localResources.put(getBaseName(lr),lr);
  }
  reducer.addTaskLocalFiles(localResources);
  return reducer;
}
