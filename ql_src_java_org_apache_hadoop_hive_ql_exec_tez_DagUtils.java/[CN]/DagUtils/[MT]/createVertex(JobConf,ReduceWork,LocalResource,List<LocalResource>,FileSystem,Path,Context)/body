{
  Utilities.setReduceWork(conf,reduceWork,mrScratchDir,false);
  Utilities.createTmpDirs(conf,reduceWork);
  MultiStageMRConfToTezTranslator.translateVertexConfToTez(conf,null);
  Vertex reducer=new Vertex(reduceWork.getName(),new ProcessorDescriptor(ReduceTezProcessor.class.getName()).setUserPayload(MRHelpers.createUserPayloadFromConf(conf)),reduceWork.getNumReduceTasks(),getContainerResource(conf));
  Map<String,String> environment=new HashMap<String,String>();
  MRHelpers.updateEnvironmentForMRTasks(conf,environment,false);
  reducer.setTaskEnvironment(environment);
  reducer.setJavaOpts(getContainerJavaOpts(conf));
  Map<String,LocalResource> localResources=new HashMap<String,LocalResource>();
  localResources.put(getBaseName(appJarLr),appJarLr);
  for (  LocalResource lr : additionalLr) {
    localResources.put(getBaseName(lr),lr);
  }
  reducer.setTaskLocalResources(localResources);
  return reducer;
}
