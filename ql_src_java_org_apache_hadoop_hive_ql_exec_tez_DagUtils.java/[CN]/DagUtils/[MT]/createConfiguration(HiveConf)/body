{
  hiveConf.setBoolean("mapred.mapper.new-api",false);
  JobConf conf=new JobConf(hiveConf);
  conf.set("mapred.output.committer.class",NullOutputCommitter.class.getName());
  conf.setBoolean("mapred.committer.job.setup.cleanup.needed",false);
  conf.setBoolean("mapred.committer.job.task.cleanup.needed",false);
  conf.setClass("mapred.output.format.class",HiveOutputFormatImpl.class,OutputFormat.class);
  conf.set(MRJobConfig.OUTPUT_KEY_CLASS,HiveKey.class.getName());
  conf.set(MRJobConfig.OUTPUT_VALUE_CLASS,BytesWritable.class.getName());
  conf.set("mapred.partitioner.class",HiveConf.getVar(conf,HiveConf.ConfVars.HIVEPARTITIONER));
  conf.set("tez.runtime.partitioner.class",MRPartitioner.class.getName());
  return conf;
}
