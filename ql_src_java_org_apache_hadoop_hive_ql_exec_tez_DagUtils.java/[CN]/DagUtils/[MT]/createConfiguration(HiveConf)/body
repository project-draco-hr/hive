{
  hiveConf.setBoolean("mapred.mapper.new-api",false);
  JobConf conf=(JobConf)MRHelpers.getBaseMRConfiguration();
  MRHelpers.doJobClientMagic(conf);
  for (  Map.Entry<String,String> entry : hiveConf) {
    if (conf.get(entry.getKey()) == null) {
      conf.set(entry.getKey(),entry.getValue());
    }
  }
  conf.set("mapreduce.framework.name","yarn-tez");
  conf.set("mapreduce.job.output.committer.class",NullOutputCommitter.class.getName());
  conf.setBoolean(MRJobConfig.SETUP_CLEANUP_NEEDED,false);
  conf.setBoolean(MRJobConfig.TASK_CLEANUP_NEEDED,false);
  conf.setClass(MRJobConfig.OUTPUT_FORMAT_CLASS_ATTR,HiveOutputFormatImpl.class,OutputFormat.class);
  conf.set(MRJobConfig.MAP_CLASS_ATTR,ExecMapper.class.getName());
  conf.set(MRJobConfig.OUTPUT_KEY_CLASS,HiveKey.class.getName());
  conf.set(MRJobConfig.OUTPUT_VALUE_CLASS,BytesWritable.class.getName());
  conf.set(MRJobConfig.PARTITIONER_CLASS_ATTR,HiveConf.getVar(conf,HiveConf.ConfVars.HIVEPARTITIONER));
  return conf;
}
