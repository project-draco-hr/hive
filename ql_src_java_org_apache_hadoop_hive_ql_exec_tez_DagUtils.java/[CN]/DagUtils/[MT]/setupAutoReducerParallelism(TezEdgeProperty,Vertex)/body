{
  if (edgeProp.isAutoReduce()) {
    Configuration pluginConf=new Configuration(false);
    VertexManagerPluginDescriptor desc=new VertexManagerPluginDescriptor(ShuffleVertexManager.class.getName());
    pluginConf.setBoolean(ShuffleVertexManager.TEZ_AM_SHUFFLE_VERTEX_MANAGER_ENABLE_AUTO_PARALLEL,true);
    pluginConf.setInt(ShuffleVertexManager.TEZ_AM_SHUFFLE_VERTEX_MANAGER_MIN_TASK_PARALLELISM,edgeProp.getMinReducer());
    pluginConf.setLong(ShuffleVertexManager.TEZ_AM_SHUFFLE_VERTEX_MANAGER_DESIRED_TASK_INPUT_SIZE,edgeProp.getInputSizePerReducer());
    ByteString payload=MRHelpers.createByteStringFromConf(pluginConf);
    desc.setUserPayload(payload.toByteArray());
    v.setVertexManagerPlugin(desc);
  }
}
