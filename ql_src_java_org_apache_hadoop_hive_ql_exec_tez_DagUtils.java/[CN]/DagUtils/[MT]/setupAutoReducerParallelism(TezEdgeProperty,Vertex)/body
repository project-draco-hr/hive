{
  if (edgeProp.isAutoReduce()) {
    Configuration pluginConf=new Configuration(false);
    VertexManagerPluginDescriptor desc=VertexManagerPluginDescriptor.create(ShuffleVertexManager.class.getName());
    pluginConf.setBoolean(ShuffleVertexManager.TEZ_SHUFFLE_VERTEX_MANAGER_ENABLE_AUTO_PARALLEL,true);
    pluginConf.setInt(ShuffleVertexManager.TEZ_SHUFFLE_VERTEX_MANAGER_MIN_TASK_PARALLELISM,edgeProp.getMinReducer());
    pluginConf.setLong(ShuffleVertexManager.TEZ_SHUFFLE_VERTEX_MANAGER_DESIRED_TASK_INPUT_SIZE,edgeProp.getInputSizePerReducer());
    UserPayload payload=TezUtils.createUserPayloadFromConf(pluginConf);
    desc.setUserPayload(payload);
    v.setVertexManagerPlugin(desc);
  }
}
