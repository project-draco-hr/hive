{
  UserGroupInformation ugi;
  String userName=System.getProperty("user.name");
  try {
    ugi=ShimLoader.getHadoopShims().getUGIForConf(conf);
    userName=ShimLoader.getHadoopShims().getShortUserName(ugi);
  }
 catch (  LoginException e) {
    throw new IOException(e);
  }
  scratchDir=new Path(scratchDir,userName);
  Path tezDir=getTezDir(scratchDir);
  FileSystem fs=tezDir.getFileSystem(conf);
  LOG.debug("TezDir path set " + tezDir + " for user: "+ userName);
  fs.mkdirs(tezDir);
  return tezDir;
}
