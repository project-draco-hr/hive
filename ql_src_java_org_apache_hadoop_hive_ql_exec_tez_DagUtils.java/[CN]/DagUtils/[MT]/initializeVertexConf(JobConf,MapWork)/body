{
  JobConf conf=new JobConf(baseConf);
  if (mapWork.getNumMapTasks() != null) {
    conf.setInt(MRJobConfig.NUM_MAPS,mapWork.getNumMapTasks().intValue());
  }
  if (mapWork.getMaxSplitSize() != null) {
    HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMAXSPLITSIZE,mapWork.getMaxSplitSize().longValue());
  }
  if (mapWork.getMinSplitSize() != null) {
    HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMINSPLITSIZE,mapWork.getMinSplitSize().longValue());
  }
  if (mapWork.getMinSplitSizePerNode() != null) {
    HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMINSPLITSIZEPERNODE,mapWork.getMinSplitSizePerNode().longValue());
  }
  if (mapWork.getMinSplitSizePerRack() != null) {
    HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMINSPLITSIZEPERRACK,mapWork.getMinSplitSizePerRack().longValue());
  }
  Utilities.setInputAttributes(conf,mapWork);
  String inpFormat=HiveConf.getVar(conf,HiveConf.ConfVars.HIVEINPUTFORMAT);
  if ((inpFormat == null) || (!StringUtils.isNotBlank(inpFormat))) {
    inpFormat=ShimLoader.getHadoopShims().getInputFormatClassName();
  }
  if (mapWork.isUseBucketizedHiveInputFormat()) {
    inpFormat=BucketizedHiveInputFormat.class.getName();
  }
  conf.set(MRJobConfig.MAP_CLASS_ATTR,ExecMapper.class.getName());
  conf.set(MRJobConfig.INPUT_FORMAT_CLASS_ATTR,inpFormat);
  return conf;
}
