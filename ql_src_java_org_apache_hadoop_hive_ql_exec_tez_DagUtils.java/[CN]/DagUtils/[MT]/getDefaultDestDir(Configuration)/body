{
  UserGroupInformation ugi=ShimLoader.getHadoopShims().getUGIForConf(conf);
  String userName=ShimLoader.getHadoopShims().getShortUserName(ugi);
  String userPathStr=HiveConf.getVar(conf,HiveConf.ConfVars.HIVE_USER_INSTALL_DIR);
  Path userPath=new Path(userPathStr);
  FileSystem fs=userPath.getFileSystem(conf);
  String jarPathStr=userPathStr + "/" + userName;
  String hdfsDirPathStr=jarPathStr;
  Path hdfsDirPath=new Path(hdfsDirPathStr);
  FileStatus fstatus=fs.getFileStatus(hdfsDirPath);
  if (!fstatus.isDir()) {
    throw new IOException(ErrorMsg.INVALID_DIR.format(hdfsDirPath.toString()));
  }
  Path retPath=new Path(hdfsDirPath.toString() + "/.hiveJars");
  fs.mkdirs(retPath);
  return retPath;
}
