{
  Path planPath=Utilities.setReduceWork(conf,reduceWork,mrScratchDir.getName(),false);
  LocalResource planLr=createLocalResource(fs,planPath,LocalResourceType.FILE,LocalResourceVisibility.APPLICATION);
  Vertex reducer=new Vertex("Reducer " + seqNo,new ProcessorDescriptor(ReduceProcessor.class.getName(),MRHelpers.createUserPayloadFromConf(conf)),reduceWork.getNumReduceTasks(),MRHelpers.getReduceResource(conf));
  Map<String,String> environment=new HashMap<String,String>();
  MRHelpers.updateEnvironmentForMRTasks(conf,environment,false);
  reducer.setTaskEnvironment(environment);
  reducer.setJavaOpts(MRHelpers.getReduceJavaOpts(conf));
  Map<String,LocalResource> localResources=new HashMap<String,LocalResource>();
  localResources.put(appJarLr.getResource().getFile(),appJarLr);
  for (  LocalResource lr : additionalLr) {
    localResources.put(lr.getResource().getFile(),lr);
  }
  localResources.put(planPath.getName(),planLr);
  reducer.setTaskLocalResources(localResources);
  return reducer;
}
