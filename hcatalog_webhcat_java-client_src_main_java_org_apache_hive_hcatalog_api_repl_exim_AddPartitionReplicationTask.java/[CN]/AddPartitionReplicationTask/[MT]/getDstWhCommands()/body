{
  verifyActionable();
  if (addPartitionMessage.getPartitions().isEmpty()) {
    return Collections.singletonList(new NoopCommand(event.getEventId()));
  }
  final String dstDbName=ReplicationUtils.mapIfMapAvailable(addPartitionMessage.getDB(),dbNameMapping);
  final String dstTableName=ReplicationUtils.mapIfMapAvailable(addPartitionMessage.getTable(),tableNameMapping);
  return Iterables.transform(addPartitionMessage.getPartitions(),new Function<Map<String,String>,Command>(){
    @Override public Command apply(    @Nullable Map<String,String> ptnDesc){
      return new ImportCommand(dstDbName,dstTableName,ptnDesc,dstStagingDirProvider.getStagingDirectory(ReplicationUtils.getUniqueKey(getEvent().getEventId(),addPartitionMessage.getDB(),addPartitionMessage.getTable(),ptnDesc)),false,event.getEventId());
    }
  }
);
}
