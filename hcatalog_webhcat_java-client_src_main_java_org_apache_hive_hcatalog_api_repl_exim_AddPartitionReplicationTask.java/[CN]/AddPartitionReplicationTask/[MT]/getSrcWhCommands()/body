{
  verifyActionable();
  if (addPartitionMessage.getPartitions().isEmpty()) {
    return Collections.singletonList(new NoopCommand(event.getEventId()));
  }
  return Iterables.transform(addPartitionMessage.getPartitions(),new Function<Map<String,String>,Command>(){
    @Override public Command apply(    @Nullable Map<String,String> ptnDesc){
      return new ExportCommand(addPartitionMessage.getDB(),addPartitionMessage.getTable(),ptnDesc,srcStagingDirProvider.getStagingDirectory(ReplicationUtils.getUniqueKey(getEvent().getEventId(),addPartitionMessage.getDB(),addPartitionMessage.getTable(),ptnDesc)),false,event.getEventId());
    }
  }
);
}
