{
  OpenTxnsResponse openedTxns=txnHandler.openTxns(new OpenTxnRequest(2,"me","localhost"));
  List<Long> txnList=openedTxns.getTxn_ids();
  long first=txnList.get(0);
  assertEquals(1L,first);
  long second=txnList.get(1);
  assertEquals(2L,second);
  txnHandler.abortTxn(new AbortTxnRequest(1));
  GetOpenTxnsInfoResponse txnsInfo=txnHandler.getOpenTxnsInfo();
  assertEquals(2L,txnsInfo.getTxn_high_water_mark());
  assertEquals(2,txnsInfo.getOpen_txns().size());
  assertEquals(1L,txnsInfo.getOpen_txns().get(0).getId());
  assertEquals(TxnState.ABORTED,txnsInfo.getOpen_txns().get(0).getState());
  assertEquals(2L,txnsInfo.getOpen_txns().get(1).getId());
  assertEquals(TxnState.OPEN,txnsInfo.getOpen_txns().get(1).getState());
  GetOpenTxnsResponse txns=txnHandler.getOpenTxns();
  assertEquals(2L,txns.getTxn_high_water_mark());
  assertEquals(2,txns.getOpen_txns().size());
  boolean[] saw=new boolean[3];
  for (int i=0; i < saw.length; i++)   saw[i]=false;
  for (  Long tid : txns.getOpen_txns()) {
    saw[tid.intValue()]=true;
  }
  for (int i=1; i < saw.length; i++)   assertTrue(saw[i]);
}
