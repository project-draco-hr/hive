{
  allAbortedTransactions=getAbortedTransactions(Bytes.toString(htable.getTableName()),scan);
  long maxValidRevision=getMaximumRevision(scan,snapshot);
  while (allAbortedTransactions.contains(maxValidRevision)) {
    maxValidRevision--;
  }
  Scan newScan=new Scan(scan);
  newScan.setStartRow(firstRow);
  newScan.setTimeRange(0,maxValidRevision + 1);
  newScan.setMaxVersions();
  this.scanner=this.htable.getScanner(newScan);
  resultItr=this.scanner.iterator();
}
