{
  try {
    Destination topic=null;
    if (null == session) {
      createConnection();
      if (null == session) {
        LOG.error("Invalid session. Failed to send message on topic: " + topicName + " event: "+ hCatEventMessage.getEventType());
        return;
      }
    }
    try {
      topic=session.createTopic(topicName);
    }
 catch (    IllegalStateException ise) {
      LOG.error("Seems like connection is lost. Retrying",ise);
      createConnection();
      topic=session.createTopic(topicName);
    }
    if (null == topic) {
      LOG.error("Invalid session. Failed to send message on topic: " + topicName + " event: "+ hCatEventMessage.getEventType());
      return;
    }
    MessageProducer producer=session.createProducer(topic);
    Message msg=session.createTextMessage(hCatEventMessage.toString());
    msg.setStringProperty(HCatConstants.HCAT_EVENT,hCatEventMessage.getEventType().toString());
    msg.setStringProperty(HCatConstants.HCAT_MESSAGE_VERSION,messageFactory.getVersion());
    msg.setStringProperty(HCatConstants.HCAT_MESSAGE_FORMAT,messageFactory.getMessageFormat());
    producer.send(msg);
    session.commit();
  }
 catch (  Exception e) {
    LOG.error("Failed to send message on topic: " + topicName + " event: "+ hCatEventMessage.getEventType(),e);
  }
}
