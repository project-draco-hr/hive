{
  this.username=username;
  this.password=password;
  creationTime=System.currentTimeMillis();
  this.sessionHandle=sessionHandle != null ? sessionHandle : new SessionHandle(protocol);
  this.sessionConf=new HiveConf(serverConf);
  this.ipAddress=ipAddress;
  this.operationLock=serverConf.getBoolVar(ConfVars.HIVE_SERVER2_PARALLEL_OPS_IN_SESSION) ? null : new Semaphore(1);
  try {
    if (!sessionConf.getBoolVar(ConfVars.HIVE_SERVER2_ENABLE_DOAS) && sessionConf.getBoolVar(ConfVars.HIVE_SERVER2_MAP_FAIR_SCHEDULER_QUEUE)) {
      ShimLoader.getHadoopShims().refreshDefaultQueue(sessionConf,username);
    }
  }
 catch (  IOException e) {
    LOG.warn("Error setting scheduler queue: " + e,e);
  }
  sessionConf.set(ConfVars.HIVESESSIONID.varname,this.sessionHandle.getHandleIdentifier().toString());
  sessionConf.set(SerDeUtils.LIST_SINK_OUTPUT_FORMATTER,ThriftFormatter.class.getName());
  sessionConf.setInt(SerDeUtils.LIST_SINK_OUTPUT_PROTOCOL,protocol.getValue());
}
