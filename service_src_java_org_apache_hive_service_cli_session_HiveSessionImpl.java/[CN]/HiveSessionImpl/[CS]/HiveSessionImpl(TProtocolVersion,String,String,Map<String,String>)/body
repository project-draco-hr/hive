{
  this.username=username;
  this.password=password;
  this.sessionHandle=new SessionHandle(protocol);
  if (sessionConf != null) {
    for (    Map.Entry<String,String> entry : sessionConf.entrySet()) {
      hiveConf.set(entry.getKey(),entry.getValue());
    }
  }
  hiveConf.set(ConfVars.HIVESESSIONID.varname,sessionHandle.getHandleIdentifier().toString());
  hiveConf.set(ListSinkOperator.OUTPUT_FORMATTER,FetchFormatter.ThriftFormatter.class.getName());
  hiveConf.setInt(ListSinkOperator.OUTPUT_PROTOCOL,protocol.getValue());
  sessionState=new SessionState(hiveConf);
  SessionState.start(sessionState);
}
