{
  if (sessionState != null) {
    String[] names=Thread.currentThread().getName().split(getHiveConf().getLogIdVar(sessionState.getSessionId()));
    String threadName=null;
    if (names.length > 1) {
      threadName=names[names.length - 1];
    }
 else     if (names.length == 1) {
      threadName=names[0];
    }
 else {
      threadName="";
    }
    Thread.currentThread().setName(threadName);
  }
  SessionState.detachSession();
  if (ThreadWithGarbageCleanup.currentThread() instanceof ThreadWithGarbageCleanup) {
    ThreadWithGarbageCleanup currentThread=(ThreadWithGarbageCleanup)ThreadWithGarbageCleanup.currentThread();
    currentThread.cacheThreadLocalRawStore();
  }
  if (userAccess) {
    lastAccessTime=System.currentTimeMillis();
  }
  if (opHandleSet.isEmpty()) {
    lastIdleTime=System.currentTimeMillis();
  }
 else {
    lastIdleTime=0;
  }
}
