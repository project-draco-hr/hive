{
  acquire(true);
  if (confOverlay == null) {
    confOverlay=new HashMap<String,String>();
  }
  String queryId=confOverlay.get(HiveConf.ConfVars.HIVEQUERYID.varname);
  if (queryId == null || queryId.isEmpty()) {
    queryId=QueryPlan.makeQueryId();
    confOverlay.put(HiveConf.ConfVars.HIVEQUERYID.varname,queryId);
    sessionState.getConf().setVar(HiveConf.ConfVars.HIVEQUERYID,queryId);
  }
  OperationManager operationManager=getOperationManager();
  ExecuteStatementOperation operation=operationManager.newExecuteStatementOperation(getSession(),statement,confOverlay,runAsync);
  OperationHandle opHandle=operation.getHandle();
  try {
    operation.run();
    addOpHandle(opHandle);
    return opHandle;
  }
 catch (  HiveSQLException e) {
    operationManager.closeOperation(opHandle);
    throw e;
  }
 finally {
    release(true);
  }
}
