{
  try {
    acquire();
    if (metastoreClient != null) {
      metastoreClient.close();
    }
    for (    OperationHandle opHandle : opHandleSet) {
      operationManager.closeOperation(opHandle);
    }
    opHandleSet.clear();
    HiveHistory hiveHist=sessionState.getHiveHistory();
    if (null != hiveHist) {
      hiveHist.closeStream();
    }
  }
  finally {
    release();
  }
}
