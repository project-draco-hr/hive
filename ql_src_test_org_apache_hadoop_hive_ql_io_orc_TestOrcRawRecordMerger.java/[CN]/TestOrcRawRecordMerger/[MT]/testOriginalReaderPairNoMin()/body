{
  ReaderKey key=new ReaderKey();
  Reader reader=createMockOriginalReader();
  ReaderPair pair=new OriginalReaderPair(key,reader,10,null,null,new Reader.Options());
  assertEquals("first",value(pair.nextRecord));
  assertEquals(0,key.getTransactionId());
  assertEquals(10,key.getBucketId());
  assertEquals(0,key.getRowId());
  assertEquals(0,key.getCurrentTransactionId());
  pair.next(pair.nextRecord);
  assertEquals("second",value(pair.nextRecord));
  assertEquals(0,key.getTransactionId());
  assertEquals(10,key.getBucketId());
  assertEquals(1,key.getRowId());
  assertEquals(0,key.getCurrentTransactionId());
  pair.next(pair.nextRecord);
  assertEquals("third",value(pair.nextRecord));
  assertEquals(0,key.getTransactionId());
  assertEquals(10,key.getBucketId());
  assertEquals(2,key.getRowId());
  assertEquals(0,key.getCurrentTransactionId());
  pair.next(pair.nextRecord);
  assertEquals("fourth",value(pair.nextRecord));
  assertEquals(0,key.getTransactionId());
  assertEquals(10,key.getBucketId());
  assertEquals(3,key.getRowId());
  assertEquals(0,key.getCurrentTransactionId());
  pair.next(pair.nextRecord);
  assertEquals("fifth",value(pair.nextRecord));
  assertEquals(0,key.getTransactionId());
  assertEquals(10,key.getBucketId());
  assertEquals(4,key.getRowId());
  assertEquals(0,key.getCurrentTransactionId());
  pair.next(pair.nextRecord);
  assertEquals(null,pair.nextRecord);
  Mockito.verify(pair.recordReader).close();
}
