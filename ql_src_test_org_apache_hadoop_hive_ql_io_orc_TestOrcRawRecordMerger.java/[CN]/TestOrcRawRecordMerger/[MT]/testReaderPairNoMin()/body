{
  ReaderKey key=new ReaderKey();
  Reader reader=createMockReader();
  ReaderPair pair=new ReaderPair(key,reader,20,null,null,new Reader.Options(),0);
  RecordReader recordReader=pair.recordReader;
  assertEquals(10,key.getTransactionId());
  assertEquals(20,key.getBucketId());
  assertEquals(20,key.getRowId());
  assertEquals(100,key.getCurrentTransactionId());
  assertEquals("first",value(pair.nextRecord));
  pair.next(pair.nextRecord);
  assertEquals(10,key.getTransactionId());
  assertEquals(20,key.getBucketId());
  assertEquals(30,key.getRowId());
  assertEquals(110,key.getCurrentTransactionId());
  assertEquals("second",value(pair.nextRecord));
  pair.next(pair.nextRecord);
  assertEquals(10,key.getTransactionId());
  assertEquals(20,key.getBucketId());
  assertEquals(40,key.getRowId());
  assertEquals(120,key.getCurrentTransactionId());
  assertEquals("third",value(pair.nextRecord));
  pair.next(pair.nextRecord);
  assertEquals(40,key.getTransactionId());
  assertEquals(50,key.getBucketId());
  assertEquals(60,key.getRowId());
  assertEquals(130,key.getCurrentTransactionId());
  assertEquals("fourth",value(pair.nextRecord));
  pair.next(pair.nextRecord);
  assertEquals(40,key.getTransactionId());
  assertEquals(50,key.getBucketId());
  assertEquals(61,key.getRowId());
  assertEquals(140,key.getCurrentTransactionId());
  assertEquals("fifth",value(pair.nextRecord));
  pair.next(pair.nextRecord);
  assertEquals(null,pair.nextRecord);
  Mockito.verify(recordReader).close();
}
