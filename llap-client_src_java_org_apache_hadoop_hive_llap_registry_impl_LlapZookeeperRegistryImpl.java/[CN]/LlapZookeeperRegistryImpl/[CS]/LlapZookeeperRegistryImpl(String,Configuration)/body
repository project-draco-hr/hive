{
  this.conf=new Configuration(conf);
  this.conf.addResource(YarnConfiguration.YARN_SITE_CONFIGURATION_FILE);
  String zkEnsemble=getQuorumServers(this.conf);
  this.encoder=new RegistryUtils.ServiceRecordMarshal();
  int sessionTimeout=(int)HiveConf.getTimeVar(conf,ConfVars.HIVE_ZOOKEEPER_SESSION_TIMEOUT,TimeUnit.MILLISECONDS);
  int baseSleepTime=(int)HiveConf.getTimeVar(conf,ConfVars.HIVE_ZOOKEEPER_CONNECTION_BASESLEEPTIME,TimeUnit.MILLISECONDS);
  int maxRetries=HiveConf.getIntVar(conf,ConfVars.HIVE_ZOOKEEPER_CONNECTION_MAX_RETRIES);
  this.zooKeeperClient=CuratorFrameworkFactory.builder().connectString(zkEnsemble).sessionTimeoutMs(sessionTimeout).aclProvider(zooKeeperAclProvider).namespace(ROOT_NAMESPACE).retryPolicy(new ExponentialBackoffRetry(baseSleepTime,maxRetries)).build();
  this.userPathPrefix=USER_SCOPE_PATH_PREFIX + getZkPathUser(this.conf);
  this.pathPrefix="/" + userPathPrefix + "/"+ instanceName+ "/workers/worker-";
  this.instancesCache=null;
  this.instances=null;
  this.stateChangeListeners=new HashSet<>();
  LOG.info("Llap Zookeeper Registry is enabled with registryid: " + instanceName);
}
