{
  Map<String,ServiceInstance> instances=new LinkedHashMap<>();
  for (  ChildData childData : instancesCache.getCurrentData()) {
    if (childData != null) {
      byte[] data=childData.getData();
      if (data != null) {
        try {
          ServiceRecord srv=encoder.fromBytes(childData.getPath(),data);
          ServiceInstance instance=new DynamicServiceInstance(srv);
          instances.put(childData.getPath(),instance);
        }
 catch (        IOException e) {
          LOG.error("Unable to decode data for zkpath: {}." + " Ignoring from current instances list..",childData.getPath());
        }
      }
    }
  }
  return instances;
}
