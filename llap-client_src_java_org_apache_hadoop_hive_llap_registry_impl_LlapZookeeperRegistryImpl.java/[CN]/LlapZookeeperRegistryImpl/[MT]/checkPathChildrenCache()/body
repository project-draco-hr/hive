{
  Preconditions.checkArgument(zooKeeperClient != null && zooKeeperClient.getState() == CuratorFrameworkState.STARTED,"client is not started");
  if (instancesCache == null) {
    this.instancesCache=new PathChildrenCache(zooKeeperClient,workersPath,true);
    instancesCache.getListenable().addListener(new InstanceStateChangeListener(),Executors.newFixedThreadPool(1,new ThreadFactoryBuilder().setDaemon(true).setNameFormat("StateChangeNotificationHandler").build()));
    try {
      this.instancesCache.start(PathChildrenCache.StartMode.BUILD_INITIAL_CACHE);
    }
 catch (    Exception e) {
      LOG.error("Unable to start curator PathChildrenCache. Exception: {}",e);
      throw new IOException(e);
    }
  }
}
