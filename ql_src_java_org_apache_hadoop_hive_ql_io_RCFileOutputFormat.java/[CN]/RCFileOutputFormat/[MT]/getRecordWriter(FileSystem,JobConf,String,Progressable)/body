{
  Path outputPath=getWorkOutputPath(job);
  FileSystem fs=outputPath.getFileSystem(job);
  if (!fs.exists(outputPath)) {
    throw new IOException("Output directory doesnt exist");
  }
  Path file=new Path(outputPath,name);
  CompressionCodec codec=null;
  if (getCompressOutput(job)) {
    Class<?> codecClass=getOutputCompressorClass(job,DefaultCodec.class);
    codec=(CompressionCodec)ReflectionUtils.newInstance(codecClass,job);
  }
  final RCFile.Writer out=new RCFile.Writer(fs,job,file,progress,codec);
  return new RecordWriter<Void,BytesRefArrayWritable>(){
    @Override public void close(    Reporter reporter) throws IOException {
      out.close();
    }
    @Override public void write(    Void key,    BytesRefArrayWritable value) throws IOException {
      out.append(value);
    }
  }
;
}
