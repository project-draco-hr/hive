{
  String[] cols=null;
  String columns=tableProperties.getProperty("columns");
  if (columns == null || columns.trim().equals("")) {
    cols=new String[0];
  }
 else {
    cols=StringUtils.split(columns,",");
  }
  RCFileOutputFormat.setColumnNumber(jc,cols.length);
  final RCFile.Writer outWriter=Utilities.createRCFileWriter(jc,finalOutPath.getFileSystem(jc),finalOutPath,isCompressed);
  return new org.apache.hadoop.hive.ql.exec.FileSinkOperator.RecordWriter(){
    @Override public void write(    Writable r) throws IOException {
      outWriter.append(r);
    }
    @Override public void close(    boolean abort) throws IOException {
      outWriter.close();
    }
  }
;
}
