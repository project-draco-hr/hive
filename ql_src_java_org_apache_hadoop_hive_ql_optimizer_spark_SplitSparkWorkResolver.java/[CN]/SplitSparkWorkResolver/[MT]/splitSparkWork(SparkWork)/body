{
  Queue<BaseWork> queue=new LinkedList<BaseWork>();
  Set<BaseWork> visited=new HashSet<BaseWork>();
  queue.addAll(sparkWork.getRoots());
  while (!queue.isEmpty()) {
    BaseWork work=queue.poll();
    if (!visited.add(work)) {
      continue;
    }
    List<BaseWork> childWorks=sparkWork.getChildren(work);
    for (    BaseWork w : childWorks) {
      queue.add(w);
    }
    splitBaseWork(sparkWork,work,childWorks);
  }
}
