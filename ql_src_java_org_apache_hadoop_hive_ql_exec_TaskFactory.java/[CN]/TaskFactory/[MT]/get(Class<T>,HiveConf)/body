{
  for (  taskTuple<? extends Serializable> t : taskvec) {
    if (t.workClass == workClass) {
      try {
        return (Task<T>)t.taskClass.newInstance();
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
    }
  }
  if (workClass == mapredWork.class) {
    String viachild=conf.getVar(HiveConf.ConfVars.SUBMITVIACHILD);
    try {
      if (conf.getVar(HiveConf.ConfVars.HADOOPJT).equals("local") || viachild.equals("true")) {
        return (Task<T>)MapRedTask.class.newInstance();
      }
 else {
        return (Task<T>)ExecDriver.class.newInstance();
      }
    }
 catch (    Exception e) {
      throw new RuntimeException(e.getMessage(),e);
    }
  }
  throw new RuntimeException("No task for work class " + workClass.getName());
}
