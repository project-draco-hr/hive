{
  String thrifturi=null;
  String database="default";
  String table=null;
  String isd=null;
  String osd=null;
  Map<String,String> m=new HashMap<String,String>();
  for (int i=0; i < args.length; i++) {
    if (args[i].equals("-u")) {
      thrifturi=args[i + 1];
    }
 else     if (args[i].equals("-t")) {
      table=args[i + 1];
    }
 else     if (args[i].equals("-i")) {
      isd=args[i + 1];
    }
 else     if (args[i].equals("-o")) {
      osd=args[i + 1];
    }
 else     if (args[i].equals("-p")) {
      String[] kvps=args[i + 1].split(";");
      for (      String kvp : kvps) {
        String[] kv=kvp.split("=");
        if (kv.length != 2) {
          System.err.println("ERROR: key value property pairs must be specified as key1=val1;key2=val2;..;keyn=valn");
          System.exit(1);
        }
        m.put(kv[0],kv[1]);
      }
    }
 else     if (args[i].equals("-d")) {
      database=args[i + 1];
    }
 else {
      System.err.println("ERROR: Unknown option: " + args[i]);
      usage();
    }
    i++;
  }
  if (table == null || thrifturi == null) {
    System.err.println("ERROR: thrift uri and table name are mandatory");
    usage();
  }
  HiveConf hiveConf=new HiveConf(PartitionStorageDriverAnnotator.class);
  hiveConf.set("hive.metastore.local","false");
  hiveConf.set("hive.metastore.uris",thrifturi);
  HiveMetaStoreClient hmsc=new HiveMetaStoreClient(hiveConf,null);
  List<Partition> parts=hmsc.listPartitions(database,table,Short.MAX_VALUE);
  m.put("hcat.isd",isd != null ? isd : RCFileInputDriver.class.getName());
  m.put("hcat.osd",osd != null ? osd : RCFileOutputDriver.class.getName());
  for (  Partition p : parts) {
    p.setParameters(m);
    hmsc.alter_partition(database,table,p);
  }
}
