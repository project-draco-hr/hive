{
  this.jobConf=job;
  Schema latest;
  try {
    latest=getSchema(job,split);
  }
 catch (  AvroSerdeException e) {
    throw new IOException(e);
  }
  GenericDatumReader<GenericRecord> gdr=new GenericDatumReader<GenericRecord>();
  if (latest != null) {
    gdr.setExpected(latest);
  }
  if (split.getLength() == 0) {
    this.isEmptyInput=true;
    this.start=0;
    this.reader=null;
  }
 else {
    this.isEmptyInput=false;
    this.reader=new DataFileReader<GenericRecord>(new FsInput(split.getPath(),job),gdr);
    this.reader.sync(split.getStart());
    this.start=reader.tell();
  }
  this.stop=split.getStart() + split.getLength();
  this.recordReaderID=new UID();
}
