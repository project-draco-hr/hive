{
  List<? extends StructField> fields=structObjInspector.getAllStructFieldRefs();
  VectorExpressionWriter[] writers=new VectorExpressionWriter[fields.size()];
  List<ObjectInspector> oids=new ArrayList<ObjectInspector>(writers.length);
  ArrayList<String> columnNames=new ArrayList<String>();
  int i=0;
  for (  StructField field : fields) {
    ObjectInspector fieldObjInsp=field.getFieldObjectInspector();
    writers[i]=VectorExpressionWriterFactory.genVectorExpressionWritable(fieldObjInsp);
    columnNames.add(field.getFieldName());
    oids.add(writers[i].getObjectInspector());
    i++;
  }
  ObjectInspector objectInspector=ObjectInspectorFactory.getStandardStructObjectInspector(columnNames,oids);
  closure.assign(writers,objectInspector);
}
