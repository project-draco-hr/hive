{
  try {
    dbName=checkDB(dbName);
    List<Partition> partitions=hmsClient.listPartitionsByFilter(dbName,tableName,getFilterString(partitionSpec),(short)-1);
    for (    Partition partition : partitions) {
      dropPartition(partition,ifExists);
    }
  }
 catch (  NoSuchObjectException e) {
    throw new ObjectNotFoundException("NoSuchObjectException while dropping partition. " + "Either db(" + dbName + ") or table("+ tableName+ ") missing.",e);
  }
catch (  MetaException e) {
    throw new HCatException("MetaException while dropping partition.",e);
  }
catch (  TException e) {
    throw new ConnectionFailureException("TException while dropping partition.",e);
  }
}
