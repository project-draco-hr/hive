{
switch (typeInfo.getPrimitiveCategory()) {
case STRING:
    return HiveVarchar.MAX_VARCHAR_LENGTH;
case VARCHAR:
  VarcharTypeParams varcharParams=(VarcharTypeParams)typeInfo.getTypeParams();
if (varcharParams == null) {
  throw new RuntimeException("varchar type used without type params");
}
return varcharParams.getLength();
default :
return 0;
}
}
