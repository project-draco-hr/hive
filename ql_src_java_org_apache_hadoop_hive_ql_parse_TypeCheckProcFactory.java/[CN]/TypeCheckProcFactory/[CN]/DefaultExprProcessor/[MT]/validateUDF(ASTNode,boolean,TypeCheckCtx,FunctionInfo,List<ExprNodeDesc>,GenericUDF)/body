{
  if (fi.getGenericUDTF() != null) {
    throw new SemanticException(ErrorMsg.UDTF_INVALID_LOCATION.getMsg());
  }
  if (fi.getGenericUDAFResolver() != null) {
    if (isFunction) {
      throw new SemanticException(ErrorMsg.UDAF_INVALID_LOCATION.getMsg((ASTNode)expr.getChild(0)));
    }
 else {
      throw new SemanticException(ErrorMsg.UDAF_INVALID_LOCATION.getMsg(expr));
    }
  }
  if (!ctx.getAllowStatefulFunctions() && (genericUDF != null)) {
    if (FunctionRegistry.isStateful(genericUDF)) {
      throw new SemanticException(ErrorMsg.UDF_STATEFUL_INVALID_LOCATION.getMsg());
    }
  }
}
