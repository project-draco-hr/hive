{
  try {
    if (colPath.equals(tableName)) {
      if (!isFormatted) {
        outStream.writeBytes(MetaDataFormatUtils.displayColsUnformatted(cols));
      }
 else {
        outStream.writeBytes(MetaDataFormatUtils.getAllColumnsInformation(cols,tbl.isPartitioned() ? tbl.getPartCols() : null));
      }
    }
 else {
      if (isFormatted) {
        outStream.writeBytes(MetaDataFormatUtils.getAllColumnsInformation(cols));
      }
 else {
        outStream.writeBytes(MetaDataFormatUtils.displayColsUnformatted(cols));
      }
    }
    if (tableName.equals(colPath)) {
      if (isFormatted) {
        if (part != null) {
          outStream.writeBytes(MetaDataFormatUtils.getPartitionInformation(part));
        }
 else {
          outStream.writeBytes(MetaDataFormatUtils.getTableInformation(tbl));
        }
      }
      if (isExt) {
        outStream.write(terminator);
        if (part != null) {
          outStream.writeBytes("Detailed Partition Information");
          outStream.write(separator);
          outStream.writeBytes(part.getTPartition().toString());
          outStream.write(separator);
          outStream.write(terminator);
        }
 else {
          outStream.writeBytes("Detailed Table Information");
          outStream.write(separator);
          outStream.writeBytes(tbl.getTTable().toString());
          outStream.write(separator);
          outStream.write(terminator);
        }
      }
    }
  }
 catch (  IOException e) {
    throw new HiveException(e);
  }
}
