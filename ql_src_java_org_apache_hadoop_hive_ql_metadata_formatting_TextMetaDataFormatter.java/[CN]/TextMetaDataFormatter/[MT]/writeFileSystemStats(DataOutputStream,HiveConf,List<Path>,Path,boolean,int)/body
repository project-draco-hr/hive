{
  long totalFileSize=0;
  long maxFileSize=0;
  long minFileSize=Long.MAX_VALUE;
  long lastAccessTime=0;
  long lastUpdateTime=0;
  int numOfFiles=0;
  boolean unknown=false;
  FileSystem fs=tblPath.getFileSystem(conf);
  try {
    FileStatus tmpStatus=fs.getFileStatus(tblPath);
    lastAccessTime=tmpStatus.getAccessTime();
    lastUpdateTime=tmpStatus.getModificationTime();
    if (partSpecified) {
      tmpStatus=fs.getFileStatus(locations.get(0));
    }
  }
 catch (  IOException e) {
    LOG.warn("Cannot access File System. File System status will be unknown: ",e);
    unknown=true;
  }
  if (!unknown) {
    for (    Path loc : locations) {
      try {
        FileStatus status=fs.getFileStatus(tblPath);
        FileStatus[] files=fs.listStatus(loc);
        long accessTime=status.getAccessTime();
        long updateTime=status.getModificationTime();
        if (!status.isDir()) {
          continue;
        }
        if (accessTime > lastAccessTime) {
          lastAccessTime=accessTime;
        }
        if (updateTime > lastUpdateTime) {
          lastUpdateTime=updateTime;
        }
        for (        FileStatus currentStatus : files) {
          if (currentStatus.isDir()) {
            continue;
          }
          numOfFiles++;
          long fileLen=currentStatus.getLen();
          totalFileSize+=fileLen;
          if (fileLen > maxFileSize) {
            maxFileSize=fileLen;
          }
          if (fileLen < minFileSize) {
            minFileSize=fileLen;
          }
          accessTime=currentStatus.getAccessTime();
          updateTime=currentStatus.getModificationTime();
          if (accessTime > lastAccessTime) {
            lastAccessTime=accessTime;
          }
          if (updateTime > lastUpdateTime) {
            lastUpdateTime=updateTime;
          }
        }
      }
 catch (      IOException e) {
      }
    }
  }
  String unknownString="unknown";
  for (int k=0; k < indent; k++) {
    outStream.write(Utilities.INDENT.getBytes("UTF-8"));
  }
  outStream.write("totalNumberFiles:".getBytes("UTF-8"));
  outStream.write((unknown ? unknownString : "" + numOfFiles).getBytes("UTF-8"));
  outStream.write(terminator);
  for (int k=0; k < indent; k++) {
    outStream.write(Utilities.INDENT.getBytes("UTF-8"));
  }
  outStream.write("totalFileSize:".getBytes("UTF-8"));
  outStream.write((unknown ? unknownString : "" + totalFileSize).getBytes("UTF-8"));
  outStream.write(terminator);
  for (int k=0; k < indent; k++) {
    outStream.write(Utilities.INDENT.getBytes("UTF-8"));
  }
  outStream.write("maxFileSize:".getBytes("UTF-8"));
  outStream.write((unknown ? unknownString : "" + maxFileSize).getBytes("UTF-8"));
  outStream.write(terminator);
  for (int k=0; k < indent; k++) {
    outStream.write(Utilities.INDENT.getBytes("UTF-8"));
  }
  outStream.write("minFileSize:".getBytes("UTF-8"));
  if (numOfFiles > 0) {
    outStream.write((unknown ? unknownString : "" + minFileSize).getBytes("UTF-8"));
  }
 else {
    outStream.write((unknown ? unknownString : "" + 0).getBytes("UTF-8"));
  }
  outStream.write(terminator);
  for (int k=0; k < indent; k++) {
    outStream.write(Utilities.INDENT.getBytes("UTF-8"));
  }
  outStream.write("lastAccessTime:".getBytes("UTF-8"));
  outStream.writeBytes((unknown || lastAccessTime < 0) ? unknownString : "" + lastAccessTime);
  outStream.write(terminator);
  for (int k=0; k < indent; k++) {
    outStream.write(Utilities.INDENT.getBytes("UTF-8"));
  }
  outStream.write("lastUpdateTime:".getBytes("UTF-8"));
  outStream.write((unknown ? unknownString : "" + lastUpdateTime).getBytes("UTF-8"));
  outStream.write(terminator);
}
