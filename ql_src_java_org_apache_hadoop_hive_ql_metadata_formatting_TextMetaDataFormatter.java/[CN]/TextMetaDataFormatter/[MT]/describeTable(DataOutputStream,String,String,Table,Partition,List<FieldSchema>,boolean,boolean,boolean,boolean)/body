{
  try {
    String output;
    if (colPath.equals(tableName)) {
      List<FieldSchema> partCols=tbl.isPartitioned() ? tbl.getPartCols() : null;
      output=isPretty ? MetaDataPrettyFormatUtils.getAllColumnsInformation(cols,partCols,prettyOutputNumCols) : MetaDataFormatUtils.getAllColumnsInformation(cols,partCols,isFormatted,isOutputPadded,showPartColsSeparately);
    }
 else {
      output=MetaDataFormatUtils.getAllColumnsInformation(cols,isFormatted,isOutputPadded);
    }
    outStream.write(output.getBytes("UTF-8"));
    if (tableName.equals(colPath)) {
      if (isFormatted) {
        if (part != null) {
          output=MetaDataFormatUtils.getPartitionInformation(part);
        }
 else {
          output=MetaDataFormatUtils.getTableInformation(tbl);
        }
        outStream.write(output.getBytes("UTF-8"));
      }
      if (isExt) {
        outStream.write(terminator);
        if (part != null) {
          outStream.writeBytes("Detailed Partition Information");
          outStream.write(separator);
          outStream.write(part.getTPartition().toString().getBytes("UTF-8"));
          outStream.write(separator);
          outStream.write(terminator);
        }
 else {
          outStream.writeBytes("Detailed Table Information");
          outStream.write(separator);
          outStream.write(tbl.getTTable().toString().getBytes("UTF-8"));
          outStream.write(separator);
          outStream.write(terminator);
        }
      }
    }
  }
 catch (  IOException e) {
    throw new HiveException(e);
  }
}
