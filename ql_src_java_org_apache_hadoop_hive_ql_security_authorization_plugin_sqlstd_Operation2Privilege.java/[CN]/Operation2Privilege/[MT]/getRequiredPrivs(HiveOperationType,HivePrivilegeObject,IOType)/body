{
  List<PrivRequirement> opPrivs=op2Priv.get(hiveOpType);
  Preconditions.checkNotNull(opPrivs,"Privileges for " + hiveOpType + " are null");
  RequiredPrivileges reqPrivs=new RequiredPrivileges();
  for (  PrivRequirement opPriv : opPrivs) {
    if (opPriv.getIOType() != null && opPriv.getIOType() != ioType) {
      continue;
    }
    if (opPriv.getActionType() != null && opPriv.getActionType() != hObj.getActionType()) {
      continue;
    }
    if (opPriv.getObjectType() != null && opPriv.getObjectType() != hObj.getType()) {
      continue;
    }
    reqPrivs.addAll(opPriv.getReqPrivs());
  }
  return reqPrivs;
}
