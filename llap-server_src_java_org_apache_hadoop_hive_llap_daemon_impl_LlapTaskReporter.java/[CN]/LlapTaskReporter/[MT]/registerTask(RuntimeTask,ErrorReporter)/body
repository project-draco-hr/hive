{
  TezCounters tezCounters=task.addAndGetTezCounter(fragmentFullId);
  FragmentCountersMap.registerCountersForFragment(fragmentFullId,tezCounters);
  LOG.info("Registered counters for fragment: {} vertexName: {}",fragmentFullId,task.getVertexName());
  currentCallable=new HeartbeatCallable(task,umbilical,pollInterval,sendCounterInterval,maxEventsToGet,requestCounter,containerIdStr,initialEvent);
  ListenableFuture<Boolean> future=heartbeatExecutor.submit(currentCallable);
  Futures.addCallback(future,new HeartbeatCallback(errorReporter));
}
