{
  TezCounters tezCounters=task.addAndGetTezCounter(fragmentId);
  FragmentCountersMap.registerCountersForFragment(fragmentId,tezCounters);
  LOG.info("Registered counters for fragment: {} vertexName: {}",fragmentId,task.getVertexName());
  currentCallable=new HeartbeatCallable(task,umbilical,pollInterval,sendCounterInterval,maxEventsToGet,requestCounter,containerIdStr,initialEvent);
  ListenableFuture<Boolean> future=heartbeatExecutor.submit(currentCallable);
  Futures.addCallback(future,new HeartbeatCallback(errorReporter));
}
