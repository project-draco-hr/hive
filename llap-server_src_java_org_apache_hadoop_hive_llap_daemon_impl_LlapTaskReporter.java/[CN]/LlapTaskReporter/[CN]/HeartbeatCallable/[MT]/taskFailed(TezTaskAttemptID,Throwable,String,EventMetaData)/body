{
  TezEvent statusUpdateEvent=new TezEvent(new TaskStatusUpdateEvent(task.getCounters(),task.getProgress()),updateEventMetadata);
  if (diagnostics == null) {
    diagnostics=ExceptionUtils.getStackTrace(t);
  }
 else {
    diagnostics=diagnostics + ":" + ExceptionUtils.getStackTrace(t);
  }
  TezEvent taskAttemptFailedEvent=new TezEvent(new TaskAttemptFailedEvent(diagnostics),srcMeta == null ? updateEventMetadata : srcMeta);
  return !heartbeat(Lists.newArrayList(statusUpdateEvent,taskAttemptFailedEvent)).shouldDie;
}
