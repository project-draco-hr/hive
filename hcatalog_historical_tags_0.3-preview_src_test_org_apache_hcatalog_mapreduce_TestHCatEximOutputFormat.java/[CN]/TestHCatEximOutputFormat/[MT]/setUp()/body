{
  System.out.println("Setup started");
  super.setUp();
  conf=new Configuration();
  job=new Job(conf,"test eximoutputformat");
  columns=new ArrayList<HCatFieldSchema>();
  columns.add(HCatSchemaUtils.getHCatFieldSchema(new FieldSchema("emp_id",Constants.INT_TYPE_NAME,"")));
  columns.add(HCatSchemaUtils.getHCatFieldSchema(new FieldSchema("emp_name",Constants.STRING_TYPE_NAME,"")));
  columns.add(HCatSchemaUtils.getHCatFieldSchema(new FieldSchema("emp_dob",Constants.STRING_TYPE_NAME,"")));
  columns.add(HCatSchemaUtils.getHCatFieldSchema(new FieldSchema("emp_sex",Constants.STRING_TYPE_NAME,"")));
  schema=new HCatSchema(columns);
  fs=new LocalFileSystem();
  fs.initialize(fs.getWorkingDirectory().toUri(),new Configuration());
  outputLocation=new Path(fs.getWorkingDirectory(),"tmp/exports");
  if (fs.exists(outputLocation)) {
    fs.delete(outputLocation,true);
  }
  dataLocation=new Path(fs.getWorkingDirectory(),"tmp/data");
  if (fs.exists(dataLocation)) {
    fs.delete(dataLocation,true);
  }
  FSDataOutputStream ds=fs.create(dataLocation,true);
  ds.writeBytes("237,Krishna,01/01/1990,M,IN,TN\n");
  ds.writeBytes("238,Kalpana,01/01/2000,F,IN,KA\n");
  ds.writeBytes("239,Satya,01/01/2001,M,US,TN\n");
  ds.writeBytes("240,Kavya,01/01/2002,F,US,KA\n");
  ds.close();
  job.setInputFormatClass(TextInputFormat.class);
  job.setOutputFormatClass(HCatEximOutputFormat.class);
  TextInputFormat.setInputPaths(job,dataLocation);
  job.setJarByClass(this.getClass());
  job.setMapperClass(TestMap.class);
  job.setNumReduceTasks(0);
  System.out.println("Setup done");
}
