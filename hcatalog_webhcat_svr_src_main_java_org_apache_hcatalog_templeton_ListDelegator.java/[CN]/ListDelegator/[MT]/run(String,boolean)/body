{
  UserGroupInformation ugi=UgiFactory.getUgi(user);
  WebHCatJTShim tracker=null;
  try {
    tracker=ShimLoader.getHadoopShims().getWebHCatShim(appConf,ugi);
    ArrayList<String> ids=new ArrayList<String>();
    JobStatus[] jobs=tracker.getAllJobs();
    if (jobs != null) {
      for (      JobStatus job : jobs) {
        JobState state=null;
        try {
          String id=job.getJobID().toString();
          state=new JobState(id,Main.getAppConfigInstance());
          if (showall || user.equals(state.getUser()))           ids.add(id);
        }
  finally {
          if (state != null) {
            state.close();
          }
        }
      }
    }
    return ids;
  }
 catch (  IllegalStateException e) {
    throw new BadParam(e.getMessage());
  }
 finally {
    if (tracker != null)     tracker.close();
  }
}
