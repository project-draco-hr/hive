{
  createTable(PARTITIONED_TABLE,"a int, b string","bkt string");
  populateBasicFile();
  PigServer server=new PigServer(ExecType.LOCAL,props);
  UDFContext.getUDFContext().setClientSystemProps();
  server.setBatchOn();
  server.registerQuery("A = load '" + basicFileFullName + "' as (a:int, b:chararray);");
  server.registerQuery("B2 = filter A by a < 2;");
  server.registerQuery("store B2 into '" + PARTITIONED_TABLE + "' using org.apache.hcatalog.pig.HCatStorer('bkt=0');");
  server.registerQuery("C2 = filter A by a >= 2;");
  server.registerQuery("store C2 into '" + PARTITIONED_TABLE + "' using org.apache.hcatalog.pig.HCatStorer('bkt=1');");
  server.executeBatch();
  driver.run("select * from " + PARTITIONED_TABLE);
  ArrayList<String> partitionedTableValuesReadFromHiveDriver=new ArrayList<String>();
  driver.getResults(partitionedTableValuesReadFromHiveDriver);
  assertEquals(basicInputData.size(),partitionedTableValuesReadFromHiveDriver.size());
}
