{
  try {
    writer.close(taContext);
    if (outputCommitter.needsTaskCommit(taContext)) {
      outputCommitter.commitTask(taContext);
    }
    if (this.wroteData && this.jobIsSetup) {
      if (!this.aborted) {
        outputCommitter.commitJob(taContext);
      }
 else {
        outputCommitter.cleanupJob(taContext);
      }
    }
  }
 catch (  Exception e) {
    throw new IOException(e);
  }
}
