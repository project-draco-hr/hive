{
  if (abort) {
    if (flushLengths == null) {
      fs.delete(path,false);
    }
  }
 else {
    if (writer != null)     writer.close();
  }
  if (flushLengths != null) {
    flushLengths.close();
    fs.delete(getSideFile(path),false);
  }
  writer=null;
}
