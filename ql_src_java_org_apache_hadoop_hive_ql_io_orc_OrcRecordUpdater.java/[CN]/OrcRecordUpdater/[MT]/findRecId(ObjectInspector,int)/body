{
  if (!(inspector instanceof StructObjectInspector)) {
    throw new RuntimeException("Serious problem, expected a StructObjectInspector, but got a " + inspector.getClass().getName());
  }
  if (rowIdColNum < 0) {
    return inspector;
  }
 else {
    RecIdStrippingObjectInspector newInspector=new RecIdStrippingObjectInspector(inspector,rowIdColNum);
    recIdField=newInspector.getRecId();
    List<? extends StructField> fields=((StructObjectInspector)recIdField.getFieldObjectInspector()).getAllStructFieldRefs();
    originalTxnField=fields.get(0);
    origTxnInspector=(LongObjectInspector)originalTxnField.getFieldObjectInspector();
    rowIdField=fields.get(2);
    rowIdInspector=(LongObjectInspector)rowIdField.getFieldObjectInspector();
    recIdInspector=(StructObjectInspector)recIdField.getFieldObjectInspector();
    return newInspector;
  }
}
