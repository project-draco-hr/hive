{
  if (!(oi instanceof StructObjectInspector)) {
    throw new RuntimeException("Serious problem, expected a StructObjectInspector, " + "but got a " + oi.getClass().getName());
  }
  wrapped=(StructObjectInspector)oi;
  List<? extends StructField> wrappedFields=wrapped.getAllStructFieldRefs();
  fields=new ArrayList<StructField>(wrapped.getAllStructFieldRefs().size());
  for (int i=0; i < wrappedFields.size(); i++) {
    if (i == rowIdColNum) {
      recId=wrappedFields.get(i);
    }
 else {
      fields.add(wrappedFields.get(i));
    }
  }
}
