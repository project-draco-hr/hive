{
  GenericUDFToUnixTimeStamp udf1=new GenericUDFToUnixTimeStamp();
  ObjectInspector valueOI=PrimitiveObjectInspectorFactory.writableStringObjectInspector;
  ObjectInspector[] arguments={valueOI};
  udf1.initialize(arguments);
  String val="2001-01-01 01:02:03";
  runAndVerify(udf1,new Text(val),new LongWritable(Timestamp.valueOf(val).getTime() / 1000));
  runAndVerify(udf1,null,null);
  GenericUDFToUnixTimeStamp udf2=new GenericUDFToUnixTimeStamp();
  ObjectInspector[] args2={valueOI,valueOI};
  udf2.initialize(args2);
  val="2001-01-01";
  String format="yyyy-MM-dd";
  runAndVerify(udf2,new Text(val),new Text(format),new LongWritable(Date.valueOf(val).getTime() / 1000));
  runAndVerify(udf2,null,null,null);
  runAndVerify(udf2,null,new Text(format),null);
  runAndVerify(udf2,new Text(val),null,null);
}
