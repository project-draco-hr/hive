{
  HiveConf conf=sess.getConf();
  String disableArch=conf.get(DISABLE_CHECK_ARCHIVAL_HOOK);
  if ((disableArch != null) && (disableArch.compareToIgnoreCase("false") == 0)) {
    return;
  }
  for (  ReadEntity re : inputs) {
    boolean isArchived=false;
    if (re.getParameters() != null) {
      String archF=re.getParameters().get(ARCHIVE_FLAG);
      if (archF != null) {
        isArchived=archF.equals("true");
        if (isArchived)         throw new Exception("Path: " + re.getLocation().toString() + " needs to be unarchived.");
      }
    }
  }
}
