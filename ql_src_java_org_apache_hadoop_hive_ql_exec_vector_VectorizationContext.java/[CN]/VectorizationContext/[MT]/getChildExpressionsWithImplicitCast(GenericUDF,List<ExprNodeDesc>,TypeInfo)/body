{
  if (isCustomUDF(genericUDF.getUdfName())) {
    return children;
  }
  if (isExcludedFromCast(genericUDF)) {
    return children;
  }
  if (children == null) {
    return null;
  }
  TypeInfo commonType=getCommonTypeForChildExpressions(genericUDF,children,returnType);
  if (commonType == null) {
    return children;
  }
  List<ExprNodeDesc> childrenWithCasts=new ArrayList<ExprNodeDesc>();
  boolean atleastOneCastNeeded=false;
  if (genericUDF instanceof GenericUDFElt) {
    int i=0;
    for (    ExprNodeDesc child : children) {
      TypeInfo castType=commonType;
      if (i++ == 0) {
        castType=isIntFamily(child.getTypeString()) ? child.getTypeInfo() : TypeInfoFactory.intTypeInfo;
      }
      ExprNodeDesc castExpression=getImplicitCastExpression(genericUDF,child,castType);
      if (castExpression != null) {
        atleastOneCastNeeded=true;
        childrenWithCasts.add(castExpression);
      }
 else {
        childrenWithCasts.add(child);
      }
    }
  }
 else {
    for (    ExprNodeDesc child : children) {
      ExprNodeDesc castExpression=getImplicitCastExpression(genericUDF,child,commonType);
      if (castExpression != null) {
        atleastOneCastNeeded=true;
        childrenWithCasts.add(castExpression);
      }
 else {
        childrenWithCasts.add(child);
      }
    }
  }
  if (atleastOneCastNeeded) {
    return childrenWithCasts;
  }
 else {
    return children;
  }
}
