{
  if (!(expr instanceof ExprNodeConstantDesc)) {
    throw new HiveException("Constant value expected for UDF argument. " + "Non-constant argument not supported for vectorization.");
  }
  ExprNodeConstantDesc constExpr=(ExprNodeConstantDesc)expr;
  Object obj=getScalarValue(constExpr);
  if (obj instanceof Integer) {
    return (long)((Integer)obj).longValue();
  }
 else   if (obj instanceof IntWritable) {
    return (long)((IntWritable)obj).get();
  }
 else   if (obj instanceof Long) {
    return ((Long)obj).longValue();
  }
 else   if (obj instanceof LongWritable) {
    return ((LongWritable)obj).get();
  }
  throw new HiveException("Udf: unhandled constant type for scalar argument." + "Expecting integer or bigint");
}
