{
  List<ObjectInspector> oids=new ArrayList<ObjectInspector>();
  for (  String columnName : columnNames) {
    int columnIndex=columnMap.get(columnName);
    String outputType=outputColumnTypes.get(columnIndex);
    ObjectInspector oi=null;
    for (    Object[] moi : mapObjectInspectors) {
      if (outputType.equalsIgnoreCase((String)moi[0])) {
        oi=(ObjectInspector)moi[1];
        break;
      }
    }
    if (oi == null) {
      throw new HiveException(String.format("Unsuported type: %s for column %d:%s",outputType,columnIndex,columnName));
    }
    oids.add(oi);
  }
  return ObjectInspectorFactory.getStandardStructObjectInspector(columnNames,oids);
}
