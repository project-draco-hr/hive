{
  if (!(expr instanceof ExprNodeConstantDesc)) {
    throw new HiveException("Constant value expected for UDF argument. " + "Non-constant argument not supported for vectorization.");
  }
  ExprNodeConstantDesc constExpr=(ExprNodeConstantDesc)expr;
  Object obj=getScalarValue(constExpr);
  if (obj instanceof Double) {
    return ((Double)obj).doubleValue();
  }
 else   if (obj instanceof DoubleWritable) {
    return ((DoubleWritable)obj).get();
  }
 else   if (obj instanceof Integer) {
    return (double)((Integer)obj).longValue();
  }
 else   if (obj instanceof IntWritable) {
    return (double)((IntWritable)obj).get();
  }
  throw new HiveException("Udf: unhandled constant type for scalar argument." + "Expecting double or integer");
}
