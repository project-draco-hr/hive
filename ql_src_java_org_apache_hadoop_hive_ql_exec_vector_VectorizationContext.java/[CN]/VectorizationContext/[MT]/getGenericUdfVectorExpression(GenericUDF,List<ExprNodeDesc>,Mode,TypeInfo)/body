{
  List<ExprNodeDesc> castedChildren=evaluateCastOnConstants(childExpr);
  childExpr=castedChildren;
  if (udf instanceof GenericUDFBetween) {
    return getBetweenFilterExpression(childExpr,mode,returnType);
  }
 else   if (udf instanceof GenericUDFIn) {
    return getInExpression(childExpr,mode,returnType);
  }
 else   if (udf instanceof GenericUDFOPPositive) {
    return getIdentityExpression(childExpr);
  }
 else   if (udf instanceof GenericUDFCoalesce || udf instanceof GenericUDFNvl) {
    return getCoalesceExpression(childExpr,returnType);
  }
 else   if (udf instanceof GenericUDFElt) {
    return getEltExpression(childExpr,returnType);
  }
 else   if (udf instanceof GenericUDFBridge) {
    VectorExpression v=getGenericUDFBridgeVectorExpression((GenericUDFBridge)udf,childExpr,mode,returnType);
    if (v != null) {
      return v;
    }
  }
 else   if (udf instanceof GenericUDFToDecimal) {
    return getCastToDecimal(childExpr,returnType);
  }
 else   if (udf instanceof GenericUDFToChar) {
    return getCastToChar(childExpr,returnType);
  }
 else   if (udf instanceof GenericUDFToVarchar) {
    return getCastToVarChar(childExpr,returnType);
  }
 else   if (udf instanceof GenericUDFTimestamp) {
    return getCastToTimestamp((GenericUDFTimestamp)udf,childExpr,mode,returnType);
  }
  Class<?> udfClass=udf.getClass();
  boolean isSubstituted=false;
  if (udf instanceof GenericUDFBridge) {
    udfClass=((GenericUDFBridge)udf).getUdfClass();
    isSubstituted=true;
  }
  VectorExpression ve=getVectorExpressionForUdf((!isSubstituted ? udf : null),udfClass,castedChildren,mode,returnType);
  if (ve == null) {
    throw new HiveException("Udf: " + udf.getClass().getSimpleName() + ", is not supported");
  }
  return ve;
}
