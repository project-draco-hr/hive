{
  VectorExpression ve=null;
  if (exprDesc instanceof ExprNodeColumnDesc) {
    ve=getColumnVectorExpression((ExprNodeColumnDesc)exprDesc,mode);
  }
 else   if (exprDesc instanceof ExprNodeGenericFuncDesc) {
    ExprNodeGenericFuncDesc expr=(ExprNodeGenericFuncDesc)exprDesc;
    if (isCustomUDF(expr) || isNonVectorizedPathUDF(expr)) {
      ve=getCustomUDFExpression(expr);
    }
 else {
      List<ExprNodeDesc> childExpressions=getChildExpressionsWithImplicitCast(expr.getGenericUDF(),exprDesc.getChildren(),exprDesc.getTypeInfo());
      ve=getGenericUdfVectorExpression(expr.getGenericUDF(),childExpressions,mode,exprDesc.getTypeInfo());
    }
  }
 else   if (exprDesc instanceof ExprNodeConstantDesc && null == ((ExprNodeConstantDesc)exprDesc).getValue()) {
    ve=getConstantVectorExpression(null,exprDesc.getTypeInfo(),mode);
  }
 else   if (exprDesc instanceof ExprNodeConstantDesc) {
    ve=getConstantVectorExpression(((ExprNodeConstantDesc)exprDesc).getValue(),exprDesc.getTypeInfo(),mode);
  }
  if (ve == null) {
    throw new HiveException("Could not vectorize expression: " + exprDesc.getName());
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Input Expression = " + exprDesc.getTypeInfo() + ", Vectorized Expression = "+ ve.toString());
  }
  return ve;
}
