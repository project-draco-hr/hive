{
  VectorExpression ve=null;
  if (exprDesc instanceof ExprNodeColumnDesc) {
    ve=getColumnVectorExpression((ExprNodeColumnDesc)exprDesc,mode);
  }
 else   if (exprDesc instanceof ExprNodeGenericFuncDesc) {
    ExprNodeGenericFuncDesc expr=(ExprNodeGenericFuncDesc)exprDesc;
    if (isCustomUDF(expr)) {
      ve=getCustomUDFExpression(expr,mode);
    }
 else {
      List<ExprNodeDesc> childExpressions=getChildExpressionsWithImplicitCast(expr.getGenericUDF(),exprDesc.getChildren(),exprDesc.getTypeInfo());
      ve=getGenericUdfVectorExpression(expr.getGenericUDF(),childExpressions,mode,exprDesc.getTypeInfo());
      if (ve == null) {
        ve=getCustomUDFExpression(expr,mode);
      }
    }
  }
 else   if (exprDesc instanceof ExprNodeConstantDesc) {
    ve=getConstantVectorExpression(((ExprNodeConstantDesc)exprDesc).getValue(),exprDesc.getTypeInfo(),mode);
  }
  if (ve == null) {
    throw new HiveException("Could not vectorize expression (mode = " + mode.name() + "): "+ exprDesc.toString());
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Input Expression = " + exprDesc.toString() + ", Vectorized Expression = "+ ve.toString());
  }
  return ve;
}
