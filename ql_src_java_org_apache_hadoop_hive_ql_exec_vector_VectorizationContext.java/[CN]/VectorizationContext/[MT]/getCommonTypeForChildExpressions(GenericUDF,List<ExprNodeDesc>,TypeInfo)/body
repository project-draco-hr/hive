{
  TypeInfo commonType;
  if (genericUdf instanceof GenericUDFBaseCompare) {
    TypeInfo tLeft=children.get(0).getTypeInfo();
    TypeInfo tRight=children.get(1).getTypeInfo();
    commonType=FunctionRegistry.getCommonClassForComparison(tLeft,tRight);
    if (commonType == null) {
      commonType=returnType;
    }
  }
 else   if (genericUdf instanceof GenericUDFIn) {
    TypeInfo colTi=children.get(0).getTypeInfo();
    if (colTi.getCategory() != Category.PRIMITIVE) {
      return colTi;
    }
    TypeInfo opTi=GenericUDFUtils.deriveInType(children);
    if (opTi == null || opTi.getCategory() != Category.PRIMITIVE) {
      throw new HiveException("Cannot vectorize IN() - common type is " + opTi);
    }
    if (((PrimitiveTypeInfo)colTi).getPrimitiveCategory() != ((PrimitiveTypeInfo)opTi).getPrimitiveCategory()) {
      throw new HiveException("Cannot vectorize IN() - casting a column is not supported. " + "Column type is " + colTi + " but the common type is "+ opTi);
    }
    return colTi;
  }
 else {
    commonType=returnType;
  }
  return commonType;
}
