{
  long memUsage=metaData.getMemoryUsage();
  memoryManager.reserveMemory(memUsage,false);
  OrcFileMetadata val=metadata.putIfAbsent(metaData.getFileId(),metaData);
  if (val == null) {
    val=metaData;
    policy.cache(val,Priority.HIGH);
  }
 else {
    memoryManager.releaseMemory(memUsage);
    policy.notifyLock(val);
  }
  policy.notifyUnlock(val);
  return val;
}
