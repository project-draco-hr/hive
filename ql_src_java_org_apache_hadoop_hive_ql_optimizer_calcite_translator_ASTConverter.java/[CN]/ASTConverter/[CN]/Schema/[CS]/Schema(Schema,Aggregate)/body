{
  for (  int i : gBy.getGroupSet()) {
    ColumnInfo cI=src.get(i);
    add(cI);
  }
  if (gBy.indicator) {
    for (    int i : gBy.getGroupSet()) {
      ColumnInfo cI=src.get(i);
      add(cI);
    }
  }
  List<AggregateCall> aggs=gBy.getAggCallList();
  for (  AggregateCall agg : aggs) {
    int argCount=agg.getArgList().size();
    ASTBuilder b=agg.isDistinct() ? ASTBuilder.construct(HiveParser.TOK_FUNCTIONDI,"TOK_FUNCTIONDI") : argCount == 0 ? ASTBuilder.construct(HiveParser.TOK_FUNCTIONSTAR,"TOK_FUNCTIONSTAR") : ASTBuilder.construct(HiveParser.TOK_FUNCTION,"TOK_FUNCTION");
    b.add(HiveParser.Identifier,agg.getAggregation().getName());
    for (    int i : agg.getArgList()) {
      RexInputRef iRef=new RexInputRef(i,gBy.getCluster().getTypeFactory().createSqlType(SqlTypeName.ANY));
      b.add(iRef.accept(new RexVisitor(src)));
    }
    add(new ColumnInfo(null,b.node()));
  }
  if (gBy.indicator) {
    add(new ColumnInfo(null,VirtualColumn.GROUPINGID.getName()));
  }
}
