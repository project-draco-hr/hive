{
switch (state) {
case SUCCEEDED:
    return SourceStateProto.S_SUCCEEDED;
case RUNNING:
  return SourceStateProto.S_RUNNING;
default :
throw new RuntimeException("Unexpected state: " + state);
}
}
