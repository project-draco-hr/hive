{
  SourceInfo sourceInfo=getSourceInfo(sourceName);
  if (sourceState == VertexState.SUCCEEDED) {
    sourceInfo.numCompletedTasks=taskCommunicatorContext.getVertexCompletedTaskCount(sourceName);
    sourceInfo.numTasks=taskCommunicatorContext.getVertexTotalTaskCount(sourceName);
  }
  sourceInfo.lastKnownState=sourceState;
  for (  LlapNodeId nodeId : sourceInfo.getInterestedNodes()) {
    NodeInfo nodeInfo=nodeInfoMap.get(nodeId);
    VertexState lastStateForNode=nodeInfo.getLastKnownStateForSource(sourceName);
    if (lastStateForNode != sourceState) {
      nodeInfo.setLastKnownStateForSource(sourceName,sourceState);
      sendStateUpdateToNode(nodeId,sourceName,sourceState);
    }
  }
}
