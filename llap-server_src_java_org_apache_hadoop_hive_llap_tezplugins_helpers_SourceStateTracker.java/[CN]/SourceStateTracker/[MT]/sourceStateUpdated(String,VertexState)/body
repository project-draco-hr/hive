{
  SourceInfo sourceInfo=getSourceInfo(sourceName);
  sourceInfo.lastKnownState=sourceState;
  for (  LlapNodeId nodeId : sourceInfo.getInterestedNodes()) {
    NodeInfo nodeInfo=nodeInfoMap.get(nodeId);
    VertexState lastStateForNode=nodeInfo.getLastKnownStateForSource(sourceName);
    if (lastStateForNode != sourceState) {
      nodeInfo.setLastKnownStateForSource(sourceName,sourceState);
      sendStateUpdateToNode(nodeId,sourceName,sourceState);
    }
  }
}
