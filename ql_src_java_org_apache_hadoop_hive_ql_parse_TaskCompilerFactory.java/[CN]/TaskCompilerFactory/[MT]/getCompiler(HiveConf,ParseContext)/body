{
  if (HiveConf.getBoolVar(conf,HiveConf.ConfVars.HIVE_OPTIMIZE_TEZ) && !parseContext.getQB().getParseInfo().isAnalyzeCommand()) {
    return new TezCompiler();
  }
 else {
    return new MapReduceCompiler();
  }
}
