{
  try {
    driver.setTryCount(Integer.MAX_VALUE);
    response=driver.run();
    if (0 != response.getResponseCode()) {
      throw toSQLException("Error while processing statement",response);
    }
  }
 catch (  HiveSQLException e) {
    if (getStatus().getState() == OperationState.CANCELED) {
      return;
    }
 else {
      setState(OperationState.ERROR);
      throw e;
    }
  }
catch (  Exception e) {
    setState(OperationState.ERROR);
    throw new HiveSQLException("Error running query: " + e.toString(),e);
  }
  setState(OperationState.FINISHED);
}
