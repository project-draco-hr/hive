{
  setState(OperationState.PENDING);
  if (!shouldRunAsync()) {
    runInternal();
  }
 else {
    Runnable backgroundOperation=new Runnable(){
      SessionState ss=SessionState.get();
      @Override public void run(){
        SessionState.start(ss);
        try {
          runInternal();
        }
 catch (        HiveSQLException e) {
          LOG.error("Error: ",e);
        }
      }
    }
;
    try {
      backgroundHandle=getParentSession().getSessionManager().submitBackgroundOperation(backgroundOperation);
    }
 catch (    RejectedExecutionException rejected) {
      setState(OperationState.ERROR);
      throw new HiveSQLException(rejected);
    }
  }
}
