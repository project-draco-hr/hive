{
  validateDefaultFetchOrientation(orientation);
  assertState(OperationState.FINISHED);
  RowSet rowSet=RowSetFactory.create(resultSchema,getProtocolVersion());
  try {
    if (orientation.equals(FetchOrientation.FETCH_FIRST) && fetchStarted) {
      driver.resetFetch();
    }
    fetchStarted=true;
    driver.setMaxRows((int)maxRows);
    if (driver.getResults(convey)) {
      return decode(convey,rowSet);
    }
    return rowSet;
  }
 catch (  IOException e) {
    throw new HiveSQLException(e);
  }
catch (  CommandNeedRetryException e) {
    throw new HiveSQLException(e);
  }
catch (  Exception e) {
    throw new HiveSQLException(e);
  }
 finally {
    convey.clear();
  }
}
