{
  if (serde != null) {
    return serde;
  }
  try {
    List<FieldSchema> fieldSchemas=mResultSchema.getFieldSchemas();
    StringBuilder namesSb=new StringBuilder();
    StringBuilder typesSb=new StringBuilder();
    if (fieldSchemas != null && !fieldSchemas.isEmpty()) {
      for (int pos=0; pos < fieldSchemas.size(); pos++) {
        if (pos != 0) {
          namesSb.append(",");
          typesSb.append(",");
        }
        namesSb.append(fieldSchemas.get(pos).getName());
        typesSb.append(fieldSchemas.get(pos).getType());
      }
    }
    String names=namesSb.toString();
    String types=typesSb.toString();
    serde=new LazySimpleSerDe();
    Properties props=new Properties();
    if (names.length() > 0) {
      LOG.debug("Column names: " + names);
      props.setProperty(serdeConstants.LIST_COLUMNS,names);
    }
    if (types.length() > 0) {
      LOG.debug("Column types: " + types);
      props.setProperty(serdeConstants.LIST_COLUMN_TYPES,types);
    }
    serde.initialize(new HiveConf(),props);
  }
 catch (  Exception ex) {
    ex.printStackTrace();
    throw new SQLException("Could not create ResultSet: " + ex.getMessage(),ex);
  }
  return serde;
}
