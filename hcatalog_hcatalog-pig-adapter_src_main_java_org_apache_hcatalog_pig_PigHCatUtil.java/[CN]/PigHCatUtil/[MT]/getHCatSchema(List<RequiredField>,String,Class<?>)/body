{
  if (fields == null) {
    return null;
  }
  Properties props=UDFContext.getUDFContext().getUDFProperties(classForUDFCLookup,new String[]{signature});
  HCatSchema hcatTableSchema=(HCatSchema)props.get(HCatConstants.HCAT_TABLE_SCHEMA);
  ArrayList<HCatFieldSchema> fcols=new ArrayList<HCatFieldSchema>();
  for (  RequiredField rf : fields) {
    fcols.add(hcatTableSchema.getFields().get(rf.getIndex()));
  }
  return new HCatSchema(fcols);
}
