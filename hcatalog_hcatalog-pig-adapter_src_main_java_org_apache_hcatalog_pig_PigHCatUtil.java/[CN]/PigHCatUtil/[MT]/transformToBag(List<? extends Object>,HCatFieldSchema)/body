{
  if (list == null) {
    return null;
  }
  HCatFieldSchema elementSubFieldSchema=hfs.getArrayElementSchema().getFields().get(0);
  DataBag db=new DefaultDataBag();
  for (  Object o : list) {
    Tuple tuple;
    if (elementSubFieldSchema.getType() == Type.STRUCT) {
      tuple=transformToTuple((List<Object>)o,elementSubFieldSchema);
    }
 else {
      tuple=tupFac.newTuple(extractPigObject(o,elementSubFieldSchema));
    }
    db.add(tuple);
  }
  return db;
}
