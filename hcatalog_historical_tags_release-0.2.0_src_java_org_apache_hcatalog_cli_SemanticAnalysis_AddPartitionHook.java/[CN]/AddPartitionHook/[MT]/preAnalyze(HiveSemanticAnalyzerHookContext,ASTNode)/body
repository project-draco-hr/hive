{
  Map<String,String> tblProps;
  tblName=ast.getChild(0).getText();
  try {
    tblProps=context.getHive().getTable(tblName).getParameters();
  }
 catch (  HiveException he) {
    throw new SemanticException(he);
  }
  inDriver=tblProps.get(HCatConstants.HCAT_ISD_CLASS);
  outDriver=tblProps.get(HCatConstants.HCAT_OSD_CLASS);
  if (inDriver == null || outDriver == null) {
    throw new SemanticException("Operation not supported. Partitions can be added only in a table created through HCatalog. " + "It seems table " + tblName + " was not created through HCatalog.");
  }
  return ast;
}
