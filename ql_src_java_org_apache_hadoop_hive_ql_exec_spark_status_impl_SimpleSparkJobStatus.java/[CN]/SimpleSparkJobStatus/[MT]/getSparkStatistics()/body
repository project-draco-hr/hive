{
  SparkStatisticsBuilder sparkStatisticsBuilder=new SparkStatisticsBuilder();
  sparkStatisticsBuilder.add(sparkCounters);
  String jobIdentifier="Spark Job[" + jobId + "] Metrics";
  Map<String,List<TaskMetrics>> jobMetric=jobStateListener.getJobMetric(jobId);
  Map<String,Long> flatJobMetric=combineJobLevelMetrics(jobMetric);
  for (  Map.Entry<String,Long> entry : flatJobMetric.entrySet()) {
    sparkStatisticsBuilder.add(jobIdentifier,entry.getKey(),Long.toString(entry.getValue()));
  }
  return sparkStatisticsBuilder.build();
}
