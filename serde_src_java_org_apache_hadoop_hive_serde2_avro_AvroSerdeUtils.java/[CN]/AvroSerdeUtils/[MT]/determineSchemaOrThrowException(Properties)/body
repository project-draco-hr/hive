{
  String schemaString=properties.getProperty(SCHEMA_LITERAL);
  if (schemaString != null && !schemaString.equals(SCHEMA_NONE))   return Schema.parse(schemaString);
  schemaString=properties.getProperty(SCHEMA_URL);
  if (schemaString == null || schemaString.equals(SCHEMA_NONE))   throw new AvroSerdeException(EXCEPTION_MESSAGE);
  try {
    if (schemaString.toLowerCase().startsWith("hdfs://"))     return getSchemaFromHDFS(schemaString,new Configuration());
  }
 catch (  IOException ioe) {
    throw new AvroSerdeException("Unable to read schema from HDFS: " + schemaString,ioe);
  }
  return Schema.parse(new URL(schemaString).openStream());
}
