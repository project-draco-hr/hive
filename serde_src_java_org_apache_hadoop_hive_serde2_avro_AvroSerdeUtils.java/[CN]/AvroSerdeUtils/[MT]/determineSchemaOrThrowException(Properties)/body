{
  String schemaString=properties.getProperty(SCHEMA_LITERAL);
  if (schemaString != null && !schemaString.equals(SCHEMA_NONE))   return Schema.parse(schemaString);
  schemaString=properties.getProperty(SCHEMA_URL);
  if (schemaString == null || schemaString.equals(SCHEMA_NONE))   throw new AvroSerdeException(EXCEPTION_MESSAGE);
  try {
    Schema s=getSchemaFromFS(schemaString,new Configuration());
    if (s == null) {
      return Schema.parse(new URL(schemaString).openStream());
    }
    return s;
  }
 catch (  IOException ioe) {
    throw new AvroSerdeException("Unable to read schema from given path: " + schemaString,ioe);
  }
catch (  URISyntaxException urie) {
    throw new AvroSerdeException("Unable to read schema from given path: " + schemaString,urie);
  }
}
