{
  String schemaString=properties.getProperty(AvroTableProperties.SCHEMA_LITERAL.getPropName());
  if (schemaString != null && !schemaString.equals(SCHEMA_NONE))   return AvroSerdeUtils.getSchemaFor(schemaString);
  schemaString=properties.getProperty(AvroTableProperties.SCHEMA_URL.getPropName());
  if (schemaString == null || schemaString.equals(SCHEMA_NONE))   throw new AvroSerdeException(EXCEPTION_MESSAGE);
  try {
    Schema s=getSchemaFromFS(schemaString,conf);
    if (s == null) {
      return AvroSerdeUtils.getSchemaFor(new URL(schemaString).openStream());
    }
    return s;
  }
 catch (  IOException ioe) {
    throw new AvroSerdeException("Unable to read schema from given path: " + schemaString,ioe);
  }
catch (  URISyntaxException urie) {
    throw new AvroSerdeException("Unable to read schema from given path: " + schemaString,urie);
  }
}
