{
  FSDataInputStream in=null;
  FileSystem fs=null;
  try {
    fs=FileSystem.get(new URI(schemaFSUrl),conf);
  }
 catch (  IOException ioe) {
    if (LOG.isDebugEnabled()) {
      String msg="Failed to open file system for uri " + schemaFSUrl + " assuming it is not a FileSystem url";
      LOG.debug(msg,ioe);
    }
    return null;
  }
  try {
    in=fs.open(new Path(schemaFSUrl));
    Schema s=AvroSerdeUtils.getSchemaFor(in);
    return s;
  }
  finally {
    if (in != null)     in.close();
  }
}
