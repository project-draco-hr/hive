{
  if (isClosed) {
    throw new SQLException("Can't execute after statement has been closed");
  }
  try {
    if (stmtHandle != null) {
      closeClientOperation();
    }
    TExecuteStatementReq execReq=new TExecuteStatementReq(sessHandle,sql);
    execReq.setRunAsync(true);
    execReq.setConfOverlay(sessConf);
    transportLock.lock();
    TExecuteStatementResp execResp=client.ExecuteStatement(execReq);
    Utils.verifySuccessWithInfo(execResp.getStatus());
    stmtHandle=execResp.getOperationHandle();
    transportLock.unlock();
  }
 catch (  SQLException eS) {
    throw eS;
  }
catch (  Exception ex) {
    throw new SQLException(ex.toString(),"08S01",ex);
  }
  TGetOperationStatusReq statusReq=new TGetOperationStatusReq(stmtHandle);
  boolean operationComplete=false;
  TGetOperationStatusResp statusResp;
  while (!operationComplete) {
    try {
      transportLock.lock();
      statusResp=client.GetOperationStatus(statusReq);
      transportLock.unlock();
      Utils.verifySuccessWithInfo(statusResp.getStatus());
      if (statusResp.isSetOperationState()) {
switch (statusResp.getOperationState()) {
case CLOSED_STATE:
case FINISHED_STATE:
          operationComplete=true;
        break;
case CANCELED_STATE:
      throw new SQLException("Query was cancelled","01000");
case ERROR_STATE:
    throw new SQLException(statusResp.getErrorMessage(),statusResp.getSqlState(),statusResp.getErrorCode());
case UKNOWN_STATE:
  throw new SQLException("Unknown query","HY000");
case INITIALIZED_STATE:
case PENDING_STATE:
case RUNNING_STATE:
break;
}
}
}
 catch (SQLException e) {
throw e;
}
catch (Exception e) {
throw new SQLException(e.toString(),"08S01",e);
}
}
if (!stmtHandle.isHasResultSet()) {
return false;
}
resultSet=new HiveQueryResultSet.Builder(this).setClient(client).setSessionHandle(sessHandle).setStmtHandle(stmtHandle).setMaxRows(maxRows).setFetchSize(fetchSize).setScrollable(isScrollableResultset).build();
return true;
}
