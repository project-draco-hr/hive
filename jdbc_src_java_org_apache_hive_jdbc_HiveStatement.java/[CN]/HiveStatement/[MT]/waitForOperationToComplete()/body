{
  TGetOperationStatusReq statusReq=new TGetOperationStatusReq(stmtHandle);
  TGetOperationStatusResp statusResp;
  while (!isOperationComplete) {
    try {
      statusResp=client.GetOperationStatus(statusReq);
      Utils.verifySuccessWithInfo(statusResp.getStatus());
      if (statusResp.isSetOperationState()) {
switch (statusResp.getOperationState()) {
case CLOSED_STATE:
case FINISHED_STATE:
          isOperationComplete=true;
        isLogBeingGenerated=false;
      break;
case CANCELED_STATE:
    throw new SQLException("Query was cancelled","01000");
case TIMEDOUT_STATE:
  throw new SQLTimeoutException("Query timed out after " + queryTimeout + " seconds");
case ERROR_STATE:
throw new SQLException(statusResp.getErrorMessage(),statusResp.getSqlState(),statusResp.getErrorCode());
case UKNOWN_STATE:
throw new SQLException("Unknown query","HY000");
case INITIALIZED_STATE:
case PENDING_STATE:
case RUNNING_STATE:
break;
}
}
}
 catch (SQLException e) {
isLogBeingGenerated=false;
throw e;
}
catch (Exception e) {
isLogBeingGenerated=false;
throw new SQLException(e.toString(),"08S01",e);
}
}
}
