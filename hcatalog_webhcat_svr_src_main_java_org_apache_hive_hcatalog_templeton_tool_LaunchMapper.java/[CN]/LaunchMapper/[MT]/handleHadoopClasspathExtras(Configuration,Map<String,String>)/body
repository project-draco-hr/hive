{
  if (!TempletonUtils.isset(conf.get(JobSubmissionConstants.HADOOP_CLASSPATH_EXTRAS))) {
    return;
  }
  LOG.debug(HADOOP_CLASSPATH_EXTRAS + "=" + conf.get(HADOOP_CLASSPATH_EXTRAS));
  String[] files=conf.getStrings(HADOOP_CLASSPATH_EXTRAS);
  StringBuilder paths=new StringBuilder();
  FileSystem fs=FileSystem.getLocal(conf);
  for (  String f : files) {
    Path p=new Path(f);
    FileStatus fileStatus=fs.getFileStatus(p);
    paths.append(f);
    if (fileStatus.isDirectory()) {
      paths.append(File.separator).append("*");
    }
    paths.append(File.pathSeparator);
  }
  paths.setLength(paths.length() - 1);
  if (TempletonUtils.isset(System.getenv("HADOOP_CLASSPATH"))) {
    env.put("HADOOP_CLASSPATH",System.getenv("HADOOP_CLASSPATH") + File.pathSeparator + paths);
  }
 else {
    env.put("HADOOP_CLASSPATH",paths.toString());
  }
}
