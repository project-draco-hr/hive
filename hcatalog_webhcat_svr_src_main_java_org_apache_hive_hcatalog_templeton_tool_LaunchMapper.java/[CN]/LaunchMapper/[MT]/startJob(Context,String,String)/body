{
  Configuration conf=context.getConfiguration();
  killLauncherChildJobs(conf,context.getJobID().toString());
  copyLocal(COPY_NAME,conf);
  String[] jarArgs=TempletonUtils.decodeArray(conf.get(JAR_ARGS_NAME));
  ArrayList<String> removeEnv=new ArrayList<String>();
  removeEnv.add("HADOOP_ROOT_LOGGER");
  removeEnv.add("hadoop-command");
  removeEnv.add("CLASS");
  removeEnv.add("mapredcommand");
  Map<String,String> env=TempletonUtils.hadoopUserEnv(user,overrideClasspath);
  handlePigEnvVars(conf,env);
  List<String> jarArgsList=new LinkedList<String>(Arrays.asList(jarArgs));
  handleTokenFile(jarArgsList,JobSubmissionConstants.TOKEN_FILE_ARG_PLACEHOLDER,"mapreduce.job.credentials.binary");
  handleTokenFile(jarArgsList,JobSubmissionConstants.TOKEN_FILE_ARG_PLACEHOLDER_TEZ,"tez.credentials.path");
  handleMapReduceJobTag(jarArgsList,JobSubmissionConstants.MAPREDUCE_JOB_TAGS_ARG_PLACEHOLDER,JobSubmissionConstants.MAPREDUCE_JOB_TAGS,context.getJobID().toString());
  return TrivialExecService.getInstance().run(jarArgsList,removeEnv,env);
}
