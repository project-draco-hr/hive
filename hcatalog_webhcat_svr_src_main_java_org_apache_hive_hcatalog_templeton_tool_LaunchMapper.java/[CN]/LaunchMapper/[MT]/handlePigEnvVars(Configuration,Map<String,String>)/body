{
  if (conf.get(PigConstants.HIVE_HOME) != null) {
    env.put(PigConstants.HIVE_HOME,new File(conf.get(PigConstants.HIVE_HOME)).getAbsolutePath());
  }
  if (conf.get(PigConstants.HCAT_HOME) != null) {
    env.put(PigConstants.HCAT_HOME,new File(conf.get(PigConstants.HCAT_HOME)).getAbsolutePath());
  }
  if (conf.get(PigConstants.PIG_OPTS) != null) {
    StringBuilder pigOpts=new StringBuilder();
    for (    String prop : StringUtils.split(conf.get(PigConstants.PIG_OPTS))) {
      pigOpts.append("-D").append(TempletonUtils.unEscape(prop)).append(" ");
    }
    env.put(PigConstants.PIG_OPTS,pigOpts.toString());
  }
}
