{
  String lockPath=prepareLockNode(tableName);
  WriteLock wLock=new WriteLock(zkUtil.getSession(),lockPath,Ids.OPEN_ACL_UNSAFE);
  RMLockListener myLockListener=new RMLockListener();
  wLock.setLockListener(myLockListener);
  try {
    boolean lockGrabbed=wLock.lock();
    if (lockGrabbed == false) {
      throw new IOException("Unable to obtain lock while refreshing transactions of table " + tableName + ".");
    }
 else {
      List<String> cfPaths=zkUtil.getColumnFamiliesOfTable(tableName);
      for (      String cf : cfPaths) {
        String runningDataPath=PathUtil.getRunningTxnInfoPath(baseDir,tableName,cf);
        zkUtil.refreshTransactions(runningDataPath);
      }
    }
  }
 catch (  KeeperException e) {
    throw new IOException("Exception while obtaining lock.",e);
  }
catch (  InterruptedException e) {
    throw new IOException("Exception while obtaining lock.",e);
  }
 finally {
    wLock.unlock();
  }
}
