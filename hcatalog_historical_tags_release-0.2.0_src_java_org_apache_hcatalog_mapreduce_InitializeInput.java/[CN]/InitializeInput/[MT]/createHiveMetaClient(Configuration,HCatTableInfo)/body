{
  if (inputInfo.getServerUri() != null) {
    hiveConf.set("hive.metastore.local","false");
    hiveConf.set(HiveConf.ConfVars.METASTOREURIS.varname,inputInfo.getServerUri());
  }
  String kerberosPrincipal=inputInfo.getServerKerberosPrincipal();
  if (kerberosPrincipal != null) {
    hiveConf.setBoolean(HiveConf.ConfVars.METASTORE_USE_THRIFT_SASL.varname,true);
    hiveConf.set(HiveConf.ConfVars.METASTORE_KERBEROS_PRINCIPAL.varname,kerberosPrincipal);
  }
  return new HiveMetaStoreClient(hiveConf,null);
}
