{
  int tryNum=0;
  do {
    try {
      tryNum++;
      if (tryNum > 1) {
        Thread.sleep(sleepTime);
        prepareRetry();
      }
      unlockPrimitive(conf,zkpClient,hiveLock,parent);
      break;
    }
 catch (    Exception e) {
      if (tryNum >= numRetriesForUnLock) {
        String name=((ZooKeeperHiveLock)hiveLock).getPath();
        LOG.error("Node " + name + " can not be deleted after "+ numRetriesForUnLock+ " attempts.");
        throw new LockException(e);
      }
    }
  }
 while (tryNum < numRetriesForUnLock);
  return;
}
