{
  this.ctx=ctx;
  HiveConf conf=ctx.getConf();
  int sessionTimeout=conf.getIntVar(HiveConf.ConfVars.HIVE_ZOOKEEPER_SESSION_TIMEOUT);
  String quorumServers=ZooKeeperHiveLockManager.getQuorumServers(conf);
  try {
    if (zooKeeper != null) {
      zooKeeper.close();
    }
    zooKeeper=new ZooKeeper(quorumServers,sessionTimeout,new DummyWatcher());
    parent=conf.getVar(HiveConf.ConfVars.HIVE_ZOOKEEPER_NAMESPACE);
    try {
      String par=zooKeeper.create("/" + parent,new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
    }
 catch (    KeeperException e) {
    }
  }
 catch (  Exception e) {
    LOG.error("Failed to create ZooKeeper object: " + e);
    throw new LockException(ErrorMsg.ZOOKEEPER_CLIENT_COULD_NOT_BE_INITIALIZED.getMsg());
  }
}
