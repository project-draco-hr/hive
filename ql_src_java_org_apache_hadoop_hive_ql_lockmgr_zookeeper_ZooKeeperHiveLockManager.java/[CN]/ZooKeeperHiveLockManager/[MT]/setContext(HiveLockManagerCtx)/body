{
  this.ctx=ctx;
  HiveConf conf=ctx.getConf();
  sessionTimeout=conf.getIntVar(HiveConf.ConfVars.HIVE_ZOOKEEPER_SESSION_TIMEOUT);
  quorumServers=ZooKeeperHiveLockManager.getQuorumServers(conf);
  try {
    renewZookeeperInstance(sessionTimeout,quorumServers);
    parent=conf.getVar(HiveConf.ConfVars.HIVE_ZOOKEEPER_NAMESPACE);
    try {
      zooKeeper.create("/" + parent,new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
    }
 catch (    KeeperException e) {
    }
  }
 catch (  Exception e) {
    LOG.error("Failed to create ZooKeeper object: " + e);
    throw new LockException(ErrorMsg.ZOOKEEPER_CLIENT_COULD_NOT_BE_INITIALIZED.getMsg());
  }
}
