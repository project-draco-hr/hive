{
  List<HiveLock> locks=new ArrayList<HiveLock>();
  List<String> children;
  try {
    children=zkpClient.getChildren("/" + parent,false);
  }
 catch (  Exception e) {
    LOG.error("Failed to get ZooKeeper children: " + e);
    throw new LockException(e);
  }
  for (  String child : children) {
    child="/" + parent + "/"+ child;
    HiveLockMode mode=getLockMode(conf,child);
    if (mode == null) {
      continue;
    }
    HiveLockObject obj=getLockObject(conf,child,mode);
    if ((key == null) || (obj.getName().equals(key.getName()))) {
      HiveLock lck=(HiveLock)(new ZooKeeperHiveLock(child,obj,mode));
      locks.add(lck);
    }
  }
  return locks;
}
