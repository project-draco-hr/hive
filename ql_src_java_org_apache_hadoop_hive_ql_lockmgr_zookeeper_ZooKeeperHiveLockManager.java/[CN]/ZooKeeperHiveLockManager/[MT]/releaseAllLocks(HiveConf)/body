{
  try {
    String parent=conf.getVar(HiveConf.ConfVars.HIVE_ZOOKEEPER_NAMESPACE);
    List<HiveLock> locks=getLocks(conf,null,parent,false,false);
    Exception lastExceptionGot=null;
    if (locks != null) {
      for (      HiveLock lock : locks) {
        try {
          unlockPrimitive(lock,parent,curatorFramework);
        }
 catch (        Exception e) {
          lastExceptionGot=e;
        }
      }
    }
    if (lastExceptionGot != null) {
      throw lastExceptionGot;
    }
  }
 catch (  Exception e) {
    LOG.error("Failed to release all locks: ",e);
    throw new Exception(ErrorMsg.ZOOKEEPER_CLIENT_COULD_NOT_BE_INITIALIZED.getMsg());
  }
}
