{
  FileOutputStream fos=null;
  try {
    if (parentFile == null) {
      parentFile=File.createTempFile("key-value-container","");
      if (parentFile.delete() && parentFile.mkdir()) {
        parentFile.deleteOnExit();
      }
    }
    if (tmpFile == null || input != null) {
      tmpFile=File.createTempFile("KeyValueContainer",".tmp",parentFile);
      LOG.info("KeyValueContainer created temp file " + tmpFile.getAbsolutePath());
      tmpFile.deleteOnExit();
    }
    fos=new FileOutputStream(tmpFile);
    output=new Output(fos);
  }
 catch (  IOException e) {
    throw new HiveException(e);
  }
 finally {
    if (output == null && fos != null) {
      fos.close();
    }
  }
}
