{
  Operator<? extends OperatorDesc> vectorOp=op;
  try {
    if (!opsDone.contains(op)) {
      vectorOp=vectorizeOperator(op,vContext);
      opsDone.add(op);
      if (vectorOp != op) {
        opsDone.add(vectorOp);
      }
      if (vectorOp instanceof VectorizationContextRegion) {
        VectorizationContextRegion vcRegion=(VectorizationContextRegion)vectorOp;
        VectorizationContext vOutContext=vcRegion.getOuputVectorizationContext();
        vContextsByTSOp.put(op,vOutContext);
        scratchColumnContext.put(vOutContext.getFileKey(),vOutContext);
      }
    }
  }
 catch (  HiveException e) {
    throw new SemanticException(e);
  }
  return vectorOp;
}
