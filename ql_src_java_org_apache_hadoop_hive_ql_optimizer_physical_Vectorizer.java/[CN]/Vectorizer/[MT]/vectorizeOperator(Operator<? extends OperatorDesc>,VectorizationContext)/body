{
  Operator<? extends OperatorDesc> vectorOp=null;
switch (op.getType()) {
case GROUPBY:
case FILTER:
case SELECT:
case FILESINK:
case REDUCESINK:
case LIMIT:
    vectorOp=OperatorFactory.getVectorOperator(op.getConf(),vContext);
  break;
default :
vectorOp=op;
break;
}
if (vectorOp != op) {
if (op.getParentOperators() != null) {
vectorOp.setParentOperators(op.getParentOperators());
for (Operator<? extends OperatorDesc> p : op.getParentOperators()) {
p.replaceChild(op,vectorOp);
}
}
if (op.getChildOperators() != null) {
vectorOp.setChildOperators(op.getChildOperators());
for (Operator<? extends OperatorDesc> c : op.getChildOperators()) {
c.replaceParent(op,vectorOp);
}
}
((AbstractOperatorDesc)vectorOp.getConf()).setVectorMode(true);
}
return vectorOp;
}
