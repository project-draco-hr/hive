{
  String udfName=aggDesc.getGenericUDAFName().toLowerCase();
  if (!supportedAggregationUdfs.contains(udfName)) {
    LOG.info("Cannot vectorize groupby aggregate expression: UDF " + udfName + " not supported");
    return false;
  }
  if (aggDesc.getParameters() != null && !validateExprNodeDesc(aggDesc.getParameters())) {
    LOG.info("Cannot vectorize groupby aggregate expression: UDF parameters not supported");
    return false;
  }
  VectorizationContext vc=new ValidatorVectorizationContext();
  VectorAggregateExpression vectorAggrExpr;
  try {
    vectorAggrExpr=vc.getAggregatorExpression(aggDesc,isReduceMergePartial);
  }
 catch (  Exception e) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Vectorization of aggreation should have succeeded ",e);
    }
    return false;
  }
  if (isReduceMergePartial && hasKeys && !validateAggregationIsPrimitive(vectorAggrExpr)) {
    LOG.info("Vectorized Reduce MergePartial GROUP BY keys can only handle aggregate outputs that are primitive types");
    return false;
  }
  return true;
}
