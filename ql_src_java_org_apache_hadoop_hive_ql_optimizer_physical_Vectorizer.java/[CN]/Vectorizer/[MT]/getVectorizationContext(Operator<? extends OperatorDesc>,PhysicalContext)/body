{
  RowResolver rr=pctx.getParseContext().getOpParseCtx().get(op).getRowResolver();
  Map<String,Integer> cmap=new HashMap<String,Integer>();
  int columnCount=0;
  for (  ColumnInfo c : rr.getColumnInfos()) {
    if (!c.getIsVirtualCol()) {
      cmap.put(c.getInternalName(),columnCount++);
    }
  }
  Table tab=pctx.getParseContext().getTopToTable().get(op);
  if (tab.getPartitionKeys() != null) {
    for (    FieldSchema fs : tab.getPartitionKeys()) {
      cmap.put(fs.getName(),columnCount++);
    }
  }
  return new VectorizationContext(cmap,columnCount);
}
