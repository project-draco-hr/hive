{
  RowSchema rs=op.getSchema();
  Map<String,Integer> cmap=new HashMap<String,Integer>();
  int columnCount=0;
  for (  ColumnInfo c : rs.getSignature()) {
    if (!c.getIsVirtualCol()) {
      cmap.put(c.getInternalName(),columnCount++);
    }
  }
  PrunedPartitionList partList=pctx.getParseContext().getOpToPartList().get(op);
  if (partList != null) {
    Table tab=partList.getSourceTable();
    if (tab.getPartitionKeys() != null) {
      for (      FieldSchema fs : tab.getPartitionKeys()) {
        cmap.put(fs.getName(),columnCount++);
      }
    }
  }
  return new VectorizationContext(cmap,columnCount);
}
