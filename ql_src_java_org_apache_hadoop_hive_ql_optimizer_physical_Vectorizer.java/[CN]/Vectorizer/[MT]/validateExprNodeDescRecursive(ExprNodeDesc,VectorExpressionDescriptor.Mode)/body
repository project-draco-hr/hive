{
  if (desc instanceof ExprNodeColumnDesc) {
    ExprNodeColumnDesc c=(ExprNodeColumnDesc)desc;
    if (VirtualColumn.VIRTUAL_COLUMN_NAMES.contains(c.getColumn())) {
      LOG.info("Cannot vectorize virtual column " + c.getColumn());
      return false;
    }
  }
  String typeName=desc.getTypeInfo().getTypeName();
  boolean ret=validateDataType(typeName,mode);
  if (!ret) {
    LOG.info("Cannot vectorize " + desc.toString() + " of type "+ typeName);
    return false;
  }
  boolean isInExpression=false;
  if (desc instanceof ExprNodeGenericFuncDesc) {
    ExprNodeGenericFuncDesc d=(ExprNodeGenericFuncDesc)desc;
    boolean r=validateGenericUdf(d);
    if (!r) {
      LOG.info("Cannot vectorize UDF " + d);
      return false;
    }
    GenericUDF genericUDF=d.getGenericUDF();
    isInExpression=(genericUDF instanceof GenericUDFIn);
  }
  if (desc.getChildren() != null) {
    if (isInExpression && desc.getChildren().get(0).getTypeInfo().getCategory() == Category.STRUCT) {
      if (!validateStructInExpression(desc,VectorExpressionDescriptor.Mode.FILTER)) {
        return false;
      }
    }
 else {
      for (      ExprNodeDesc d : desc.getChildren()) {
        if (!validateExprNodeDescRecursive(d,VectorExpressionDescriptor.Mode.FILTER)) {
          return false;
        }
      }
    }
  }
  return true;
}
