{
  TableScanDesc desc=op.getConf();
  if (desc.isGatherStats()) {
    return false;
  }
  String columns="";
  String types="";
  String partitionColumns="";
  String partitionTypes="";
  boolean haveInfo=false;
  LinkedHashMap<String,PartitionDesc> partitionDescs=mWork.getPathToPartitionInfo();
  for (  Map.Entry<String,PartitionDesc> entry : partitionDescs.entrySet()) {
    PartitionDesc partDesc=entry.getValue();
    if (partDesc.getPartSpec() == null || partDesc.getPartSpec().isEmpty()) {
      continue;
    }
    Properties partProps=partDesc.getProperties();
    if (!haveInfo) {
      columns=partProps.getProperty(hive_metastoreConstants.META_TABLE_COLUMNS);
      types=partProps.getProperty(hive_metastoreConstants.META_TABLE_COLUMN_TYPES);
      partitionColumns=partProps.getProperty(hive_metastoreConstants.META_TABLE_PARTITION_COLUMNS);
      partitionTypes=partProps.getProperty(hive_metastoreConstants.META_TABLE_PARTITION_COLUMN_TYPES);
      haveInfo=true;
    }
 else {
      String nextColumns=partProps.getProperty(hive_metastoreConstants.META_TABLE_COLUMNS);
      String nextTypes=partProps.getProperty(hive_metastoreConstants.META_TABLE_COLUMN_TYPES);
      String nextPartitionColumns=partProps.getProperty(hive_metastoreConstants.META_TABLE_PARTITION_COLUMNS);
      String nextPartitionTypes=partProps.getProperty(hive_metastoreConstants.META_TABLE_PARTITION_COLUMN_TYPES);
      if (!columns.equalsIgnoreCase(nextColumns)) {
        LOG.info(String.format("Could not vectorize partition %s.  Its column names %s do not match the other column names %s",entry.getKey(),nextColumns,columns));
        return false;
      }
      if (!types.equalsIgnoreCase(nextTypes)) {
        LOG.info(String.format("Could not vectorize partition %s.  Its column types %s do not match the other column types %s",entry.getKey(),nextTypes,types));
        return false;
      }
      if (!partitionColumns.equalsIgnoreCase(nextPartitionColumns)) {
        LOG.info(String.format("Could not vectorize partition %s.  Its partition column names %s do not match the other partition column names %s",entry.getKey(),nextPartitionColumns,partitionColumns));
        return false;
      }
      if (!partitionTypes.equalsIgnoreCase(nextPartitionTypes)) {
        LOG.info(String.format("Could not vectorize partition %s.  Its partition column types %s do not match the other partition column types %s",entry.getKey(),nextPartitionTypes,partitionTypes));
        return false;
      }
    }
  }
  return true;
}
