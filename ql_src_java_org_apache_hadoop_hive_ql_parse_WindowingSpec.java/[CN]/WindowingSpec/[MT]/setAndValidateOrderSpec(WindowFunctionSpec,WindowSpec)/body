{
  wdwSpec.ensureOrderSpec(wFn);
  WindowFrameSpec wFrame=wdwSpec.getWindowFrame();
  OrderSpec order=wdwSpec.getOrder();
  BoundarySpec start=wFrame.getStart();
  BoundarySpec end=wFrame.getEnd();
  if (start instanceof ValueBoundarySpec || end instanceof ValueBoundarySpec) {
    if (order != null) {
      if (order.getExpressions().size() > 1) {
        throw new SemanticException("Range based Window Frame can have only 1 Sort Key");
      }
      if (start instanceof ValueBoundarySpec) {
        ((ValueBoundarySpec)start).setExpression(order.getExpressions().get(0).getExpression());
      }
      if (end instanceof ValueBoundarySpec) {
        ((ValueBoundarySpec)end).setExpression(order.getExpressions().get(0).getExpression());
      }
    }
  }
}
