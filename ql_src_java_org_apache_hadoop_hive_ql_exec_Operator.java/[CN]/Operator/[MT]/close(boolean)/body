{
  if (state == State.CLOSE) {
    return;
  }
  if (!allInitializedParentsAreClosed()) {
    LOG.debug("Not all parent operators are closed. Not closing.");
    return;
  }
  state=State.CLOSE;
  LOG.info(id + " finished. closing... ");
  closeOp(abort);
  reporter=null;
  try {
    logStats();
    if (childOperators == null) {
      return;
    }
    for (    Operator<? extends OperatorDesc> op : childOperators) {
      LOG.debug("Closing child = " + op);
      op.close(abort);
    }
    LOG.info(id + " Close done");
  }
 catch (  HiveException e) {
    e.printStackTrace();
    throw e;
  }
}
