{
  if (state == State.CLOSE) {
    return;
  }
  if (!allInitializedParentsAreClosed()) {
    if (isLogDebugEnabled) {
      LOG.debug("Not all parent operators are closed. Not closing.");
    }
    return;
  }
  state=State.CLOSE;
  if (isLogDebugEnabled) {
    LOG.debug(id + " finished. closing... ");
  }
  abort|=abortOp.get();
  closeOp(abort);
  reporter=null;
  try {
    logStats();
    if (childOperators == null) {
      return;
    }
    for (    Operator<? extends OperatorDesc> op : childOperators) {
      if (isLogDebugEnabled) {
        LOG.debug("Closing child = " + op);
      }
      op.close(abort);
    }
    if (isLogDebugEnabled) {
      LOG.debug(id + " Close done");
    }
  }
 catch (  HiveException e) {
    e.printStackTrace();
    throw e;
  }
}
