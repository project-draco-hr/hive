{
  if (fname == null || conf == null) {
    return null;
  }
  FileSystem defaultFs=FileSystem.get(new URI(fname),conf,user);
  URI u=new URI(fname);
  Path p=new Path(u).makeQualified(defaultFs);
  FileSystem fs=p.getFileSystem(conf);
  if (hadoopFsIsMissing(fs,p))   throw new FileNotFoundException("File " + fname + " does not exist.");
  return p;
}
