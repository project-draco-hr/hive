{
  try {
    Type hType=hcatField.getType();
switch (hType) {
case SMALLINT:
case TINYINT:
case BOOLEAN:
      throw new PigException("Incompatible type found in hcat table schema: " + hcatField,PigHCatUtil.PIG_EXCEPTION_CODE);
case ARRAY:
    validateHCatSchemaFollowsPigRules(hcatField.getArrayElementSchema());
  break;
case STRUCT:
validateHCatSchemaFollowsPigRules(hcatField.getStructSubSchema());
break;
case MAP:
validateHCatSchemaFollowsPigRules(hcatField.getMapValueSchema());
break;
}
}
 catch (HCatException e) {
throw new PigException("Incompatible type found in hcat table schema: " + hcatField,PigHCatUtil.PIG_EXCEPTION_CODE,e);
}
}
