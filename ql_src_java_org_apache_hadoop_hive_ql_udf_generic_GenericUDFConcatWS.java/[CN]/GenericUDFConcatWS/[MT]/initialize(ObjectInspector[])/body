{
  if (arguments.length < 2) {
    throw new UDFArgumentLengthException("The function CONCAT_WS(separator,[string | array(string)]+) " + "needs at least two arguments.");
  }
  for (int i=0; i < arguments.length; i++) {
switch (arguments[i].getCategory()) {
case LIST:
      if (isStringOrVoidType(((ListObjectInspector)arguments[i]).getListElementObjectInspector())) {
        break;
      }
case PRIMITIVE:
    if (isStringOrVoidType(arguments[i])) {
      break;
    }
default :
  throw new UDFArgumentTypeException(i,"Argument " + (i + 1) + " of function CONCAT_WS must be \""+ serdeConstants.STRING_TYPE_NAME+ " or "+ serdeConstants.LIST_TYPE_NAME+ "<"+ serdeConstants.STRING_TYPE_NAME+ ">\", but \""+ arguments[i].getTypeName()+ "\" was found.");
}
}
argumentOIs=arguments;
return PrimitiveObjectInspectorFactory.writableStringObjectInspector;
}
