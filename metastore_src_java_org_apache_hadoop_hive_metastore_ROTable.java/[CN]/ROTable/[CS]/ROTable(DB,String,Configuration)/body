{
  parent_=parent;
  tableName_=tableName;
  conf_=conf;
  store_=new FileStore(conf);
  if (store_.tableExists(parent_.getName(),tableName) == false) {
    throw new UnknownTableException("metadata does not exist");
  }
  schema_=store_.load(parent,tableName);
  whPath_=new Path(schema_.getProperty(Constants.META_TABLE_LOCATION));
  if (whPath_.toUri().relativize(parent.whRoot_.toUri()) == null) {
    LOG.warn(whPath_ + " is not the current default fs");
  }
  try {
    if (whPath_.getFileSystem(conf).exists(whPath_) == false) {
      throw new UnknownTableException("data does not exist:" + whPath_);
    }
  }
 catch (  IOException e) {
  }
}
