{
  int i=0;
  TField field=new TField();
  for (Iterator it=obj_fields.entrySet().iterator(); it.hasNext(); ) {
    Map.Entry entry=(Map.Entry)it.next();
    String key=(String)entry.getKey();
    Object f=entry.getValue();
    DynamicSerDeTypeBase mt=this.types_by_column_name.get(key);
    if (thrift_mode) {
      field.name=mt.name;
      field.type=mt.getType();
      field.id=(short)mt.fieldid;
      oprot.writeFieldBegin(field);
    }
    mt.serialize(f,oprot);
    if (thrift_mode) {
      oprot.writeFieldEnd();
    }
    i++;
  }
  if (thrift_mode) {
    oprot.writeFieldStop();
  }
}
