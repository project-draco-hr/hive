{
  boolean runOptiq=false;
  if ((qp.getJoinCount() > 1) && (qp.getJoinCount() < HiveConf.getIntVar(conf,HiveConf.ConfVars.HIVE_CBO_MAX_JOINS_SUPPORTED)) && (qp.getOuterJoinCount() == 0)&& !qp.hasClusterBy()&& !qp.hasDistributeBy()&& !qp.hasSortBy()&& !qp.hasWindowing()) {
    @SuppressWarnings("rawtypes") final HashSet<Operator> start=new HashSet<Operator>();
    start.add(sinkOp);
    if (!CostBasedOptimizer.operatorExists(start,true,m_unsupportedOpTypes)) {
      runOptiq=true;
    }
  }
  return runOptiq;
}
