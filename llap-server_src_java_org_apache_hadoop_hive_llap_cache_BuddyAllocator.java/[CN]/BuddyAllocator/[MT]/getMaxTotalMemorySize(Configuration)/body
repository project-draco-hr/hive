{
  long maxSize=HiveConf.getSizeVar(conf,ConfVars.LLAP_IO_MEMORY_MAX_SIZE);
  if (maxSize > MIN_TOTAL_MEMORY_SIZE || HiveConf.getBoolVar(conf,ConfVars.HIVE_IN_TEST)) {
    return maxSize;
  }
  throw new RuntimeException("Allocator space is too small for reasonable operation; " + ConfVars.LLAP_IO_MEMORY_MAX_SIZE.varname + "="+ maxSize+ ", but at least "+ MIN_TOTAL_MEMORY_SIZE+ " is required. If you cannot spare any memory, you can "+ "disable LLAP IO entirely via "+ ConfVars.LLAP_IO_ENABLED.varname+ "; or set "+ ConfVars.LLAP_IO_MEMORY_MODE.varname+ " to 'none'");
}
