{
  StructObjectInspector oi=(StructObjectInspector)serDe.getObjectInspector();
  List<? extends StructField> fieldRefs=oi.getAllStructFieldRefs();
  assertEquals(9,fieldRefs.size());
  Object row=serDe.deserialize(r);
  for (int i=0; i < fieldRefs.size(); i++) {
    Object fieldData=oi.getStructFieldData(row,fieldRefs.get(i));
    if (fieldData != null) {
      fieldData=((LazyPrimitive<?,?>)fieldData).getWritableObject();
    }
    assertEquals("Field " + i,expectedFieldsData[i],fieldData);
  }
  assertEquals(Put.class,serDe.getSerializedClass());
  Put serializedPut=(Put)serDe.serialize(row,oi);
  assertEquals("Serialized data",p.toString(),serializedPut.toString());
}
