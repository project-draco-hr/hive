{
  StructObjectInspector oi=(StructObjectInspector)serDe.getObjectInspector();
  List<? extends StructField> fieldRefs=oi.getAllStructFieldRefs();
  assertEquals(9,fieldRefs.size());
  Object row=serDe.deserialize(new ResultWritable(r));
  for (int i=0; i < fieldRefs.size(); i++) {
    Object fieldData=oi.getStructFieldData(row,fieldRefs.get(i));
    if (fieldData != null) {
      fieldData=((LazyPrimitive<?,?>)fieldData).getWritableObject();
    }
    assertEquals("Field " + i,expectedFieldsData[i],fieldData);
  }
  assertEquals(PutWritable.class,serDe.getSerializedClass());
  PutWritable serializedPut=(PutWritable)serDe.serialize(row,oi);
  assertEquals("Serialized data",p.toString(),String.valueOf(serializedPut.getPut()));
}
