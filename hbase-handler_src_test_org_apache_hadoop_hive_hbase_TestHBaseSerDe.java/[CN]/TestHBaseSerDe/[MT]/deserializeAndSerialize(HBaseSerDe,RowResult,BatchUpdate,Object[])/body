{
  StructObjectInspector oi=(StructObjectInspector)serDe.getObjectInspector();
  List<? extends StructField> fieldRefs=oi.getAllStructFieldRefs();
  assertEquals(7,fieldRefs.size());
  Object row=serDe.deserialize(rr);
  for (int i=0; i < fieldRefs.size(); i++) {
    Object fieldData=oi.getStructFieldData(row,fieldRefs.get(i));
    if (fieldData != null) {
      fieldData=((LazyPrimitive)fieldData).getWritableObject();
    }
    assertEquals("Field " + i,expectedFieldsData[i],fieldData);
  }
  assertEquals(BatchUpdate.class,serDe.getSerializedClass());
  BatchUpdate serializedBU=(BatchUpdate)serDe.serialize(row,oi);
  assertEquals("Serialized data",bu.toString(),serializedBU.toString());
}
