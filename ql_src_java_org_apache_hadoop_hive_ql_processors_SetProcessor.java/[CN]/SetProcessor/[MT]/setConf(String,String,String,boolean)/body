{
  HiveConf conf=SessionState.get().getConf();
  String value=new VariableSubstitution().substitute(conf,varvalue);
  if (conf.getBoolVar(HiveConf.ConfVars.HIVECONFVALIDATION)) {
    HiveConf.ConfVars confVars=HiveConf.getConfVars(key);
    if (confVars != null && !confVars.isType(value)) {
      StringBuilder message=new StringBuilder();
      message.append("'SET ").append(varname).append('=').append(varvalue);
      message.append("' FAILED because ");
      message.append(key).append(" expects an ");
      message.append(confVars.typeString()).append(" value.");
      return message.toString();
    }
  }
  conf.set(key,value);
  if (register) {
    SessionState.get().getOverriddenConfigurations().put(key,value);
  }
  return null;
}
