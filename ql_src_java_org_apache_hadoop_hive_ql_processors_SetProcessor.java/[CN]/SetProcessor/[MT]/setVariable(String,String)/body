{
  SessionState ss=SessionState.get();
  if (varvalue.contains("\n")) {
    ss.err.println("Warning: Value had a \\n character in it.");
  }
  if (varname.startsWith(SetProcessor.ENV_PREFIX)) {
    ss.err.println("env:* variables can not be set.");
    return new CommandProcessorResponse(1);
  }
 else   if (varname.startsWith(SetProcessor.SYSTEM_PREFIX)) {
    String propName=varname.substring(SetProcessor.SYSTEM_PREFIX.length());
    System.getProperties().setProperty(propName,new VariableSubstitution().substitute(ss.getConf(),varvalue));
    return new CommandProcessorResponse(0);
  }
 else   if (varname.startsWith(SetProcessor.HIVECONF_PREFIX)) {
    String propName=varname.substring(SetProcessor.HIVECONF_PREFIX.length());
    String error=setConf(varname,propName,varvalue,false);
    return new CommandProcessorResponse(error == null ? 0 : 1,error,null);
  }
 else   if (varname.startsWith(SetProcessor.HIVEVAR_PREFIX)) {
    String propName=varname.substring(SetProcessor.HIVEVAR_PREFIX.length());
    ss.getHiveVariables().put(propName,new VariableSubstitution().substitute(ss.getConf(),varvalue));
    return new CommandProcessorResponse(0);
  }
 else {
    String error=setConf(varname,varname,varvalue,true);
    return new CommandProcessorResponse(error == null ? 0 : 1,error,null);
  }
}
