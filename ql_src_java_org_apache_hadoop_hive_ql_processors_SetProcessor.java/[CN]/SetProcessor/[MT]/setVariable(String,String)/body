{
  SessionState ss=SessionState.get();
  if (varvalue.contains("\n")) {
    ss.err.println("Warning: Value had a \\n character in it.");
  }
  if (varname.startsWith(ENV_PREFIX)) {
    ss.err.println("env:* variables can not be set.");
    return new CommandProcessorResponse(1);
  }
 else   if (varname.startsWith(SYSTEM_PREFIX)) {
    String propName=varname.substring(SYSTEM_PREFIX.length());
    System.getProperties().setProperty(propName,new VariableSubstitution().substitute(ss.getConf(),varvalue));
    return new CommandProcessorResponse(0);
  }
 else   if (varname.startsWith(HIVECONF_PREFIX)) {
    String propName=varname.substring(HIVECONF_PREFIX.length());
    try {
      setConf(varname,propName,varvalue,false);
      return new CommandProcessorResponse(0);
    }
 catch (    IllegalArgumentException e) {
      return new CommandProcessorResponse(1,e.getMessage(),"42000");
    }
  }
 else   if (varname.startsWith(HIVEVAR_PREFIX)) {
    String propName=varname.substring(HIVEVAR_PREFIX.length());
    ss.getHiveVariables().put(propName,new VariableSubstitution().substitute(ss.getConf(),varvalue));
    return new CommandProcessorResponse(0);
  }
 else {
    try {
      setConf(varname,varname,varvalue,true);
      return new CommandProcessorResponse(0);
    }
 catch (    IllegalArgumentException e) {
      return new CommandProcessorResponse(1,e.getMessage(),"42000");
    }
  }
}
