{
  if (!LlapProxy.isDaemon()) {
    throw new IOException("LlapOutputFormat can only be used inside Llap");
  }
  try {
    return LlapOutputFormatService.get().<K,V>getWriter(job.get(LLAP_OF_ID_KEY));
  }
 catch (  InterruptedException e) {
    throw new IOException(e);
  }
}
