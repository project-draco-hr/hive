{
  if (bndSpec instanceof ValueBoundarySpec) {
    ValueBoundarySpec vBndSpec=(ValueBoundarySpec)bndSpec;
    ValueBoundaryDef vbDef=new ValueBoundaryDef(vBndSpec.getDirection(),vBndSpec.getAmt());
    PTFTranslator.validateNoLeadLagInValueBoundarySpec(vBndSpec.getExpression());
    PTFExpressionDef exprDef=null;
    try {
      exprDef=buildExpressionDef(inpShape,vBndSpec.getExpression());
    }
 catch (    HiveException he) {
      throw new SemanticException(he);
    }
    PTFTranslator.validateValueBoundaryExprType(exprDef.getOI());
    vbDef.setExpressionDef(exprDef);
    return vbDef;
  }
 else   if (bndSpec instanceof RangeBoundarySpec) {
    RangeBoundarySpec rBndSpec=(RangeBoundarySpec)bndSpec;
    return new RangeBoundaryDef(rBndSpec.getDirection(),rBndSpec.getAmt());
  }
 else   if (bndSpec instanceof CurrentRowSpec) {
    CurrentRowDef cbDef=new CurrentRowDef();
    return cbDef;
  }
  throw new SemanticException("Unknown Boundary: " + bndSpec);
}
