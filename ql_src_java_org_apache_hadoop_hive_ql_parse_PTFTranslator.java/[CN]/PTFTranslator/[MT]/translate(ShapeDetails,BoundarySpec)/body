{
  if (bndSpec instanceof ValueBoundarySpec) {
    ValueBoundarySpec vBndSpec=(ValueBoundarySpec)bndSpec;
    ValueBoundaryDef vbDef=new ValueBoundaryDef(vBndSpec.getDirection(),vBndSpec.getAmt());
    for (    OrderExpression oe : vBndSpec.getOrderExpressions()) {
      PTFTranslator.validateNoLeadLagInValueBoundarySpec(oe.getExpression());
      PTFExpressionDef exprDef=null;
      try {
        exprDef=buildExpressionDef(inpShape,oe.getExpression());
      }
 catch (      HiveException he) {
        throw new SemanticException(he);
      }
      PTFTranslator.validateValueBoundaryExprType(exprDef.getOI());
      OrderExpressionDef orderExprDef=new OrderExpressionDef(exprDef);
      orderExprDef.setOrder(oe.getOrder());
      orderExprDef.setNullOrder(oe.getNullOrder());
      vbDef.addOrderExpressionDef(orderExprDef);
    }
    return vbDef;
  }
 else   if (bndSpec instanceof RangeBoundarySpec) {
    RangeBoundarySpec rBndSpec=(RangeBoundarySpec)bndSpec;
    return new RangeBoundaryDef(rBndSpec.getDirection(),rBndSpec.getAmt());
  }
 else   if (bndSpec instanceof CurrentRowSpec) {
    CurrentRowDef cbDef=new CurrentRowDef();
    return cbDef;
  }
  throw new SemanticException("Unknown Boundary: " + bndSpec);
}
