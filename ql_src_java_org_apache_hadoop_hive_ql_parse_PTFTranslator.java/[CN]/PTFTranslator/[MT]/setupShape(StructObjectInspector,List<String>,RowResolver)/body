{
  Map<String,String> serdePropsMap=new LinkedHashMap<String,String>();
  SerDe serde=null;
  ShapeDetails shp=new ShapeDetails();
  try {
    serde=PTFTranslator.createLazyBinarySerDe(hCfg,OI,serdePropsMap);
    StructObjectInspector outOI=PTFPartition.setupPartitionOutputOI(serde,OI);
    shp.setOI(outOI);
  }
 catch (  SerDeException se) {
    throw new SemanticException(se);
  }
  shp.setRr(rr);
  shp.setSerde(serde);
  shp.setSerdeClassName(serde.getClass().getName());
  shp.setSerdeProps(serdePropsMap);
  shp.setColumnNames(columnNames);
  TypeCheckCtx tCtx=new TypeCheckCtx(rr);
  tCtx.setUnparseTranslator(unparseT);
  shp.setTypeCheckCtx(tCtx);
  return shp;
}
