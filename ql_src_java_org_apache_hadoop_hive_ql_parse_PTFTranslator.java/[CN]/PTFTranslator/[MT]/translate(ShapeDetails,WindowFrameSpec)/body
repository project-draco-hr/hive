{
  if (spec == null) {
    return null;
  }
  BoundarySpec s=spec.getStart();
  BoundarySpec e=spec.getEnd();
  int cmp=s.compareTo(e);
  if (cmp > 0) {
    throw new SemanticException(String.format("Window range invalid, start boundary is greater than end boundary: %s",spec));
  }
  return new WindowFrameDef(translate(inpShape,s),translate(inpShape,e));
}
