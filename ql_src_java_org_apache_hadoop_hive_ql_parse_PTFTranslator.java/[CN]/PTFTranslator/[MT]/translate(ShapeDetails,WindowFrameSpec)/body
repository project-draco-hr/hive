{
  if (spec == null) {
    return null;
  }
  BoundarySpec s=spec.getStart();
  BoundarySpec e=spec.getEnd();
  int cmp=s.compareTo(e);
  if (cmp > 0) {
    throw new SemanticException(String.format("Window range invalid, start boundary is greater than end boundary: %s",spec));
  }
  WindowFrameDef wfDef=new WindowFrameDef();
  wfDef.setStart(translate(inpShape,s));
  wfDef.setEnd(translate(inpShape,e));
  return wfDef;
}
