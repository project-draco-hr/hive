{
  if (--usageCount == 0) {
    try {
      cluster.stop();
      cluster=null;
    }
  finally {
      System.out.println("Trying to cleanup: " + testDir);
      try {
        FileSystem fs=FileSystem.get(jobConf);
        fs.delete(new Path(testDir),true);
      }
 catch (      IOException e) {
        throw new IllegalStateException("Failed to cleanup test dir",e);
      }
    }
  }
}
