{
  BaseWork parent=nodes.get(0);
  BaseWork children[]={nodes.get(1),nodes.get(2)};
  TezEdgeProperty edgeProp=new TezEdgeProperty(EdgeType.SIMPLE_EDGE);
  work.connect(parent,children[0],edgeProp);
  work.connect(parent,children[1],edgeProp);
  work.remove(parent);
  Assert.assertEquals(work.getParents(children[0]).size(),0);
  Assert.assertEquals(work.getParents(children[1]).size(),0);
  Assert.assertEquals(work.getAllWork().size(),nodes.size() - 1);
  Assert.assertEquals(work.getRoots().size(),nodes.size() - 1);
  Assert.assertEquals(work.getLeaves().size(),nodes.size() - 1);
}
