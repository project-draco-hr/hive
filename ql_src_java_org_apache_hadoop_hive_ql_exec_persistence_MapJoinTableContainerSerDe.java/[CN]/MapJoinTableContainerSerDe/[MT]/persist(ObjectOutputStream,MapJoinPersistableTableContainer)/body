{
  int numKeys=tableContainer.size();
  try {
    out.writeUTF(tableContainer.getClass().getName());
    out.writeObject(tableContainer.getMetaData());
    out.writeInt(numKeys);
    for (    Map.Entry<MapJoinKey,MapJoinRowContainer> entry : tableContainer.entrySet()) {
      entry.getKey().write(keyContext,out);
      entry.getValue().write(valueContext,out);
    }
  }
 catch (  SerDeException e) {
    String msg="SerDe error while attempting to persist table container";
    throw new HiveException(msg,e);
  }
catch (  IOException e) {
    String msg="IO error while attempting to persist table container";
    throw new HiveException(msg,e);
  }
  if (numKeys != tableContainer.size()) {
    throw new ConcurrentModificationException("TableContainer was modified while persisting: " + tableContainer);
  }
}
