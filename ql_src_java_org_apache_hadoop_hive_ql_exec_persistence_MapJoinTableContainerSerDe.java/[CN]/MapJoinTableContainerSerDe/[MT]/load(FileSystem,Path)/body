{
  try {
    if (!fs.isDirectory(folder)) {
      throw new HiveException("Error, not a directory: " + folder);
    }
    FileStatus[] fileStatuses=fs.listStatus(folder);
    if (fileStatuses == null || fileStatuses.length == 0) {
      return null;
    }
    SerDe keySerDe=keyContext.getSerDe();
    SerDe valueSerDe=valueContext.getSerDe();
    Writable keyContainer=keySerDe.getSerializedClass().newInstance();
    Writable valueContainer=valueSerDe.getSerializedClass().newInstance();
    MapJoinPersistableTableContainer tableContainer=null;
    for (    FileStatus fileStatus : fs.listStatus(folder)) {
      Path filePath=fileStatus.getPath();
      if (fileStatus.isDir()) {
        throw new HiveException("Error, not a file: " + filePath);
      }
      InputStream is=null;
      ObjectInputStream in=null;
      try {
        is=fs.open(filePath,4096);
        in=new ObjectInputStream(is);
        String name=in.readUTF();
        Map<String,String> metaData=(Map<String,String>)in.readObject();
        if (tableContainer == null) {
          tableContainer=create(name,metaData);
        }
        int numKeys=in.readInt();
        for (int keyIndex=0; keyIndex < numKeys; keyIndex++) {
          MapJoinKeyObject key=new MapJoinKeyObject();
          key.read(keyContext,in,keyContainer);
          MapJoinEagerRowContainer values=new MapJoinEagerRowContainer();
          values.read(valueContext,in,valueContainer);
          tableContainer.put(key,values);
        }
      }
  finally {
        if (in != null) {
          in.close();
        }
 else         if (is != null) {
          is.close();
        }
      }
    }
    return tableContainer;
  }
 catch (  IOException e) {
    throw new HiveException("IO error while trying to create table container",e);
  }
catch (  Exception e) {
    throw new HiveException("Error while trying to create table container",e);
  }
}
