{
  final Class<? extends InputFormat> destInputFormat;
  try {
    if (ts.getPartSpec() == null || ts.getPartSpec().isEmpty()) {
      destInputFormat=ts.tableHandle.getInputFormatClass();
    }
 else {
      destInputFormat=ts.partHandle.getInputFormatClass();
    }
  }
 catch (  HiveException e) {
    throw new SemanticException(e);
  }
  try {
    FileSystem fs=FileSystem.get(fromURI,conf);
    boolean validFormat=HiveFileFormatUtils.checkInputFormat(fs,conf,destInputFormat,fileStatuses);
    if (!validFormat) {
      throw new SemanticException(ErrorMsg.INVALID_FILE_FORMAT_IN_LOAD.getMsg());
    }
  }
 catch (  Exception e) {
    throw new SemanticException("Unable to load data to destination table." + " Error: " + e.getMessage());
  }
}
