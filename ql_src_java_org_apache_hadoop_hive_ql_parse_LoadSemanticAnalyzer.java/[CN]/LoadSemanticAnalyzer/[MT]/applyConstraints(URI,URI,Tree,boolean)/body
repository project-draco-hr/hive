{
  if (!fromURI.getScheme().equals("file") && !fromURI.getScheme().equals("hdfs")) {
    throw new SemanticException(ErrorMsg.INVALID_PATH.getMsg(ast,"only \"file\" or \"hdfs\" file systems accepted"));
  }
  if (isLocal && !fromURI.getScheme().equals("file")) {
    throw new SemanticException(ErrorMsg.ILLEGAL_PATH.getMsg(ast,"Source file system should be \"file\" if \"local\" is specified"));
  }
  try {
    FileStatus[] srcs=matchFilesOrDir(FileSystem.get(fromURI,conf),new Path(fromURI.getScheme(),fromURI.getAuthority(),fromURI.getPath()));
    if (srcs == null || srcs.length == 0) {
      throw new SemanticException(ErrorMsg.INVALID_PATH.getMsg(ast,"No files matching path " + fromURI));
    }
    for (    FileStatus oneSrc : srcs) {
      if (oneSrc.isDir()) {
        throw new SemanticException(ErrorMsg.INVALID_PATH.getMsg(ast,"source contains directory: " + oneSrc.getPath().toString()));
      }
    }
  }
 catch (  IOException e) {
    throw new SemanticException(ErrorMsg.INVALID_PATH.getMsg(ast),e);
  }
  if (!isLocal && (!StringUtils.equals(fromURI.getScheme(),toURI.getScheme()) || !StringUtils.equals(fromURI.getAuthority(),toURI.getAuthority()))) {
    String reason="Move from: " + fromURI.toString() + " to: "+ toURI.toString()+ " is not valid. "+ "Please check that values for params \"default.fs.name\" and "+ "\"hive.metastore.warehouse.dir\" do not conflict.";
    throw new SemanticException(ErrorMsg.ILLEGAL_PATH.getMsg(ast,reason));
  }
}
