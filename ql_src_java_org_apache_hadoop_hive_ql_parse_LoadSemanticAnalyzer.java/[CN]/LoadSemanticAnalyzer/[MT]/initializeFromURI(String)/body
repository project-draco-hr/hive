{
  URI fromURI=new Path(fromPath).toUri();
  String fromScheme=fromURI.getScheme();
  String fromAuthority=fromURI.getAuthority();
  String path=fromURI.getPath();
  if (!path.startsWith("/")) {
    if (isLocal) {
      path=new Path(System.getProperty("user.dir"),path).toString();
    }
 else {
      path=new Path(new Path("/user/" + System.getProperty("user.name")),path).toString();
    }
  }
  if (StringUtils.isEmpty(fromScheme)) {
    if (isLocal) {
      fromScheme="file";
    }
 else {
      URI defaultURI=FileSystem.get(conf).getUri();
      fromScheme=defaultURI.getScheme();
      fromAuthority=defaultURI.getAuthority();
    }
  }
  if ((!fromScheme.equals("file")) && StringUtils.isEmpty(fromAuthority)) {
    URI defaultURI=FileSystem.get(conf).getUri();
    fromAuthority=defaultURI.getAuthority();
  }
  LOG.debug(fromScheme + "@" + fromAuthority+ "@"+ path);
  return new URI(fromScheme,fromAuthority,path,null,null);
}
