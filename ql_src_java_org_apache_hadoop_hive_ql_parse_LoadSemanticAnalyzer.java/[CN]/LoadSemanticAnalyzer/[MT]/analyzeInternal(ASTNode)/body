{
  isLocal=isOverWrite=false;
  Tree from_t=ast.getChild(0);
  Tree table_t=ast.getChild(1);
  if (ast.getChildCount() == 4) {
    isOverWrite=isLocal=true;
  }
  if (ast.getChildCount() == 3) {
    if (ast.getChild(2).getText().toLowerCase().equals("local")) {
      isLocal=true;
    }
 else {
      isOverWrite=true;
    }
  }
  URI fromURI;
  try {
    String fromPath=stripQuotes(from_t.getText());
    fromURI=initializeFromURI(fromPath);
  }
 catch (  IOException e) {
    throw new SemanticException(ErrorMsg.INVALID_PATH.getMsg(from_t,e.getMessage()),e);
  }
catch (  URISyntaxException e) {
    throw new SemanticException(ErrorMsg.INVALID_PATH.getMsg(from_t,e.getMessage()),e);
  }
  tableSpec ts=new tableSpec(db,conf,(ASTNode)table_t);
  URI toURI=(ts.partHandle != null) ? ts.partHandle.getDataLocation() : ts.tableHandle.getDataLocation();
  List<FieldSchema> parts=ts.tableHandle.getTTable().getPartitionKeys();
  if (isOverWrite && (parts != null && parts.size() > 0) && (ts.partSpec == null || ts.partSpec.size() == 0)) {
    throw new SemanticException(ErrorMsg.NEED_PARTITION_ERROR.getMsg());
  }
  applyConstraints(fromURI,toURI,from_t,isLocal);
  Task<? extends Serializable> rTask=null;
  if (isLocal) {
    String copyURIStr=ctx.getExternalTmpFileURI(toURI);
    URI copyURI=URI.create(copyURIStr);
    rTask=TaskFactory.get(new copyWork(fromURI.toString(),copyURIStr),this.conf);
    fromURI=copyURI;
  }
  String loadTmpPath=ctx.getExternalTmpFileURI(toURI);
  loadTableDesc loadTableWork=new loadTableDesc(fromURI.toString(),loadTmpPath,Utilities.getTableDesc(ts.tableHandle),(ts.partSpec != null) ? ts.partSpec : new HashMap<String,String>(),isOverWrite);
  if (rTask != null) {
    rTask.addDependentTask(TaskFactory.get(new moveWork(getInputs(),getOutputs(),loadTableWork,null,true),this.conf));
  }
 else {
    rTask=TaskFactory.get(new moveWork(getInputs(),getOutputs(),loadTableWork,null,true),this.conf);
  }
  rootTasks.add(rTask);
}
