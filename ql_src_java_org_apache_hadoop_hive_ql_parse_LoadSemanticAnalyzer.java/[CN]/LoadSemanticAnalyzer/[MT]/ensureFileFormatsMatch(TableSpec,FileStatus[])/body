{
  final Class<? extends InputFormat> destInputFormat;
  try {
    if (ts.getPartSpec() == null || ts.getPartSpec().isEmpty()) {
      destInputFormat=ts.tableHandle.getInputFormatClass();
    }
 else {
      destInputFormat=ts.partHandle.getInputFormatClass();
    }
  }
 catch (  HiveException e) {
    throw new SemanticException(e);
  }
  if (OrcInputFormat.class.equals(destInputFormat)) {
    for (    FileStatus fileStatus : fileStatuses) {
      try {
        Path filePath=fileStatus.getPath();
        FileSystem fs=FileSystem.get(filePath.toUri(),conf);
        OrcFile.createReader(fs,filePath);
      }
 catch (      FileFormatException e) {
        throw new SemanticException(ErrorMsg.INVALID_FILE_FORMAT_IN_LOAD.getMsg("Destination" + " table is stored as ORC but the file being loaded is not a valid ORC file."));
      }
catch (      IOException e) {
        throw new SemanticException("Unable to load data to destination table." + " Error: " + e.getMessage());
      }
    }
  }
}
