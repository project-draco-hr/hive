{
  driver.run("drop table if exists employee");
  String createTable="CREATE TABLE employee (emp_id INT, emp_name STRING, emp_start_date STRING , emp_gender STRING ) " + " PARTITIONED BY (emp_country STRING , emp_state STRING ) STORED AS RCFILE";
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  MiniCluster.deleteFile(cluster,fullFileName);
  String[] inputData={};
  MiniCluster.createInputFile(cluster,fullFileName,inputData);
  PigServer pig=new PigServer(ExecType.LOCAL,props);
  UDFContext.getUDFContext().setClientSystemProps();
  pig.setBatchOn();
  pig.registerQuery("A = LOAD '" + fullFileName + "' USING PigStorage() AS (emp_id:int,emp_name:chararray,emp_start_date:chararray,"+ "emp_gender:chararray,emp_country:chararray,emp_state:chararray);");
  pig.registerQuery("IN = FILTER A BY emp_country == 'IN';");
  pig.registerQuery("STORE IN INTO 'employee' USING " + HCatStorer.class.getName() + "();");
  pig.executeBatch();
  driver.run("select * from employee");
  ArrayList<String> results=new ArrayList<String>();
  driver.getResults(results);
  assertEquals(0,results.size());
  MiniCluster.deleteFile(cluster,fullFileName);
  driver.run("drop table employee");
}
