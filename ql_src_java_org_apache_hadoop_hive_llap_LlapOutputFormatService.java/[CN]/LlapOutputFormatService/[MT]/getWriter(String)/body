{
  RecordWriter writer=null;
synchronized (service) {
    while ((writer=writers.get(id)) == null) {
      LOG.info("Waiting for writer for: " + id);
      service.wait();
    }
  }
  LOG.info("Returning writer for: " + id);
  return writer;
}
