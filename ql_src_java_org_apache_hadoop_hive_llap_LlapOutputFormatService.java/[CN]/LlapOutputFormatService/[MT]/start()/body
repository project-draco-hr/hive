{
  LOG.info("Starting LlapOutputFormatService");
  int portFromConf=conf.getIntVar(HiveConf.ConfVars.LLAP_DAEMON_OUTPUT_SERVICE_PORT);
  eventLoopGroup=new NioEventLoopGroup(1);
  serverBootstrap=new ServerBootstrap();
  serverBootstrap.group(eventLoopGroup);
  serverBootstrap.channel(NioServerSocketChannel.class);
  serverBootstrap.childHandler(new LlapOutputFormatServiceChannelHandler());
  try {
    listeningChannelFuture=serverBootstrap.bind(portFromConf).sync();
    this.port=((InetSocketAddress)listeningChannelFuture.channel().localAddress()).getPort();
    LOG.info("LlapOutputFormatService: Binding to port " + this.port);
  }
 catch (  InterruptedException err) {
    throw new IOException("LlapOutputFormatService: Error binding to port " + portFromConf,err);
  }
}
