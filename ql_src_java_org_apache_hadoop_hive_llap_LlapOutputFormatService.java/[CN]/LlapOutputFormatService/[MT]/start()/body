{
  LOG.info("Starting LlapOutputFormatService");
  int portFromConf=HiveConf.getIntVar(conf,HiveConf.ConfVars.LLAP_DAEMON_OUTPUT_SERVICE_PORT);
  int sendBufferSize=HiveConf.getIntVar(conf,HiveConf.ConfVars.LLAP_DAEMON_OUTPUT_SERVICE_SEND_BUFFER_SIZE);
  eventLoopGroup=new NioEventLoopGroup(1);
  serverBootstrap=new ServerBootstrap();
  serverBootstrap.group(eventLoopGroup);
  serverBootstrap.channel(NioServerSocketChannel.class);
  serverBootstrap.childHandler(new LlapOutputFormatServiceChannelHandler(sendBufferSize));
  try {
    listeningChannelFuture=serverBootstrap.bind(portFromConf).sync();
    this.port=((InetSocketAddress)listeningChannelFuture.channel().localAddress()).getPort();
    LOG.info("LlapOutputFormatService: Binding to port: {} with send buffer size: {} ",this.port,sendBufferSize);
  }
 catch (  InterruptedException err) {
    throw new IOException("LlapOutputFormatService: Error binding to port " + portFromConf,err);
  }
}
