{
synchronized (service) {
    LOG.debug("registering socket for: " + id);
    int bufSize=128 * 1024;
    OutputStream stream=new ChannelOutputStream(ctx,id,bufSize);
    LlapRecordWriter writer=new LlapRecordWriter(stream);
    writers.put(id,writer);
    ctx.channel().closeFuture().addListener(new LlapOutputFormatChannelCloseListener(id));
    service.notifyAll();
  }
}
