{
synchronized (INSTANCE) {
    LOG.debug("registering socket for: " + id);
    OutputStream stream=new ChannelOutputStream(ctx,id,sendBufferSize);
    LlapRecordWriter writer=new LlapRecordWriter(stream);
    writers.put(id,writer);
    ctx.channel().closeFuture().addListener(new LlapOutputFormatChannelCloseListener(id));
    INSTANCE.notifyAll();
  }
}
