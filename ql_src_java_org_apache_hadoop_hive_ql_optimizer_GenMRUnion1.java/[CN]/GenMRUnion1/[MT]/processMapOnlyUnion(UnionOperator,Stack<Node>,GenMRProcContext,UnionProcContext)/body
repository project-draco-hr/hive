{
  HashMap<Operator<? extends Serializable>,Task<? extends Serializable>> opTaskMap=ctx.getOpTaskMap();
  if (opTaskMap != null && opTaskMap.size() > 0) {
    Task<? extends Serializable> tsk=opTaskMap.get(null);
    if (tsk != null) {
      ctx.setCurrTask(tsk);
    }
  }
  UnionParseContext uPrsCtx=uCtx.getUnionParseContext(union);
  if ((uPrsCtx != null) && (uPrsCtx.getMapJoinQuery())) {
    GenMapRedUtils.mergeMapJoinUnion(union,ctx,UnionProcFactory.getPositionParent(union,stack));
  }
 else {
    ctx.getMapCurrCtx().put((Operator<? extends Serializable>)union,new GenMapRedCtx(ctx.getCurrTask(),ctx.getCurrTopOp(),ctx.getCurrAliasId()));
  }
  return null;
}
