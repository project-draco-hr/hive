{
  if (split instanceof FileSplit) {
    FileSplit fsplit=(FileSplit)split;
    long hash=generateHash(fsplit.getPath().toString(),fsplit.getStart());
    int indexRaw=(int)(hash % knownLocations.length);
    int index=Math.abs(indexRaw);
    if (isDebugEnabled) {
      LOG.debug("Split at " + fsplit.getPath() + " with offset= "+ fsplit.getStart()+ ", length="+ fsplit.getLength()+ " mapped to index="+ index+ ", location="+ knownLocations[index]);
    }
    return new String[]{knownLocations[index]};
  }
 else {
    if (isDebugEnabled) {
      LOG.debug("Split: " + split + " is not a FileSplit. Using default locations");
    }
    return split.getLocations();
  }
}
