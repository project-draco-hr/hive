{
  VectorUDFDateAddColScalar udf;
  if (isPositive) {
    udf=new VectorUDFDateAddColScalar(0,scalar2,1);
  }
 else {
    udf=new VectorUDFDateSubColScalar(0,scalar2,1);
  }
  udf.setInputTypes(colType1,VectorExpression.Type.OTHER);
  udf.evaluate(batch);
  BytesColumnVector output=(BytesColumnVector)batch.cols[1];
  try {
    for (int i=0; i < size; i++) {
      String expected;
      if (isPositive) {
        expected=new String(toString(date1.vector[i] + scalar2),"UTF-8");
      }
 else {
        expected=new String(toString(date1.vector[i] - scalar2),"UTF-8");
      }
      if (date1.isNull[i]) {
        Assert.assertTrue(output.isNull[i]);
      }
 else {
        String actual=new String(output.vector[i],output.start[i],output.start[i] + output.length[i],"UTF-8");
        Assert.assertEquals("expectedLen:" + expected.length() + " actualLen:"+ actual.length(),expected,actual);
      }
    }
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
