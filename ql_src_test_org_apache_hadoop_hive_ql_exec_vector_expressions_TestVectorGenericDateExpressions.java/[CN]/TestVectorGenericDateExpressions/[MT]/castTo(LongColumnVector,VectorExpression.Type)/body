{
switch (type) {
case DATE:
    return date;
case TIMESTAMP:
  return toTimestamp(date);
case STRING:
case CHAR:
case VARCHAR:
return toString(date);
default :
throw new Error("Unsupported input type " + type.name());
}
}
