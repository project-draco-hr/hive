{
  this.tblProps.put(org.apache.hadoop.hive.metastore.api.hive_metastoreConstants.META_TABLE_STORAGE,storageHandler);
  LOG.warn("HiveStorageHandlers can't be reliably instantiated on the client-side. " + "Attempting to derive Input/OutputFormat settings from StorageHandler, on best effort: ");
  try {
    HiveStorageHandler sh=HiveUtils.getStorageHandler(getConf(),storageHandler);
    this.sd.setInputFormat(sh.getInputFormatClass().getName());
    this.sd.setOutputFormat(sh.getOutputFormatClass().getName());
    this.sd.getSerdeInfo().setSerializationLib(sh.getSerDeClass().getName());
  }
 catch (  HiveException e) {
    LOG.warn("Could not derive Input/OutputFormat and SerDe settings from storageHandler. " + "These values need to be set explicitly.",e);
  }
  return this;
}
