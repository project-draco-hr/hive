{
  if (dynamicPartitioningUsed) {
    for (    RecordWriter<? super WritableComparable<?>,? super Writable> bwriter : baseDynamicWriters.values()) {
      bwriter.close(context);
    }
    for (    Map.Entry<Integer,OutputCommitter> entry : baseDynamicCommitters.entrySet()) {
      OutputCommitter baseOutputCommitter=entry.getValue();
      if (baseOutputCommitter.needsTaskCommit(context)) {
        baseOutputCommitter.commitTask(context);
      }
    }
  }
 else {
    getBaseRecordWriter().close(context);
  }
}
