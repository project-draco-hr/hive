{
  HiveConf metastoreConf=new HiveConf();
  metastoreConf.setClass(HiveConf.ConfVars.METASTORE_EXPRESSION_PROXY_CLASS.varname,MockPartitionExpressionForMetastore.class,PartitionExpressionProxy.class);
  msPort=MetaStoreUtils.startMetaStore(metastoreConf);
  securityManager=System.getSecurityManager();
  System.setSecurityManager(new NoExitSecurityManager());
  hiveConf=new HiveConf(TestHiveMetaStorePartitionSpecs.class);
  hiveConf.setVar(HiveConf.ConfVars.METASTOREURIS,"thrift://localhost:" + msPort);
  hiveConf.setIntVar(HiveConf.ConfVars.METASTORETHRIFTCONNECTIONRETRIES,3);
  hiveConf.set(HiveConf.ConfVars.PREEXECHOOKS.varname,"");
  hiveConf.set(HiveConf.ConfVars.POSTEXECHOOKS.varname,"");
  hiveConf.set(HiveConf.ConfVars.HIVE_SUPPORT_CONCURRENCY.varname,"false");
  hiveConf.set(HiveConf.ConfVars.METASTORE_EXPRESSION_PROXY_CLASS.name(),MockPartitionExpressionForMetastore.class.getCanonicalName());
  System.setProperty(HiveConf.ConfVars.PREEXECHOOKS.varname," ");
  System.setProperty(HiveConf.ConfVars.POSTEXECHOOKS.varname," ");
}
