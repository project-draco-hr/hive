{
  String testScript[]={"-- this is a comment","DROP TABLE IF EXISTS fooTab;","DELIMITER $$","/*!1234 this is comment code like mysql */$$","CREATE TABLE fooTab(id INTEGER)$$","DELIMITER ;","/* multiline comment started "," * multiline comment continue"," * multiline comment ended */","DROP TABLE footab;","-- ending comment"};
  String parsedScript[]={"DROP TABLE IF EXISTS fooTab","/*!1234 this is comment code like mysql */","CREATE TABLE fooTab(id INTEGER)","DROP TABLE footab"};
  String expectedSQL=StringUtils.join(parsedScript,System.getProperty("line.separator")) + System.getProperty("line.separator");
  File testScriptFile=generateTestScript(testScript);
  NestedScriptParser testDbParser=HiveSchemaHelper.getDbCommandParser("mysql");
  String flattenedSql=HiveSchemaTool.buildCommand(testDbParser,testScriptFile.getParentFile().getPath(),testScriptFile.getName());
  assertEquals(expectedSQL,flattenedSql);
}
