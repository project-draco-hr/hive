{
  BaseSemanticAnalyzer analyzer=getAnalyzer(conf,tree);
  HiveOperation operation;
  if (tree.getType() == HiveParser.TOK_ALTERTABLE_PARTITION) {
    Integer type=tree.getChild(1).getType();
    if (tree.getChild(0).getChildCount() > 1) {
      operation=tablePartitionCommandType.get(type)[1];
    }
 else {
      operation=tablePartitionCommandType.get(type)[0];
    }
  }
 else {
    operation=commandType.get(tree.getType());
  }
  analyzer.setHiveOperation(operation);
  if (SessionState.get() != null) {
    SessionState.get().setCommandType(operation);
  }
  return analyzer;
}
