{
  if (tree.getToken() == null) {
    throw new RuntimeException("Empty Syntax Tree");
  }
 else {
switch (tree.getToken().getType()) {
case HiveParser.TOK_EXPLAIN:
      return new ExplainSemanticAnalyzer(conf);
case HiveParser.TOK_LOAD:
    return new LoadSemanticAnalyzer(conf);
case HiveParser.TOK_CREATETABLE:
case HiveParser.TOK_DROPTABLE:
case HiveParser.TOK_DESCTABLE:
case HiveParser.TOK_DESCFUNCTION:
case HiveParser.TOK_MSCK:
case HiveParser.TOK_ALTERTABLE_ADDCOLS:
case HiveParser.TOK_ALTERTABLE_REPLACECOLS:
case HiveParser.TOK_ALTERTABLE_RENAME:
case HiveParser.TOK_ALTERTABLE_DROPPARTS:
case HiveParser.TOK_ALTERTABLE_ADDPARTS:
case HiveParser.TOK_ALTERTABLE_PROPERTIES:
case HiveParser.TOK_ALTERTABLE_SERIALIZER:
case HiveParser.TOK_ALTERTABLE_SERDEPROPERTIES:
case HiveParser.TOK_SHOWTABLES:
case HiveParser.TOK_SHOWFUNCTIONS:
case HiveParser.TOK_SHOWPARTITIONS:
  return new DDLSemanticAnalyzer(conf);
case HiveParser.TOK_CREATEFUNCTION:
case HiveParser.TOK_DROPFUNCTION:
return new FunctionSemanticAnalyzer(conf);
default :
return new SemanticAnalyzer(conf);
}
}
}
