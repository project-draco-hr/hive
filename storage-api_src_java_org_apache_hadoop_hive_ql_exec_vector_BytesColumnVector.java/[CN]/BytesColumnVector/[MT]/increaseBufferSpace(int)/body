{
  int newLength=2 * buffer.length;
  while ((nextFree + nextElemLength) > newLength) {
    newLength*=2;
  }
  byte[] newBuffer=new byte[newLength];
  System.arraycopy(buffer,0,newBuffer,0,nextFree);
  buffer=newBuffer;
}
