{
  populateDataFile();
{
    PigServer server=new PigServer(ExecType.LOCAL,props);
    UDFContext.getUDFContext().setClientSystemProps();
    server.setBatchOn();
    server.registerQuery("A = load '" + fqdataLocation + "' using PigStorage(',') as (emp_id:int, emp_name:chararray, emp_dob:chararray, emp_sex:chararray);");
    server.registerQuery("store A into '" + NONPART_TABLE + "' using org.apache.hcatalog.pig.HCatEximStorer('"+ fqexportLocation+ "');");
    server.executeBatch();
  }
{
    PigServer server=new PigServer(ExecType.LOCAL,props);
    UDFContext.getUDFContext().setClientSystemProps();
    server.registerQuery("A = load '" + fqexportLocation + "' using org.apache.hcatalog.pig.HCatEximLoader();");
    Iterator<Tuple> XIter=server.openIterator("A");
    assertTrue(XIter.hasNext());
    Tuple t=XIter.next();
    assertEmpDetail(t,237,"Krishna","01/01/1990","M");
    assertTrue(XIter.hasNext());
    t=XIter.next();
    assertEmpDetail(t,238,"Kalpana","01/01/2000","F");
    assertTrue(XIter.hasNext());
    t=XIter.next();
    assertEmpDetail(t,239,"Satya","01/01/2001","M");
    assertTrue(XIter.hasNext());
    t=XIter.next();
    assertEmpDetail(t,240,"Kavya","01/01/2002","F");
    assertFalse(XIter.hasNext());
  }
}
