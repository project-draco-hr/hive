{
  String decStr="1786135888657847525803324040144343378.09799306448796128931113691624";
  HiveDecimal dec=HiveDecimal.create(decStr);
  Assert.assertEquals("1786135888657847525803324040144343378.1",dec.toString());
  Assert.assertTrue("Decimal precision should not go above maximum",dec.precision() <= HiveDecimal.MAX_PRECISION);
  Assert.assertTrue("Decimal scale should not go above maximum",dec.scale() <= HiveDecimal.MAX_SCALE);
  decStr="57847525803324040144343378.09799306448796128931113691624";
  BigDecimal bd=new BigDecimal(decStr);
  BigDecimal bd1=HiveDecimal.enforcePrecisionScale(bd,20,5);
  Assert.assertNull(bd1);
  bd1=HiveDecimal.enforcePrecisionScale(bd,35,5);
  Assert.assertEquals("57847525803324040144343378.09799",bd1.toString());
  bd1=HiveDecimal.enforcePrecisionScale(bd,45,20);
  Assert.assertNull(bd1);
  dec=HiveDecimal.create(bd,false);
  Assert.assertNull(dec);
  dec=HiveDecimal.create("-1786135888657847525803324040144343378.09799306448796128931113691624");
  Assert.assertEquals("-1786135888657847525803324040144343378.1",dec.toString());
  dec=HiveDecimal.create("005.34000");
  Assert.assertEquals(dec.precision(),6);
  Assert.assertEquals(dec.scale(),5);
  dec=HiveDecimal.create("178613588865784752580332404014434337809799306448796128931113691624");
  Assert.assertNull(dec);
  Assert.assertEquals("0.0",HiveDecimal.enforcePrecisionScale(new BigDecimal("0.0"),2,1).toString());
  Assert.assertEquals("0.00",HiveDecimal.enforcePrecisionScale(new BigDecimal("0.00"),3,2).toString());
  Assert.assertEquals("0.0000",HiveDecimal.enforcePrecisionScale(new BigDecimal("0.0000"),10,4).toString());
  Assert.assertEquals("100.00000",HiveDecimal.enforcePrecisionScale(new BigDecimal("100.00000"),15,5).toString());
  Assert.assertEquals("100.00",HiveDecimal.enforcePrecisionScale(new BigDecimal("100.00"),15,5).toString());
  Assert.assertEquals("0.01",HiveDecimal.enforcePrecisionScale(new BigDecimal("0.012"),3,2).toString());
  Assert.assertEquals("0.02",HiveDecimal.enforcePrecisionScale(new BigDecimal("0.015"),3,2).toString());
  Assert.assertEquals("0.01",HiveDecimal.enforcePrecisionScale(new BigDecimal("0.0145"),3,2).toString());
  Assert.assertEquals("0",HiveDecimal.enforcePrecisionScale(new BigDecimal("0"),1,0).toString());
  Assert.assertEquals("30",HiveDecimal.enforcePrecisionScale(new BigDecimal("30"),2,0).toString());
  Assert.assertEquals("5",HiveDecimal.enforcePrecisionScale(new BigDecimal("5"),3,2).toString());
}
