{
  try {
    Path fullFilePath=FileSystems.getDefault().getPath(filePath);
    Path fileName=fullFilePath.getFileName();
    if (Files.exists(fileName)) {
      return Files.newBufferedReader(fileName,Charset.defaultCharset());
    }
 else     if (Files.exists(fullFilePath)) {
      return Files.newBufferedReader(fullFilePath,Charset.defaultCharset());
    }
 else {
      throw new HiveException("Could not find \"" + fileName + "\" or \""+ fullFilePath+ "\" in IN_FILE() UDF.");
    }
  }
 catch (  IOException exception) {
    throw new HiveException(exception);
  }
}
