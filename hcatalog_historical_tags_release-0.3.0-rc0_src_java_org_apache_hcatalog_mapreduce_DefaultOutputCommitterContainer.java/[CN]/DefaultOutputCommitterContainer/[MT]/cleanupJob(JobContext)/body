{
  getBaseOutputCommitter().cleanupJob(context);
  OutputJobInfo jobInfo=HCatOutputFormat.getJobInfo(context);
  try {
    HiveMetaStoreClient client=HCatOutputFormat.createHiveClient(jobInfo.getServerUri(),context.getConfiguration());
    String tokenStrForm=client.getTokenStrForm();
    if (tokenStrForm != null && context.getConfiguration().get(HCatConstants.HCAT_KEY_TOKEN_SIGNATURE) != null) {
      client.cancelDelegationToken(tokenStrForm);
    }
  }
 catch (  Exception e) {
    throw new IOException("Failed to cancel delegation token",e);
  }
}
