{
  try {
    client.execute("set hive.support.concurrency = false");
    client.execute("drop table " + tableName);
  }
 catch (  Exception ex) {
  }
  client.execute("create table " + tableName + " (key int, value string)");
  client.execute("load data local inpath '" + dataFilePath.toString() + "' into table "+ tableName);
  try {
    client.execute("select key, value from " + tableName);
    assertEquals(client.fetchAll().size(),500);
    assertEquals(client.fetchAll().size(),0);
    client.execute("select key, value from " + tableName);
    for (int i=0; i < 500; i++) {
      String str=client.fetchOne();
      if (str.equals("")) {
        assertTrue(false);
      }
    }
    assertEquals(client.fetchOne(),"");
    client.execute("select key, value from " + tableName);
    assertEquals(client.fetchN(499).size(),499);
    assertEquals(client.fetchN(499).size(),1);
    assertEquals(client.fetchN(499).size(),0);
  }
 catch (  Throwable e) {
    e.printStackTrace();
  }
}
