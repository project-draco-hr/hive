{
  try {
    client.execute("drop table " + tableName);
  }
 catch (  Exception ex) {
  }
  try {
    client.execute("create table " + tableName + " (num int)");
    client.execute("load data local inpath '" + dataFilePath.toString() + "' into table "+ tableName);
    client.execute("select count(1) as cnt from " + tableName);
    String row=client.fetchOne();
    assertEquals(row,"500");
    Schema hiveSchema=client.getSchema();
    List<FieldSchema> listFields=hiveSchema.getFieldSchemas();
    assertEquals(listFields.size(),1);
    assertEquals(listFields.get(0).getName(),"cnt");
    assertEquals(listFields.get(0).getType(),"bigint");
    Schema thriftSchema=client.getThriftSchema();
    List<FieldSchema> listThriftFields=thriftSchema.getFieldSchemas();
    assertEquals(listThriftFields.size(),1);
    assertEquals(listThriftFields.get(0).getName(),"cnt");
    assertEquals(listThriftFields.get(0).getType(),"i64");
    client.execute("drop table " + tableName);
  }
 catch (  Throwable t) {
    t.printStackTrace();
  }
}
