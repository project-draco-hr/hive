{
  jobId=rj.getJobID();
  int returnVal=0;
  String pwd=HiveConf.getVar(job,HiveConf.ConfVars.METASTOREPWD);
  if (pwd != null) {
    HiveConf.setVar(job,HiveConf.ConfVars.METASTOREPWD,"HIVE");
  }
  if (pwd != null) {
    HiveConf.setVar(job,HiveConf.ConfVars.METASTOREPWD,pwd);
  }
  runningJobKillURIs.put(rj.getJobID(),rj.getTrackingURL() + "&action=kill");
  ExecDriverTaskHandle th=new ExecDriverTaskHandle(jc,rj);
  jobInfo(rj);
  MapRedStats mapRedStats=progress(th);
  if (SessionState.get() != null) {
    SessionState.get().getLastMapRedStatsList().add(mapRedStats);
  }
  boolean success=mapRedStats.isSuccess();
  String statusMesg=getJobEndMsg(rj.getJobID());
  if (!success) {
    statusMesg+=" with errors";
    returnVal=2;
    console.printError(statusMesg);
    if (HiveConf.getBoolVar(job,HiveConf.ConfVars.SHOW_JOB_FAIL_DEBUG_INFO)) {
      showJobFailDebugInfo(job,rj);
    }
  }
 else {
    console.printInfo(statusMesg);
  }
  return returnVal;
}
