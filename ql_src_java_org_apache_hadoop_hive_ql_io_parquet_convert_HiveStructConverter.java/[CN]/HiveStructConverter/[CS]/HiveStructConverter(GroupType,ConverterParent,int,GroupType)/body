{
  if (parent != null) {
    setMetadata(parent.getMetadata());
  }
  this.parent=parent;
  this.index=index;
  this.totalFieldCount=containingGroupType.getFieldCount();
  final int selectedFieldCount=selectedGroupType.getFieldCount();
  converters=new Converter[selectedFieldCount];
  this.repeatedConverters=new ArrayList<Repeated>();
  List<Type> selectedFields=selectedGroupType.getFields();
  for (int i=0; i < selectedFieldCount; i++) {
    Type subtype=selectedFields.get(i);
    if (containingGroupType.getFields().contains(subtype)) {
      int fieldIndex=containingGroupType.getFieldIndex(subtype.getName());
      converters[i]=getFieldConverter(subtype,fieldIndex);
    }
 else {
      throw new IllegalStateException("Group type [" + containingGroupType + "] does not contain requested field: "+ subtype);
    }
  }
}
