{
  if (hiveTypeInfo == null) {
    return null;
  }
 else   if (hiveTypeInfo.getCategory().equals(ObjectInspector.Category.STRUCT)) {
    return getStructFieldTypeInfo(fieldName,fieldIndex);
  }
 else   if (hiveTypeInfo.getCategory().equals(ObjectInspector.Category.MAP)) {
    if (fieldIndex == 0) {
      return ((MapTypeInfo)hiveTypeInfo).getMapKeyTypeInfo();
    }
 else     if (fieldIndex == 1) {
      return ((MapTypeInfo)hiveTypeInfo).getMapValueTypeInfo();
    }
 else {
      return null;
    }
  }
  throw new RuntimeException("Unknown hive type info " + hiveTypeInfo + " when searching for field "+ fieldName);
}
