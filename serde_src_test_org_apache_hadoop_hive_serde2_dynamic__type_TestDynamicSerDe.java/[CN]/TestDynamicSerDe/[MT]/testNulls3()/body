{
  try {
    ArrayList<String> bye=new ArrayList<String>();
    HashMap<String,Integer> another=null;
    ArrayList<Object> struct=new ArrayList<Object>();
    struct.add(null);
    struct.add(bye);
    struct.add(another);
    Properties schema=new Properties();
    schema.setProperty(Constants.SERIALIZATION_FORMAT,org.apache.hadoop.hive.serde2.thrift.TCTLSeparatedProtocol.class.getName());
    schema.setProperty(org.apache.hadoop.hive.metastore.api.Constants.META_TABLE_NAME,"test");
    schema.setProperty(Constants.SERIALIZATION_DDL,"struct test { i32 hello, list<string> bye, map<string,i32> another}");
    schema.setProperty(Constants.SERIALIZATION_LIB,new DynamicSerDe().getClass().toString());
    schema.setProperty(TCTLSeparatedProtocol.ReturnNullsKey,"true");
    DynamicSerDe serde=new DynamicSerDe();
    serde.initialize(new Configuration(),schema);
    ObjectInspector oi=serde.getObjectInspector();
    BytesWritable bytes=(BytesWritable)serde.serialize(struct,oi);
    hexString(bytes);
    Object o=serde.deserialize(bytes);
    List<?> olist=(List<?>)o;
    assertTrue(olist.size() == 3);
    assertEquals(null,olist.get(0));
    assertEquals(0,((List<?>)olist.get(1)).size());
    assertEquals(null,olist.get(2));
  }
 catch (  Throwable e) {
    e.printStackTrace();
    throw e;
  }
}
