{
  if (shutdownList != null) {
    return;
  }
  shutdownList=Collections.synchronizedList(new LinkedList<DAGClient>());
  Runtime.getRuntime().addShutdownHook(new Thread(){
    @Override public void run(){
      for (      DAGClient c : shutdownList) {
        TezJobMonitor.killRunningJobs();
      }
      try {
        for (        TezSessionState s : TezSessionState.getOpenSessions()) {
          System.err.println("Shutting down tez session.");
          TezSessionPoolManager.getInstance().close(s,false);
        }
      }
 catch (      Exception e) {
      }
    }
  }
);
}
