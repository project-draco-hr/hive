{
  StringBuffer reportBuffer=new StringBuffer();
  SortedSet<String> keys=new TreeSet<String>(progressMap.keySet());
  for (  String s : keys) {
    Progress progress=progressMap.get(s);
    int percentComplete=(int)(100 * progress.getSucceededTaskCount() / (float)progress.getTotalTaskCount());
    if (percentComplete == 100 && !completed.contains(s)) {
      completed.add(s);
      perfLogger.PerfLogEnd(CLASS_NAME,PerfLogger.TEZ_RUN_VERTEX + s);
    }
    reportBuffer.append(String.format("%s: %3d%% complete\t",s,percentComplete));
  }
  String report=reportBuffer.toString();
  if (!report.equals(lastReport)) {
    console.printInfo(report);
  }
  return report;
}
