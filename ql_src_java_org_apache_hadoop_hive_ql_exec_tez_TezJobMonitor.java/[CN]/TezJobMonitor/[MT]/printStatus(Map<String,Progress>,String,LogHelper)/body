{
  StringBuffer reportBuffer=new StringBuffer();
  SortedSet<String> keys=new TreeSet<String>(progressMap.keySet());
  for (  String s : keys) {
    Progress progress=progressMap.get(s);
    int complete=progress.getSucceededTaskCount();
    int total=progress.getTotalTaskCount();
    if (total <= 0) {
      reportBuffer.append(String.format("%s: -/-\t",s,complete,total));
    }
 else {
      if (complete == total && !completed.contains(s)) {
        completed.add(s);
        perfLogger.PerfLogEnd(CLASS_NAME,PerfLogger.TEZ_RUN_VERTEX + s);
      }
      reportBuffer.append(String.format("%s: %d/%d\t",s,complete,total));
    }
  }
  String report=reportBuffer.toString();
  if (!report.equals(lastReport) || System.currentTimeMillis() >= lastPrintTime + printInterval) {
    console.printInfo(report);
    lastPrintTime=System.currentTimeMillis();
  }
  return report;
}
