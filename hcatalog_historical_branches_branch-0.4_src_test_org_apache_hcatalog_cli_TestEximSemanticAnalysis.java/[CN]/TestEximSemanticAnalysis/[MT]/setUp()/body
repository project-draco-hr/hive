{
  hcatConf=new HiveConf(this.getClass());
  hcatConf.set(HiveConf.ConfVars.PREEXECHOOKS.varname,"");
  hcatConf.set(HiveConf.ConfVars.POSTEXECHOOKS.varname,"");
  hcatConf.set(HiveConf.ConfVars.HIVE_SUPPORT_CONCURRENCY.varname,"false");
  hcatConf.set(ConfVars.SEMANTIC_ANALYZER_HOOK.varname,HCatSemanticAnalyzer.class.getName());
  hcatConf.set("fs.pfile.impl","org.apache.hadoop.fs.ProxyLocalFileSystem");
  URI fsuri=cluster.getFileSystem().getUri();
  Path whPath=new Path(fsuri.getScheme(),fsuri.getAuthority(),"/user/hive/warehouse");
  hcatConf.set(HiveConf.ConfVars.HADOOPFS.varname,fsuri.toString());
  hcatConf.set(ConfVars.METASTOREWAREHOUSE.varname,whPath.toString());
  wh=new Warehouse(hcatConf);
  SessionState.start(new CliSessionState(hcatConf));
  hcatDriver=new HCatDriver();
}
