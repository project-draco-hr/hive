{
  hcatDriver.run("drop table junit_sem_analysis");
  CommandProcessorResponse response=hcatDriver.run("create table junit_sem_analysis (a int) partitioned by (b string) stored as RCFILE");
  assertEquals(0,response.getResponseCode());
  Runtime.getRuntime().exec("rm -rf /tmp/hcat");
  response=hcatDriver.run("export table junit_sem_analysis to 'pfile://local:9080/tmp/hcat/exports/junit_sem_analysis'");
  assertEquals(0,response.getResponseCode());
  response=hcatDriver.run("drop table junit_sem_analysis");
  assertEquals(0,response.getResponseCode());
  response=hcatDriver.run("create table junit_sem_analysis (a int) partitioned by (b string) stored as RCFILE");
  assertEquals(0,response.getResponseCode());
  Path whPath=wh.getTablePath(Hive.get(hcatConf).getDatabase("default"),"junit_sem_analysis");
  cluster.getFileSystem().setPermission(whPath,FsPermission.valueOf("-rwxrwxr-x"));
  cluster.getFileSystem().setOwner(whPath,"nosuchuser","nosuchgroup");
  response=hcatDriver.run("import table junit_sem_analysis from 'pfile://local:9080/tmp/hcat/exports/junit_sem_analysis'");
  assertEquals(10,response.getResponseCode());
  assertTrue("Permission denied expected: " + response.getErrorMessage(),response.getErrorMessage().startsWith("FAILED: Error in semantic analysis: org.apache.hcatalog.common.HCatException : 3000 : Permission denied"));
  Runtime.getRuntime().exec("rm -rf /tmp/hcat");
  cluster.getFileSystem().setPermission(whPath,FsPermission.valueOf("-rwxrwxrwx"));
  response=hcatDriver.run("drop table junit_sem_analysis");
  if (response.getResponseCode() != 0) {
    LOG.error(response.getErrorMessage());
    fail("Drop table failed");
  }
}
