{
  String mode=HiveConf.getVar(pctx.getConf(),HiveConf.ConfVars.HIVEFETCHTASKCONVERSION);
  boolean aggressive="more".equals(mode);
  final int limit=pctx.getQB().getParseInfo().getOuterQueryLimit();
  FetchData fetch=checkTree(aggressive,pctx,alias,source);
  if (fetch != null && checkThreshold(fetch,limit,pctx)) {
    FetchWork fetchWork=fetch.convertToWork();
    FetchTask fetchTask=(FetchTask)TaskFactory.get(fetchWork,pctx.getConf());
    fetchWork.setSink(fetch.completed(pctx,fetchWork));
    fetchWork.setSource(source);
    fetchWork.setLimit(limit);
    return fetchTask;
  }
  return null;
}
