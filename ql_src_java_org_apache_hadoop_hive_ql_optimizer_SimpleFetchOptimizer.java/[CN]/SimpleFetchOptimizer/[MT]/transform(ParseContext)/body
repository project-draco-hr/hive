{
  Map<String,Operator<? extends OperatorDesc>> topOps=pctx.getTopOps();
  if (pctx.getQB().isSimpleSelectQuery() && topOps.size() == 1) {
    String alias=(String)pctx.getTopOps().keySet().toArray()[0];
    Operator topOp=(Operator)pctx.getTopOps().values().toArray()[0];
    if (topOp instanceof TableScanOperator) {
      try {
        FetchTask fetchTask=optimize(pctx,alias,(TableScanOperator)topOp);
        if (fetchTask != null) {
          pctx.setFetchTask(fetchTask);
        }
      }
 catch (      Exception e) {
        LOG.error(org.apache.hadoop.util.StringUtils.stringifyException(e));
        if (e instanceof SemanticException) {
          throw (SemanticException)e;
        }
        throw new SemanticException(e.getMessage(),e);
      }
    }
  }
  return pctx;
}
