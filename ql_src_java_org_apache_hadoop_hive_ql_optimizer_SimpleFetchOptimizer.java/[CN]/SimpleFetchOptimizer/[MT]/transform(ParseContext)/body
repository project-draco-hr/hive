{
  Map<String,TableScanOperator> topOps=pctx.getTopOps();
  if (pctx.getQueryProperties().isQuery() && !pctx.getQueryProperties().isAnalyzeCommand() && topOps.size() == 1) {
    String alias=(String)pctx.getTopOps().keySet().toArray()[0];
    TableScanOperator topOp=pctx.getTopOps().values().iterator().next();
    try {
      FetchTask fetchTask=optimize(pctx,alias,topOp);
      if (fetchTask != null) {
        pctx.setFetchTask(fetchTask);
      }
    }
 catch (    Exception e) {
      LOG.error(org.apache.hadoop.util.StringUtils.stringifyException(e));
      if (e instanceof SemanticException) {
        throw (SemanticException)e;
      }
      throw new SemanticException(e.getMessage(),e);
    }
  }
  return pctx;
}
