{
  if (ts.getChildOperators().size() != 1) {
    return null;
  }
  Operator<?> op=ts.getChildOperators().get(0);
  for (; ; op=op.getChildOperators().get(0)) {
    if (op instanceof SelectOperator) {
      if (!aggressive) {
        if (!checkExpressions((SelectOperator)op)) {
          break;
        }
      }
      continue;
    }
    if (aggressive) {
      if (!(op instanceof LimitOperator || op instanceof FilterOperator)) {
        break;
      }
    }
 else     if (!(op instanceof LimitOperator || (op instanceof FilterOperator && bypassFilter))) {
      break;
    }
    if (op.getChildOperators() == null || op.getChildOperators().size() != 1) {
      return null;
    }
  }
  if (op instanceof FileSinkOperator) {
    fetch.scanOp=ts;
    fetch.fileSink=op;
    return fetch;
  }
  return null;
}
