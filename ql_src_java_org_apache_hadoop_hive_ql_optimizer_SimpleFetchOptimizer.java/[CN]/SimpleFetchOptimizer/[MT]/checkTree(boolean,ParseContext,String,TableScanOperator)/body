{
  SplitSample splitSample=pctx.getNameToSplitSample().get(alias);
  if (!aggressive && splitSample != null) {
    return null;
  }
  QB qb=pctx.getQB();
  if (!aggressive && qb.hasTableSample(alias)) {
    return null;
  }
  Table table=pctx.getTopToTable().get(ts);
  if (table == null) {
    return null;
  }
  ReadEntity parent=PlanUtils.getParentViewInfo(alias,pctx.getViewAliasToInput());
  if (!table.isPartitioned()) {
    FetchData fetch=new FetchData(ts,parent,table,splitSample);
    return checkOperators(fetch,aggressive,false);
  }
  boolean bypassFilter=false;
  if (HiveConf.getBoolVar(pctx.getConf(),HiveConf.ConfVars.HIVEOPTPPD)) {
    ExprNodeDesc pruner=pctx.getOpToPartPruner().get(ts);
    if (PartitionPruner.onlyContainsPartnCols(table,pruner)) {
      bypassFilter=!pctx.getPrunedPartitions(alias,ts).hasUnknownPartitions();
    }
  }
  if (!aggressive && !bypassFilter) {
    return null;
  }
  PrunedPartitionList partitions=pctx.getPrunedPartitions(alias,ts);
  FetchData fetch=new FetchData(ts,parent,table,partitions,splitSample,bypassFilter);
  return checkOperators(fetch,aggressive,bypassFilter);
}
