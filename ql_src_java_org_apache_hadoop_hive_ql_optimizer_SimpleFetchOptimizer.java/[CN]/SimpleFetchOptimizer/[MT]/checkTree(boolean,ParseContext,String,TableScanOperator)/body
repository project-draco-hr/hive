{
  SplitSample splitSample=pctx.getNameToSplitSample().get(alias);
  if (!aggressive && splitSample != null) {
    return null;
  }
  QB qb=pctx.getQB();
  if (!aggressive && qb.hasTableSample(alias)) {
    return null;
  }
  Table table=qb.getMetaData().getAliasToTable().get(alias);
  if (table == null) {
    return null;
  }
  if (!table.isPartitioned()) {
    return checkOperators(new FetchData(table,splitSample),ts,aggressive,false);
  }
  boolean bypassFilter=false;
  if (HiveConf.getBoolVar(pctx.getConf(),HiveConf.ConfVars.HIVEOPTPPD)) {
    ExprNodeDesc pruner=pctx.getOpToPartPruner().get(ts);
    bypassFilter=PartitionPruner.onlyContainsPartnCols(table,pruner);
  }
  if (aggressive || bypassFilter) {
    PrunedPartitionList pruned=pctx.getPrunedPartitions(alias,ts);
    if (aggressive || pruned.getUnknownPartns().isEmpty()) {
      bypassFilter&=pruned.getUnknownPartns().isEmpty();
      return checkOperators(new FetchData(pruned,splitSample),ts,aggressive,bypassFilter);
    }
  }
  return null;
}
