{
  SplitSample splitSample=pctx.getNameToSplitSample().get(alias);
  if (!aggressive && splitSample != null) {
    return null;
  }
  if (!aggressive && ts.getConf().getTableSample() != null) {
    return null;
  }
  Table table=ts.getConf().getTableMetadata();
  ReadEntity parent=PlanUtils.getParentViewInfo(alias,pctx.getViewAliasToInput());
  if (table != null && !table.isPartitioned()) {
    FetchData fetch=new FetchData(ts,parent,table,splitSample);
    return checkOperators(fetch,aggressive,false);
  }
  boolean bypassFilter=false;
  if (table != null && HiveConf.getBoolVar(pctx.getConf(),HiveConf.ConfVars.HIVEOPTPPD)) {
    ExprNodeDesc pruner=pctx.getOpToPartPruner().get(ts);
    if (PartitionPruner.onlyContainsPartnCols(table,pruner)) {
      bypassFilter=!pctx.getPrunedPartitions(alias,ts).hasUnknownPartitions();
    }
  }
  if (table != null && !aggressive && !bypassFilter) {
    return null;
  }
  PrunedPartitionList partitions=pctx.getPrunedPartitions(alias,ts);
  FetchData fetch=new FetchData(ts,parent,table,partitions,splitSample,bypassFilter);
  return checkOperators(fetch,aggressive,bypassFilter);
}
