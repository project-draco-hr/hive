{
  return new CombineFileInputFormatShim(){
    @Override public RecordReader getRecordReader(    InputSplit split,    JobConf job,    Reporter reporter) throws IOException {
      throw new IOException("CombineFileInputFormat.getRecordReader not needed.");
    }
    @Override protected FileStatus[] listStatus(    JobConf job) throws IOException {
      FileStatus[] result=super.listStatus(job);
      boolean foundDir=false;
      for (      FileStatus stat : result) {
        if (stat.isDir()) {
          foundDir=true;
          break;
        }
      }
      if (!foundDir) {
        return result;
      }
      ArrayList<FileStatus> files=new ArrayList<FileStatus>();
      for (      FileStatus stat : result) {
        if (!stat.isDir()) {
          files.add(stat);
        }
      }
      return files.toArray(new FileStatus[files.size()]);
    }
  }
;
}
