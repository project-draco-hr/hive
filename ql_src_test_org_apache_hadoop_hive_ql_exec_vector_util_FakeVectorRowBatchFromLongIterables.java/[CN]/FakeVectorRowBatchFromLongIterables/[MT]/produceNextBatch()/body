{
  batch.size=0;
  batch.selectedInUse=false;
  for (int i=0; i < numCols; ++i) {
    ColumnVector col=batch.cols[i];
    col.noNulls=true;
    col.isRepeating=false;
  }
  while (!eof && batch.size < this.batchSize) {
    int r=batch.size;
    for (int i=0; i < numCols; ++i) {
      Iterator<Long> it=iterators.get(i);
      if (!it.hasNext()) {
        eof=true;
        break;
      }
      LongColumnVector col=(LongColumnVector)batch.cols[i];
      Long value=it.next();
      if (null == value) {
        col.noNulls=false;
        col.isNull[batch.size]=true;
      }
 else {
        long[] vector=col.vector;
        vector[r]=value;
        col.isNull[batch.size]=false;
      }
    }
    if (!eof) {
      batch.size+=1;
    }
  }
  return batch;
}
