{
  try {
    if (driver != null && driver.length() != 0) {
      Class.forName(driver);
    }
  }
 catch (  ClassNotFoundException cnfe) {
    return beeLine.error(cnfe);
  }
  boolean foundDriver=false;
  try {
    foundDriver=DriverManager.getDriver(getUrl()) != null;
  }
 catch (  Exception e) {
  }
  try {
    close();
  }
 catch (  Exception e) {
    return beeLine.error(e);
  }
  Properties info=new Properties();
  info.put(HIVE_AUTH_USER,username);
  info.put(HIVE_AUTH_PASSWD,password);
  Map<String,String> hiveVars=beeLine.getOpts().getHiveVariables();
  for (  Map.Entry<String,String> var : hiveVars.entrySet()) {
    info.put(HIVE_VAR_PREFIX + var.getKey(),var.getValue());
  }
  setConnection(DriverManager.getConnection(getUrl(),info));
  setDatabaseMetaData(getConnection().getMetaData());
  try {
    beeLine.info(beeLine.loc("connected",new Object[]{getDatabaseMetaData().getDatabaseProductName(),getDatabaseMetaData().getDatabaseProductVersion()}));
  }
 catch (  Exception e) {
    beeLine.handleException(e);
  }
  try {
    beeLine.info(beeLine.loc("driver",new Object[]{getDatabaseMetaData().getDriverName(),getDatabaseMetaData().getDriverVersion()}));
  }
 catch (  Exception e) {
    beeLine.handleException(e);
  }
  try {
    getConnection().setAutoCommit(beeLine.getOpts().getAutoCommit());
  }
 catch (  Exception e) {
    beeLine.handleException(e);
  }
  try {
    beeLine.getCommands().isolation("isolation: " + beeLine.getOpts().getIsolation());
  }
 catch (  Exception e) {
    beeLine.handleException(e);
  }
  return true;
}
