{
  LOG.info("user: " + user + " loginUser: "+ UserGroupInformation.getLoginUser().getUserName());
  final UserGroupInformation ugi=UgiFactory.getUgi(user);
  final TokenWrapper twrapper=new TokenWrapper();
  ugi.doAs(new PrivilegedExceptionAction<Object>(){
    public Object run() throws IOException {
      FileSystem fs=FileSystem.get(conf);
      twrapper.token=fs.getDelegationToken(ugi.getShortUserName());
      return null;
    }
  }
);
  return twrapper.token;
}
