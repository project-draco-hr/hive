{
  Set<String> validGroups=proxyUserGroups.get(proxyUser);
  if (validGroups == WILD_CARD) {
    return;
  }
 else   if (validGroups == null || validGroups.isEmpty()) {
    throw new NotAuthorizedException(MessageFormat.format("Unauthorized proxyuser [{0}] for doAsUser [{1}], not in proxyuser groups",proxyUser,doAsUser));
  }
  Groups groupsInfo=new Groups(Main.getAppConfigInstance());
  try {
    List<String> userGroups=groupsInfo.getGroups(doAsUser);
    for (    String g : validGroups) {
      if (userGroups.contains(g)) {
        return;
      }
    }
  }
 catch (  IOException ex) {
    LOG.warn(MessageFormat.format("Unable to get list of groups for doAsUser [{0}].",doAsUser),ex);
  }
  throw new NotAuthorizedException(MessageFormat.format("Unauthorized proxyuser [{0}] for doAsUser [{1}], not in proxyuser groups",proxyUser,doAsUser));
}
