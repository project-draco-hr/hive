{
  boolean isExternal=MetaStoreUtils.isExternalTable(table);
  String tableName=getFullyQualifiedHBaseTableName(table);
  RevisionManager rm=null;
  try {
    if (!isExternal && getHBaseAdmin().tableExists(tableName)) {
      if (getHBaseAdmin().isTableEnabled(tableName)) {
        getHBaseAdmin().disableTable(tableName);
      }
      getHBaseAdmin().deleteTable(tableName);
      rm=HBaseRevisionManagerUtil.getOpenedRevisionManager(hbaseConf);
      rm.dropTable(tableName);
    }
  }
 catch (  IOException ie) {
    throw new MetaException(StringUtils.stringifyException(ie));
  }
 finally {
    HBaseRevisionManagerUtil.closeRevisionManagerQuietly(rm);
  }
}
