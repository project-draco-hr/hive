{
  LongColumnVector lcv=(LongColumnVector)columnVector;
  if (isPositive) {
    calendar.setTimeInMillis(DateWritable.daysToMillis((int)lcv.vector[index] + numDays));
  }
 else {
    calendar.setTimeInMillis(DateWritable.daysToMillis((int)lcv.vector[index] - numDays));
  }
  Date newDate=calendar.getTime();
  text.set(formatter.format(newDate));
  return Arrays.copyOf(text.getBytes(),text.getLength());
}
