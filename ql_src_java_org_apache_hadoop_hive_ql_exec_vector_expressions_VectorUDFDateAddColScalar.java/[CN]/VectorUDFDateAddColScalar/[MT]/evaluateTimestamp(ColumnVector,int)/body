{
  TimestampColumnVector tcv=(TimestampColumnVector)columnVector;
  calendar.setTimeInMillis(tcv.getTimestampMilliseconds(index));
  if (isPositive) {
    calendar.add(Calendar.DATE,numDays);
  }
 else {
    calendar.add(Calendar.DATE,-numDays);
  }
  Date newDate=calendar.getTime();
  text.set(formatter.format(newDate));
  return Arrays.copyOf(text.getBytes(),text.getLength());
}
