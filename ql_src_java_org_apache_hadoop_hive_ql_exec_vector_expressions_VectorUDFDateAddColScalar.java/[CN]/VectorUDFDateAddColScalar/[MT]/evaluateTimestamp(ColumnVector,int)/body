{
  LongColumnVector lcv=(LongColumnVector)columnVector;
  calendar.setTimeInMillis(lcv.vector[index] / 1000000);
  if (isPositive) {
    calendar.add(Calendar.DATE,numDays);
  }
 else {
    calendar.add(Calendar.DATE,-numDays);
  }
  Date newDate=calendar.getTime();
  text.set(formatter.format(newDate));
  return Arrays.copyOf(text.getBytes(),text.getLength());
}
