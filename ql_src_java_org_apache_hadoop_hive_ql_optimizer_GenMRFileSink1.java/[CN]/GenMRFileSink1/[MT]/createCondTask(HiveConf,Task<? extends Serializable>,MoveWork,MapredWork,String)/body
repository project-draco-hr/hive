{
  Task<? extends Serializable> mergeTask=TaskFactory.get(mergeWork,conf);
  Task<? extends Serializable> moveTask=TaskFactory.get(mvWork,conf);
  List<Serializable> listWorks=new ArrayList<Serializable>();
  listWorks.add(mvWork);
  listWorks.add(mergeWork);
  ConditionalWork cndWork=new ConditionalWork(listWorks);
  List<Task<? extends Serializable>> listTasks=new ArrayList<Task<? extends Serializable>>();
  listTasks.add(moveTask);
  listTasks.add(mergeTask);
  ConditionalTask cndTsk=(ConditionalTask)TaskFactory.get(cndWork,conf);
  cndTsk.setListTasks(listTasks);
  cndTsk.setResolver(new ConditionalResolverMergeFiles());
  ConditionalResolverMergeFilesCtx mrCtx=new ConditionalResolverMergeFilesCtx(listTasks,inputPath);
  cndTsk.setResolverCtx(mrCtx);
  currTask.addDependentTask(cndTsk);
  return cndTsk;
}
