{
  String inputDir=fsInputDesc.getDirName();
  TableDesc tblDesc=fsInputDesc.getTableInfo();
  if (tblDesc.getInputFileFormatClass().equals(RCFileInputFormat.class)) {
    ArrayList<String> inputDirs=new ArrayList<String>();
    if (!hasDynamicPartitions) {
      inputDirs.add(inputDir);
    }
    MergeWork work=new MergeWork(inputDirs,finalName,hasDynamicPartitions);
    LinkedHashMap<String,ArrayList<String>> pathToAliases=new LinkedHashMap<String,ArrayList<String>>();
    pathToAliases.put(inputDir,(ArrayList<String>)inputDirs.clone());
    work.setMapperCannotSpanPartns(true);
    work.setPathToAliases(pathToAliases);
    work.setAliasToWork(new LinkedHashMap<String,Operator<? extends Serializable>>());
    if (hasDynamicPartitions) {
      work.getPathToPartitionInfo().put(inputDir,new PartitionDesc(tblDesc,null));
    }
    return work;
  }
  throw new SemanticException("createRCFileMergeTask called on non-RCFile table");
}
