{
  ParseContext parseCtx=ctx.getParseCtx();
  HiveConf conf=parseCtx.getConf();
  if (conf.getBoolVar(HiveConf.ConfVars.HIVEMERGEMAPONLY) && Utilities.supportCombineFileInputFormat()) {
    createMap4Merge(fsOp,ctx,finalName);
    LOG.info("use CombineHiveInputformat for the merge job");
  }
 else {
    if (fsOp.getConf().getDynPartCtx() != null) {
      throw new SemanticException(ErrorMsg.DYNAMIC_PARTITION_MERGE.getMsg());
    }
    createMapReduce4Merge(fsOp,ctx,finalName);
    LOG.info("use HiveInputFormat for the merge job");
  }
}
