{
  ParseContext parseCtx=ctx.getParseCtx();
  HiveConf conf=parseCtx.getConf();
  if ((conf.getBoolVar(HiveConf.ConfVars.HIVEMERGEMAPFILES) || conf.getBoolVar(HiveConf.ConfVars.HIVEMERGEMAPREDFILES)) && Utilities.supportCombineFileInputFormat()) {
    createMap4Merge(fsOp,ctx,finalName);
    LOG.info("use CombineHiveInputformat for the merge job");
  }
 else {
    createMapReduce4Merge(fsOp,ctx,finalName);
    LOG.info("use HiveInputFormat for the merge job");
  }
}
