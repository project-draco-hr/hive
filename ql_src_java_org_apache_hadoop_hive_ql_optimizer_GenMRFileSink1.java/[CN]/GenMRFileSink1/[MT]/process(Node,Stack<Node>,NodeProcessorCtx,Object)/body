{
  GenMRProcContext ctx=(GenMRProcContext)opProcCtx;
  ParseContext parseCtx=ctx.getParseCtx();
  boolean chDir=false;
  Task<? extends Serializable> currTask=ctx.getCurrTask();
  if (((ctx.getMvTask() != null) && (!ctx.getMvTask().isEmpty())) && ((ctx.getSeenFileSinkOps() == null) || (!ctx.getSeenFileSinkOps().contains((FileSinkOperator)nd)))) {
    if ((parseCtx.getConf().getBoolVar(HiveConf.ConfVars.HIVEMERGEMAPFILES) && (((mapredWork)currTask.getWork()).getReducer() == null)) || parseCtx.getConf().getBoolVar(HiveConf.ConfVars.HIVEMERGEMAPREDFILES))     chDir=true;
  }
  String finalName=processFS(nd,stack,opProcCtx,chDir);
  if (chDir && (finalName != null)) {
    createMergeJob((FileSinkOperator)nd,ctx,finalName);
  }
  return null;
}
