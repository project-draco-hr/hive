{
  Operator<? extends OperatorDesc> currTopOp=ctx.getCurrTopOp();
  String currAliasId=ctx.getCurrAliasId();
  List<Operator<? extends OperatorDesc>> seenOps=ctx.getSeenOps();
  List<Task<? extends Serializable>> rootTasks=ctx.getRootTasks();
  Task<? extends Serializable> currTask=ctx.getCurrTask();
  if (currTopOp != null) {
    if (!seenOps.contains(currTopOp)) {
      seenOps.add(currTopOp);
      GenMapRedUtils.setTaskPlan(currAliasId,currTopOp,(MapredWork)currTask.getWork(),false,ctx);
    }
    if (!rootTasks.contains(currTask) && (currTask.getParentTasks() == null || currTask.getParentTasks().isEmpty())) {
      rootTasks.add(currTask);
    }
  }
  if (childTask != null) {
    currTask.addDependentTask(childTask);
  }
}
