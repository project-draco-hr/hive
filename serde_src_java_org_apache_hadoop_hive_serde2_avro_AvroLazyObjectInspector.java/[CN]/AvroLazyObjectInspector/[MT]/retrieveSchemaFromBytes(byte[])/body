{
  ByteArrayInputStream bais=new ByteArrayInputStream(data);
  DatumReader<GenericRecord> reader=new GenericDatumReader<GenericRecord>();
  Schema schema=null;
  try {
    @SuppressWarnings("resource") DataFileStream<GenericRecord> dfs=new DataFileStream<GenericRecord>(bais,reader);
    schema=dfs.getSchema();
  }
 catch (  IOException ioe) {
    throw new AvroObjectInspectorException("An error occurred retrieving schema from bytes",ioe);
  }
  return schema;
}
