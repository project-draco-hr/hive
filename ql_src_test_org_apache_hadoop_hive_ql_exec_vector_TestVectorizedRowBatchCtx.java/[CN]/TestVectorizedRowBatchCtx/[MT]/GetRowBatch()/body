{
  RCFile.Reader reader=new RCFile.Reader(fs,this.testFilePath,conf);
  StructObjectInspector oi=(StructObjectInspector)serDe.getObjectInspector();
  List<? extends StructField> fieldRefs=oi.getAllStructFieldRefs();
  Assert.assertEquals("Field size should be 9",colCount,fieldRefs.size());
  VectorizedRowBatchCtx ctx=new VectorizedRowBatchCtx(oi,oi,serDe,null);
  VectorizedRowBatch batch=ctx.createVectorizedRowBatch();
  VectorizedBatchUtil.SetNoNullFields(true,batch);
  LongWritable rowID=new LongWritable();
  for (int i=0; i < 10; i++) {
    reader.next(rowID);
    BytesRefArrayWritable cols=new BytesRefArrayWritable();
    reader.getCurrentRow(cols);
    cols.resetValid(colCount);
    ctx.addRowToBatch(i,cols,batch);
  }
  reader.close();
  batch.size=10;
  return batch;
}
