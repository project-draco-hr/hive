{
  int numPartFields=0;
switch (gbInfo.gbPhysicalPipelineMode) {
case MAP_SIDE_GB_NO_SKEW_NO_ADD_MR_JOB:
case MAP_SIDE_GB_NO_SKEW_ADD_MR_JOB:
case MAP_SIDE_GB_SKEW_GBKEYS_AND_DIST_UDAF_NOT_PRESENT:
case NO_MAP_SIDE_GB_NO_SKEW:
    numPartFields+=gbInfo.gbKeys.size();
  break;
case NO_MAP_SIDE_GB_SKEW:
case MAP_SIDE_GB_SKEW_GBKEYS_OR_DIST_UDAF_PRESENT:
if (gbInfo.containsDistinctAggr) {
  numPartFields=Integer.MAX_VALUE;
}
 else {
  numPartFields=-1;
}
break;
default :
throw new RuntimeException("Unable to determine Number of Partition Fields - Invalid Physical Mode: " + gbInfo.gbPhysicalPipelineMode);
}
return numPartFields;
}
