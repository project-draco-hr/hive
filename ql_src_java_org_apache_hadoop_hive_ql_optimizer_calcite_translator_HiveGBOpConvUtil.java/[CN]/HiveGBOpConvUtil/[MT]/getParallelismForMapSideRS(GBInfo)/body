{
  int degreeOfParallelism=0;
switch (gbInfo.gbPhysicalPipelineMode) {
case MAP_SIDE_GB_NO_SKEW_NO_ADD_MR_JOB:
case MAP_SIDE_GB_NO_SKEW_ADD_MR_JOB:
case NO_MAP_SIDE_GB_NO_SKEW:
    if (gbInfo.gbKeys.isEmpty()) {
      degreeOfParallelism=1;
    }
 else {
      degreeOfParallelism=-1;
    }
  break;
case NO_MAP_SIDE_GB_SKEW:
case MAP_SIDE_GB_SKEW_GBKEYS_OR_DIST_UDAF_PRESENT:
degreeOfParallelism=-1;
break;
case MAP_SIDE_GB_SKEW_GBKEYS_AND_DIST_UDAF_NOT_PRESENT:
degreeOfParallelism=1;
break;
default :
throw new RuntimeException("Unable to determine Reducer Parallelism - Invalid Physical Mode: " + gbInfo.gbPhysicalPipelineMode);
}
return degreeOfParallelism;
}
