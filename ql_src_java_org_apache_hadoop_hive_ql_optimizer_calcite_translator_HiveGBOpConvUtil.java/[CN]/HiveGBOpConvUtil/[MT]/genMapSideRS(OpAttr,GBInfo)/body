{
  Map<String,ExprNodeDesc> colExprMap=new HashMap<String,ExprNodeDesc>();
  List<String> outputKeyColumnNames=new ArrayList<String>();
  List<String> outputValueColumnNames=new ArrayList<String>();
  ArrayList<ColumnInfo> colInfoLst=new ArrayList<ColumnInfo>();
  String outputColName;
  ArrayList<ExprNodeDesc> reduceKeys=new ArrayList<ExprNodeDesc>();
  for (int i=0; i < gbInfo.gbKeys.size(); i++) {
    reduceKeys.add(gbInfo.gbKeys.get(i));
    String colOutputName=SemanticAnalyzer.getColumnInternalName(i);
    outputKeyColumnNames.add(colOutputName);
    colInfoLst.add(new ColumnInfo(Utilities.ReduceField.KEY.toString() + "." + colOutputName,gbInfo.gbKeyTypes.get(i),"",false));
    colExprMap.put(colOutputName,gbInfo.gbKeys.get(i));
  }
  int keyLength=reduceKeys.size();
  if (gbInfo.containsDistinctAggr) {
    String udafName=SemanticAnalyzer.getColumnInternalName(reduceKeys.size());
    outputKeyColumnNames.add(udafName);
    for (int i=0; i < gbInfo.distExprNodes.size(); i++) {
      reduceKeys.add(gbInfo.distExprNodes.get(i));
      outputColName=SemanticAnalyzer.getColumnInternalName(0);
      String field=Utilities.ReduceField.KEY.toString() + "." + udafName+ ":"+ i+ "."+ outputColName;
      ColumnInfo colInfo=new ColumnInfo(field,gbInfo.distExprNodes.get(i).getTypeInfo(),null,false);
      colInfoLst.add(colInfo);
      colExprMap.put(field,gbInfo.distExprNodes.get(i));
    }
  }
  ArrayList<ExprNodeDesc> reduceValues=new ArrayList<ExprNodeDesc>();
  for (int i=0; i < gbInfo.deDupedNonDistIrefs.size(); i++) {
    reduceValues.add(gbInfo.deDupedNonDistIrefs.get(i));
    outputColName=SemanticAnalyzer.getColumnInternalName(reduceValues.size() - 1);
    outputValueColumnNames.add(outputColName);
    String field=Utilities.ReduceField.VALUE.toString() + "." + outputColName;
    colInfoLst.add(new ColumnInfo(field,reduceValues.get(reduceValues.size() - 1).getTypeInfo(),null,false));
    colExprMap.put(field,reduceValues.get(reduceValues.size() - 1));
  }
  ReduceSinkOperator rsOp=(ReduceSinkOperator)OperatorFactory.getAndMakeChild(PlanUtils.getReduceSinkDesc(reduceKeys,keyLength,reduceValues,gbInfo.distColIndices,outputKeyColumnNames,outputValueColumnNames,true,-1,getNumPartFieldsForMapSideRS(gbInfo),getParallelismForMapSideRS(gbInfo),AcidUtils.Operation.NOT_ACID),new RowSchema(colInfoLst),inputOpAf.inputs.get(0));
  rsOp.setColumnExprMap(colExprMap);
  return new OpAttr("",new HashSet<Integer>(),rsOp);
}
