{
  HIVEGBPHYSICALMODE gbPhysicalPipelineMode=HIVEGBPHYSICALMODE.MAP_SIDE_GB_NO_SKEW_NO_ADD_MR_JOB;
  if (hc.getBoolVar(HiveConf.ConfVars.HIVEMAPSIDEAGGREGATE)) {
    if (!hc.getBoolVar(HiveConf.ConfVars.HIVEGROUPBYSKEW)) {
      if (!gbInfo.grpSetRqrAdditionalMRJob) {
        gbPhysicalPipelineMode=HIVEGBPHYSICALMODE.MAP_SIDE_GB_NO_SKEW_NO_ADD_MR_JOB;
      }
 else {
        gbPhysicalPipelineMode=HIVEGBPHYSICALMODE.MAP_SIDE_GB_NO_SKEW_ADD_MR_JOB;
      }
    }
 else {
      if (gbInfo.containsDistinctAggr || !gbInfo.gbKeys.isEmpty()) {
        gbPhysicalPipelineMode=HIVEGBPHYSICALMODE.MAP_SIDE_GB_SKEW_GBKEYS_OR_DIST_UDAF_PRESENT;
      }
 else {
        gbPhysicalPipelineMode=HIVEGBPHYSICALMODE.MAP_SIDE_GB_SKEW_GBKEYS_AND_DIST_UDAF_NOT_PRESENT;
      }
    }
  }
 else {
    if (!hc.getBoolVar(HiveConf.ConfVars.HIVEGROUPBYSKEW)) {
      gbPhysicalPipelineMode=HIVEGBPHYSICALMODE.NO_MAP_SIDE_GB_NO_SKEW;
    }
 else {
      gbPhysicalPipelineMode=HIVEGBPHYSICALMODE.NO_MAP_SIDE_GB_SKEW;
    }
  }
  return gbPhysicalPipelineMode;
}
