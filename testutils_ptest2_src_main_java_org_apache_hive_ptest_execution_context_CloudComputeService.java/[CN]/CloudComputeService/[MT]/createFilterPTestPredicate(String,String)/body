{
  return new Predicate<ComputeMetadata>(){
    @Override public boolean apply(    ComputeMetadata computeMetadata){
      NodeMetadata nodeMetadata=(NodeMetadata)computeMetadata;
      return nodeMetadata.getStatus() == Status.RUNNING && isPTestHost(nodeMetadata);
    }
    private boolean isPTestHost(    NodeMetadata node){
      String result="false non-ptest host";
      if (groupName.equalsIgnoreCase(node.getGroup())) {
        result="true due to group " + groupName;
        return true;
      }
      if (Strings.nullToEmpty(node.getName()).startsWith(groupName)) {
        result="true due to name " + groupName;
        return true;
      }
      if (node.getTags().contains(groupTag)) {
        result="true due to tag " + groupName;
        return true;
      }
      LOG.debug("Found node: " + node + ", Result: "+ result);
      return false;
    }
  }
;
}
