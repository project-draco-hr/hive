{
  HiveConf conf=new HiveConf();
  SparkSessionManager sessionManager=SparkSessionManagerImpl.getInstance();
  SparkSession sparkSession1=sessionManager.getSession(null,conf,true);
  assertTrue(sparkSession1.isOpen());
  SparkSession sparkSession2=sessionManager.getSession(sparkSession1,conf,true);
  assertTrue(sparkSession1 == sparkSession2);
  assertTrue(sparkSession2.isOpen());
  sessionManager.shutdown();
  sessionManager.closeSession(sparkSession1);
}
