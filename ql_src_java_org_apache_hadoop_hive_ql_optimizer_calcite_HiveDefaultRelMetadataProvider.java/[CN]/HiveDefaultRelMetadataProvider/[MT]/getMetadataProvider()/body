{
  final HiveCostModel cm;
  if (HiveConf.getVar(this.hiveConf,HiveConf.ConfVars.HIVE_EXECUTION_ENGINE).equals("tez") && HiveConf.getBoolVar(this.hiveConf,HiveConf.ConfVars.EXTENDED_COST_MODEL)) {
    final Double maxMemory=(double)HiveConf.getLongVar(this.hiveConf,HiveConf.ConfVars.HIVECONVERTJOINNOCONDITIONALTASKTHRESHOLD);
    cm=new HiveOnTezCostModel(maxMemory);
  }
 else {
    cm=new HiveDefaultCostModel();
  }
  final Double maxSplitSize=(double)HiveConf.getLongVar(this.hiveConf,HiveConf.ConfVars.MAPREDMAXSPLITSIZE);
  return ChainedRelMetadataProvider.of(ImmutableList.of(HiveRelMdDistinctRowCount.SOURCE,new HiveRelMdCost(cm).getMetadataProvider(),HiveRelMdSelectivity.SOURCE,HiveRelMdRowCount.SOURCE,HiveRelMdUniqueKeys.SOURCE,HiveRelMdSize.SOURCE,HiveRelMdMemory.SOURCE,new HiveRelMdParallelism(maxSplitSize).getMetadataProvider(),HiveRelMdDistribution.SOURCE,HiveRelMdCollation.SOURCE,new DefaultRelMetadataProvider()));
}
