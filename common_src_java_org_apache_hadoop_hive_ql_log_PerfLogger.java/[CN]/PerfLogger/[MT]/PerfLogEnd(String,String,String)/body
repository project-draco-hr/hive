{
  Long startTime=startTimes.get(method);
  long endTime=System.currentTimeMillis();
  endTimes.put(method,new Long(endTime));
  long duration=startTime == null ? -1 : endTime - startTime.longValue();
  if (LOG.isDebugEnabled()) {
    StringBuilder sb=new StringBuilder("</PERFLOG method=").append(method);
    if (startTime != null) {
      sb.append(" start=").append(startTime);
    }
    sb.append(" end=").append(endTime);
    if (startTime != null) {
      sb.append(" duration=").append(duration);
    }
    sb.append(" from=").append(callerName);
    if (additionalInfo != null) {
      sb.append(" ").append(additionalInfo);
    }
    sb.append(">");
    LOG.debug(sb.toString());
  }
  endMetrics(method);
  return duration;
}
