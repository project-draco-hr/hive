{
  if (httpUGI != null) {
    try {
      return httpUGI.doAs(new HttpKerberosServerAction(request,httpUGI));
    }
 catch (    Exception e) {
      LOG.info("Failed to authenticate with http/_HOST kerberos principal, " + "trying with hive/_HOST kerberos principal");
    }
  }
  try {
    return serviceUGI.doAs(new HttpKerberosServerAction(request,serviceUGI));
  }
 catch (  Exception e) {
    LOG.error("Failed to authenticate with hive/_HOST kerberos principal");
    throw new HttpAuthenticationException(e);
  }
}
