{
  KerberosNameShim fullKerberosName;
  try {
    fullKerberosName=ShimLoader.getHadoopShims().getKerberosNameShim(fullPrincipal);
  }
 catch (  IOException e) {
    throw new HttpAuthenticationException(e);
  }
  String serviceName=fullKerberosName.getServiceName();
  String hostName=fullKerberosName.getHostName();
  String principalWithoutRealm=serviceName;
  if (hostName != null) {
    principalWithoutRealm=serviceName + "/" + hostName;
  }
  return principalWithoutRealm;
}
