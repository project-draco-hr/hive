{
  super(processor,protocolFactory);
  this.authType=authType;
  this.serviceUGI=serviceUGI;
  this.httpUGI=httpUGI;
  this.hiveAuthFactory=hiveAuthFactory;
  this.isCookieAuthEnabled=hiveConf.getBoolVar(ConfVars.HIVE_SERVER2_THRIFT_HTTP_COOKIE_AUTH_ENABLED);
  if (isCookieAuthEnabled) {
    String secret=Long.toString(RAN.nextLong());
    LOG.debug("Using the random number as the secret for cookie generation " + secret);
    this.signer=new CookieSigner(secret.getBytes());
    this.cookieMaxAge=(int)hiveConf.getTimeVar(ConfVars.HIVE_SERVER2_THRIFT_HTTP_COOKIE_MAX_AGE,TimeUnit.SECONDS);
    this.cookieDomain=hiveConf.getVar(ConfVars.HIVE_SERVER2_THRIFT_HTTP_COOKIE_DOMAIN);
    this.cookiePath=hiveConf.getVar(ConfVars.HIVE_SERVER2_THRIFT_HTTP_COOKIE_PATH);
    this.isCookieSecure=hiveConf.getBoolVar(ConfVars.HIVE_SERVER2_THRIFT_HTTP_COOKIE_IS_SECURE);
    this.isHttpOnlyCookie=hiveConf.getBoolVar(ConfVars.HIVE_SERVER2_THRIFT_HTTP_COOKIE_IS_HTTPONLY);
  }
}
