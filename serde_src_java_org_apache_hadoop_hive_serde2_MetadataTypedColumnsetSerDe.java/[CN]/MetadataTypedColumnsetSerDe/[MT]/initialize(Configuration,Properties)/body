{
  String altSep=tbl.getProperty(serdeConstants.SERIALIZATION_FORMAT);
  separator=getByteValue(altSep,DefaultSeparator);
  String altNull=tbl.getProperty(serdeConstants.SERIALIZATION_NULL_FORMAT);
  nullString=getByteValue(altNull,defaultNullString);
  String columnProperty=tbl.getProperty("columns");
  String serdeName=tbl.getProperty(serdeConstants.SERIALIZATION_LIB);
  boolean columnsetSerDe=false;
  if ((serdeName != null) && serdeName.equals("org.apache.hadoop.hive.serde.thrift.columnsetSerDe")) {
    columnsetSerDe=true;
  }
  if (columnProperty == null || columnProperty.length() == 0 || columnsetSerDe) {
    cachedObjectInspector=ObjectInspectorFactory.getReflectionObjectInspector(ColumnSet.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
 else {
    columnNames=Arrays.asList(columnProperty.split(","));
    cachedObjectInspector=MetadataListStructObjectInspector.getInstance(columnNames);
  }
  String lastColumnTakesRestString=tbl.getProperty(serdeConstants.SERIALIZATION_LAST_COLUMN_TAKES_REST);
  lastColumnTakesRest=(lastColumnTakesRestString != null && lastColumnTakesRestString.equalsIgnoreCase("true"));
  splitLimit=(lastColumnTakesRest && columnNames != null) ? columnNames.size() : -1;
  LOG.debug(getClass().getName() + ": initialized with columnNames: " + columnNames+ " and separator code="+ (int)separator.charAt(0)+ " lastColumnTakesRest="+ lastColumnTakesRest+ " splitLimit="+ splitLimit);
}
