{
  String alt_sep=tbl.getProperty(Constants.SERIALIZATION_FORMAT);
  separator=getByteValue(alt_sep,DefaultSeparator);
  String alt_null=tbl.getProperty(Constants.SERIALIZATION_NULL_FORMAT);
  nullString=getByteValue(alt_null,defaultNullString);
  String columnProperty=tbl.getProperty("columns");
  String serdeName=tbl.getProperty(Constants.SERIALIZATION_LIB);
  boolean columnsetSerDe=false;
  if ((serdeName != null) && serdeName.equals("org.apache.hadoop.hive.serde.thrift.columnsetSerDe")) {
    columnsetSerDe=true;
  }
  if (columnProperty == null || columnProperty.length() == 0 || columnsetSerDe) {
    cachedObjectInspector=ObjectInspectorFactory.getReflectionObjectInspector(ColumnSet.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
 else {
    columnNames=Arrays.asList(columnProperty.split(","));
    cachedObjectInspector=MetadataListStructObjectInspector.getInstance(columnNames);
  }
  LOG.debug(getClass().getName() + ": initialized with columnNames: " + columnNames+ " and separator code="+ (int)separator.charAt(0));
}
