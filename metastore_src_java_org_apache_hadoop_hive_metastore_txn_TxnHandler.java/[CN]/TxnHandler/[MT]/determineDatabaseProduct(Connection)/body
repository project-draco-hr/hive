{
  if (dbProduct == null) {
    try {
      String s=conn.getMetaData().getDatabaseProductName();
      if (s == null) {
        String msg="getDatabaseProductName returns null, can't determine database product";
        LOG.error(msg);
        throw new MetaException(msg);
      }
 else       if (s.equals("Apache Derby")) {
        dbProduct=DatabaseProduct.DERBY;
      }
 else       if (s.equals("Microsoft SQL Server")) {
        dbProduct=DatabaseProduct.SQLSERVER;
      }
 else       if (s.equals("MySQL")) {
        dbProduct=DatabaseProduct.MYSQL;
      }
 else       if (s.equals("Oracle")) {
        dbProduct=DatabaseProduct.ORACLE;
      }
 else       if (s.equals("PostgreSQL")) {
        dbProduct=DatabaseProduct.POSTGRES;
      }
 else {
        String msg="Unrecognized database product name <" + s + ">";
        LOG.error(msg);
        throw new MetaException(msg);
      }
    }
 catch (    SQLException e) {
      String msg="Unable to get database product name: " + e.getMessage();
      LOG.error(msg);
      throw new MetaException(msg);
    }
  }
  return dbProduct;
}
