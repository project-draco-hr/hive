{
  long txnid=rqst.getTxnid();
  try {
    Connection dbConn=getDbConn();
    try {
      Statement stmt=dbConn.createStatement();
      String s="delete from HIVE_LOCKS where hl_txnid = " + txnid;
      LOG.debug("Going to execute update <" + s + ">");
      stmt.executeUpdate(s);
      s="update TXNS set txn_state = '" + TXN_ABORTED + "' where txn_id = "+ txnid;
      LOG.debug("Going to execute update <" + s + ">");
      int updateCnt=stmt.executeUpdate(s);
      if (updateCnt != 1) {
        LOG.debug("Going to rollback");
        dbConn.rollback();
        throw new NoSuchTxnException("No such transaction: " + txnid);
      }
      LOG.debug("Going to commit");
      dbConn.commit();
    }
 catch (    SQLException e) {
      try {
        LOG.debug("Going to rollback");
        dbConn.rollback();
      }
 catch (      SQLException e1) {
      }
      detectDeadlock(e,"abortTxn");
      throw new MetaException("Unable to update transaction database " + StringUtils.stringifyException(e));
    }
 finally {
      closeDbConn(dbConn);
    }
  }
 catch (  DeadlockException e) {
    abortTxn(rqst);
  }
 finally {
    deadlockCnt=0;
  }
}
