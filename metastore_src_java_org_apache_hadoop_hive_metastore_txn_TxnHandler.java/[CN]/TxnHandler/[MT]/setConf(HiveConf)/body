{
  this.conf=conf;
  checkQFileTestHack();
  Connection dbConn=null;
  try {
    setupJdbcConnectionPool(conf);
    dbConn=getDbConn(Connection.TRANSACTION_READ_COMMITTED);
    determineDatabaseProduct(dbConn);
    sqlGenerator=new SQLGenerator(dbProduct,conf);
  }
 catch (  SQLException e) {
    String msg="Unable to instantiate JDBC connection pooling, " + e.getMessage();
    LOG.error(msg);
    throw new RuntimeException(e);
  }
 finally {
    closeDbConn(dbConn);
  }
  timeout=HiveConf.getTimeVar(conf,HiveConf.ConfVars.HIVE_TXN_TIMEOUT,TimeUnit.MILLISECONDS);
  buildJumpTable();
  retryInterval=HiveConf.getTimeVar(conf,HiveConf.ConfVars.HMSHANDLERINTERVAL,TimeUnit.MILLISECONDS);
  retryLimit=HiveConf.getIntVar(conf,HiveConf.ConfVars.HMSHANDLERATTEMPTS);
  deadlockRetryInterval=retryInterval / 10;
  maxOpenTxns=HiveConf.getIntVar(conf,HiveConf.ConfVars.HIVE_MAX_OPEN_TXNS);
  if (dumpConfig) {
    LOG.info(HiveConfUtil.dumpConfig(conf).toString());
    dumpConfig=false;
  }
}
