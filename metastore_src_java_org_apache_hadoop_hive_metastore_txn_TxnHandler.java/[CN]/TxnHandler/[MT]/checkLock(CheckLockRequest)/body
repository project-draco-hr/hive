{
  try {
    Connection dbConn=getDbConn(Connection.TRANSACTION_SERIALIZABLE);
    try {
      long extLockId=rqst.getLockid();
      timeOutLocks(dbConn);
      heartbeatLock(dbConn,extLockId);
      long txnid=getTxnIdFromLockId(dbConn,extLockId);
      if (txnid > 0)       heartbeatTxn(dbConn,txnid);
      return checkLock(dbConn,extLockId,true);
    }
 catch (    SQLException e) {
      try {
        LOG.debug("Going to rollback");
        dbConn.rollback();
      }
 catch (      SQLException e1) {
      }
      detectDeadlock(dbConn,e,"checkLock");
      throw new MetaException("Unable to update transaction database " + StringUtils.stringifyException(e));
    }
 finally {
      closeDbConn(dbConn);
    }
  }
 catch (  DeadlockException e) {
    return checkLock(rqst);
  }
 finally {
    deadlockCnt=0;
  }
}
