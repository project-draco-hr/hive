{
  if (ex instanceof SQLException) {
    SQLException sqlException=(SQLException)ex;
    if ("08S01".equalsIgnoreCase(sqlException.getSQLState())) {
      return true;
    }
    if ("ORA-08176".equalsIgnoreCase(sqlException.getSQLState()) || sqlException.getMessage().contains("consistent read failure; rollback data not available")) {
      return true;
    }
    String regex=HiveConf.getVar(conf,HiveConf.ConfVars.HIVE_TXN_RETRYABLE_SQLEX_REGEX);
    if (regex != null && !regex.isEmpty()) {
      String[] patterns=regex.split(",(?=\\S)");
      String message=getMessage((SQLException)ex);
      for (      String p : patterns) {
        if (Pattern.matches(p,message)) {
          return true;
        }
      }
    }
  }
  return false;
}
