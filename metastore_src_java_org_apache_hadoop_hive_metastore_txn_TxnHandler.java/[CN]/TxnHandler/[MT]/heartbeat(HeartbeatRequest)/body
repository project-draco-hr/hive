{
  try {
    Connection dbConn=null;
    try {
      dbConn=getDbConn(Connection.TRANSACTION_SERIALIZABLE);
      heartbeatLock(dbConn,ids.getLockid());
      heartbeatTxn(dbConn,ids.getTxnid());
    }
 catch (    SQLException e) {
      LOG.debug("Going to rollback");
      rollbackDBConn(dbConn);
      checkRetryable(dbConn,e,"heartbeat");
      throw new MetaException("Unable to select from transaction database " + StringUtils.stringifyException(e));
    }
 finally {
      closeDbConn(dbConn);
    }
  }
 catch (  RetryException e) {
    heartbeat(ids);
  }
 finally {
    deadlockCnt=0;
  }
}
