{
  if (connPool != null)   return;
  String driverUrl=HiveConf.getVar(conf,HiveConf.ConfVars.METASTORECONNECTURLKEY);
  String user=HiveConf.getVar(conf,HiveConf.ConfVars.METASTORE_CONNECTION_USER_NAME);
  String passwd=HiveConf.getVar(conf,HiveConf.ConfVars.METASTOREPWD);
  BoneCPConfig config=new BoneCPConfig();
  config.setJdbcUrl(driverUrl);
  config.setMaxConnectionsPerPartition(10);
  config.setPartitionCount(1);
  config.setUser(user);
  config.setPassword(passwd);
  connPool=new BoneCP(config);
}
