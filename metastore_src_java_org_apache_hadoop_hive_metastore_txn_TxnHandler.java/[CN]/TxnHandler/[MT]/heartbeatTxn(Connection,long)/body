{
  if (txnid == 0)   return;
  Statement stmt=null;
  try {
    stmt=dbConn.createStatement();
    long now=getDbTime(dbConn);
    ensureValidTxn(dbConn,txnid,stmt);
    String s="update TXNS set txn_last_heartbeat = " + now + " where txn_id = "+ txnid+ " and txn_state = '"+ TXN_OPEN+ "'";
    LOG.debug("Going to execute update <" + s + ">");
    int rc=stmt.executeUpdate(s);
    if (rc < 1) {
      ensureValidTxn(dbConn,txnid,stmt);
      LOG.warn("Can neither heartbeat txn nor confirm it as invalid.");
      dbConn.rollback();
      throw new NoSuchTxnException("No such txn: " + txnid);
    }
    s="update HIVE_LOCKS set hl_last_heartbeat = " + now + " where hl_txnid = "+ txnid;
    LOG.debug("Going to execute update <" + s + ">");
    stmt.executeUpdate(s);
    LOG.debug("Going to commit");
    dbConn.commit();
  }
  finally {
    closeStmt(stmt);
  }
}
