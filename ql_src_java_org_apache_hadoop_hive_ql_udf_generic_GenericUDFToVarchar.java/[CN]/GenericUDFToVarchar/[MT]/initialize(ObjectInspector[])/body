{
  if (arguments.length != 1) {
    throw new UDFArgumentException("VARCHAR cast requires a value argument");
  }
  try {
    argumentOI=(PrimitiveObjectInspector)arguments[0];
  }
 catch (  ClassCastException e) {
    throw new UDFArgumentException("The function VARCHAR takes only primitive types");
  }
  SettableHiveVarcharObjectInspector outputOI;
  if (typeParams != null) {
    outputOI=(SettableHiveVarcharObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveWritableObjectInspector(PrimitiveObjectInspectorUtils.getTypeEntryFromTypeSpecs(PrimitiveCategory.VARCHAR,typeParams));
  }
 else {
    outputOI=PrimitiveObjectInspectorFactory.writableHiveVarcharObjectInspector;
  }
  converter=new HiveVarcharConverter(argumentOI,outputOI);
  return outputOI;
}
