{
  writeLock.lock();
  try {
    if (!this.isStopped.getAndSet(true)) {
      pendingTaskSchedulerCallable.shutdown();
      if (pendingTaskSchedulerFuture != null) {
        pendingTaskSchedulerFuture.cancel(true);
      }
      executor.shutdownNow();
      if (registry != null) {
        registry.stop();
      }
      appCallbackExecutor.shutdownNow();
    }
  }
  finally {
    writeLock.unlock();
  }
}
