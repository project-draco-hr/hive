{
  registry.start();
  if (serviceHosts.size() > 0) {
    return;
  }
  LOG.info("Reading YARN registry for service records");
  try {
    Map<String,ServiceRecord> workers=registry.getWorkers();
    for (    ServiceRecord srv : workers.values()) {
      Endpoint rpc=srv.getInternalEndpoint("llap");
      if (rpc != null) {
        LOG.info("Examining endpoint: " + rpc);
        final String host=RegistryTypeUtils.getAddressField(rpc.addresses.get(0),AddressTypes.ADDRESS_HOSTNAME_FIELD);
        serviceHosts.add(host);
        serviceHostSet.add(host);
      }
 else {
        LOG.info("The SRV record was " + srv);
      }
    }
    LOG.info("Re-inited with configuration: " + "memoryPerInstance=" + memoryPerInstance + ", vcoresPerInstance="+ coresPerInstance+ ", executorsPerInstance="+ executorsPerInstance+ ", resourcePerInstanceInferred="+ resourcePerExecutor+ ", hosts="+ serviceHosts.toString());
  }
 catch (  IOException ioe) {
    throw new TezUncheckedException(ioe);
  }
}
