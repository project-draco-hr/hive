{
  NodeServiceInstancePair nsPair=selectHost(taskInfo);
  if (nsPair == null) {
    return false;
  }
 else {
    Container container=containerFactory.createContainer(resourcePerExecutor,taskInfo.priority,nsPair.getServiceInstance().getHost(),nsPair.getServiceInstance().getRpcPort());
    writeLock.lock();
    try {
      LOG.info("Assigned task {} to container {}",taskInfo,container.getId());
      dagStats.registerTaskAllocated(taskInfo.requestedHosts,taskInfo.requestedRacks,nsPair.getServiceInstance().getHost());
      taskInfo.setAssignmentInfo(nsPair.getServiceInstance(),container.getId(),clock.getTime());
      registerRunningTask(taskInfo);
      nsPair.getNodeInfo().registerTaskScheduled();
    }
  finally {
      writeLock.unlock();
    }
    getContext().taskAllocated(taskInfo.task,taskInfo.clientCookie,container);
    return true;
  }
}
