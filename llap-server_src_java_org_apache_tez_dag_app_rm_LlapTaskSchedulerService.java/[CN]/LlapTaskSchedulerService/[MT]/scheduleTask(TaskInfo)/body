{
  NodeServiceInstancePair nsPair=selectHost(taskInfo);
  if (nsPair == null) {
    return false;
  }
 else {
    Container container=containerFactory.createContainer(resourcePerExecutor,taskInfo.priority,nsPair.getServiceInstance().getHost(),nsPair.getServiceInstance().getRpcPort());
    writeLock.lock();
    try {
      dagStats.registerTaskAllocated(taskInfo.requestedHosts,taskInfo.requestedRacks,nsPair.getServiceInstance().getHost());
      taskInfo.setAssignmentInfo(nsPair.getServiceInstance(),container.getId());
      knownTasks.putIfAbsent(taskInfo.task,taskInfo);
      nsPair.getNodeInfo().registerTaskScheduled();
    }
  finally {
      writeLock.unlock();
    }
    appClientDelegate.taskAllocated(taskInfo.task,taskInfo.clientCookie,container);
    return true;
  }
}
