{
  String host=selectHost(taskInfo.requestedHosts);
  if (host == null) {
    return false;
  }
 else {
    Container container=containerFactory.createContainer(resourcePerExecutor,taskInfo.priority,host,containerPort);
    writeLock.lock();
    try {
      dagStats.registerTaskAllocated(taskInfo.requestedHosts,taskInfo.requestedRacks,host);
      taskInfo.setAssignmentInfo(host,container.getId());
      knownTasks.putIfAbsent(taskInfo.task,taskInfo);
      containerToHostMap.put(container.getId(),host);
    }
  finally {
      writeLock.unlock();
    }
    appClientDelegate.taskAllocated(taskInfo.task,taskInfo.clientCookie,container);
    return true;
  }
}
