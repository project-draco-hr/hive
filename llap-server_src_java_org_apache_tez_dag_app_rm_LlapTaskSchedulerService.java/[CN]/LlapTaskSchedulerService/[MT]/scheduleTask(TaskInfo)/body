{
  ServiceInstance host=selectHost(taskInfo);
  if (host == null) {
    return false;
  }
 else {
    Container container=containerFactory.createContainer(resourcePerExecutor,taskInfo.priority,host.getHost(),host.getRpcPort());
    writeLock.lock();
    try {
      dagStats.registerTaskAllocated(taskInfo.requestedHosts,taskInfo.requestedRacks,host.getHost());
      taskInfo.setAssignmentInfo(host,container.getId());
      knownTasks.putIfAbsent(taskInfo.task,taskInfo);
    }
  finally {
      writeLock.unlock();
    }
    appClientDelegate.taskAllocated(taskInfo.task,taskInfo.clientCookie,container);
    return true;
  }
}
