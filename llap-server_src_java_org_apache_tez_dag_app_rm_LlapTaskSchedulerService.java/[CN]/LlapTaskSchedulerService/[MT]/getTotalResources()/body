{
  int memory=0;
  int vcores=0;
  readLock.lock();
  try {
    for (    ServiceInstance inst : activeInstances.getAll().values()) {
      if (inst.isAlive()) {
        Resource r=inst.getResource();
        LOG.info("Found instance " + inst + " with "+ r);
        memory+=r.getMemory();
        vcores+=r.getVirtualCores();
      }
 else {
        LOG.info("Ignoring dead instance " + inst);
      }
    }
  }
  finally {
    readLock.unlock();
  }
  return Resource.newInstance(memory,vcores);
}
