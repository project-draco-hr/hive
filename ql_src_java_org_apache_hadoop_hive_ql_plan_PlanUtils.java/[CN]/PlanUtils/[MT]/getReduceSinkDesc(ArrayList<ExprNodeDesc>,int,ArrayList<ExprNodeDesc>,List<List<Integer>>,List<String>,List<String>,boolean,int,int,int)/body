{
  ArrayList<ExprNodeDesc> partitionCols=null;
  if (numPartitionFields >= keyCols.size()) {
    partitionCols=keyCols;
  }
 else   if (numPartitionFields >= 0) {
    partitionCols=new ArrayList<ExprNodeDesc>(numPartitionFields);
    for (int i=0; i < numPartitionFields; i++) {
      partitionCols.add(keyCols.get(i));
    }
  }
 else {
    partitionCols=new ArrayList<ExprNodeDesc>(1);
    partitionCols.add(TypeCheckProcFactory.DefaultExprProcessor.getFuncExprNodeDesc("rand"));
  }
  StringBuilder order=new StringBuilder();
  for (int i=0; i < keyCols.size(); i++) {
    order.append("+");
  }
  return getReduceSinkDesc(keyCols,numKeys,valueCols,distinctColIndices,outputKeyColumnNames,outputValueColumnNames,includeKey,tag,partitionCols,order.toString(),numReducers);
}
