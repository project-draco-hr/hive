{
  this.hiveconf=hiveconf;
  timeout=(int)HiveConf.getTimeVar(hiveconf,HiveConf.ConfVars.HIVE_STATS_JDBC_TIMEOUT,TimeUnit.SECONDS);
  connectionString=HiveConf.getVar(hiveconf,HiveConf.ConfVars.HIVESTATSDBCONNECTIONSTRING);
  String driver=HiveConf.getVar(hiveconf,HiveConf.ConfVars.HIVESTATSJDBCDRIVER);
  maxRetries=HiveConf.getIntVar(hiveconf,HiveConf.ConfVars.HIVE_STATS_RETRIES_MAX);
  waitWindow=HiveConf.getTimeVar(hiveconf,HiveConf.ConfVars.HIVE_STATS_RETRIES_WAIT,TimeUnit.MILLISECONDS);
  this.sourceTask=sourceTask;
  try {
    JavaUtils.loadClass(driver).newInstance();
  }
 catch (  Exception e) {
    LOG.error("Error during instantiating JDBC driver " + driver + ". ",e);
    return false;
  }
  DriverManager.setLoginTimeout(timeout);
  Utilities.SQLCommand<Void> setQueryTimeout=new Utilities.SQLCommand<Void>(){
    @Override public Void run(    PreparedStatement stmt) throws SQLException {
      stmt.setQueryTimeout(timeout);
      return null;
    }
  }
;
  for (int failures=0; ; failures++) {
    try {
      conn=Utilities.connectWithRetry(connectionString,waitWindow,maxRetries);
      for (      String statType : JDBCStatsUtils.getSupportedStatistics()) {
        PreparedStatement selStmt=Utilities.prepareWithRetry(conn,JDBCStatsUtils.getSelectAggr(statType,comment),waitWindow,maxRetries);
        columnMapping.put(statType,selStmt);
        Utilities.executeWithRetry(setQueryTimeout,selStmt,waitWindow,failures);
      }
      return true;
    }
 catch (    SQLRecoverableException e) {
      if (failures > maxRetries) {
        LOG.error("Error during JDBC connection and preparing statement: " + e);
        return false;
      }
      long waitTime=Utilities.getRandomWaitTime(waitWindow,failures,r);
      try {
        Thread.sleep(waitTime);
      }
 catch (      InterruptedException e1) {
      }
    }
catch (    SQLException e) {
      return false;
    }
  }
}
