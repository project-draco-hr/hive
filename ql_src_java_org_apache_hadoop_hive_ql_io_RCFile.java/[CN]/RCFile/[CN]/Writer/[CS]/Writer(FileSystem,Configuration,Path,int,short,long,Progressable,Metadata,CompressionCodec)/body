{
  RECORD_INTERVAL=HiveConf.getIntVar(conf,HIVE_RCFILE_RECORD_INTERVAL);
  columnNumber=HiveConf.getIntVar(conf,HIVE_RCFILE_COLUMN_NUMBER_CONF);
  if (metadata == null) {
    metadata=new Metadata();
  }
  metadata.set(new Text(COLUMN_NUMBER_METADATA_STR),new Text("" + columnNumber));
  columnsBufferSize=conf.getInt(COLUMNS_BUFFER_SIZE_CONF_STR,4 * 1024 * 1024);
  columnValuePlainLength=new int[columnNumber];
  columnBuffers=new ColumnBuffer[columnNumber];
  for (int i=0; i < columnNumber; i++) {
    columnBuffers[i]=new ColumnBuffer();
  }
  init(conf,fs.create(name,true,bufferSize,replication,blockSize,progress),codec,metadata);
  initializeFileHeader();
  writeFileHeader();
  finalizeFileHeader();
  key=new KeyBuffer(columnNumber);
  plainTotalColumnLength=new int[columnNumber];
  comprTotalColumnLength=new int[columnNumber];
}
