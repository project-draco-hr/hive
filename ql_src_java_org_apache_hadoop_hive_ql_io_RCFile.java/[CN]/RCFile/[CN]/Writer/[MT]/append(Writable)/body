{
  if (!(val instanceof BytesRefArrayWritable))   throw new UnsupportedOperationException("Currently the writer can only accept BytesRefArrayWritable");
  BytesRefArrayWritable columns=(BytesRefArrayWritable)val;
  int size=columns.size();
  for (int i=0; i < size; i++) {
    BytesRefWritable cu=columns.get(i);
    int plainLen=cu.getLength();
    columnBufferSize+=plainLen;
    columnValuePlainLength[i]+=plainLen;
    columnBuffers[i].append(cu);
  }
  if (size < columnNumber) {
    for (int i=columns.size(); i < columnNumber; i++) {
      columnBuffers[i].append(BytesRefWritable.ZeroBytesRefWritable);
    }
  }
  bufferedRecords++;
  if ((columnBufferSize > columnsBufferSize) || (bufferedRecords >= RECORD_INTERVAL)) {
    flushRecords();
  }
}
