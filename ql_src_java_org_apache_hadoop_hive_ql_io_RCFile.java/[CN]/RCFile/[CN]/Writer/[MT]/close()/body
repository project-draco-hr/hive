{
  if (bufferedRecords > 0)   flushRecords();
  clearColumnBuffers();
  if (isCompressed()) {
    for (int i=0; i < columnNumber; i++) {
      deflateFilter[i].close();
      IOUtils.closeStream(deflateOut[i]);
    }
    keyDeflateFilter.close();
    IOUtils.closeStream(keyDeflateOut);
    CodecPool.returnCompressor(keyCompressor);
    keyCompressor=null;
    CodecPool.returnCompressor(compressor);
    compressor=null;
  }
  if (out != null) {
    out.flush();
    out.close();
    out=null;
  }
}
