{
  if (in.getPos() >= end) {
    return -1;
  }
  int length=in.readInt();
  if (sync != null && length == SYNC_ESCAPE) {
    lastSeenSyncPos=in.getPos() - 4;
    in.readFully(syncCheck);
    if (!Arrays.equals(sync,syncCheck)) {
      throw new IOException("File is corrupt!");
    }
    syncSeen=true;
    if (in.getPos() >= end) {
      return -1;
    }
    length=in.readInt();
  }
 else {
    syncSeen=false;
  }
  return length;
}
