{
  ResultSet rs=new HiveMetaDataResultSet(Arrays.asList("key"),Arrays.asList("long"),Arrays.asList(1234,"1234","abc")){
    private int cnt=1;
    public boolean next() throws SQLException {
      if (cnt < data.size()) {
        row=Arrays.asList(data.get(cnt));
        cnt++;
        return true;
      }
 else {
        return false;
      }
    }
  }
;
  while (rs.next()) {
    String key=rs.getString("key");
    if ("1234".equals(key)) {
      assertEquals("Converting a string column into a long failed.",rs.getLong("key"),1234L);
      assertEquals("Converting a string column into a int failed.",rs.getInt("key"),1234);
    }
 else     if ("abc".equals(key)) {
      Object result=null;
      Exception expectedException=null;
      try {
        result=rs.getLong("key");
      }
 catch (      SQLException e) {
        expectedException=e;
      }
      assertTrue("Trying to convert 'abc' into a long should not work.",expectedException != null);
      try {
        result=rs.getInt("key");
      }
 catch (      SQLException e) {
        expectedException=e;
      }
      assertTrue("Trying to convert 'abc' into a int should not work.",expectedException != null);
    }
  }
}
