{
  Category typeCategory=fieldTypeInfo.getCategory();
  if (Category.PRIMITIVE == typeCategory) {
    return new HCatFieldSchema(fieldName,getPrimitiveHType(fieldTypeInfo),null);
  }
 else   if (Category.STRUCT == typeCategory) {
    HCatSchema subSchema=constructHCatSchema((StructTypeInfo)fieldTypeInfo);
    return new HCatFieldSchema(fieldName,HCatFieldSchema.Type.STRUCT,subSchema,null);
  }
 else   if (Category.LIST == typeCategory) {
    HCatSchema subSchema=getHCatSchema(((ListTypeInfo)fieldTypeInfo).getListElementTypeInfo());
    return new HCatFieldSchema(fieldName,HCatFieldSchema.Type.ARRAY,subSchema,null);
  }
 else   if (Category.MAP == typeCategory) {
    HCatFieldSchema.Type mapKeyType=getPrimitiveHType(((MapTypeInfo)fieldTypeInfo).getMapKeyTypeInfo());
    HCatSchema subSchema=getHCatSchema(((MapTypeInfo)fieldTypeInfo).getMapValueTypeInfo());
    return new HCatFieldSchema(fieldName,HCatFieldSchema.Type.MAP,mapKeyType,subSchema,null);
  }
 else {
    throw new TypeNotPresentException(fieldTypeInfo.getTypeName(),null);
  }
}
