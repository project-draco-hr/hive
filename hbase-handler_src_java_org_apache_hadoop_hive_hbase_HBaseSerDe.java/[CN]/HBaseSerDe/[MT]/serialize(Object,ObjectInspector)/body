{
  if (objInspector.getCategory() != Category.STRUCT) {
    throw new SerDeException(getClass().toString() + " can only serialize struct types, but we got: " + objInspector.getTypeName());
  }
  StructObjectInspector soi=(StructObjectInspector)objInspector;
  List<? extends StructField> fields=soi.getAllStructFieldRefs();
  List<Object> list=soi.getStructFieldsDataAsList(obj);
  List<? extends StructField> declaredFields=(serdeParams.getRowTypeInfo() != null && ((StructTypeInfo)serdeParams.getRowTypeInfo()).getAllStructFieldNames().size() > 0) ? ((StructObjectInspector)getObjectInspector()).getAllStructFieldRefs() : null;
  Put put=null;
  try {
    byte[] key=serializeField(iKey,null,fields,list,declaredFields);
    if (key == null) {
      throw new SerDeException("HBase row key cannot be NULL");
    }
    if (putTimestamp >= 0) {
      put=new Put(key,putTimestamp);
    }
 else {
      put=new Put(key);
    }
    for (int i=0; i < fields.size(); i++) {
      if (i == iKey) {
        continue;
      }
      serializeField(i,put,fields,list,declaredFields);
    }
  }
 catch (  IOException e) {
    throw new SerDeException(e);
  }
  return put;
}
