{
  ColumnMapping colMap=columnsMapping.get(i);
  ObjectInspector foi=fields.get(i).getFieldObjectInspector();
  Object f=(list == null ? null : list.get(i));
  if (f == null) {
    return null;
  }
  if (colMap.qualifierName == null && !colMap.hbaseRowKey) {
    MapObjectInspector moi=(MapObjectInspector)foi;
    ObjectInspector koi=moi.getMapKeyObjectInspector();
    ObjectInspector voi=moi.getMapValueObjectInspector();
    Map<?,?> map=moi.getMap(f);
    if (map == null) {
      return null;
    }
 else {
      for (      Map.Entry<?,?> entry : map.entrySet()) {
        serializeStream.reset();
        boolean isNotNull=serialize(entry.getKey(),koi,3,colMap.binaryStorage.get(0));
        if (!isNotNull) {
          continue;
        }
        byte[] columnQualifierBytes=new byte[serializeStream.getCount()];
        System.arraycopy(serializeStream.getData(),0,columnQualifierBytes,0,serializeStream.getCount());
        serializeStream.reset();
        isNotNull=serialize(entry.getValue(),voi,3,colMap.binaryStorage.get(1));
        if (!isNotNull) {
          continue;
        }
        byte[] value=new byte[serializeStream.getCount()];
        System.arraycopy(serializeStream.getData(),0,value,0,serializeStream.getCount());
        put.add(colMap.familyNameBytes,columnQualifierBytes,value);
      }
    }
  }
 else {
    serializeStream.reset();
    boolean isNotNull;
    if (!foi.getCategory().equals(Category.PRIMITIVE) && (declaredFields == null || declaredFields.get(i).getFieldObjectInspector().getCategory().equals(Category.PRIMITIVE) || useJSONSerialize)) {
      isNotNull=serialize(SerDeUtils.getJSONString(f,foi),PrimitiveObjectInspectorFactory.javaStringObjectInspector,1,false);
    }
 else {
      isNotNull=serialize(f,foi,1,colMap.binaryStorage.get(0));
    }
    if (!isNotNull) {
      return null;
    }
    byte[] key=new byte[serializeStream.getCount()];
    System.arraycopy(serializeStream.getData(),0,key,0,serializeStream.getCount());
    if (i == iKey) {
      return key;
    }
    put.add(colMap.familyNameBytes,colMap.qualifierNameBytes,key);
  }
  return null;
}
