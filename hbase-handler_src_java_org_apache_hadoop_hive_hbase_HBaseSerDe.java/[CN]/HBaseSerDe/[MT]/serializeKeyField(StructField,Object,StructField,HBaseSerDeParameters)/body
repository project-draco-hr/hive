{
  if (keyValue == null) {
    return null;
  }
  boolean writeBinary=serdeParams.getKeyColumnMapping().binaryStorage.get(0);
  ObjectInspector keyFieldOI=keyField.getFieldObjectInspector();
  if (!keyFieldOI.getCategory().equals(Category.PRIMITIVE) && declaredKeyField.getFieldObjectInspector().getCategory().equals(Category.PRIMITIVE)) {
    return serialize(SerDeUtils.getJSONString(keyValue,keyFieldOI),PrimitiveObjectInspectorFactory.javaStringObjectInspector,1,false,serdeParams);
  }
 else {
    return serialize(keyValue,keyFieldOI,1,writeBinary,serdeParams);
  }
}
