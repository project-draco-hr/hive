{
  ObjectInspector foi=fields.get(i).getFieldObjectInspector();
  Object f=(list == null ? null : list.get(i));
  if (f == null) {
    return null;
  }
  if (hbaseColumn.endsWith(":")) {
    MapObjectInspector moi=(MapObjectInspector)foi;
    ObjectInspector koi=moi.getMapKeyObjectInspector();
    ObjectInspector voi=moi.getMapValueObjectInspector();
    Map<?,?> map=moi.getMap(f);
    if (map == null) {
      return null;
    }
 else {
      for (      Map.Entry<?,?> entry : map.entrySet()) {
        serializeStream.reset();
        serialize(serializeStream,entry.getKey(),koi,serdeParams.getSeparators(),3,serdeParams.getNullSequence(),serdeParams.isEscaped(),serdeParams.getEscapeChar(),serdeParams.getNeedsEscape());
        String hbaseSparseColumn=hbaseColumn + Bytes.toString(serializeStream.getData(),0,serializeStream.getCount());
        serializeStream.reset();
        boolean isNotNull=serialize(serializeStream,entry.getValue(),voi,serdeParams.getSeparators(),3,serdeParams.getNullSequence(),serdeParams.isEscaped(),serdeParams.getEscapeChar(),serdeParams.getNeedsEscape());
        if (!isNotNull) {
          continue;
        }
        byte[] key=new byte[serializeStream.getCount()];
        System.arraycopy(serializeStream.getData(),0,key,0,serializeStream.getCount());
        batchUpdate.put(hbaseSparseColumn,key);
      }
    }
  }
 else {
    serializeStream.reset();
    boolean isNotNull;
    if (!foi.getCategory().equals(Category.PRIMITIVE) && (declaredFields == null || declaredFields.get(i).getFieldObjectInspector().getCategory().equals(Category.PRIMITIVE) || useJSONSerialize)) {
      isNotNull=serialize(serializeStream,SerDeUtils.getJSONString(f,foi),PrimitiveObjectInspectorFactory.javaStringObjectInspector,serdeParams.getSeparators(),1,serdeParams.getNullSequence(),serdeParams.isEscaped(),serdeParams.getEscapeChar(),serdeParams.getNeedsEscape());
    }
 else {
      isNotNull=serialize(serializeStream,f,foi,serdeParams.getSeparators(),1,serdeParams.getNullSequence(),serdeParams.isEscaped(),serdeParams.getEscapeChar(),serdeParams.getNeedsEscape());
    }
    if (!isNotNull) {
      return null;
    }
    byte[] key=new byte[serializeStream.getCount()];
    System.arraycopy(serializeStream.getData(),0,key,0,serializeStream.getCount());
    if (hbaseColumn.equals(HBASE_KEY_COL)) {
      return key;
    }
    batchUpdate.put(hbaseColumn,key);
  }
  return null;
}
