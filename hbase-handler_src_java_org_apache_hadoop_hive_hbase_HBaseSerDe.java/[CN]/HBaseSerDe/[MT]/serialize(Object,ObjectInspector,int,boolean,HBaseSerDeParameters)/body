{
  ByteStream.Output ss=new ByteStream.Output();
  if (objInspector.getCategory() == Category.PRIMITIVE && writeBinary) {
    LazyUtils.writePrimitive(ss,obj,(PrimitiveObjectInspector)objInspector);
  }
 else {
    if (false == serialize(obj,objInspector,level,serdeParams,ss)) {
      return null;
    }
  }
  return getBytesFromStream(ss);
}
