{
switch (objInspector.getCategory()) {
case PRIMITIVE:
{
      LazyUtils.writePrimitiveUTF8(serializeStream,obj,(PrimitiveObjectInspector)objInspector,escaped,escapeChar,needsEscape);
      return true;
    }
case LIST:
{
    char separator=(char)separators[level];
    ListObjectInspector loi=(ListObjectInspector)objInspector;
    List<?> list=loi.getList(obj);
    ObjectInspector eoi=loi.getListElementObjectInspector();
    if (list == null) {
      return false;
    }
 else {
      for (int i=0; i < list.size(); i++) {
        if (i > 0) {
          serializeStream.write(separator);
        }
        serialize(list.get(i),eoi,level + 1);
      }
    }
    return true;
  }
case MAP:
{
  char separator=(char)separators[level];
  char keyValueSeparator=(char)separators[level + 1];
  MapObjectInspector moi=(MapObjectInspector)objInspector;
  ObjectInspector koi=moi.getMapKeyObjectInspector();
  ObjectInspector voi=moi.getMapValueObjectInspector();
  Map<?,?> map=moi.getMap(obj);
  if (map == null) {
    return false;
  }
 else {
    boolean first=true;
    for (    Map.Entry<?,?> entry : map.entrySet()) {
      if (first) {
        first=false;
      }
 else {
        serializeStream.write(separator);
      }
      serialize(entry.getKey(),koi,level + 2);
      serializeStream.write(keyValueSeparator);
      serialize(entry.getValue(),voi,level + 2);
    }
  }
  return true;
}
case STRUCT:
{
char separator=(char)separators[level];
StructObjectInspector soi=(StructObjectInspector)objInspector;
List<? extends StructField> fields=soi.getAllStructFieldRefs();
List<Object> list=soi.getStructFieldsDataAsList(obj);
if (list == null) {
  return false;
}
 else {
  for (int i=0; i < list.size(); i++) {
    if (i > 0) {
      serializeStream.write(separator);
    }
    serialize(list.get(i),fields.get(i).getFieldObjectInspector(),level + 1);
  }
}
return true;
}
}
throw new RuntimeException("Unknown category type: " + objInspector.getCategory());
}
