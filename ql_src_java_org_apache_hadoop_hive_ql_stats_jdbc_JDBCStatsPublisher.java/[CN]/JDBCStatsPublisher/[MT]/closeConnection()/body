{
  if (conn == null) {
    return true;
  }
  try {
    if (updStmt != null) {
      updStmt.close();
    }
    if (insStmt != null) {
      insStmt.close();
    }
    conn.close();
    if (HiveConf.getVar(hiveconf,HiveConf.ConfVars.HIVESTATSDBCLASS).equalsIgnoreCase("jdbc:derby")) {
      try {
synchronized (DriverManager.class) {
          DriverManager.getConnection(connectionString + ";shutdown=true");
        }
      }
 catch (      Exception e) {
      }
    }
    return true;
  }
 catch (  SQLException e) {
    LOG.error("Error during JDBC termination. ",e);
    return false;
  }
}
