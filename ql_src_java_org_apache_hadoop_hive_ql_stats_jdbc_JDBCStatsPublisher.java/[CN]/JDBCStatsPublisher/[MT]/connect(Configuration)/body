{
  try {
    this.hiveconf=hiveconf;
    connectionString=HiveConf.getVar(hiveconf,HiveConf.ConfVars.HIVESTATSDBCONNECTIONSTRING);
    timeout=HiveConf.getIntVar(hiveconf,HiveConf.ConfVars.HIVE_STATS_JDBC_TIMEOUT);
    String driver=HiveConf.getVar(hiveconf,HiveConf.ConfVars.HIVESTATSJDBCDRIVER);
    Class.forName(driver).newInstance();
    DriverManager.setLoginTimeout(timeout);
    conn=DriverManager.getConnection(connectionString);
    String select="SELECT /* " + comment + " */ "+ JDBCStatsSetupConstants.PART_STAT_ROW_COUNT_COLUMN_NAME+ " FROM "+ JDBCStatsSetupConstants.PART_STAT_TABLE_NAME+ " WHERE "+ JDBCStatsSetupConstants.PART_STAT_ID_COLUMN_NAME+ " = ?";
    String update="UPDATE /* " + comment + " */ "+ JDBCStatsSetupConstants.PART_STAT_TABLE_NAME+ " SET "+ JDBCStatsSetupConstants.PART_STAT_ROW_COUNT_COLUMN_NAME+ "= ? "+ " WHERE "+ JDBCStatsSetupConstants.PART_STAT_ID_COLUMN_NAME+ " = ?";
    String insert="INSERT INTO /* " + comment + " */ "+ JDBCStatsSetupConstants.PART_STAT_TABLE_NAME+ " VALUES (?, ?)";
    selStmt=conn.prepareStatement(select);
    updStmt=conn.prepareStatement(update);
    insStmt=conn.prepareStatement(insert);
    selStmt.setQueryTimeout(timeout);
    updStmt.setQueryTimeout(timeout);
    insStmt.setQueryTimeout(timeout);
    return true;
  }
 catch (  Exception e) {
    LOG.error("Error during JDBC connection to " + connectionString + ". ",e);
    return false;
  }
}
