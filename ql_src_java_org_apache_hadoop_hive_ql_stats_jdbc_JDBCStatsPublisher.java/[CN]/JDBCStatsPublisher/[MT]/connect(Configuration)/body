{
  try {
    this.hiveconf=hiveconf;
    connectionString=HiveConf.getVar(hiveconf,HiveConf.ConfVars.HIVESTATSDBCONNECTIONSTRING);
    String driver=HiveConf.getVar(hiveconf,HiveConf.ConfVars.HIVESTATSJDBCDRIVER);
    Class.forName(driver).newInstance();
    DriverManager.setLoginTimeout(3);
    conn=DriverManager.getConnection(connectionString);
    String select="SELECT " + JDBCStatsSetupConstants.PART_STAT_ROW_COUNT_COLUMN_NAME + " FROM "+ JDBCStatsSetupConstants.PART_STAT_TABLE_NAME+ " WHERE "+ JDBCStatsSetupConstants.PART_STAT_ID_COLUMN_NAME+ " = ?";
    String update="UPDATE " + JDBCStatsSetupConstants.PART_STAT_TABLE_NAME + " SET "+ JDBCStatsSetupConstants.PART_STAT_ROW_COUNT_COLUMN_NAME+ "= ? "+ " WHERE "+ JDBCStatsSetupConstants.PART_STAT_ID_COLUMN_NAME+ " = ?";
    String insert="INSERT INTO " + JDBCStatsSetupConstants.PART_STAT_TABLE_NAME + " VALUES (?, ?)";
    selStmt=conn.prepareStatement(select);
    updStmt=conn.prepareStatement(update);
    insStmt=conn.prepareStatement(insert);
    selStmt.setQueryTimeout(5);
    updStmt.setQueryTimeout(5);
    insStmt.setQueryTimeout(5);
    return true;
  }
 catch (  Exception e) {
    LOG.error("Error during JDBC connection to " + connectionString + ". ",e);
    return false;
  }
}
