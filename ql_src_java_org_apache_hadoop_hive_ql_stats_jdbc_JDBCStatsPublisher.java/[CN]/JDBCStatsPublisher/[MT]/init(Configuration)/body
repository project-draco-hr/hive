{
  Statement stmt=null;
  ResultSet rs=null;
  try {
    this.hiveconf=hconf;
    connectionString=HiveConf.getVar(hconf,HiveConf.ConfVars.HIVESTATSDBCONNECTIONSTRING);
    String driver=HiveConf.getVar(hconf,HiveConf.ConfVars.HIVESTATSJDBCDRIVER);
    Class.forName(driver).newInstance();
synchronized (DriverManager.class) {
      DriverManager.setLoginTimeout(timeout);
      conn=DriverManager.getConnection(connectionString);
      stmt=conn.createStatement();
      stmt.setQueryTimeout(timeout);
      DatabaseMetaData dbm=conn.getMetaData();
      rs=dbm.getTables(null,null,JDBCStatsUtils.getStatTableName(),null);
      boolean tblExists=rs.next();
      if (!tblExists) {
        String createTable=JDBCStatsUtils.getCreate("");
        stmt.executeUpdate(createTable);
      }
    }
  }
 catch (  Exception e) {
    LOG.error("Error during JDBC initialization. ",e);
    return false;
  }
 finally {
    if (rs != null) {
      try {
        rs.close();
      }
 catch (      SQLException e) {
      }
    }
    if (stmt != null) {
      try {
        stmt.close();
      }
 catch (      SQLException e) {
      }
    }
    closeConnection();
  }
  return true;
}
