{
  try {
    this.hiveconf=hconf;
    connectionString=HiveConf.getVar(hconf,HiveConf.ConfVars.HIVESTATSDBCONNECTIONSTRING);
    String driver=HiveConf.getVar(hconf,HiveConf.ConfVars.HIVESTATSJDBCDRIVER);
    Class.forName(driver).newInstance();
    conn=DriverManager.getConnection(connectionString);
    Statement stmt=conn.createStatement();
    DatabaseMetaData dbm=conn.getMetaData();
    ResultSet rs=dbm.getTables(null,null,JDBCStatsSetupConstants.PART_STAT_TABLE_NAME,null);
    boolean tblExists=rs.next();
    if (!tblExists) {
      String createTable="CREATE TABLE " + JDBCStatsSetupConstants.PART_STAT_TABLE_NAME + " ("+ JDBCStatsSetupConstants.PART_STAT_ID_COLUMN_NAME+ " VARCHAR(255), "+ JDBCStatsSetupConstants.PART_STAT_ROW_COUNT_COLUMN_NAME+ " BIGINT)";
      stmt.executeUpdate(createTable);
      stmt.close();
    }
    closeConnection();
  }
 catch (  Exception e) {
    LOG.error("Error during JDBC initialization. ",e);
    return false;
  }
  return true;
}
