{
  int minAllocation=HiveConf.getIntVar(conf,ConfVars.LLAP_ORC_CACHE_MIN_ALLOC);
  long maxSize=HiveConf.getLongVar(conf,ConfVars.LLAP_ORC_CACHE_MAX_SIZE);
  cachePolicy=HiveConf.getBoolVar(conf,HiveConf.ConfVars.LLAP_USE_LRFU) ? new LowLevelLrfuCachePolicy(conf,minAllocation,maxSize,this) : new LowLevelFifoCachePolicy(minAllocation,maxSize,this);
  allocator=new BuddyAllocator(conf,cachePolicy);
  cleanupThread=new CleanupThread();
  cleanupThread.start();
}
