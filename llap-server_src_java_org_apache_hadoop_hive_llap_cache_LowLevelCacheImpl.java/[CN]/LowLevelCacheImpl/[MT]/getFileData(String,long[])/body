{
  LlapMemoryBuffer[] result=null;
  FileCache subCache=cache.get(fileName);
  if (subCache == null || !subCache.incRef())   return result;
  try {
    for (int i=0; i < offsets.length; ++i) {
      while (true) {
        long offset=offsets[i];
        LlapCacheableBuffer buffer=subCache.cache.get(offset);
        if (buffer == null)         break;
        if (lockBuffer(buffer)) {
          if (result == null) {
            result=new LlapCacheableBuffer[offsets.length];
          }
          result[i]=buffer;
          break;
        }
        if (subCache.cache.remove(offset,buffer))         break;
      }
    }
  }
  finally {
    subCache.decRef();
  }
  return result;
}
