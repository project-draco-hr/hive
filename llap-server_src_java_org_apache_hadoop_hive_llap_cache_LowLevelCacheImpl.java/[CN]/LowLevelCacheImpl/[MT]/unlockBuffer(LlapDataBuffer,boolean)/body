{
  boolean isLastDecref=(buffer.decRef() == 0);
  if (handleLastDecRef && isLastDecref) {
    if (buffer.declaredCachedLength != LlapDataBuffer.UNKNOWN_CACHED_LENGTH) {
      cachePolicy.notifyUnlock(buffer);
    }
 else {
      allocator.deallocate(buffer);
    }
  }
  metrics.decrCacheNumLockedBuffers();
}
