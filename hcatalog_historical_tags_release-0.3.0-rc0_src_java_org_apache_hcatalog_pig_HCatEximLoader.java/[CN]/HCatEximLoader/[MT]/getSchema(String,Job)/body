{
  LOG.debug("getSchema with location :" + location);
  if (tableSchema == null) {
    List<HCatSchema> rv=HCatEximInputFormat.setInput(job,location,null);
    tableSchema=rv.get(0);
    partitionSchema=rv.get(1);
  }
  LOG.debug("getSchema got schema :" + tableSchema.toString());
  List<HCatFieldSchema> colsPlusPartKeys=new ArrayList<HCatFieldSchema>();
  colsPlusPartKeys.addAll(tableSchema.getFields());
  colsPlusPartKeys.addAll(partitionSchema.getFields());
  outputSchema=new HCatSchema(colsPlusPartKeys);
  return PigHCatUtil.getResourceSchema(outputSchema);
}
