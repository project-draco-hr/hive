{
  HiveConf hiveConf=ctx.getConf();
  GroupByOptimizerSortMatch match=checkSortGroupBy(stack,groupByOp);
  boolean useMapperSort=HiveConf.getBoolVar(hiveConf,HiveConf.ConfVars.HIVE_MAP_GROUPBY_SORT);
  if (useMapperSort && !groupByOp.getConf().isDistinct() && (match == GroupByOptimizerSortMatch.COMPLETE_MATCH)) {
    convertGroupByMapSideSortedGroupBy(hiveConf,groupByOp,depth);
  }
 else   if ((match == GroupByOptimizerSortMatch.PARTIAL_MATCH) || (match == GroupByOptimizerSortMatch.COMPLETE_MATCH)) {
    groupByOp.getConf().setBucketGroup(true);
  }
}
