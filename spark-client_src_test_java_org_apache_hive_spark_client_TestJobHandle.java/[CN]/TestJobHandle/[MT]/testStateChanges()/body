{
  JobHandleImpl<Serializable> handle=new JobHandleImpl<Serializable>(client,promise,"job");
  handle.addListener(listener);
  assertTrue(handle.changeState(JobHandle.State.QUEUED));
  verify(listener).onJobQueued(handle);
  assertTrue(handle.changeState(JobHandle.State.STARTED));
  verify(listener).onJobStarted(handle);
  handle.addSparkJobId(1);
  verify(listener).onSparkJobStarted(same(handle),eq(1));
  assertTrue(handle.changeState(JobHandle.State.CANCELLED));
  verify(listener).onJobCancelled(handle);
  assertFalse(handle.changeState(JobHandle.State.STARTED));
  assertFalse(handle.changeState(JobHandle.State.FAILED));
  assertFalse(handle.changeState(JobHandle.State.SUCCEEDED));
}
