{
  if (arguments.length != 1) {
    throw new UDFArgumentLengthException("last_day() requires 1 argument, got " + arguments.length);
  }
  if (arguments[0].getCategory() != ObjectInspector.Category.PRIMITIVE) {
    throw new UDFArgumentTypeException(0,"Only primitive type arguments are accepted but " + arguments[0].getTypeName() + " is passed. as first arguments");
  }
  inputType1=((PrimitiveObjectInspector)arguments[0]).getPrimitiveCategory();
  ObjectInspector outputOI=PrimitiveObjectInspectorFactory.writableStringObjectInspector;
switch (inputType1) {
case STRING:
case VARCHAR:
case CHAR:
    inputType1=PrimitiveCategory.STRING;
  textConverter=ObjectInspectorConverters.getConverter((PrimitiveObjectInspector)arguments[0],PrimitiveObjectInspectorFactory.writableStringObjectInspector);
break;
case TIMESTAMP:
timestampConverter=new TimestampConverter((PrimitiveObjectInspector)arguments[0],PrimitiveObjectInspectorFactory.writableTimestampObjectInspector);
break;
case DATE:
dateWritableConverter=ObjectInspectorConverters.getConverter((PrimitiveObjectInspector)arguments[0],PrimitiveObjectInspectorFactory.writableDateObjectInspector);
break;
default :
throw new UDFArgumentException(" LAST_DAY() only takes STRING/TIMESTAMP/DATEWRITABLE types as first argument, got " + inputType1);
}
return outputOI;
}
