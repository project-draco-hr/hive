{
  Task<? extends Serializable> currTask=task;
  mapredWork plan=(mapredWork)currTask.getWork();
  Operator<? extends Serializable> currTopOp=opProcCtx.getCurrTopOp();
  if (oldTask != null) {
    splitTasks(op,oldTask,currTask,opProcCtx);
  }
  if (currTopOp != null) {
    List<Operator<? extends Serializable>> seenOps=opProcCtx.getSeenOps();
    String currAliasId=opProcCtx.getCurrAliasId();
    if (!seenOps.contains(currTopOp)) {
      seenOps.add(currTopOp);
      setTaskPlan(currAliasId,currTopOp,op,plan,false,opProcCtx);
    }
    currTopOp=null;
    opProcCtx.setCurrTopOp(currTopOp);
  }
  opProcCtx.setCurrTask(currTask);
}
