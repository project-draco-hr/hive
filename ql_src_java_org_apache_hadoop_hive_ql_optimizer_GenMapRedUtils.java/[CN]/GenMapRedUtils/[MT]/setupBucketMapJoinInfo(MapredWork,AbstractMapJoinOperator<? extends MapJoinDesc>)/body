{
  if (currMapJoinOp != null) {
    LinkedHashMap<String,LinkedHashMap<String,ArrayList<String>>> aliasBucketFileNameMapping=currMapJoinOp.getConf().getAliasBucketFileNameMapping();
    if (aliasBucketFileNameMapping != null) {
      MapredLocalWork localPlan=plan.getMapLocalWork();
      if (localPlan == null) {
        if (currMapJoinOp instanceof SMBMapJoinOperator) {
          localPlan=((SMBMapJoinOperator)currMapJoinOp).getConf().getLocalWork();
        }
        if (localPlan == null) {
          localPlan=new MapredLocalWork(new LinkedHashMap<String,Operator<? extends Serializable>>(),new LinkedHashMap<String,FetchWork>());
        }
      }
 else {
        if (currMapJoinOp instanceof SMBMapJoinOperator) {
          MapredLocalWork smbLocalWork=((SMBMapJoinOperator)currMapJoinOp).getConf().getLocalWork();
          if (smbLocalWork != null) {
            localPlan.getAliasToFetchWork().putAll(smbLocalWork.getAliasToFetchWork());
            localPlan.getAliasToWork().putAll(smbLocalWork.getAliasToWork());
          }
        }
      }
      if (currMapJoinOp instanceof SMBMapJoinOperator) {
        plan.setMapLocalWork(null);
        ((SMBMapJoinOperator)currMapJoinOp).getConf().setLocalWork(localPlan);
      }
 else {
        plan.setMapLocalWork(localPlan);
      }
      BucketMapJoinContext bucketMJCxt=new BucketMapJoinContext();
      localPlan.setBucketMapjoinContext(bucketMJCxt);
      bucketMJCxt.setAliasBucketFileNameMapping(aliasBucketFileNameMapping);
      localPlan.setInputFileChangeSensitive(true);
      bucketMJCxt.setMapJoinBigTableAlias(currMapJoinOp.getConf().getBigTableAlias());
      bucketMJCxt.setBucketMatcherClass(org.apache.hadoop.hive.ql.exec.DefaultBucketMatcher.class);
    }
  }
}
