{
  String dest=null;
  if (chDir) {
    dest=fsOp.getConf().getFinalDirName();
    Context baseCtx=parseCtx.getContext();
    String tmpDir=baseCtx.getExternalTmpFileURI((new Path(dest)).toUri());
    FileSinkDesc fileSinkDesc=fsOp.getConf();
    if (fileSinkDesc.isLinkedFileSink()) {
      for (      FileSinkDesc fsConf : fileSinkDesc.getLinkedFileSinkDesc()) {
        String fileName=Utilities.getFileNameFromDirName(fsConf.getDirName());
        fsConf.setParentDir(tmpDir);
        fsConf.setDirName(tmpDir + Path.SEPARATOR + fileName);
      }
    }
 else {
      fileSinkDesc.setDirName(tmpDir);
    }
  }
  Task<MoveWork> mvTask=null;
  if (!chDir) {
    mvTask=GenMapRedUtils.findMoveTask(mvTasks,fsOp);
  }
  if (mvTask != null) {
    GenMapRedUtils.addDependentMoveTasks(mvTask,hconf,currTask,dependencyTask);
  }
  return dest;
}
