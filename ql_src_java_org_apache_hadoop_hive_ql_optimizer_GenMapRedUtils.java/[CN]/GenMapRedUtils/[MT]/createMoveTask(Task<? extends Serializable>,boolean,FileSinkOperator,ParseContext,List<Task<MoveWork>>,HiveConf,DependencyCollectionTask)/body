{
  Path dest=null;
  if (chDir) {
    dest=fsOp.getConf().getFinalDirName();
    Context baseCtx=parseCtx.getContext();
    Path tmpDir=baseCtx.getExternalTmpPath(dest);
    FileSinkDesc fileSinkDesc=fsOp.getConf();
    if (fileSinkDesc.isLinkedFileSink()) {
      for (      FileSinkDesc fsConf : fileSinkDesc.getLinkedFileSinkDesc()) {
        fsConf.setParentDir(tmpDir);
        fsConf.setDirName(new Path(tmpDir,fsConf.getDirName().getName()));
      }
    }
 else {
      fileSinkDesc.setDirName(tmpDir);
    }
  }
  Task<MoveWork> mvTask=null;
  if (!chDir) {
    mvTask=GenMapRedUtils.findMoveTask(mvTasks,fsOp);
  }
  if (mvTask != null) {
    GenMapRedUtils.addDependentMoveTasks(mvTask,hconf,currTask,dependencyTask);
  }
  return dest;
}
