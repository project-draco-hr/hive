{
  Set<Partition> confirmedPartns=new HashSet<Partition>();
  TableSpec tblSpec=tableScanOp.getConf().getTableMetadata().getTableSpec();
  if (tblSpec.specType == TableSpec.SpecType.STATIC_PARTITION) {
    if (tblSpec.partHandle != null) {
      confirmedPartns.add(tblSpec.partHandle);
    }
 else {
      confirmedPartns.addAll(tblSpec.partitions);
    }
  }
 else   if (tblSpec.specType == TableSpec.SpecType.DYNAMIC_PARTITION) {
    confirmedPartns.addAll(tblSpec.partitions);
  }
  return confirmedPartns;
}
