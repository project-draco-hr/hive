{
  if ((mvTasks != null) && (!mvTasks.isEmpty())) {
    MoveTask mvTask=(MoveTask)GenMapRedUtils.findMoveTask(mvTasks,fsOp);
    if (mvTask != null && isInsertTable && hconf.getBoolVar(ConfVars.HIVESTATSAUTOGATHER)) {
      GenMapRedUtils.addStatsTask(fsOp,mvTask,currTask,hconf);
    }
    if ((mvTask != null) && !mvTask.isLocal() && fsOp.getConf().canBeMerged()) {
      if (fsOp.getConf().isLinkedFileSink()) {
        if (hconf.getBoolVar(ConfVars.HIVEMERGEMAPFILES) || hconf.getBoolVar(ConfVars.HIVEMERGEMAPREDFILES)) {
          return true;
        }
      }
 else {
        ReduceWork reduceWork=currTask.getWork() instanceof MapredWork ? ((MapredWork)currTask.getWork()).getReduceWork() : null;
        boolean mergeMapOnly=hconf.getBoolVar(ConfVars.HIVEMERGEMAPFILES) && reduceWork == null;
        boolean mergeMapRed=hconf.getBoolVar(ConfVars.HIVEMERGEMAPREDFILES) && reduceWork != null;
        if (mergeMapOnly || mergeMapRed) {
          return true;
        }
      }
    }
  }
  return false;
}
