{
  if ((mvTasks != null) && (!mvTasks.isEmpty())) {
    MoveTask mvTask=(MoveTask)GenMapRedUtils.findMoveTask(mvTasks,fsOp);
    if (mvTask != null && isInsertTable && hconf.getBoolVar(ConfVars.HIVESTATSAUTOGATHER)) {
      GenMapRedUtils.addStatsTask(fsOp,mvTask,currTask,hconf);
    }
    if ((mvTask != null) && !mvTask.isLocal() && fsOp.getConf().canBeMerged()) {
      if (currTask.getWork() instanceof TezWork) {
        return hconf.getBoolVar(ConfVars.HIVEMERGETEZFILES);
      }
 else       if (currTask.getWork() instanceof SparkWork) {
        return hconf.getBoolVar(ConfVars.HIVEMERGESPARKFILES);
      }
      if (fsOp.getConf().isLinkedFileSink()) {
        if (hconf.getBoolVar(ConfVars.HIVEMERGEMAPFILES) || hconf.getBoolVar(ConfVars.HIVEMERGEMAPREDFILES)) {
          return true;
        }
      }
 else {
        if (currTask.getWork() instanceof MapredWork) {
          ReduceWork reduceWork=((MapredWork)currTask.getWork()).getReduceWork();
          boolean mergeMapOnly=hconf.getBoolVar(ConfVars.HIVEMERGEMAPFILES) && reduceWork == null;
          boolean mergeMapRed=hconf.getBoolVar(ConfVars.HIVEMERGEMAPREDFILES) && reduceWork != null;
          if (mergeMapOnly || mergeMapRed) {
            return true;
          }
        }
 else {
          return false;
        }
      }
    }
  }
  return false;
}
