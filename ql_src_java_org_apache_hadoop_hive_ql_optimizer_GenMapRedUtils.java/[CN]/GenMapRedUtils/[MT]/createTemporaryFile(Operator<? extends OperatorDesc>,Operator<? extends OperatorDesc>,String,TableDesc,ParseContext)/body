{
  boolean compressIntermediate=parseCtx.getConf().getBoolVar(HiveConf.ConfVars.COMPRESSINTERMEDIATE);
  FileSinkDesc desc=new FileSinkDesc(taskTmpDir,tt_desc,compressIntermediate);
  if (compressIntermediate) {
    desc.setCompressCodec(parseCtx.getConf().getVar(HiveConf.ConfVars.COMPRESSINTERMEDIATECODEC));
    desc.setCompressType(parseCtx.getConf().getVar(HiveConf.ConfVars.COMPRESSINTERMEDIATETYPE));
  }
  Operator<? extends OperatorDesc> fileSinkOp=putOpInsertMap(OperatorFactory.get(desc,parent.getSchema()),null,parseCtx);
  parent.replaceChild(child,fileSinkOp);
  fileSinkOp.setParentOperators(Utilities.makeList(parent));
  RowResolver parentRowResolver=parseCtx.getOpParseCtx().get(parent).getRowResolver();
  TableScanOperator tableScanOp=(TableScanOperator)putOpInsertMap(createTemporaryTableScanOperator(parent.getSchema()),parentRowResolver,parseCtx);
  tableScanOp.setChildOperators(Utilities.makeList(child));
  child.replaceParent(parent,tableScanOp);
  return tableScanOp;
}
