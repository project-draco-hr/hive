{
  ParseContext parseCtx=opProcCtx.getParseCtx();
  MapredWork cplan=getMapRedWork(parseCtx);
  Task<? extends Serializable> redTask=TaskFactory.get(cplan,parseCtx.getConf());
  Operator<? extends OperatorDesc> reducer=op.getChildOperators().get(0);
  cplan.setReducer(reducer);
  ReduceSinkDesc desc=op.getConf();
  cplan.setNumReduceTasks(new Integer(desc.getNumReducers()));
  HashMap<Operator<? extends OperatorDesc>,Task<? extends Serializable>> opTaskMap=opProcCtx.getOpTaskMap();
  opTaskMap.put(reducer,redTask);
  Task<? extends Serializable> currTask=opProcCtx.getCurrTask();
  splitTasks(op,currTask,redTask,opProcCtx,true,false,0);
  opProcCtx.getRootOps().add(op);
}
