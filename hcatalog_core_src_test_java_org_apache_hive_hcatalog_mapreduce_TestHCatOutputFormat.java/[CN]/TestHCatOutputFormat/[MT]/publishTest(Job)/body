{
  HCatOutputFormat hcof=new HCatOutputFormat();
  TaskAttemptContext tac=ShimLoader.getHadoopShims().getHCatShim().createTaskAttemptContext(job.getConfiguration(),ShimLoader.getHadoopShims().getHCatShim().createTaskAttemptID());
  OutputCommitter committer=hcof.getOutputCommitter(tac);
  committer.setupJob(job);
  committer.setupTask(tac);
  committer.commitTask(tac);
  committer.commitJob(job);
  Partition part=client.getPartition(dbName,tblName,Arrays.asList("p1"));
  assertNotNull(part);
  StorerInfo storer=InternalUtil.extractStorerInfo(part.getSd(),part.getParameters());
  assertEquals(storer.getProperties().get("hcat.testarg"),"testArgValue");
  assertTrue(part.getSd().getLocation().indexOf("p1") != -1);
}
