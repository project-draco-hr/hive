{
  HiveConf hiveConf=null;
  if (configuration != null) {
    if (!HiveConf.class.isAssignableFrom(configuration.getClass())) {
      hiveConf=new HiveConf(configuration,clazz);
    }
 else {
      hiveConf=(HiveConf)configuration;
    }
  }
  if (hiveConf == null) {
    hiveConf=HiveConfFactory.newInstance(clazz,metaStoreUri);
  }
 else {
    HiveConfFactory.overrideSettings(hiveConf);
  }
  return hiveConf;
}
