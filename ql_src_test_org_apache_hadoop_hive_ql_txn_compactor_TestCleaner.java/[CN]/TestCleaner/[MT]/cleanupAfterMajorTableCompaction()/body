{
  Table t=newTable("default","camtc",false);
  HiveConf conf=new HiveConf();
  addBaseFile(conf,t,null,20L,20);
  addDeltaFile(conf,t,null,21L,22L,2);
  addDeltaFile(conf,t,null,23L,24L,2);
  addBaseFile(conf,t,null,25L,25);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","camtc",CompactionType.MAJOR);
  txnHandler.compact(rqst);
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  txnHandler.markCompacted(ci);
  txnHandler.setRunAs(ci.id,System.getProperty("user.name"));
  startCleaner(conf);
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  Assert.assertNull(rsp.getCompacts());
  List<Path> paths=getDirectories(conf,t,null);
  Assert.assertEquals(1,paths.size());
  Assert.assertEquals("base_25",paths.get(0).getName());
}
