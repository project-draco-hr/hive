{
  if (LOG.isTraceEnabled()) {
    LOG.trace("Attempting to heartbeat to AM: " + amNodeInfo);
  }
  if (amNodeInfo.getTaskCount() > 0) {
    try {
      if (LOG.isTraceEnabled()) {
        LOG.trace("NodeHeartbeat to: " + amNodeInfo);
      }
      amNodeInfo.getUmbilical().nodeHeartbeat(new Text(nodeId.getHostname()),nodeId.getPort());
    }
 catch (    IOException e) {
      QueryIdentifier currentQueryIdentifier=amNodeInfo.getCurrentQueryIdentifier();
      amNodeInfo.setAmFailed(true);
      LOG.warn("Failed to communicated with AM at {}. Killing remaining fragments for query {}",amNodeInfo.amNodeId,currentQueryIdentifier,e);
      queryFailedHandler.queryFailed(currentQueryIdentifier);
    }
catch (    InterruptedException e) {
      if (!isShutdown.get()) {
        LOG.warn("Interrupted while trying to send heartbeat to AM {}",amNodeInfo.amNodeId,e);
      }
    }
  }
 else {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Skipping node heartbeat to AM: " + amNodeInfo + ", since ref count is 0");
    }
  }
  return null;
}
