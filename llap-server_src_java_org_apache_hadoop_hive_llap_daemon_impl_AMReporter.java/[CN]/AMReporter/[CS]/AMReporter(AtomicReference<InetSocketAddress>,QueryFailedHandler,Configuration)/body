{
  super(AMReporter.class.getName());
  this.localAddress=localAddress;
  this.queryFailedHandler=queryFailedHandler;
  this.conf=conf;
  ExecutorService rawExecutor=Executors.newCachedThreadPool(new ThreadFactoryBuilder().setDaemon(true).setNameFormat("AMReporter %d").build());
  this.executor=MoreExecutors.listeningDecorator(rawExecutor);
  ExecutorService rawExecutor2=Executors.newFixedThreadPool(1,new ThreadFactoryBuilder().setDaemon(true).setNameFormat("AMReporterQueueDrainer").build());
  this.queueLookupExecutor=MoreExecutors.listeningDecorator(rawExecutor2);
  this.heartbeatInterval=conf.getLong(LlapConfiguration.LLAP_DAEMON_AM_LIVENESS_HEARTBEAT_INTERVAL_MS,LlapConfiguration.LLAP_DAEMON_AM_LIVENESS_HEARTBEAT_INTERVAL_MS_DEFAULT);
  this.retryTimeout=conf.getLong(LlapConfiguration.LLAP_DAEMON_AM_LIVENESS_CONNECTION_TIMEOUT_MILLIS,LlapConfiguration.LLAP_DAEMON_AM_LIVENESS_CONNECTION_TIMEOUT_MILLIS_DEFAULT);
  long retrySleep=conf.getLong(LlapConfiguration.LLAP_DAEMON_AM_LIVENESS_CONNECTION_SLEEP_BETWEEN_RETRIES_MILLIS,LlapConfiguration.LLAP_DAEMON_AM_LIVENESS_CONNECTION_SLEEP_BETWEEN_RETRIES_MILLIS_DEFAULT);
  this.retryPolicy=RetryPolicies.retryUpToMaximumTimeWithFixedSleep(retryTimeout,retrySleep,TimeUnit.MILLISECONDS);
  this.socketFactory=NetUtils.getDefaultSocketFactory(conf);
  LOG.info("Setting up AMReporter with " + "heartbeatInterval(ms)=" + heartbeatInterval + ", retryTime(ms)="+ retryTimeout+ ", retrySleep(ms)="+ retrySleep);
}
