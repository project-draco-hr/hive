{
  int type=ast.getType();
  if (type == HiveParser.DOT) {
    return ast;
  }
  if (type == HiveParser.TOK_TABLE_OR_COL) {
    if (tableAlias == null) {
      return null;
    }
    String colName=SemanticAnalyzer.unescapeIdentifier(ast.getChild(0).getText());
    return SubQueryUtils.createColRefAST(tableAlias,colName);
  }
  for (int i=0; i < ast.getChildCount(); i++) {
    ASTNode child=(ASTNode)ast.getChild(i);
    ASTNode c=setQualifiedColumnReferences(child,tableAlias);
    if (c == null) {
      return null;
    }
    if (c != child) {
      ast.setChild(i,c);
    }
  }
  return ast;
}
