{
  if (!this.isStopped.getAndSet(true)) {
    try {
      TaskSchedulerAppCallback.AppFinalStatus status=appClientDelegate.getFinalAppStatus();
      amRmClient.unregisterApplicationMaster(status.exitStatus,status.exitMessage,status.postCompletionTrackingUrl);
    }
 catch (    YarnException e) {
      throw new TezUncheckedException(e);
    }
catch (    IOException e) {
      throw new TezUncheckedException(e);
    }
    appCallbackExecutor.shutdownNow();
  }
}
