{
  Path[] paths=findFilesInBasePath();
  TFSOInputFormat input=new TFSOInputFormat();
  FileInputFormat.setInputPaths(jc,paths);
  InputSplit[] splits=input.getSplits(jc,1);
  RecordReader<NullWritable,TFSORow> reader=input.getRecordReader(splits[0],jc,Mockito.mock(Reporter.class));
  NullWritable key=reader.createKey();
  TFSORow value=reader.createValue();
  List<TFSORow> results=new ArrayList<TFSORow>(rows.size());
  List<TFSORow> sortedRows=new ArrayList<TFSORow>(rows.size());
  for (int i=0; i < rows.size(); i++) {
    Assert.assertTrue(reader.next(key,value));
    results.add(new TFSORow(value));
    sortedRows.add(new TFSORow(rows.get(i)));
  }
  Assert.assertFalse(reader.next(key,value));
  Collections.sort(results);
  Collections.sort(sortedRows);
  for (int i=0; i < rows.size(); i++) {
    Assert.assertTrue(sortedRows.get(i).equals(results.get(i)));
  }
}
