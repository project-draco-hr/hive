{
  return new FileSinkOperator.RecordWriter(){
    @Override public void write(    Writable w) throws IOException {
      Assert.assertTrue(w instanceof TFSORow);
      records.add((TFSORow)w);
    }
    @Override public void close(    boolean abort) throws IOException {
      if (out == null) {
        FileSystem fs=finalOutPath.getFileSystem(jc);
        out=fs.create(finalOutPath);
      }
      for (      TFSORow r : records)       r.write(out);
      records.clear();
      out.flush();
      out.close();
    }
  }
;
}
