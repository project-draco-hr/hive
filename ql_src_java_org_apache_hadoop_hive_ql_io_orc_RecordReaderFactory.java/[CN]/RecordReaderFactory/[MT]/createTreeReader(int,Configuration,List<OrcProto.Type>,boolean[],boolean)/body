{
  final boolean isAcid=checkAcidSchema(fileSchema);
  final List<OrcProto.Type> originalFileSchema;
  if (isAcid) {
    originalFileSchema=fileSchema.subList(fileSchema.get(0).getSubtypesCount(),fileSchema.size());
  }
 else {
    originalFileSchema=fileSchema;
  }
  final int numCols=originalFileSchema.get(0).getSubtypesCount();
  List<OrcProto.Type> schemaOnRead=getSchemaOnRead(numCols,conf);
  List<OrcProto.Type> schemaUsed=getMatchingSchema(fileSchema,schemaOnRead);
  if (schemaUsed == null) {
    return TreeReaderFactory.createTreeReader(colId,fileSchema,included,skipCorrupt);
  }
 else {
    return ConversionTreeReaderFactory.createTreeReader(colId,schemaUsed,included,skipCorrupt);
  }
}
