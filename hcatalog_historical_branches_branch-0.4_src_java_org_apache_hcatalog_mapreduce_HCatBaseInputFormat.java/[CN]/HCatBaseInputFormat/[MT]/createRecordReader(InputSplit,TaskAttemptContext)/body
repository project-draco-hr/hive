{
  HCatSplit hcatSplit=InternalUtil.castToHCatSplit(split);
  PartInfo partitionInfo=hcatSplit.getPartitionInfo();
  JobContext jobContext=taskContext;
  HCatStorageHandler storageHandler=HCatUtil.getStorageHandler(jobContext.getConfiguration(),partitionInfo);
  JobConf jobConf=HCatUtil.getJobConfFromContext(jobContext);
  Map<String,String> jobProperties=partitionInfo.getJobProperties();
  HCatUtil.copyJobPropertiesToJobConf(jobProperties,jobConf);
  Map<String,String> valuesNotInDataCols=getColValsNotInDataColumns(getOutputSchema(jobContext),partitionInfo);
  return new HCatRecordReader(storageHandler,valuesNotInDataCols);
}
