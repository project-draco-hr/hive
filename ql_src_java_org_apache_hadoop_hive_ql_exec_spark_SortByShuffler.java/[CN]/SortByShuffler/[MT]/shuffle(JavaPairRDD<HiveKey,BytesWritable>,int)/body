{
  JavaPairRDD<HiveKey,BytesWritable> rdd;
  if (numPartitions > 0) {
    rdd=input.sortByKey(true,numPartitions);
  }
 else {
    rdd=input.sortByKey(true);
  }
  return rdd.mapPartitionsToPair(new ShuffleFunction());
}
