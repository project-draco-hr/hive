{
  String uname=UserGroupInformation.getLoginUser().getShortUserName();
  FileSystem fs=FileSystem.get(conf);
  Token<?> fsToken=fs.getDelegationToken(uname);
  File t=File.createTempFile("hive_hadoop_delegation_token",null);
  Path tokenPath=new Path(t.toURI());
  Credentials cred=new Credentials();
  cred.addToken(fsToken.getService(),fsToken);
  cred.writeTokenStorageFile(tokenPath,conf);
  return tokenPath;
}
