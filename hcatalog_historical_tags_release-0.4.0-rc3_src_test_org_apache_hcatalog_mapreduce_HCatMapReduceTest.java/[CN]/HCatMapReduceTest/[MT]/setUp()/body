{
  hiveConf=new HiveConf(this.getClass());
  hiveConf.set(HiveConf.ConfVars.PREEXECHOOKS.varname,"");
  hiveConf.set(HiveConf.ConfVars.POSTEXECHOOKS.varname,"");
  hiveConf.set(HiveConf.ConfVars.HIVE_SUPPORT_CONCURRENCY.varname,"false");
  driver=new Driver(hiveConf);
  SessionState.start(new CliSessionState(hiveConf));
  thriftUri=System.getenv("HCAT_METASTORE_URI");
  if (thriftUri != null) {
    System.out.println("Using URI " + thriftUri);
    hiveConf.set("hive.metastore.local","false");
    hiveConf.set(HiveConf.ConfVars.METASTOREURIS.varname,thriftUri);
  }
  fs=new LocalFileSystem();
  fs.initialize(fs.getWorkingDirectory().toUri(),new Configuration());
  initialize();
  client=new HiveMetaStoreClient(hiveConf,null);
  initTable();
}
