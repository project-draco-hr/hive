{
  String dbName="testDb";
  String tblName_1="testTbl_1";
  String tblName_2="testTbl_2";
  try {
    silentDropDatabase(dbName);
    Database db=new Database();
    db.setName(dbName);
    String dbLocation=HiveConf.getVar(hiveConf,HiveConf.ConfVars.METASTOREWAREHOUSE) + "_testDB_table_create_";
    db.setLocationUri(dbLocation);
    client.createDatabase(db);
    db=client.getDatabase(dbName);
    Table tbl=new Table();
    tbl.setDbName(dbName);
    tbl.setTableName(tblName_1);
    ArrayList<FieldSchema> cols=new ArrayList<FieldSchema>(2);
    cols.add(new FieldSchema("name",Constants.STRING_TYPE_NAME,""));
    cols.add(new FieldSchema("income",Constants.INT_TYPE_NAME,""));
    StorageDescriptor sd=new StorageDescriptor();
    sd.setSerdeInfo(new SerDeInfo());
    sd.getSerdeInfo().setName(tbl.getTableName());
    sd.getSerdeInfo().setParameters(new HashMap<String,String>());
    sd.setParameters(new HashMap<String,String>());
    sd.getSerdeInfo().getParameters().put(org.apache.hadoop.hive.serde.Constants.SERIALIZATION_FORMAT,"9");
    sd.getSerdeInfo().setSerializationLib(org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe.class.getName());
    tbl.setSd(sd);
    tbl.getSd().setCols(cols);
    client.createTable(tbl);
    tbl=client.getTable(dbName,tblName_1);
    Path path=new Path(tbl.getSd().getLocation());
    System.err.println("Table's location " + path + ", Database's location "+ db.getLocationUri());
    assertEquals("Table location is not a subset of the database location",path.getParent().toString(),db.getLocationUri());
  }
 catch (  Exception e) {
    System.err.println(StringUtils.stringifyException(e));
    System.err.println("testTableDatabase() failed.");
    throw e;
  }
 finally {
    silentDropDatabase(dbName);
  }
}
