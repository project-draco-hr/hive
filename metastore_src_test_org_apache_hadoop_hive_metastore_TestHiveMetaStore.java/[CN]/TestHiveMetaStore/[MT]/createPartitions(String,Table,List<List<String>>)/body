{
  int i=1;
  List<Partition> partitions=new ArrayList<Partition>();
  for (  List<String> vals : values) {
    Partition part=makePartitionObject(dbName,tbl.getTableName(),vals,tbl,"/part" + i);
    i++;
    boolean exceptionThrown=false;
    try {
      Partition p=client.getPartition(dbName,tbl.getTableName(),vals);
    }
 catch (    Exception e) {
      assertEquals("partition should not have existed",NoSuchObjectException.class,e.getClass());
      exceptionThrown=true;
    }
    assertTrue("getPartition() should have thrown NoSuchObjectException",exceptionThrown);
    Partition retp=client.add_partition(part);
    assertNotNull("Unable to create partition " + part,retp);
    partitions.add(retp);
  }
  return partitions;
}
