{
  try {
    String dbName="simpdb";
    String tblName="simptbl";
    String tblName2="simptbl2";
    String typeName="Person";
    client.dropTable(dbName,tblName);
    client.dropDatabase(dbName);
    boolean ret=client.createDatabase(dbName,"strange_loc");
    assertTrue("Unable to create the databse " + dbName,ret);
    client.dropType(typeName);
    Type typ1=new Type();
    typ1.setName(typeName);
    typ1.setFields(new ArrayList<FieldSchema>(2));
    typ1.getFields().add(new FieldSchema("name",Constants.STRING_TYPE_NAME,""));
    typ1.getFields().add(new FieldSchema("income",Constants.INT_TYPE_NAME,""));
    ret=client.createType(typ1);
    assertTrue("Unable to create type " + typeName,ret);
    Table tbl=new Table();
    tbl.setDatabase(dbName);
    tbl.setTableName(tblName);
    StorageDescriptor sd=new StorageDescriptor();
    tbl.setSd(sd);
    sd.setCols(typ1.getFields());
    sd.setIsCompressed(false);
    sd.setNumBuckets(1);
    sd.setParameters(new HashMap<String,String>());
    sd.getParameters().put("test_param_1","Use this for comments etc");
    sd.setBucketCols(new ArrayList<String>(2));
    sd.getBucketCols().add("name");
    sd.setSerdeInfo(new SerDeInfo());
    sd.getSerdeInfo().setName(tbl.getTableName());
    sd.getSerdeInfo().setSerializationFormat("1");
    client.createTable(tbl);
    Table tbl2=client.getTable(dbName,tblName);
    assertNotNull(tbl2);
    assertEquals(tbl2.getDatabase(),dbName);
    assertEquals(tbl2.getTableName(),tblName);
    assertEquals(tbl2.getSd().getCols().size(),typ1.getFields().size());
    assertEquals(tbl2.getSd().isIsCompressed(),false);
    assertEquals(tbl2.getSd().getNumBuckets(),1);
    assertEquals(tbl2.getSd().getLocation(),tbl.getSd().getLocation());
    assertNotNull(tbl2.getSd().getSerdeInfo());
    assertEquals(tbl2.getSd().getSerdeInfo().getSerializationFormat(),"1");
    tbl.setTableName(tblName2);
    client.createTable(tbl);
    Table tbl3=client.getTable(dbName,tblName2);
    assertNotNull(tbl3);
    assertEquals(tbl3.getDatabase(),dbName);
    assertEquals(tbl3.getTableName(),tblName2);
    assertEquals(tbl3.getSd().getCols().size(),typ1.getFields().size());
    assertEquals(tbl3.getSd().isIsCompressed(),false);
    assertEquals(tbl3.getSd().getNumBuckets(),1);
    assertEquals(tbl3.getSd().getLocation(),tbl.getSd().getLocation());
    assertEquals("Use this for comments etc",tbl2.getSd().getParameters().get("test_param_1"));
    assertEquals("name",tbl2.getSd().getBucketCols().get(0));
    assertTrue("Partition key list is not empty",(tbl2.getPartitionKeys() == null) || (tbl2.getPartitionKeys().size() == 0));
    client.dropTable(dbName,tblName);
    client.dropTable(dbName,tblName2);
    ret=client.dropType(typeName);
    assertTrue("Unable to drop type " + typeName,ret);
    ret=client.dropDatabase(dbName);
    assertTrue("Unable to drop databse " + dbName,ret);
  }
 catch (  Exception e) {
    System.err.println(StringUtils.stringifyException(e));
    System.err.println("testSimpleTable() failed.");
    throw e;
  }
}
