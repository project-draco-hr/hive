{
  String user=SessionState.getUserFromAuthenticator();
  if (user == null) {
    user=UserGroupInformation.getCurrentUser().getUserName();
    LOG.warn("Cannot determine the session user; using " + user + " instead");
  }
  final SignableVertexSpec.Builder svsb=Converters.convertTaskSpecToProto(taskSpec,0,fakeApplicationId.toString(),user);
  if (signer == null) {
    SignedMessage result=new SignedMessage();
    result.message=serializeVertexSpec(svsb);
    return result;
  }
  return signer.serializeAndSign(new Signable(){
    @Override public void setSignInfo(    int masterKeyId){
      svsb.setSignatureKeyId(masterKeyId);
    }
    @Override public byte[] serialize() throws IOException {
      return serializeVertexSpec(svsb);
    }
  }
);
}
