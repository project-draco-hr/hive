{
  final SignableVertexSpec.Builder svsb=Converters.convertTaskSpecToProto(taskSpec,0,applicationId.toString(),queryUser);
  if (signer == null) {
    SignedMessage result=new SignedMessage();
    result.message=serializeVertexSpec(svsb);
    return result;
  }
  return signer.serializeAndSign(new Signable(){
    @Override public void setSignInfo(    int masterKeyId){
      svsb.setSignatureKeyId(masterKeyId);
    }
    @Override public byte[] serialize() throws IOException {
      return serializeVertexSpec(svsb);
    }
  }
);
}
