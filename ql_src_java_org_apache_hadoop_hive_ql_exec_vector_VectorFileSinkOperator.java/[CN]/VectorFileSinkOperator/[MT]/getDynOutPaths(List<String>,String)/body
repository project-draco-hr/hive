{
  FSPaths fp;
  String dpDir=getDynPartDirectory(row,dpColNames,numDynParts);
  if (dpDir != null) {
    dpDir=appendListBucketingDirName(lbDirName,dpDir);
    FSPaths fsp2=valToPaths.get(dpDir);
    if (fsp2 == null) {
      if (valToPaths.size() > maxPartitions) {
        incrCounter(fatalErrorCntr,1);
        fatalError=true;
        LOG.error("Fatal error was thrown due to exceeding number of dynamic partitions");
      }
      fsp2=createNewPaths(dpDir);
    }
    fp=fsp2;
  }
 else {
    fp=fsp;
  }
  return fp;
}
