{
  final List<RexNode> joinFilters=RelOptUtil.conjunctions(join.getCondition());
  if (((HiveJoinRel)join).isLeftSemiJoin()) {
    return;
  }
  if (filter == null) {
    boolean onlyTrueFilter=true;
    for (    RexNode joinFilter : joinFilters) {
      if (!joinFilter.isAlwaysTrue()) {
        onlyTrueFilter=false;
        break;
      }
    }
    if (onlyTrueFilter) {
      return;
    }
  }
  final List<RexNode> aboveFilters=filter != null ? RelOptUtil.conjunctions(filter.getCondition()) : ImmutableList.<RexNode>of();
  List<RexNode> leftFilters=new ArrayList<RexNode>();
  List<RexNode> rightFilters=new ArrayList<RexNode>();
  boolean filterPushed=false;
  if (RelOptUtil.classifyFilters(join,aboveFilters,false,!join.getJoinType().generatesNullsOnLeft(),!join.getJoinType().generatesNullsOnRight(),joinFilters,leftFilters,rightFilters)) {
    filterPushed=true;
  }
  if (RelOptUtil.classifyFilters(join,joinFilters,false,!join.getJoinType().generatesNullsOnRight(),!join.getJoinType().generatesNullsOnLeft(),joinFilters,leftFilters,rightFilters)) {
    filterPushed=true;
  }
  if (!filterPushed) {
    return;
  }
  RexBuilder rexBuilder=join.getCluster().getRexBuilder();
  RelNode leftRel=createFilterOnRel(rexBuilder,join.getLeft(),leftFilters);
  RelNode rightRel=createFilterOnRel(rexBuilder,join.getRight(),rightFilters);
  RexNode joinFilter;
  if (joinFilters.size() == 0) {
    if ((leftFilters.size() == 0) && (rightFilters.size() == 0)) {
      return;
    }
    joinFilter=rexBuilder.makeLiteral(true);
  }
 else {
    joinFilter=RexUtil.composeConjunction(rexBuilder,joinFilters,true);
  }
  RelNode newJoinRel=HiveJoinRel.getJoin(join.getCluster(),leftRel,rightRel,joinFilter,join.getJoinType(),false);
  RelNode newRel=createFilterOnRel(rexBuilder,newJoinRel,aboveFilters);
  call.transformTo(newRel);
}
