{
  List<String> filesInPath=Lists.newArrayList();
  FileSystem fs=path.getFileSystem(conf);
  FileStatus fileStatus=fs.getFileStatus(path);
  if (fileStatus.isDir()) {
    FileStatus[] fileStatuses=fs.listStatus(path,HIDDEN_AND_SIDE_FILE_FILTER);
    for (    FileStatus fileInPath : fileStatuses) {
      if (fileInPath.isDir()) {
        filesInPath.addAll(getAllFilesInPath(fileInPath.getPath(),conf));
      }
 else {
        filesInPath.add(fileInPath.getPath().toString());
      }
    }
  }
 else {
    filesInPath.add(path.toString());
  }
  return filesInPath;
}
