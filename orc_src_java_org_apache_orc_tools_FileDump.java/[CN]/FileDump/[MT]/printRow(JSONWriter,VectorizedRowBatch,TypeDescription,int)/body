{
  if (schema.getCategory() == TypeDescription.Category.STRUCT) {
    List<TypeDescription> fieldTypes=schema.getChildren();
    List<String> fieldNames=schema.getFieldNames();
    writer.object();
    for (int c=0; c < batch.cols.length; ++c) {
      writer.key(fieldNames.get(c));
      printValue(writer,batch.cols[c],fieldTypes.get(c),row);
    }
    writer.endObject();
  }
 else {
    printValue(writer,batch.cols[0],schema,row);
  }
}
