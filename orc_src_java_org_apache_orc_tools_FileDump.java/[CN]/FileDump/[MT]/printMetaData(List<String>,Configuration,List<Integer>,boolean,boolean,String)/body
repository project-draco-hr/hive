{
  List<String> corruptFiles=Lists.newArrayList();
  for (  String filename : files) {
    printMetaDataImpl(filename,conf,rowIndexCols,printTimeZone,corruptFiles);
    System.out.println(SEPARATOR);
  }
  if (!corruptFiles.isEmpty()) {
    if (recover) {
      recoverFiles(corruptFiles,conf,backupPath);
    }
 else {
      System.err.println(corruptFiles.size() + " file(s) are corrupted." + " Run the following command to recover corrupted files.\n");
      String fileNames=Joiner.on(" ").skipNulls().join(corruptFiles);
      System.err.println("hive --orcfiledump --recover --skip-dump " + fileNames);
      System.out.println(SEPARATOR);
    }
  }
}
