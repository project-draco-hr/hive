{
  for (int bindex=0; bindex < bigTblBucketNameList.size(); bindex++) {
    ArrayList<String> resultFileNames=new ArrayList<String>();
    for (int sindex=0; sindex < smallTblBucketNums.size(); sindex++) {
      int smallTblBucketNum=smallTblBucketNums.get(sindex);
      List<String> smallTblFileNames=smallTblFilesList.get(sindex);
      if (bigTblBucketNum >= smallTblBucketNum) {
        int toAddSmallIndex=bindex % smallTblBucketNum;
        resultFileNames.add(smallTblFileNames.get(toAddSmallIndex));
      }
 else {
        int jump=smallTblBucketNum / bigTblBucketNum;
        for (int i=bindex; i < smallTblFileNames.size(); i=i + jump) {
          resultFileNames.add(smallTblFileNames.get(i));
        }
      }
    }
    String inputBigTBLBucket=bigTblBucketNameList.get(bindex);
    bigTableBucketFileNameToSmallTableBucketFileNames.put(inputBigTBLBucket,resultFileNames);
    bucketFileNameMapping.put(inputBigTBLBucket,bindex);
  }
}
