{
  int numPartitions=minNumParts;
  if (memoryThreshold < minNumParts * minWbSize) {
    LOG.warn("Available memory is not enough to create a HybridHashTableContainer!");
  }
  if (memoryThreshold / 2 < dataSize) {
    while (dataSize / numPartitions > memoryThreshold / 2) {
      numPartitions*=2;
    }
  }
  LOG.info("Total available memory: " + memoryThreshold);
  LOG.info("Estimated small table size: " + dataSize);
  LOG.info("Number of hash partitions to be created: " + numPartitions);
  return numPartitions;
}
