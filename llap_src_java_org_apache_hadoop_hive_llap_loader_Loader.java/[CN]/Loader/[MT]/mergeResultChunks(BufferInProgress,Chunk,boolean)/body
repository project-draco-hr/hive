{
  int rowCount=colBuffer.getChunkInProgressRows();
  Chunk chunk=colBuffer.extractChunk();
  if (rowCount <= 0) {
    if (finalCheck && existingResult == null) {
      throw new IOException("No rows written for column");
    }
    return existingResult;
  }
  writer.finishChunk(chunk,rowCount);
  return (existingResult == null) ? chunk : existingResult.addChunk(chunk);
}
