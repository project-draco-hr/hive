{
  ExprNodeTempDesc desc;
  try {
    Table t=this.metaData.getTableForAlias(tabAlias);
    if (t.isPartitionKey(colName)) {
      if (tabAlias.equalsIgnoreCase(tableAlias)) {
        desc=new ExprNodeTempDesc(new exprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,colName));
      }
 else {
        desc=new ExprNodeTempDesc(new exprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,null));
      }
    }
 else {
      TypeInfo typeInfo=TypeInfoUtils.getTypeInfoFromObjectInspector(this.metaData.getTableForAlias(tabAlias).getDeserializer().getObjectInspector());
      desc=new ExprNodeTempDesc(new exprNodeConstantDesc(((StructTypeInfo)typeInfo).getStructFieldTypeInfo(colName),null));
      onlyContainsPartCols=false;
    }
  }
 catch (  SerDeException e) {
    throw new RuntimeException(e);
  }
  return desc;
}
