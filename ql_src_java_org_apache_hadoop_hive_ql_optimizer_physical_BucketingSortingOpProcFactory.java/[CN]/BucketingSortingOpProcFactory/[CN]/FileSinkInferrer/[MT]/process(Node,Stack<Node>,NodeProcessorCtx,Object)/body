{
  BucketingSortingCtx bctx=(BucketingSortingCtx)procCtx;
  FileSinkOperator fop=(FileSinkOperator)nd;
  Operator<? extends OperatorDesc> parent=getParent(stack);
  List<BucketCol> bucketCols=bctx.getBucketedCols(parent);
  List<ColumnInfo> colInfos=fop.getSchema().getSignature();
  if (bucketCols != null) {
    List<BucketCol> newBucketCols=getNewBucketCols(bucketCols,colInfos);
    bctx.getBucketedColsByDirectory().put(fop.getConf().getDirName(),newBucketCols);
    bctx.setBucketedCols(fop,newBucketCols);
  }
  List<SortCol> sortCols=bctx.getSortedCols(parent);
  if (sortCols != null) {
    List<SortCol> newSortCols=getNewSortCols(sortCols,colInfos);
    bctx.getSortedColsByDirectory().put(fop.getConf().getDirName(),newSortCols);
    bctx.setSortedCols(fop,newSortCols);
  }
  return null;
}
