{
  MapColumnVector result=(MapColumnVector)previous;
  super.nextVector(result,isNull,batchSize);
  if (result.noNulls || !(result.isRepeating && result.isNull[0])) {
    lengths.nextVector(result,result.lengths,batchSize);
    result.isRepeating=false;
    result.childCount=0;
    for (int r=0; r < batchSize; ++r) {
      if (result.noNulls || !result.isNull[r]) {
        result.offsets[r]=result.childCount;
        result.childCount+=result.lengths[r];
      }
    }
    result.keys.ensureSize(result.childCount,false);
    result.values.ensureSize(result.childCount,false);
    keyReader.nextVector(result.keys,null,result.childCount);
    valueReader.nextVector(result.values,null,result.childCount);
  }
}
