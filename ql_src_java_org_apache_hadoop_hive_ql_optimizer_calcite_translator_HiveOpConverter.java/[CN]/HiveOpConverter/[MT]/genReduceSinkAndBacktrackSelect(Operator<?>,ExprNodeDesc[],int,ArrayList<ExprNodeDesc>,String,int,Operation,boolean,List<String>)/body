{
  if (input.getSchema().getTableNames().size() != 1) {
    throw new SemanticException("In CBO return path, genReduceSinkAndBacktrackSelect is expecting only one SelectOp but there is " + input.getSchema().getTableNames().size());
  }
  ReduceSinkOperator rsOp=genReduceSink(input,input.getSchema().getTableNames().iterator().next(),keys,tag,partitionCols,order,numReducers,acidOperation,strictMode);
  Map<String,ExprNodeDesc> descriptors=buildBacktrackFromReduceSink(keepColNames,rsOp.getConf().getOutputKeyColumnNames(),rsOp.getConf().getOutputValueColumnNames(),rsOp.getValueIndex(),input);
  SelectDesc selectDesc=new SelectDesc(new ArrayList<ExprNodeDesc>(descriptors.values()),new ArrayList<String>(descriptors.keySet()));
  ArrayList<ColumnInfo> cinfoLst=createColInfosSubset(input,keepColNames);
  SelectOperator selectOp=(SelectOperator)OperatorFactory.getAndMakeChild(selectDesc,new RowSchema(cinfoLst),rsOp);
  selectOp.setColumnExprMap(descriptors);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Generated " + selectOp + " with row schema: ["+ selectOp.getSchema()+ "]");
  }
  return selectOp;
}
