{
  if (hiveExprs.size() != projNames.size()) {
    throw new RuntimeException("Column expressions list doesn't match Column Names list");
  }
  RexNode rexN;
  ExprNodeDesc pe;
  ArrayList<ColumnInfo> colInfos=new ArrayList<ColumnInfo>();
  VirtualColumn vc;
  Map<Integer,VirtualColumn> newVColMap=new HashMap<Integer,VirtualColumn>();
  for (int i=0; i < hiveExprs.size(); i++) {
    pe=hiveExprs.get(i);
    rexN=calciteExprs.get(i);
    vc=null;
    if (rexN instanceof RexInputRef) {
      vc=inpOpAf.vcolMap.get(((RexInputRef)rexN).getIndex());
      if (vc != null) {
        newVColMap.put(i,vc);
      }
    }
    colInfos.add(new ColumnInfo(projNames.get(i),pe.getTypeInfo(),inpOpAf.tabAlias,vc != null));
  }
  return new Pair<ArrayList<ColumnInfo>,Map<Integer,VirtualColumn>>(colInfos,newVColMap);
}
