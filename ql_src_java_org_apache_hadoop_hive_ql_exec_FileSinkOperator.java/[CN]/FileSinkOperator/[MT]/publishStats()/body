{
  StatsPublisher statsPublisher=Utilities.getStatsPublisher(jc);
  if (statsPublisher == null || !statsPublisher.connect(hconf)) {
    LOG.error("StatsPublishing error: cannot connect to database");
    return;
  }
  String taskID=Utilities.getTaskIdFromFilename(Utilities.getTaskId(hconf));
  String spSpec=conf.getStaticSpec() != null ? conf.getStaticSpec() : "";
  for (  String fspKey : valToPaths.keySet()) {
    FSPaths fspValue=valToPaths.get(fspKey);
    String key;
    if (fspKey == "") {
      key=conf.getStatsAggPrefix() + spSpec + taskID;
    }
 else {
      key=conf.getStatsAggPrefix() + spSpec + fspKey+ Path.SEPARATOR+ taskID;
    }
    statsPublisher.publishStat(key,StatsSetupConst.ROW_COUNT,Long.toString(fspValue.stat.getNumRows()));
  }
  statsPublisher.closeConnection();
}
