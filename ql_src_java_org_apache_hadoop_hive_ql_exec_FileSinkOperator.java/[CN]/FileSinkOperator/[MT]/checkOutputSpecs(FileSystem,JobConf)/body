{
  if (hiveOutputFormat == null) {
    Utilities.copyTableJobPropertiesToConf(conf.getTableInfo(),job);
    try {
      hiveOutputFormat=HiveFileFormatUtils.getHiveOutputFormat(job,getConf().getTableInfo());
    }
 catch (    Exception ex) {
      throw new IOException(ex);
    }
  }
  if (conf.getTableInfo().isNonNative()) {
    try {
      hiveOutputFormat.checkOutputSpecs(ignored,job);
    }
 catch (    NoSuchMethodError e) {
      LOG.warn("HiveOutputFormat should implement checkOutputSpecs() method`");
    }
  }
}
