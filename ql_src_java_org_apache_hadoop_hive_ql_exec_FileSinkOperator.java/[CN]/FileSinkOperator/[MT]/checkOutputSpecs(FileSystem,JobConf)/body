{
  if (hiveOutputFormat == null) {
    try {
      if (getConf().getTableInfo().getJobProperties() != null) {
        if (getConf().getTableInfo().getJobProperties().get(HivePassThroughOutputFormat.HIVE_PASSTHROUGH_STORAGEHANDLER_OF_JOBCONFKEY) != null) {
          job.set(HivePassThroughOutputFormat.HIVE_PASSTHROUGH_STORAGEHANDLER_OF_JOBCONFKEY,getConf().getTableInfo().getJobProperties().get(HivePassThroughOutputFormat.HIVE_PASSTHROUGH_STORAGEHANDLER_OF_JOBCONFKEY));
          hiveOutputFormat=ReflectionUtils.newInstance(conf.getTableInfo().getOutputFileFormatClass(),job);
        }
 else {
          hiveOutputFormat=conf.getTableInfo().getOutputFileFormatClass().newInstance();
        }
      }
 else {
        hiveOutputFormat=conf.getTableInfo().getOutputFileFormatClass().newInstance();
      }
    }
 catch (    Exception ex) {
      throw new IOException(ex);
    }
  }
  Utilities.copyTableJobPropertiesToConf(conf.getTableInfo(),job);
  if (conf.getTableInfo().isNonNative()) {
    try {
      hiveOutputFormat.checkOutputSpecs(ignored,job);
    }
 catch (    NoSuchMethodError e) {
      LOG.warn("HiveOutputFormat should implement checkOutputSpecs() method`");
    }
  }
}
