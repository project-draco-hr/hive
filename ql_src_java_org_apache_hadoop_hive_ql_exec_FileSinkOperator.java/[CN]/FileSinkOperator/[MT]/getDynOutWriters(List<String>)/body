{
  RecordWriter[] rw;
  String dpDir=getDynPartDirectory(row,dpColNames,numDynParts);
  if (dpDir != null) {
    FSPaths fsp2=valToPaths.get(dpDir);
    if (fsp2 == null) {
      if (valToPaths.size() > maxPartitions) {
        incrCounter(fatalErrorCntr,1);
        fatalError=true;
        LOG.error("Fatal error was thrown due to exceeding number of dynamic partitions");
      }
      fsp2=new FSPaths(specPath);
      fsp2.tmpPath=new Path(fsp2.tmpPath,dpDir);
      createBucketFiles(fsp2);
      valToPaths.put(dpDir,fsp2);
    }
    if (conf.isGatherStats()) {
      fsp2.stat.increaseNumRows(1);
    }
    rw=fsp2.outWriters;
  }
 else {
    rw=fsp.outWriters;
  }
  return rw;
}
