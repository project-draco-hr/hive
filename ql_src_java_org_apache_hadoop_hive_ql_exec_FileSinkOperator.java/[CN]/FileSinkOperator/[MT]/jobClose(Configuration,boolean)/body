{
  try {
    if (conf != null) {
      fs=FileSystem.get(hconf);
      Path tmpPath=Utilities.toTempPath(conf.getDirName());
      Path finalPath=new Path(conf.getDirName());
      if (success) {
        if (fs.exists(tmpPath)) {
          LOG.info("Renaming tmp dir: " + tmpPath + " to: "+ finalPath);
          if (!fs.rename(tmpPath,finalPath)) {
            throw new HiveException("Unable to commit result directory: " + finalPath);
          }
          Utilities.removeTempFiles(fs,finalPath);
        }
      }
 else {
        fs.delete(tmpPath);
      }
    }
  }
 catch (  IOException e) {
    throw new HiveException(e);
  }
  super.jobClose(hconf,success);
}
