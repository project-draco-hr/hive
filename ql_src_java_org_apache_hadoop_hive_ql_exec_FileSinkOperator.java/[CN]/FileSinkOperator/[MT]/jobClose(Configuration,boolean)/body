{
  try {
    if (conf != null) {
      String specPath=conf.getDirName();
      fs=(new Path(specPath)).getFileSystem(hconf);
      Path tmpPath=Utilities.toTempPath(specPath);
      Path finalPath=new Path(specPath);
      if (success) {
        if (fs.exists(tmpPath)) {
          LOG.info("Moving tmp dir: " + tmpPath + " to: "+ finalPath);
          renameOrMoveFiles(fs,tmpPath,finalPath);
          Utilities.removeTempFiles(fs,finalPath);
        }
      }
 else {
        fs.delete(tmpPath);
      }
    }
  }
 catch (  IOException e) {
    throw new HiveException(e);
  }
  super.jobClose(hconf,success);
}
