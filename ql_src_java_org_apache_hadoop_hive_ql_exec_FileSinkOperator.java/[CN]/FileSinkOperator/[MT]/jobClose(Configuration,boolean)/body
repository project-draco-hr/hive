{
  try {
    if (conf != null) {
      String specPath=conf.getDirName();
      fs=(new Path(specPath)).getFileSystem(hconf);
      Path tmpPath=Utilities.toTempPath(specPath);
      Path intermediatePath=new Path(tmpPath.getParent(),tmpPath.getName() + ".intermediate");
      Path finalPath=new Path(specPath);
      if (success) {
        if (fs.exists(tmpPath)) {
          LOG.info("Moving tmp dir: " + tmpPath + " to: "+ intermediatePath);
          Utilities.rename(fs,tmpPath,intermediatePath);
          Utilities.removeTempOrDuplicateFiles(fs,intermediatePath);
          LOG.info("Moving tmp dir: " + intermediatePath + " to: "+ finalPath);
          Utilities.renameOrMoveFiles(fs,intermediatePath,finalPath);
        }
      }
 else {
        fs.delete(tmpPath,true);
      }
    }
  }
 catch (  IOException e) {
    throw new HiveException(e);
  }
  super.jobClose(hconf,success);
}
