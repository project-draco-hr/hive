{
  FSPaths fp;
  String dpDir=getDynPartDirectory(row,dpColNames,numDynParts);
  if (dpDir != null) {
    FSPaths fsp2=valToPaths.get(dpDir);
    if (fsp2 == null) {
      if (valToPaths.size() > maxPartitions) {
        incrCounter(fatalErrorCntr,1);
        fatalError=true;
        LOG.error("Fatal error was thrown due to exceeding number of dynamic partitions");
      }
      fsp2=new FSPaths(specPath);
      if (childSpecPathDynLinkedPartitions != null) {
        fsp2.tmpPath=new Path(fsp2.tmpPath,dpDir + Path.SEPARATOR + childSpecPathDynLinkedPartitions);
        fsp2.taskOutputTempPath=new Path(fsp2.taskOutputTempPath,dpDir + Path.SEPARATOR + childSpecPathDynLinkedPartitions);
      }
 else {
        fsp2.tmpPath=new Path(fsp2.tmpPath,dpDir);
        fsp2.taskOutputTempPath=new Path(fsp2.taskOutputTempPath,dpDir);
      }
      createBucketFiles(fsp2);
      valToPaths.put(dpDir,fsp2);
    }
    fp=fsp2;
  }
 else {
    fp=fsp;
  }
  return fp;
}
