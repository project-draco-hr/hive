{
  super.initialize(hconf,reporter,inputObjInspector);
  try {
    serializer=(Serializer)conf.getTableInfo().getDeserializerClass().newInstance();
    serializer.initialize(null,conf.getTableInfo().getProperties());
    JobConf jc;
    if (hconf instanceof JobConf) {
      jc=(JobConf)hconf;
    }
 else {
      jc=new JobConf(hconf,ExecDriver.class);
    }
    int id=conf.getDestTableId();
    if ((id != 0) && (id <= TableIdEnum.values().length)) {
      String enumName="TABLE_ID_" + String.valueOf(id) + "_ROWCOUNT";
      tabIdEnum=TableIdEnum.valueOf(enumName);
      row_count=new LongWritable();
      statsMap.put(tabIdEnum,row_count);
    }
    fs=FileSystem.get(hconf);
    finalPath=new Path(Utilities.toTempPath(conf.getDirName()),Utilities.getTaskId(hconf));
    outPath=new Path(Utilities.toTempPath(conf.getDirName()),Utilities.toTempPath(Utilities.getTaskId(hconf)));
    LOG.info("Writing to temp file: " + outPath);
    HiveOutputFormat<?,?> hiveOutputFormat=conf.getTableInfo().getOutputFileFormatClass().newInstance();
    final Class<? extends Writable> outputClass=serializer.getSerializedClass();
    boolean isCompressed=conf.getCompressed();
    Path parent=Utilities.toTempPath(conf.getDirName());
    finalPath=HiveFileFormatUtils.getOutputFormatFinalPath(parent,jc,hiveOutputFormat,isCompressed,finalPath);
    tableDesc tableInfo=conf.getTableInfo();
    this.outWriter=getRecordWriter(jc,hiveOutputFormat,outputClass,isCompressed,tableInfo.getProperties(),outPath);
    try {
      Method deleteOnExit=FileSystem.class.getDeclaredMethod("deleteOnExit",new Class[]{Path.class});
      deleteOnExit.setAccessible(true);
      deleteOnExit.invoke(fs,outPath);
      autoDelete=true;
    }
 catch (    Exception e) {
    }
  }
 catch (  HiveException e) {
    throw e;
  }
catch (  Exception e) {
    e.printStackTrace();
    throw new HiveException(e);
  }
}
