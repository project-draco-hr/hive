{
  String specPath=conf.getDirName();
  JobConf jobConf=new JobConf();
  Path tmpPath=Utilities.toTempPath(specPath);
  StringBuilder sb=new StringBuilder("\n");
  try {
    DynamicPartitionCtx dpCtx=conf.getDynPartCtx();
    int numDP=dpCtx.getNumDPCols();
    FileSystem fs=tmpPath.getFileSystem(jobConf);
    int level=numDP;
    if (conf.isLinkedFileSink()) {
      level++;
    }
    FileStatus[] status=HiveStatsUtils.getFileStatusRecurse(tmpPath,level,fs);
    sb.append("Sample of ").append(Math.min(status.length,100)).append(" partitions created under ").append(tmpPath.toString()).append(":\n");
    for (int i=0; i < status.length; ++i) {
      sb.append("\t.../");
      sb.append(getPartitionSpec(status[i].getPath(),numDP)).append("\n");
    }
    sb.append("...\n");
  }
 catch (  Exception e) {
    sb.append(tmpPath).append("...\n").append(e.getMessage());
    e.printStackTrace();
  }
 finally {
    return sb.toString();
  }
}
