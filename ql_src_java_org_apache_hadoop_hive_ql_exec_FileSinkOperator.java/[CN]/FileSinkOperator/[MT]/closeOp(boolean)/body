{
  if (!bDynParts && !filesCreated) {
    createBucketFiles(fsp);
  }
  lastProgressReport=System.currentTimeMillis();
  if (!abort) {
    for (    FSPaths fsp : valToPaths.values()) {
      fsp.closeWriters(abort);
      if (conf.isGatherStats() && isCollectRWStats) {
        for (int idx=0; idx < fsp.outWriters.length; idx++) {
          FSRecordWriter outWriter=fsp.outWriters[idx];
          if (outWriter != null) {
            SerDeStats stats=((StatsProvidingRecordWriter)outWriter).getStats();
            if (stats != null) {
              fsp.stat.addToStat(StatsSetupConst.RAW_DATA_SIZE,stats.getRawDataSize());
              fsp.stat.addToStat(StatsSetupConst.ROW_COUNT,stats.getRowCount());
            }
          }
        }
      }
      if (isNativeTable) {
        fsp.commit(fs);
      }
    }
    if (conf.isGatherStats()) {
      publishStats();
    }
  }
 else {
    for (    FSPaths fsp : valToPaths.values()) {
      fsp.abortWriters(fs,abort,!autoDelete && isNativeTable);
    }
  }
}
