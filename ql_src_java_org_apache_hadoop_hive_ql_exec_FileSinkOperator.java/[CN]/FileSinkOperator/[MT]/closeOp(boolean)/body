{
  if (!bDynParts && !filesCreated) {
    createBucketFiles(fsp);
  }
  lastProgressReport=System.currentTimeMillis();
  if (!abort) {
    for (    FSPaths fsp : valToPaths.values()) {
      fsp.closeWriters(abort);
      if (isNativeTable) {
        fsp.commit(fs);
      }
    }
    if (conf.isGatherStats()) {
      publishStats();
    }
  }
 else {
    for (    FSPaths fsp : valToPaths.values()) {
      fsp.abortWriters(fs,abort,!autoDelete && isNativeTable);
    }
  }
}
