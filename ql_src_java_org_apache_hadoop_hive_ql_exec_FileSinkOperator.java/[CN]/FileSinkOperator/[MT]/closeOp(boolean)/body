{
  if (!filesCreated)   openFiles(hconf);
  if (!abort) {
    for (int idx=0; idx < numFiles; idx++) {
      if (outWriters[idx] != null) {
        try {
          outWriters[idx].close(abort);
          commit(idx);
        }
 catch (        IOException e) {
          throw new HiveException(e);
        }
      }
    }
  }
 else {
    try {
      for (int idx=0; idx < numFiles; idx++) {
        outWriters[idx].close(abort);
        if (!autoDelete && isNativeTable) {
          fs.delete(outPaths[idx],true);
        }
      }
    }
 catch (    Exception e) {
      e.printStackTrace();
    }
  }
}
