{
  if (data == null || key == null) {
    return null;
  }
  if (data instanceof ObjectArrayWritable) {
    final Object[] mapContainer=((ObjectArrayWritable)data).get();
    if (mapContainer == null || mapContainer.length == 0) {
      return null;
    }
    final Object[] mapArray=((ObjectArrayWritable)mapContainer[0]).get();
    for (    final Object obj : mapArray) {
      final ObjectArrayWritable mapObj=(ObjectArrayWritable)obj;
      final Object[] arr=mapObj.get();
      if (key.equals(arr[0])) {
        return arr[1];
      }
    }
    return null;
  }
  if (data instanceof Map) {
    return ((Map)data).get(key);
  }
  throw new UnsupportedOperationException("Cannot inspect " + data.getClass().getCanonicalName());
}
