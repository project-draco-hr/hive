{
  TOpenSessionReq openReq=new TOpenSessionReq();
  TSessionHandle sessHandle=client.OpenSession(openReq).getSessionHandle();
  assertNotNull(sessHandle);
  String queryString="SET hive.lock.manager=" + "org.apache.hadoop.hive.ql.lockmgr.EmbeddedLockManager";
  executeQuery(queryString,sessHandle,false);
  queryString="DROP TABLE IF EXISTS TEST_EXEC_THRIFT";
  executeQuery(queryString,sessHandle,false);
  queryString="CREATE TABLE TEST_EXEC_THRIFT(ID STRING)";
  executeQuery(queryString,sessHandle,false);
  queryString="SELECT ID FROM TEST_EXEC_THRIFT";
  TExecuteStatementResp execResp=executeQuery(queryString,sessHandle,false);
  TOperationHandle operationHandle=execResp.getOperationHandle();
  assertNotNull(operationHandle);
  TGetOperationStatusReq opStatusReq=new TGetOperationStatusReq();
  opStatusReq.setOperationHandle(operationHandle);
  assertNotNull(opStatusReq);
  TGetOperationStatusResp opStatusResp=client.GetOperationStatus(opStatusReq);
  TOperationState state=opStatusResp.getOperationState();
  assertEquals("Query should be finished",TOperationState.FINISHED_STATE,state);
  queryString="DROP TABLE TEST_EXEC_THRIFT";
  executeQuery(queryString,sessHandle,false);
  TCloseSessionReq closeReq=new TCloseSessionReq(sessHandle);
  client.CloseSession(closeReq);
}
