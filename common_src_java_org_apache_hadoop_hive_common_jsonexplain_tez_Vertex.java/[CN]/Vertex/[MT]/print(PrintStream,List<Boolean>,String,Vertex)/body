{
  if (TezJsonParser.printSet.contains(this) && !hasMultiReduceOp) {
    if (type != null) {
      out.println(TezJsonParser.prefixString(indentFlag,"|<-") + " Please refer to the previous " + this.name+ " ["+ type+ "]");
    }
 else {
      out.println(TezJsonParser.prefixString(indentFlag,"|<-") + " Please refer to the previous " + this.name);
    }
    return;
  }
  TezJsonParser.printSet.add(this);
  if (type != null) {
    out.println(TezJsonParser.prefixString(indentFlag,"|<-") + this.name + " ["+ type+ "]");
  }
 else   if (this.name != null) {
    out.println(TezJsonParser.prefixString(indentFlag) + this.name);
  }
  if (hasMultiReduceOp && !callingVertex.union) {
    Op choose=null;
    for (    Op op : this.rootOps) {
      if (op.outputVertexName.equals(callingVertex.name)) {
        choose=op;
      }
    }
    if (choose != null) {
      choose.print(out,indentFlag,false);
    }
 else {
      throw new Exception("Can not find the right reduce output operator for vertex " + this.name);
    }
  }
 else {
    for (    Op op : this.rootOps) {
      if (this.dummy) {
        op.print(out,indentFlag,true);
      }
 else {
        op.print(out,indentFlag,false);
      }
    }
  }
  if (this.union) {
    for (int index=0; index < this.parentConnections.size(); index++) {
      Connection connection=this.parentConnections.get(index);
      List<Boolean> unionFlag=new ArrayList<>();
      unionFlag.addAll(indentFlag);
      if (index != this.parentConnections.size() - 1) {
        unionFlag.add(true);
      }
 else {
        unionFlag.add(false);
      }
      connection.from.print(out,unionFlag,connection.type,this);
    }
  }
}
