{
  ScanPlan newPlan=new ScanPlan();
  newPlan.markers.putAll(markers);
  for (  String keyName : other.markers.keySet()) {
    if (newPlan.markers.containsKey(keyName)) {
      ScanMarker greaterStartMarker=getComparedMarker(this.getStartMarker(keyName),other.getStartMarker(keyName),true);
      if (greaterStartMarker != null) {
        newPlan.setStartMarker(keyName,greaterStartMarker.type,greaterStartMarker.value,greaterStartMarker.isInclusive);
      }
      ScanMarker lesserEndMarker=getComparedMarker(this.getEndMarker(keyName),other.getEndMarker(keyName),false);
      if (lesserEndMarker != null) {
        newPlan.setEndMarker(keyName,lesserEndMarker.type,lesserEndMarker.value,lesserEndMarker.isInclusive);
      }
    }
 else {
      newPlan.markers.put(keyName,other.markers.get(keyName));
    }
  }
  newPlan.ops.addAll(ops);
  newPlan.ops.addAll(other.ops);
  return newPlan;
}
