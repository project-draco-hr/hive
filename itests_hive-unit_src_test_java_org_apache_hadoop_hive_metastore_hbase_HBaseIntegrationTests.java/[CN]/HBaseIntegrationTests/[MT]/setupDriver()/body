{
  HBaseReadWrite.setConf(conf);
  conf=new HiveConf();
  conf.setVar(HiveConf.ConfVars.DYNAMICPARTITIONINGMODE,"nonstrict");
  conf.setVar(HiveConf.ConfVars.METASTORE_RAW_STORE_IMPL,"org.apache.hadoop.hive.metastore.hbase.HBaseStore");
  conf.setBoolVar(HiveConf.ConfVars.METASTORE_FASTPATH,true);
  conf.setBoolVar(HiveConf.ConfVars.HIVE_SUPPORT_CONCURRENCY,false);
  conf.setBoolVar(HiveConf.ConfVars.HIVE_TEST_AUTHORIZATION_SQLSTD_HS2_MODE,true);
  conf.setVar(HiveConf.ConfVars.HIVE_AUTHORIZATION_MANAGER,SQLStdHiveAuthorizerFactoryForTest.class.getName());
  conf.setVar(HiveConf.ConfVars.HIVE_AUTHENTICATOR_MANAGER,SessionStateConfigUserAuthenticator.class.getName());
  conf.setBoolVar(HiveConf.ConfVars.HIVE_AUTHORIZATION_ENABLED,true);
  conf.setVar(HiveConf.ConfVars.USERS_IN_ADMIN_ROLE,System.getProperty("user.name"));
  conf.setVar(HiveConf.ConfVars.HIVEMAPREDMODE,"nonstrict");
  SessionState.start(new CliSessionState(conf));
  driver=new Driver(conf);
}
