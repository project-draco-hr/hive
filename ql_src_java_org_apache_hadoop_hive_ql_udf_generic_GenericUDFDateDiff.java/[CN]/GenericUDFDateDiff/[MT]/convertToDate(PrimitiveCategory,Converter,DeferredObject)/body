{
  assert(converter != null);
  assert(argument != null);
  if (argument.get() == null) {
    return null;
  }
  Date date=new Date();
switch (inputType) {
case STRING:
case VARCHAR:
case CHAR:
    String dateString=converter.convert(argument.get()).toString();
  try {
    date=formatter.parse(dateString);
  }
 catch (  ParseException e) {
    return null;
  }
break;
case TIMESTAMP:
Timestamp ts=((TimestampWritable)converter.convert(argument.get())).getTimestamp();
date.setTime(ts.getTime());
break;
case DATE:
DateWritable dw=(DateWritable)converter.convert(argument.get());
date=dw.get();
break;
default :
throw new UDFArgumentException("TO_DATE() only takes STRING/TIMESTAMP/DATEWRITABLE types, got " + inputType);
}
return date;
}
