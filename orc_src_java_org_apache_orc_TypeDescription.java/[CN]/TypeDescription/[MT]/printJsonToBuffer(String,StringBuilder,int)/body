{
  for (int i=0; i < indent; ++i) {
    buffer.append(' ');
  }
  buffer.append(prefix);
  buffer.append("{\"category\": \"");
  buffer.append(category.name);
  buffer.append("\", \"id\": ");
  buffer.append(getId());
  buffer.append(", \"max\": ");
  buffer.append(maxId);
switch (category) {
case DECIMAL:
    buffer.append(", \"precision\": ");
  buffer.append(precision);
buffer.append(", \"scale\": ");
buffer.append(scale);
break;
case CHAR:
case VARCHAR:
buffer.append(", \"length\": ");
buffer.append(maxLength);
break;
case LIST:
case MAP:
case UNION:
buffer.append(", \"children\": [");
for (int i=0; i < children.size(); ++i) {
buffer.append('\n');
children.get(i).printJsonToBuffer("",buffer,indent + 2);
if (i != children.size() - 1) {
buffer.append(',');
}
}
buffer.append("]");
break;
case STRUCT:
buffer.append(", \"fields\": [");
for (int i=0; i < children.size(); ++i) {
buffer.append('\n');
children.get(i).printJsonToBuffer("\"" + fieldNames.get(i) + "\": ",buffer,indent + 2);
if (i != children.size() - 1) {
buffer.append(',');
}
}
buffer.append(']');
break;
default :
break;
}
buffer.append('}');
}
