{
switch (category) {
case BOOLEAN:
case BYTE:
case SHORT:
case INT:
case LONG:
case DATE:
    return new LongColumnVector();
case TIMESTAMP:
  return new TimestampColumnVector();
case FLOAT:
case DOUBLE:
return new DoubleColumnVector();
case DECIMAL:
return new DecimalColumnVector(precision,scale);
case STRING:
case BINARY:
case CHAR:
case VARCHAR:
return new BytesColumnVector();
case STRUCT:
{
ColumnVector[] fieldVector=new ColumnVector[children.size()];
for (int i=0; i < fieldVector.length; ++i) {
fieldVector[i]=children.get(i).createColumn(maxSize);
}
return new StructColumnVector(VectorizedRowBatch.DEFAULT_SIZE,fieldVector);
}
case UNION:
{
ColumnVector[] fieldVector=new ColumnVector[children.size()];
for (int i=0; i < fieldVector.length; ++i) {
fieldVector[i]=children.get(i).createColumn(maxSize);
}
return new UnionColumnVector(VectorizedRowBatch.DEFAULT_SIZE,fieldVector);
}
case LIST:
return new ListColumnVector(VectorizedRowBatch.DEFAULT_SIZE,children.get(0).createColumn(maxSize));
case MAP:
return new MapColumnVector(VectorizedRowBatch.DEFAULT_SIZE,children.get(0).createColumn(maxSize),children.get(1).createColumn(maxSize));
default :
throw new IllegalArgumentException("Unknown type " + category);
}
}
