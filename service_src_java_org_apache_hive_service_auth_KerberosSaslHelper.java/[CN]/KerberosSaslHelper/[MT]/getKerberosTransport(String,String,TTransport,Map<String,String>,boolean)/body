{
  try {
    String[] names=principal.split("[/@]");
    if (names.length != 3) {
      throw new IllegalArgumentException("Kerberos principal should have 3 parts: " + principal);
    }
    if (assumeSubject) {
      return createSubjectAssumedTransport(principal,underlyingTransport,saslProps);
    }
 else {
      HadoopThriftAuthBridge.Client authBridge=ShimLoader.getHadoopThriftAuthBridge().createClientWithConf("kerberos");
      return authBridge.createClientTransport(principal,host,"KERBEROS",null,underlyingTransport,saslProps);
    }
  }
 catch (  IOException e) {
    throw new SaslException("Failed to open client transport",e);
  }
}
