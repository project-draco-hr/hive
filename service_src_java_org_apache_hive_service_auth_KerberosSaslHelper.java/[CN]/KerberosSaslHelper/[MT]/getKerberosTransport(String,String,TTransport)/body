{
  try {
    final String names[]=principal.split("[/@]");
    if (names.length != 3) {
      throw new IllegalArgumentException("Kerberos principal should have 3 parts: " + principal);
    }
    HadoopThriftAuthBridge.Client authBridge=ShimLoader.getHadoopThriftAuthBridge().createClientWithConf("kerberos");
    return authBridge.createClientTransport(principal,host,"KERBEROS",null,underlyingTransport);
  }
 catch (  IOException e) {
    throw new SaslException("Failed to open client transport",e);
  }
}
