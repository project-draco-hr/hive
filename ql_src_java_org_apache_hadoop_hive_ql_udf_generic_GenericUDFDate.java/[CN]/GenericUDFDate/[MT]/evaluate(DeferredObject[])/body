{
  if (arguments[0].get() == null) {
    return null;
  }
switch (inputType) {
case STRING:
    Date date;
  String dateString=textConverter.convert(arguments[0].get()).toString();
try {
  date=formatter.parse(dateString);
}
 catch (ParseException e) {
  return null;
}
output.set(formatter.format(date));
break;
case TIMESTAMP:
Timestamp ts=((TimestampWritable)timestampConverter.convert(arguments[0].get())).getTimestamp();
output.set(formatter.format(ts));
break;
case DATE:
DateWritable dw=(DateWritable)dateWritableConverter.convert(arguments[0].get());
output.set(formatter.format(dw.get()));
break;
default :
throw new UDFArgumentException("TO_DATE() only takes STRING/TIMESTAMP/DATEWRITABLE types, got " + inputType);
}
return output;
}
