{
  FireEventRequestData data=new FireEventRequestData();
  InsertEventRequestData insertData=new InsertEventRequestData();
  data.setInsertData(insertData);
  insertData.addToFilesAdded("/warehouse/mytable/today/b1");
  FireEventRequest rqst=new FireEventRequest(true,data);
  rqst.setDbName("mydb");
  rqst.setTableName("mytable");
  rqst.setPartitionVals(Arrays.asList("today"));
  msClient.fireListenerEvent(rqst);
  NotificationEventResponse rsp=msClient.getNextNotification(firstEventId,0,null);
  assertEquals(1,rsp.getEventsSize());
  NotificationEvent event=rsp.getEvents().get(0);
  assertEquals(firstEventId + 1,event.getEventId());
  assertTrue(event.getEventTime() >= startTime);
  assertEquals(HCatConstants.HCAT_INSERT_EVENT,event.getEventType());
  assertEquals("mydb",event.getDbName());
  assertEquals("mytable",event.getTableName());
  assertTrue(event.getMessage().matches("\\{\"eventType\":\"INSERT\",\"server\":\"\"," + "\"servicePrincipal\":\"\",\"db\":\"mydb\",\"table\":" + "\"mytable\",\"timestamp\":[0-9]+,\"partitionValues\":\\[\"today\"],"+ "\"files\":\\[\"/warehouse/mytable/today/b1\"]}"));
}
