{
  driver.run("create table sip (c int) partitioned by (ds string)");
  driver.run("insert into table sip partition (ds = 'today') values (1)");
  driver.run("insert into table sip partition (ds = 'today') values (2)");
  driver.run("insert into table sip partition (ds) values (3, 'today')");
  driver.run("alter table sip add partition (ds = 'yesterday')");
  driver.run("insert into table sip partition (ds = 'yesterday') values (2)");
  driver.run("insert into table sip partition (ds) values (3, 'yesterday')");
  driver.run("insert into table sip partition (ds) values (3, 'tomorrow')");
  driver.run("alter table sip drop partition (ds = 'tomorrow')");
  NotificationEventResponse rsp=msClient.getNextNotification(firstEventId,0,null);
  for (  NotificationEvent ne : rsp.getEvents())   LOG.debug("EVENT: " + ne.getMessage());
  assertEquals(19,rsp.getEventsSize());
  NotificationEvent event=rsp.getEvents().get(1);
  assertEquals(firstEventId + 2,event.getEventId());
  assertEquals(HCatConstants.HCAT_ADD_PARTITION_EVENT,event.getEventType());
  event=rsp.getEvents().get(4);
  assertEquals(firstEventId + 5,event.getEventId());
  assertEquals(HCatConstants.HCAT_INSERT_EVENT,event.getEventType());
  assertTrue(event.getMessage().matches(".*\"files\":\\[\"pfile.*"));
  event=rsp.getEvents().get(7);
  assertEquals(firstEventId + 8,event.getEventId());
  assertEquals(HCatConstants.HCAT_INSERT_EVENT,event.getEventType());
  assertTrue(event.getMessage().matches(".*\"files\":\\[\"pfile.*"));
  event=rsp.getEvents().get(9);
  assertEquals(firstEventId + 10,event.getEventId());
  assertEquals(HCatConstants.HCAT_ADD_PARTITION_EVENT,event.getEventType());
  event=rsp.getEvents().get(11);
  assertEquals(firstEventId + 12,event.getEventId());
  assertEquals(HCatConstants.HCAT_INSERT_EVENT,event.getEventType());
  assertTrue(event.getMessage().matches(".*\"files\":\\[\"pfile.*"));
  event=rsp.getEvents().get(14);
  assertEquals(firstEventId + 15,event.getEventId());
  assertEquals(HCatConstants.HCAT_INSERT_EVENT,event.getEventType());
  assertTrue(event.getMessage().matches(".*\"files\":\\[\"pfile.*"));
  event=rsp.getEvents().get(16);
  assertEquals(firstEventId + 17,event.getEventId());
  assertEquals(HCatConstants.HCAT_ADD_PARTITION_EVENT,event.getEventType());
  event=rsp.getEvents().get(18);
  assertEquals(firstEventId + 19,event.getEventId());
  assertEquals(HCatConstants.HCAT_DROP_PARTITION_EVENT,event.getEventType());
}
