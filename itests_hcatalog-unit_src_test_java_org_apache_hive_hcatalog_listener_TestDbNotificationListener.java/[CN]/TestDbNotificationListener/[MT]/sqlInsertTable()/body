{
  driver.run("create table sit (c int)");
  driver.run("insert into table sit values (1)");
  driver.run("alter table sit add columns (c2 int)");
  driver.run("drop table sit");
  NotificationEventResponse rsp=msClient.getNextNotification(firstEventId,0,null);
  assertEquals(6,rsp.getEventsSize());
  NotificationEvent event=rsp.getEvents().get(0);
  assertEquals(firstEventId + 1,event.getEventId());
  assertEquals(HCatConstants.HCAT_CREATE_TABLE_EVENT,event.getEventType());
  event=rsp.getEvents().get(2);
  assertEquals(firstEventId + 3,event.getEventId());
  assertEquals(HCatConstants.HCAT_INSERT_EVENT,event.getEventType());
  assertTrue(event.getMessage().matches(".*\"files\":\\[\"pfile.*"));
  event=rsp.getEvents().get(4);
  assertEquals(firstEventId + 5,event.getEventId());
  assertEquals(HCatConstants.HCAT_ALTER_TABLE_EVENT,event.getEventType());
  event=rsp.getEvents().get(5);
  assertEquals(firstEventId + 6,event.getEventId());
  assertEquals(HCatConstants.HCAT_DROP_TABLE_EVENT,event.getEventType());
}
