{
  howlDriver.run("drop table junit_pigstorage_delim");
  CommandProcessorResponse resp;
  String createTable="create table junit_pigstorage_delim (a string) partitioned by (b string) stored as RCFILE";
  resp=howlDriver.run(createTable);
  assertEquals(0,resp.getResponseCode());
  assertNull(resp.getErrorMessage());
  resp=howlDriver.run("alter table junit_pigstorage_delim add partition (b='2010-10-10')");
  assertEquals(0,resp.getResponseCode());
  assertNull(resp.getErrorMessage());
  resp=howlDriver.run("alter table junit_pigstorage_delim partition (b='2010-10-10') set fileformat inputformat '" + RCFileInputFormat.class.getName() + "' outputformat '"+ RCFileOutputFormat.class.getName()+ "' inputdriver '"+ MyPigStorageDriver.class.getName()+ "' outputdriver 'non-existent'");
  Partition part=msc.getPartition(MetaStoreUtils.DEFAULT_DATABASE_NAME,"junit_pigstorage_delim","b=2010-10-10");
  Map<String,String> partParms=part.getParameters();
  partParms.put(PigStorageInputDriver.delim,"control-A");
  msc.alter_partition(MetaStoreUtils.DEFAULT_DATABASE_NAME,"junit_pigstorage_delim",part);
  PigServer server=new PigServer(ExecType.LOCAL,howlConf.getAllProperties());
  UDFContext.getUDFContext().setClientSystemProps();
  server.registerQuery(" a = load 'junit_pigstorage_delim' using " + HCatLoader.class.getName() + ";");
  try {
    server.openIterator("a");
  }
 catch (  FrontendException fe) {
  }
}
