{
  String outputInfo=job.get(HCatConstants.HCAT_KEY_OUTPUT_INFO);
  OutputJobInfo outputJobInfo=(OutputJobInfo)HCatUtil.deserialize(outputInfo);
  OutputFormat<WritableComparable<?>,Put> outputFormat=null;
  if (HBaseHCatStorageHandler.isBulkMode(outputJobInfo)) {
    outputFormat=new HBaseBulkOutputFormat();
  }
 else {
    outputFormat=new HBaseDirectOutputFormat();
  }
  return outputFormat;
}
