{
  LowLevelCacheImpl cache=new LowLevelCacheImpl(LlapDaemonCacheMetrics.create("test","1"),new DummyCachePolicy(),new DummyAllocator(),true,-1);
  long fn1=1, fn2=2;
  MemoryBuffer[] fakes=new MemoryBuffer[]{fb(),fb(),fb()};
  assertNull(cache.putFileData(fn1,drs(1,2),fbs(fakes,0,1),0,Priority.NORMAL,null));
  assertNull(cache.putFileData(fn2,drs(1),fbs(fakes,2),0,Priority.NORMAL,null));
  verifyCacheGet(cache,fn1,1,3,fakes[0],fakes[1]);
  verifyCacheGet(cache,fn2,1,2,fakes[2]);
  verifyRefcount(fakes,3,3,3);
  evict(cache,fakes[0]);
  evict(cache,fakes[2]);
  verifyCacheGet(cache,fn1,1,3,dr(1,2),fakes[1]);
  verifyCacheGet(cache,fn2,1,2,dr(1,2));
  verifyRefcount(fakes,-1,4,-1);
}
