{
  Configuration conf=createConf();
  LowLevelCacheImpl cache=new LowLevelCacheImpl(conf,new DummyCachePolicy(10),new DummyAllocator(),-1);
  String fn1="file1".intern(), fn2="file2".intern();
  LlapMemoryBuffer[] fakes=new LlapMemoryBuffer[]{fb(),fb(),fb()};
  assertNull(cache.putFileData(fn1,new long[]{1,2},fbs(fakes,0,1)));
  assertNull(cache.putFileData(fn2,new long[]{1},fbs(fakes,2)));
  assertArrayEquals(fbs(fakes,0,1),cache.getFileData(fn1,new long[]{1,2}));
  assertArrayEquals(fbs(fakes,2),cache.getFileData(fn2,new long[]{1}));
  verifyRefcount(fakes,2,2,2);
  evict(cache,fakes[0]);
  evict(cache,fakes[2]);
  assertArrayEquals(fbs(fakes,-1,1),cache.getFileData(fn1,new long[]{1,2}));
  assertNull(cache.getFileData(fn2,new long[]{1}));
  verifyRefcount(fakes,-1,3,-1);
}
