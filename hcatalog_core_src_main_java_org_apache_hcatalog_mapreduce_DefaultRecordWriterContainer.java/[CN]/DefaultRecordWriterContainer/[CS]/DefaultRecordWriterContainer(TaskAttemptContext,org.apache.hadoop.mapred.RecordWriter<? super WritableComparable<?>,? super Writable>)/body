{
  super(context,baseRecordWriter);
  jobInfo=HCatOutputFormat.getJobInfo(context);
  storageHandler=HCatUtil.getStorageHandler(context.getConfiguration(),jobInfo.getTableInfo().getStorerInfo());
  HCatOutputFormat.configureOutputStorageHandler(context);
  serDe=ReflectionUtils.newInstance(storageHandler.getSerDeClass(),context.getConfiguration());
  hcatRecordOI=InternalUtil.createStructObjectInspector(jobInfo.getOutputSchema());
  try {
    InternalUtil.initializeOutputSerDe(serDe,context.getConfiguration(),jobInfo);
  }
 catch (  SerDeException e) {
    throw new IOException("Failed to initialize SerDe",e);
  }
}
