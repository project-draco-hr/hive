{
  OutputJobInfo jobInfo=HCatOutputFormat.getJobInfo(context);
  try {
    HiveConf hiveConf=HCatUtil.getHiveConf(context.getConfiguration());
    handleDuplicatePublish(context,jobInfo,HCatUtil.createHiveClient(hiveConf),jobInfo.getTableInfo().getTable());
  }
 catch (  MetaException e) {
    throw new IOException(e);
  }
catch (  TException e) {
    throw new IOException(e);
  }
catch (  NoSuchObjectException e) {
    throw new IOException(e);
  }
  if (!jobInfo.isDynamicPartitioningUsed()) {
    JobConf jobConf=new JobConf(context.getConfiguration());
    getBaseOutputFormat().checkOutputSpecs(null,jobConf);
    HCatUtil.copyConf(jobConf,context.getConfiguration());
  }
}
