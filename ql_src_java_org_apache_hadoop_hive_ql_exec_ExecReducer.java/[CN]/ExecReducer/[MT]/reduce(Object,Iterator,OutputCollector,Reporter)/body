{
  if (oc == null) {
    try {
      oc=output;
      reducer.setOutputCollector(oc);
      reducer.initialize(jc);
      rp=reporter;
    }
 catch (    HiveException e) {
      abort=true;
      e.printStackTrace();
      throw new RuntimeException("Reduce operator initialization failed");
    }
  }
  try {
    BytesWritable keyWritable=(BytesWritable)key;
    byte tag=0;
    if (isTagged) {
      int size=keyWritable.getSize() - 1;
      tag=keyWritable.get()[size];
      keyWritable.setSize(size);
    }
    if (!keyWritable.equals(groupKey)) {
      if (groupKey == null) {
        groupKey=new BytesWritable();
      }
 else {
        l4j.trace("End Group");
        reducer.endGroup();
      }
      groupKey.set(keyWritable.get(),0,keyWritable.getSize());
      l4j.trace("Start Group");
      reducer.startGroup();
    }
    try {
      keyObject=inputKeyDeserializer.deserialize(keyWritable);
    }
 catch (    SerDeException e) {
      throw new HiveException(e);
    }
    while (values.hasNext()) {
      Writable valueWritable=(Writable)values.next();
      try {
        valueObject[tag]=inputValueDeserializer[tag].deserialize(valueWritable);
      }
 catch (      SerDeException e) {
        throw new HiveException(e);
      }
      row.clear();
      row.add(keyObject);
      row.add(valueObject[tag]);
      row.add(tag);
      reducer.process(row,rowObjectInspector[tag]);
    }
  }
 catch (  HiveException e) {
    abort=true;
    throw new IOException(e);
  }
}
