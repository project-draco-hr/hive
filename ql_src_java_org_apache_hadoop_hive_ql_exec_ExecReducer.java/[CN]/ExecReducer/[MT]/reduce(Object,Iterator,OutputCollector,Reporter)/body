{
  if (oc == null) {
    try {
      oc=output;
      reducer.setOutputCollector(oc);
      reducer.initialize(jc,reporter,rowObjectInspector);
      rp=reporter;
    }
 catch (    HiveException e) {
      abort=true;
      e.printStackTrace();
      throw new RuntimeException("Reduce operator initialization failed");
    }
  }
  try {
    BytesWritable keyWritable=(BytesWritable)key;
    tag.set((byte)0);
    if (isTagged) {
      int size=keyWritable.getSize() - 1;
      tag.set(keyWritable.get()[size]);
      keyWritable.setSize(size);
    }
    if (!keyWritable.equals(groupKey)) {
      if (groupKey == null) {
        groupKey=new BytesWritable();
      }
 else {
        l4j.trace("End Group");
        reducer.endGroup();
      }
      groupKey.set(keyWritable.get(),0,keyWritable.getSize());
      l4j.trace("Start Group");
      reducer.startGroup();
    }
    try {
      keyObject=inputKeyDeserializer.deserialize(keyWritable);
    }
 catch (    SerDeException e) {
      throw new HiveException(e);
    }
    while (values.hasNext()) {
      Writable valueWritable=(Writable)values.next();
      try {
        valueObject[tag.get()]=inputValueDeserializer[tag.get()].deserialize(valueWritable);
      }
 catch (      SerDeException e) {
        throw new HiveException(e);
      }
      row.clear();
      row.add(keyObject);
      row.add(valueObject[tag.get()]);
      row.add(tag);
      cntr++;
      if (cntr == nextCntr) {
        l4j.info("ExecReducer: processing " + cntr + " rows");
        nextCntr=getNextCntr(cntr);
      }
      reducer.process(row,rowObjectInspector[tag.get()],tag.get());
    }
  }
 catch (  HiveException e) {
    abort=true;
    throw new IOException(e);
  }
}
