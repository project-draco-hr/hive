{
  if (oc == null) {
    try {
      oc=output;
      reducer.setOutputCollector(oc);
      reducer.initialize(jc);
      rp=reporter;
    }
 catch (    HiveException e) {
      abort=true;
      e.printStackTrace();
      throw new RuntimeException("Reduce operator initialization failed");
    }
  }
  try {
    HiveObject keyObject=((WritableComparableHiveObject)key).getHo();
    reducer.startGroup();
    while (values.hasNext()) {
      WritableHiveObject who=(WritableHiveObject)values.next();
      LabeledCompositeHiveObject lho=new LabeledCompositeHiveObject(fieldNames);
      lho.addHiveObject(keyObject);
      lho.addHiveObject(who.getHo());
      if (isTagged) {
        lho.addHiveObject(tagObjects[who.getTag()]);
      }
      reducer.process(lho);
    }
    reducer.endGroup();
  }
 catch (  HiveException e) {
    abort=true;
    throw new IOException(e.getMessage());
  }
}
