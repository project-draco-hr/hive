{
  try {
    conf.setBoolVar(HiveConf.ConfVars.HIVE_SERVER2_ENABLE_DOAS,false);
    conf.setVar(HiveConf.ConfVars.HIVE_SERVER2_TEZ_DEFAULT_QUEUES,"a,b,c");
    conf.setIntVar(HiveConf.ConfVars.HIVE_SERVER2_TEZ_SESSIONS_PER_DEFAULT_QUEUE,2);
    poolManager=new TestTezSessionPoolManager();
    poolManager.setupPool(conf);
    poolManager.startPool();
    TezSessionState sessionState=poolManager.getSession(null,conf);
    if (sessionState.getQueueName().compareTo("a") != 0) {
      fail();
    }
    poolManager.returnSession(sessionState);
    sessionState=poolManager.getSession(null,conf);
    if (sessionState.getQueueName().compareTo("b") != 0) {
      fail();
    }
    poolManager.returnSession(sessionState);
    sessionState=poolManager.getSession(null,conf);
    if (sessionState.getQueueName().compareTo("c") != 0) {
      fail();
    }
    poolManager.returnSession(sessionState);
    sessionState=poolManager.getSession(null,conf);
    if (sessionState.getQueueName().compareTo("a") != 0) {
      fail();
    }
    poolManager.returnSession(sessionState);
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail();
  }
}
