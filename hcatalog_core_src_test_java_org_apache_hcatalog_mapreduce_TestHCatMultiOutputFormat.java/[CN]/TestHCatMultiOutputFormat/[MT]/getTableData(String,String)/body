{
  ArrayList<String> results=new ArrayList<String>();
  ArrayList<String> temp=new ArrayList<String>();
  Hive hive=Hive.get(hiveConf);
  org.apache.hadoop.hive.ql.metadata.Table tbl=hive.getTable(database,table);
  FetchWork work;
  if (tbl.getPartCols().isEmpty()) {
    work=new FetchWork(new Path(tbl.getDataLocation()),Utilities.getTableDesc(tbl));
  }
 else {
    List<Partition> partitions=hive.getPartitions(tbl);
    List<PartitionDesc> partDesc=new ArrayList<PartitionDesc>();
    List<Path> partLocs=new ArrayList<Path>();
    for (    Partition part : partitions) {
      partLocs.add(part.getPartitionPath());
      partDesc.add(Utilities.getPartitionDesc(part));
    }
    work=new FetchWork(partLocs,partDesc,Utilities.getTableDesc(tbl));
    work.setLimit(100);
  }
  FetchTask task=new FetchTask();
  task.setWork(work);
  task.initialize(hiveConf,null,null);
  task.fetch(temp);
  for (  String str : temp) {
    results.add(str.replace("\t",","));
  }
  return results;
}
