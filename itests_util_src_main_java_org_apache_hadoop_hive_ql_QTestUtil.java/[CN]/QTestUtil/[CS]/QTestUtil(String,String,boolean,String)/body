{
  this.outDir=outDir;
  this.logDir=logDir;
  conf=new HiveConf(Driver.class);
  this.miniMr=miniMr;
  this.hadoopVer=getHadoopMainVersion(hadoopVer);
  qMap=new TreeMap<String,String>();
  qSkipSet=new HashSet<String>();
  qSortSet=new HashSet<String>();
  if (miniMr) {
    dfs=ShimLoader.getHadoopShims().getMiniDfs(conf,4,true,null);
    FileSystem fs=dfs.getFileSystem();
    mr=ShimLoader.getHadoopShims().getMiniMrCluster(conf,4,getHdfsUriString(fs.getUri().toString()),1);
  }
  initConf();
  String dataDir=conf.get("test.data.files");
  if (dataDir == null) {
    dataDir=new File(".").getAbsolutePath() + "/data/files";
  }
  testFiles=dataDir;
  overWrite="true".equalsIgnoreCase(System.getProperty("test.output.overwrite"));
  setup=new QTestSetup();
  setup.preTest(conf);
  init();
}
