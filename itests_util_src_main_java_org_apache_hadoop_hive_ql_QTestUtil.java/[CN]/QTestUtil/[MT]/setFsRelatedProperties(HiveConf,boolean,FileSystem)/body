{
  String fsUriString=WindowsPathUtil.getHdfsUriString(fs.getUri().toString());
  Path warehousePath;
  Path jarPath;
  Path userInstallPath;
  if (isLocalFs) {
    String buildDir=System.getProperty(BUILD_DIR_PROPERTY);
    Preconditions.checkState(Strings.isNotBlank(buildDir));
    Path path=new Path(fsUriString,buildDir);
    Path localFsRoot=new Path(path,"localfs");
    warehousePath=new Path(localFsRoot,"warehouse");
    jarPath=new Path(localFsRoot,"jar");
    userInstallPath=new Path(localFsRoot,"user_install");
  }
 else {
    warehousePath=new Path(fsUriString,"/build/ql/test/data/warehouse/");
    jarPath=new Path(new Path(fsUriString,"/user"),"hive");
    userInstallPath=new Path(fsUriString,"/user");
  }
  warehousePath=fs.makeQualified(warehousePath);
  jarPath=fs.makeQualified(jarPath);
  userInstallPath=fs.makeQualified(userInstallPath);
  conf.set(CommonConfigurationKeysPublic.FS_DEFAULT_NAME_KEY,fsUriString);
  conf.setVar(ConfVars.METASTOREWAREHOUSE,warehousePath.toString());
  conf.setVar(ConfVars.HIVE_JAR_DIRECTORY,jarPath.toString());
  conf.setVar(ConfVars.HIVE_USER_INSTALL_DIR,userInstallPath.toString());
}
