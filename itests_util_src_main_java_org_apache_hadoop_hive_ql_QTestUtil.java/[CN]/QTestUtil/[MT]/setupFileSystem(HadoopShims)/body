{
  if (fsType == FsType.local) {
    fs=FileSystem.getLocal(conf);
  }
 else   if (fsType == FsType.hdfs || fsType == FsType.encrypted_hdfs) {
    int numDataNodes=4;
    if (fsType == FsType.encrypted_hdfs) {
      conf.set(SECURITY_KEY_PROVIDER_URI_NAME,getKeyProviderURI());
      conf.setInt("fs.trash.interval",50);
      dfs=shims.getMiniDfs(conf,numDataNodes,true,null);
      fs=dfs.getFileSystem();
      hes=shims.createHdfsEncryptionShim(fs,conf);
      LOG.info("key provider is initialized");
    }
 else {
      dfs=shims.getMiniDfs(conf,numDataNodes,true,null);
      fs=dfs.getFileSystem();
    }
  }
 else {
    throw new IllegalArgumentException("Unknown or unhandled fsType [" + fsType + "]");
  }
}
