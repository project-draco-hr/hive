{
  if (!isSessionStateStarted) {
    startSessionState();
  }
  conf.setBoolean("hive.test.init.phase",true);
  String initCommands=readEntireFileIntoString(new File(this.initScript));
  LOG.info("Initial setup (" + initScript + "):\n"+ initCommands);
  if (cliDriver == null) {
    cliDriver=new CliDriver();
  }
  cliDriver.processLine("set test.data.dir=" + testFiles + ";");
  cliDriver.processLine(initCommands);
  conf.setBoolean("hive.test.init.phase",false);
  HBaseAdmin admin=utility.getHBaseAdmin();
  for (  String tableName : HBaseReadWrite.tableNames) {
    admin.snapshot("snapshot_" + tableName,tableName);
  }
  snapshotTaken=true;
}
