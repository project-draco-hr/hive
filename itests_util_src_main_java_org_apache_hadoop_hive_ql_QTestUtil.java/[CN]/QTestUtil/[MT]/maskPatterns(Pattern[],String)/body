{
  String maskPattern="#### A masked pattern was here ####";
  String line;
  BufferedReader in;
  BufferedWriter out;
  File file=new File(fname);
  File fileOrig=new File(fname + ".orig");
  FileUtils.copyFile(file,fileOrig);
  in=new BufferedReader(new InputStreamReader(new FileInputStream(fileOrig),"UTF-8"));
  out=new BufferedWriter(new OutputStreamWriter(new FileOutputStream(file),"UTF-8"));
  boolean lastWasMasked=false;
  while (null != (line=in.readLine())) {
    for (    Pattern pattern : patterns) {
      line=pattern.matcher(line).replaceAll(maskPattern);
    }
    if (line.equals(maskPattern)) {
      if (!lastWasMasked) {
        out.write(line);
        out.write("\n");
        lastWasMasked=true;
      }
    }
 else {
      out.write(line);
      out.write("\n");
      lastWasMasked=false;
    }
  }
  in.close();
  out.close();
}
