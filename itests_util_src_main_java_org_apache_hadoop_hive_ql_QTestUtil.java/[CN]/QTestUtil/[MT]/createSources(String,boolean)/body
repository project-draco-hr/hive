{
  boolean canReuseSession=(tname == null) || !qNoSessionReuseQuerySet.contains(tname);
  if (!isSessionStateStarted) {
    startSessionState(canReuseSession);
  }
  if (cliDriver == null) {
    cliDriver=new CliDriver();
  }
  File scriptFile=new File(this.initScript);
  if (!scriptFile.isFile()) {
    LOG.info("No init script detected. Skipping");
    if (attemptingCacheUsage) {
      setupDbsEtc(true,true);
    }
    return;
  }
  if (!attemptingCacheUsage || forceCreate) {
    LOG.info("Creating sources without data caching. attemptingCacheUsage={}, forceCreate={}",attemptingCacheUsage,forceCreate);
    cliDriver.processLine("set test.data.dir=" + testFiles + ";");
    conf.setBoolean("hive.test.init.phase",true);
    createSourcesNonCached(scriptFile);
  }
 else {
    LOG.info("Creating sources with data caching");
    createSourcesCached(scriptFile);
  }
  conf.setBoolean("hive.test.init.phase",false);
}
