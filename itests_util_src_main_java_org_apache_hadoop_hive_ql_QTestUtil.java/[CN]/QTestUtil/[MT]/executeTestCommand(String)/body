{
  String commandName=command.trim().split("\\s+")[0];
  String commandArgs=command.trim().substring(commandName.length());
  if (commandArgs.endsWith(";")) {
    commandArgs=StringUtils.chop(commandArgs);
  }
  String wareHouseDir=SessionState.get().getConf().getVar(ConfVars.METASTOREWAREHOUSE).replaceAll("^[a-zA-Z]+://.*?:\\d+","");
  commandArgs=commandArgs.replaceAll("\\$\\{hiveconf:hive\\.metastore\\.warehouse\\.dir\\}",wareHouseDir);
  enableTestOnlyCmd(SessionState.get().getConf());
  try {
    CommandProcessor proc=getTestCommand(commandName);
    if (proc != null) {
      CommandProcessorResponse response=proc.run(commandArgs.trim());
      int rc=response.getResponseCode();
      if (rc != 0) {
        SessionState.get().out.println(response);
      }
      return rc;
    }
 else {
      throw new RuntimeException("Could not get CommandProcessor for command: " + commandName);
    }
  }
 catch (  Exception e) {
    throw new RuntimeException("Could not execute test command: " + e.getMessage());
  }
}
