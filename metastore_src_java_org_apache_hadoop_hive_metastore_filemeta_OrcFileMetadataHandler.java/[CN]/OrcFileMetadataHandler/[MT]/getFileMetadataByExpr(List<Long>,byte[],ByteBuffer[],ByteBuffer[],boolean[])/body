{
  SearchArgument sarg=getExpressionProxy().createSarg(expr);
  if (metadatas == null) {
    metadatas=new ByteBuffer[results.length];
  }
  getStore().getFileMetadata(fileIds,metadatas);
  for (int i=0; i < metadatas.length; ++i) {
    eliminated[i]=false;
    results[i]=null;
    if (metadatas[i] == null)     continue;
    ByteBuffer metadata=metadatas[i].duplicate();
    SplitInfos result=null;
    try {
      result=getFileFormatProxy().applySargToMetadata(sarg,metadata);
    }
 catch (    IOException ex) {
      LOG.error("Failed to apply SARG to metadata",ex);
      metadatas[i]=null;
      continue;
    }
    eliminated[i]=(result == null);
    if (!eliminated[i]) {
      results[i]=ByteBuffer.wrap(result.toByteArray());
    }
  }
}
