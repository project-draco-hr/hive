{
  super.setUp();
  hiveConf=new HiveConf(this.getClass());
  if (isServerStarted) {
    assertNotNull("Unable to connect to the MetaStore server",msc);
    return;
  }
  int port=MetaStoreUtils.findFreePort();
  System.out.println("Starting MetaStore Server on port " + port);
  System.setProperty(ConfVars.METASTORE_EVENT_LISTENERS.varname,IpAddressListener.class.getName());
  MetaStoreUtils.startMetaStore(port,ShimLoader.getHadoopThriftAuthBridge());
  isServerStarted=true;
  createClient(port);
}
