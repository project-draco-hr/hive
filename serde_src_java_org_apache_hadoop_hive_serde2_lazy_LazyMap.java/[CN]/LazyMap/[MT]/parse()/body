{
  parsed=true;
  byte itemSeparator=oi.getItemSeparator();
  byte keyValueSeparator=oi.getKeyValueSeparator();
  boolean isEscaped=oi.isEscaped();
  byte escapeChar=oi.getEscapeChar();
  if (length == 0) {
    mapSize=0;
    return;
  }
  mapSize=0;
  int arrayByteEnd=start + length;
  int elementByteBegin=start;
  int keyValueSeparatorPosition=-1;
  int elementByteEnd=start;
  byte[] bytes=this.bytes.getData();
  while (elementByteEnd <= arrayByteEnd) {
    if (elementByteEnd == arrayByteEnd || bytes[elementByteEnd] == itemSeparator) {
      if (keyStart == null || mapSize + 1 == keyStart.length) {
        enlargeArrays();
      }
      keyStart[mapSize]=elementByteBegin;
      keyEnd[mapSize]=(keyValueSeparatorPosition == -1 ? elementByteEnd : keyValueSeparatorPosition);
      keyValueSeparatorPosition=-1;
      mapSize++;
      elementByteBegin=elementByteEnd + 1;
    }
    if (keyValueSeparatorPosition == -1 && elementByteEnd != arrayByteEnd && bytes[elementByteEnd] == keyValueSeparator) {
      keyValueSeparatorPosition=elementByteEnd;
    }
    if (isEscaped && bytes[elementByteEnd] == escapeChar && elementByteEnd + 1 < arrayByteEnd) {
      elementByteEnd+=2;
    }
 else {
      elementByteEnd++;
    }
  }
  keyStart[mapSize]=arrayByteEnd + 1;
  if (mapSize > 0) {
    Arrays.fill(keyInited,0,mapSize,false);
    Arrays.fill(valueInited,0,mapSize,false);
  }
}
