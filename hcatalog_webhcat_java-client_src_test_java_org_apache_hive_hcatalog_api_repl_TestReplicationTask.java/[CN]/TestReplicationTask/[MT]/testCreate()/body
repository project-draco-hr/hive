{
  Table t=new Table();
  t.setDbName("testdb");
  t.setTableName("testtable");
  NotificationEvent event=new NotificationEvent(0,(int)System.currentTimeMillis(),HCatConstants.HCAT_CREATE_TABLE_EVENT,msgFactory.buildCreateTableMessage(t).toString());
  event.setDbName(t.getDbName());
  event.setTableName(t.getTableName());
  ReplicationTask.resetFactory(null);
  ReplicationTask rtask=ReplicationTask.create(HCatClient.create(new HiveConf()),new HCatNotificationEvent(event));
  assertTrue("Provided factory instantiation should yield CreateTableReplicationTask",rtask instanceof CreateTableReplicationTask);
  ReplicationTask.resetFactory(NoopFactory.class);
  rtask=ReplicationTask.create(HCatClient.create(new HiveConf()),new HCatNotificationEvent(event));
  assertTrue("Provided factory instantiation should yield NoopReplicationTask",rtask instanceof NoopReplicationTask);
  ReplicationTask.resetFactory(null);
}
