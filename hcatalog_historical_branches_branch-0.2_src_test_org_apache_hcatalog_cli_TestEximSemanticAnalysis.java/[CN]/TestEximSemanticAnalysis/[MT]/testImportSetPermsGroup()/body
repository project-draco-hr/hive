{
  hcatDriver.run("drop table junit_sem_analysis");
  hcatDriver.run("drop table junit_sem_analysis_imported");
  CommandProcessorResponse response=hcatDriver.run("create table junit_sem_analysis (a int) partitioned by (b string) stored as RCFILE");
  assertEquals(0,response.getResponseCode());
  Runtime.getRuntime().exec("rm -rf /tmp/hcat");
  response=hcatDriver.run("export table junit_sem_analysis to 'pfile://local:9080/tmp/hcat/exports/junit_sem_analysis'");
  assertEquals(0,response.getResponseCode());
  response=hcatDriver.run("drop table junit_sem_analysis");
  assertEquals(0,response.getResponseCode());
  hcatConf.set(HCatConstants.HCAT_PERMS,"-rwxrw-r--");
  hcatConf.set(HCatConstants.HCAT_GROUP,"nosuchgroup");
  response=hcatDriver.run("import table junit_sem_analysis_imported from 'pfile://local:9080/tmp/hcat/exports/junit_sem_analysis'");
  assertEquals(0,response.getResponseCode());
  Path whPath=wh.getTablePath(Hive.get(hcatConf).getDatabase("default"),"junit_sem_analysis_imported");
  assertEquals(FsPermission.valueOf("-rwxrw-r--"),cluster.getFileSystem().getFileStatus(whPath).getPermission());
  assertEquals("nosuchgroup",cluster.getFileSystem().getFileStatus(whPath).getGroup());
  Runtime.getRuntime().exec("rm -rf /tmp/hcat");
  response=hcatDriver.run("drop table junit_sem_analysis_imported");
  if (response.getResponseCode() != 0) {
    System.err.println(response.getErrorMessage());
    fail("Drop table failed");
  }
}
