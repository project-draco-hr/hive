{
  hcatConf=new HiveConf(this.getClass());
  URI fsuri=getFileSystem().getUri();
  Path whPath=new Path(fsuri.getScheme(),fsuri.getAuthority(),getTestDir());
  hcatConf.set(HiveConf.ConfVars.HIVE_SUPPORT_CONCURRENCY.varname,"false");
  hcatConf.set(HiveConf.ConfVars.PREEXECHOOKS.varname,"");
  hcatConf.set(HiveConf.ConfVars.POSTEXECHOOKS.varname,"");
  hcatConf.set(ConfVars.METASTOREWAREHOUSE.varname,whPath.toString());
  for (  Map.Entry<String,String> el : getHbaseConf()) {
    if (el.getKey().startsWith("hbase.")) {
      hcatConf.set(el.getKey(),el.getValue());
    }
  }
  driver=new Driver(hcatConf);
  SessionState.start(new CliSessionState(hcatConf));
}
