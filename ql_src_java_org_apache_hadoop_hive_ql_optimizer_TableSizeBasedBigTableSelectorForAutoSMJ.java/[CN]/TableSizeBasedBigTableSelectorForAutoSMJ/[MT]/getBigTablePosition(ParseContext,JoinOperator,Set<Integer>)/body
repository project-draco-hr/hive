{
  int bigTablePos=-1;
  long maxSize=-1;
  HiveConf conf=parseCtx.getConf();
  try {
    List<TableScanOperator> topOps=new ArrayList<TableScanOperator>();
    getListTopOps(joinOp,topOps);
    int currentPos=0;
    for (    TableScanOperator topOp : topOps) {
      if (topOp == null) {
        return -1;
      }
      if (!bigTableCandidates.contains(currentPos)) {
        currentPos++;
        continue;
      }
      Table table=parseCtx.getTopToTable().get(topOp);
      long currentSize=0;
      if (!table.isPartitioned()) {
        currentSize=getSize(conf,table);
      }
 else {
        PrunedPartitionList partsList=PartitionPruner.prune(topOp,parseCtx,null);
        for (        Partition part : partsList.getNotDeniedPartns()) {
          currentSize+=getSize(conf,part);
        }
      }
      if (currentSize > maxSize) {
        maxSize=currentSize;
        bigTablePos=currentPos;
      }
      currentPos++;
    }
  }
 catch (  HiveException e) {
    throw new SemanticException(e.getMessage());
  }
  return bigTablePos;
}
