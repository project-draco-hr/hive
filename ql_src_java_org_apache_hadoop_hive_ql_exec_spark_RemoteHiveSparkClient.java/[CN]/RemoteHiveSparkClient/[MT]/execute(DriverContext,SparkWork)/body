{
  final Context ctx=driverContext.getCtx();
  final HiveConf hiveConf=(HiveConf)ctx.getConf();
  refreshLocalResources(sparkWork,hiveConf);
  final JobConf jobConf=new JobConf(hiveConf);
  final Path emptyScratchDir=ctx.getMRTmpPath();
  FileSystem fs=emptyScratchDir.getFileSystem(jobConf);
  fs.mkdirs(emptyScratchDir);
  byte[] jobConfBytes=KryoSerializer.serializeJobConf(jobConf);
  byte[] scratchDirBytes=KryoSerializer.serialize(emptyScratchDir);
  byte[] sparkWorkBytes=KryoSerializer.serialize(sparkWork);
  long timeout=hiveConf.getTimeVar(HiveConf.ConfVars.SPARK_CLIENT_FUTURE_TIMEOUT,TimeUnit.SECONDS);
  JobHandle<Serializable> jobHandle=remoteClient.submit(new JobStatusJob(jobConfBytes,scratchDirBytes,sparkWorkBytes));
  return new RemoteSparkJobRef(jobHandle,new RemoteSparkJobStatus(remoteClient,jobHandle,timeout));
}
