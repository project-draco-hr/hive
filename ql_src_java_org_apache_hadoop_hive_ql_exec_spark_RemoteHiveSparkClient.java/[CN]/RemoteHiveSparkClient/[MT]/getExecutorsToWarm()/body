{
  int minExecutors=HiveConf.getIntVar(hiveConf,HiveConf.ConfVars.SPARK_PREWARM_NUM_CONTAINERS);
  boolean dynamicAllocation=hiveConf.getBoolean("spark.dynamicAllocation.enabled",false);
  if (dynamicAllocation) {
    int min=sparkConf.getInt("spark.dynamicAllocation.minExecutors",0);
    int initExecutors=sparkConf.getInt("spark.dynamicAllocation.initialExecutors",min);
    minExecutors=Math.min(minExecutors,initExecutors);
  }
 else {
    int execInstances=sparkConf.getInt("spark.executor.instances",2);
    minExecutors=Math.min(minExecutors,execInstances);
  }
  return minExecutors;
}
