{
  StatsPublisher statsPublisher=Utilities.getStatsPublisher(jc);
  if (!statsPublisher.connect(jc)) {
    LOG.info("StatsPublishing error: cannot connect to database.");
    return;
  }
  String key;
  String taskID=Utilities.getTaskIdFromFilename(Utilities.getTaskId(hconf));
  Map<String,String> statsToPublish=new HashMap<String,String>();
  for (  String pspecs : stats.keySet()) {
    statsToPublish.clear();
    if (pspecs.isEmpty()) {
      key=conf.getStatsAggPrefix() + taskID;
    }
 else {
      key=conf.getStatsAggPrefix() + pspecs + Path.SEPARATOR+ taskID;
    }
    for (    String statType : stats.get(pspecs).getStoredStats()) {
      statsToPublish.put(statType,Long.toString(stats.get(pspecs).getStat(statType)));
    }
    statsPublisher.publishStat(key,statsToPublish);
    LOG.info("publishing : " + key + " : "+ statsToPublish.toString());
  }
  statsPublisher.closeConnection();
}
