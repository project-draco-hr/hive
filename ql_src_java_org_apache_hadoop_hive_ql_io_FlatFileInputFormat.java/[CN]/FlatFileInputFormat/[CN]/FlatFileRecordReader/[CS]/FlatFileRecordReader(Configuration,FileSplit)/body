{
  final Path path=split.getPath();
  FileSystem fileSys=path.getFileSystem(conf);
  CompressionCodecFactory compressionCodecs=new CompressionCodecFactory(conf);
  final CompressionCodec codec=compressionCodecs.getCodec(path);
  this.conf=conf;
  fsin=fileSys.open(path);
  if (codec != null) {
    dcin=codec.createInputStream(fsin);
    in=new DataInputStream(dcin);
  }
 else {
    dcin=null;
    in=fsin;
  }
  isEOF=false;
  end=split.getLength();
  SerializationContext<R> sinfo;
  Class<SerializationContext<R>> sinfoClass=(Class<SerializationContext<R>>)conf.getClass(SerializationContextImplKey,SerializationContextFromConf.class);
  sinfo=(SerializationContext<R>)ReflectionUtils.newInstance(sinfoClass,conf);
  Serialization<R> serialization=sinfo.getSerialization();
  realRowClass=(Class<R>)sinfo.getRealClass();
  deserializer=serialization.getDeserializer(realRowClass);
  deserializer.open(in);
}
