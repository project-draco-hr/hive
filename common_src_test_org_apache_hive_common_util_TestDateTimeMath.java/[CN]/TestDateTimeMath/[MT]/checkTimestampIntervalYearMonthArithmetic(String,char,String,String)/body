{
  Timestamp leftTs=null;
  if (left != null) {
    leftTs=Timestamp.valueOf(left);
  }
  HiveIntervalYearMonth rightInterval=null;
  if (right != null) {
    rightInterval=HiveIntervalYearMonth.valueOf(right);
  }
  Timestamp expectedResult=null;
  if (expected != null) {
    expectedResult=Timestamp.valueOf(expected);
  }
  Timestamp testResult=null;
  DateTimeMath dtm=new DateTimeMath();
switch (operationType) {
case '-':
    testResult=dtm.subtract(leftTs,rightInterval);
  break;
case '+':
testResult=dtm.add(leftTs,rightInterval);
break;
default :
throw new IllegalArgumentException("Invalid operation " + operationType);
}
assertEquals(String.format("%s %s %s",leftTs,operationType,rightInterval),expectedResult,testResult);
}
