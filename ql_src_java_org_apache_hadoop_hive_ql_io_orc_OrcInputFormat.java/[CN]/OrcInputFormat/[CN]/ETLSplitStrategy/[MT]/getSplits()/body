{
  List<SplitInfo> result=new ArrayList<>(files.size());
  FooterCache cache=context.cacheStripeDetails ? (deltas == null ? context.footerCache : Context.localCache) : null;
  if (cache != null) {
    FileInfo[] infos=cache.getAndValidate(files);
    for (int i=0; i < files.size(); ++i) {
      FileInfo info=infos[i];
      if (info != null) {
        context.cacheHitCounter.incrementAndGet();
      }
      HdfsFileStatusWithId file=files.get(i);
      if (file.getFileStatus().getLen() > 0) {
        result.add(new SplitInfo(context,fs,file,info,isOriginal,deltas,true,dir,covered));
      }
    }
  }
 else {
    for (    HdfsFileStatusWithId file : files) {
      if (file.getFileStatus().getLen() > 0) {
        result.add(new SplitInfo(context,fs,file,null,isOriginal,deltas,true,dir,covered));
      }
    }
  }
  return result;
}
