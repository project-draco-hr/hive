{
  List<SplitInfo> splits=getSplits();
  List<Future<List<OrcSplit>>> localList=new ArrayList<>(splits.size());
  UserGroupInformation tpUgi=ugi == null ? UserGroupInformation.getCurrentUser() : ugi;
  for (  SplitInfo splitInfo : splits) {
    localList.add(Context.threadPool.submit(new SplitGenerator(splitInfo,tpUgi,allowSyntheticFileIds)));
  }
synchronized (splitFutures) {
    splitFutures.addAll(localList);
  }
}
