{
  perfLogger.PerfLogBegin(CLASS_NAME,PerfLogger.CREATE_ORC_SPLITS);
  try {
    populateAndCacheStripeDetails();
    long currentOffset=-1;
    long currentLength=0;
    for (    StripeInformation stripe : stripes) {
      if (currentOffset != -1 && currentLength > context.minSize && (currentOffset / blockSize != stripe.getOffset() / blockSize)) {
        createSplit(currentOffset,currentLength,fileMetaInfo);
        currentOffset=-1;
      }
      if (currentOffset == -1) {
        currentOffset=stripe.getOffset();
        currentLength=stripe.getLength();
      }
 else {
        currentLength+=stripe.getLength();
      }
      if (currentLength >= context.maxSize) {
        createSplit(currentOffset,currentLength,fileMetaInfo);
        currentOffset=-1;
      }
    }
    if (currentOffset != -1) {
      createSplit(currentOffset,currentLength,fileMetaInfo);
    }
  }
 catch (  Throwable th) {
    if (!(th instanceof IOException)) {
      LOG.error("Unexpected Exception",th);
    }
synchronized (context.errors) {
      context.errors.add(th);
    }
    if (!(th instanceof IOException)) {
      context.notifyOnNonIOException(th);
    }
  }
 finally {
    context.decrementSchedulers();
  }
  perfLogger.PerfLogEnd(CLASS_NAME,PerfLogger.CREATE_ORC_SPLITS);
}
