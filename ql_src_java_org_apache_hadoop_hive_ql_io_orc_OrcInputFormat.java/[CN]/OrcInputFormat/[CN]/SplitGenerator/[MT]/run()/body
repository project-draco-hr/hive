{
  try {
    populateAndCacheStripeDetails();
    Configuration conf=context.conf;
    SearchArgument sarg=createSarg(types,conf);
    List<StripeStatistics> stripeStats=null;
    int[] filterColumns=null;
    if (sarg != null) {
      List<PredicateLeaf> sargLeaves=null;
      String[] allColumns=conf.get(serdeConstants.LIST_COLUMNS).split(",");
      String[] neededColumns=conf.get(ColumnProjectionUtils.READ_COLUMN_NAMES_CONF_STR).split(",");
      sargLeaves=sarg.getLeaves();
      filterColumns=new int[sargLeaves.size()];
      for (int i=0; i < filterColumns.length; ++i) {
        String colName=sargLeaves.get(i).getColumnName();
        if (containsColumn(neededColumns,colName)) {
          filterColumns[i]=RecordReaderImpl.findColumns(allColumns,colName);
        }
 else {
          filterColumns[i]=-1;
        }
      }
      stripeStats=metadata.getStripeStatistics();
    }
    long currentOffset=-1;
    long currentLength=0;
    int idx=-1;
    for (    StripeInformation stripe : stripes) {
      idx++;
      if (sarg != null && stripeStats != null && idx < stripeStats.size() && !isStripeSatisfyPredicate(stripeStats.get(idx),sarg,filterColumns)) {
        if (LOG.isDebugEnabled()) {
          LOG.debug("Eliminating ORC stripe-" + idx + " of file '"+ file.getPath()+ "'  as it did not satisfy predicate condition.");
        }
        if (currentOffset != -1) {
          createSplit(currentOffset,currentLength,fileMetaInfo);
          currentOffset=-1;
        }
        continue;
      }
      if (currentOffset != -1 && currentLength > context.minSize && (currentOffset / blockSize != stripe.getOffset() / blockSize)) {
        createSplit(currentOffset,currentLength,fileMetaInfo);
        currentOffset=-1;
      }
      if (currentOffset == -1) {
        currentOffset=stripe.getOffset();
        currentLength=stripe.getLength();
      }
 else {
        currentLength=(stripe.getOffset() + stripe.getLength()) - currentOffset;
      }
      if (currentLength >= context.maxSize) {
        createSplit(currentOffset,currentLength,fileMetaInfo);
        currentOffset=-1;
      }
    }
    if (currentOffset != -1) {
      createSplit(currentOffset,currentLength,fileMetaInfo);
    }
  }
 catch (  Throwable th) {
    if (!(th instanceof IOException)) {
      LOG.error("Unexpected Exception",th);
    }
synchronized (context.errors) {
      context.errors.add(th);
    }
    if (!(th instanceof IOException)) {
      context.notifyOnNonIOException(th);
    }
  }
 finally {
    context.decrementSchedulers();
  }
}
