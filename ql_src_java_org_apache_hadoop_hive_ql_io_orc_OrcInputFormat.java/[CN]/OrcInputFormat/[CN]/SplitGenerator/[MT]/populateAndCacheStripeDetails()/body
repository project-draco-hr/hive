{
  Reader orcReader=OrcFile.createReader(file.getPath(),OrcFile.readerOptions(context.conf).filesystem(fs));
  if (fileInfo != null) {
    stripes=fileInfo.stripeInfos;
    fileMetaInfo=fileInfo.fileMetaInfo;
    metadata=fileInfo.metadata;
    types=fileInfo.types;
    writerVersion=fileInfo.writerVersion;
    if (fileMetaInfo == null && context.footerInSplits) {
      fileInfo.fileMetaInfo=((ReaderImpl)orcReader).getFileMetaInfo();
      fileInfo.metadata=orcReader.getMetadata();
      fileInfo.types=orcReader.getTypes();
      fileInfo.writerVersion=orcReader.getWriterVersion();
    }
  }
 else {
    stripes=orcReader.getStripes();
    metadata=orcReader.getMetadata();
    types=orcReader.getTypes();
    writerVersion=orcReader.getWriterVersion();
    fileMetaInfo=context.footerInSplits ? ((ReaderImpl)orcReader).getFileMetaInfo() : null;
    if (context.cacheStripeDetails) {
      Context.footerCache.put(file.getPath(),new FileInfo(file.getModificationTime(),file.getLen(),stripes,metadata,types,fileMetaInfo,writerVersion));
    }
  }
  includedCols=genIncludedColumns(types,context.conf,isOriginal);
  projColsUncompressedSize=computeProjectionSize(orcReader,includedCols,isOriginal);
}
