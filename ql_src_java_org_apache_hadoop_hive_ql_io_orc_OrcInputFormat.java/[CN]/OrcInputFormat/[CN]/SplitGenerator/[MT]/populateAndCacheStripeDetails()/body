{
  Reader orcReader=OrcFile.createReader(fileWithId.getFileStatus().getPath(),OrcFile.readerOptions(context.conf).filesystem(fs));
  List<String> projCols=Lists.newArrayList(ColumnProjectionUtils.getReadColumnNames(context.conf));
  projColsUncompressedSize=orcReader.getRawDataSizeOfColumns(projCols);
  if (fileInfo != null) {
    stripes=fileInfo.stripeInfos;
    stripeStats=fileInfo.stripeStats;
    fileMetaInfo=fileInfo.fileMetaInfo;
    types=fileInfo.types;
    writerVersion=fileInfo.writerVersion;
    if (fileMetaInfo == null && context.footerInSplits) {
      fileInfo.fileMetaInfo=((ReaderImpl)orcReader).getFileMetaInfo();
      fileInfo.types=orcReader.getTypes();
      fileInfo.writerVersion=orcReader.getWriterVersion();
    }
  }
 else {
    stripes=orcReader.getStripes();
    types=orcReader.getTypes();
    writerVersion=orcReader.getWriterVersion();
    stripeStats=orcReader.getStripeStatistics();
    fileMetaInfo=context.footerInSplits ? ((ReaderImpl)orcReader).getFileMetaInfo() : null;
    if (context.cacheStripeDetails) {
      Context.footerCache.put(fileWithId.getFileStatus().getPath(),new FileInfo(fileWithId.getFileStatus().getModificationTime(),fileWithId.getFileStatus().getLen(),stripes,stripeStats,types,fileMetaInfo,writerVersion));
    }
  }
}
