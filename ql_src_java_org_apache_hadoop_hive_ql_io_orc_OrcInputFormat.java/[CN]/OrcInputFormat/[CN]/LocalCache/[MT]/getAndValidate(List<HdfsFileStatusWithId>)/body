{
  FileInfo[] result=new FileInfo[files.size()];
  int i=-1;
  for (  HdfsFileStatusWithId fileWithId : files) {
    ++i;
    FileStatus file=fileWithId.getFileStatus();
    Path path=file.getPath();
    Long fileId=fileWithId.getFileId();
    FileInfo fileInfo=cache.getIfPresent(path);
    if (isDebugEnabled) {
      LOG.debug("Info " + (fileInfo == null ? "not " : "") + "cached for path: "+ path);
    }
    if (fileInfo == null)     continue;
    if ((fileId != null && fileInfo.fileId != null && fileId == fileInfo.fileId) || (fileInfo.modificationTime == file.getModificationTime() && fileInfo.size == file.getLen())) {
      result[i]=fileInfo;
      continue;
    }
    cache.invalidate(path);
    if (isDebugEnabled) {
      LOG.debug("Meta-Info for : " + path + " changed. CachedModificationTime: "+ fileInfo.modificationTime+ ", CurrentModificationTime: "+ file.getModificationTime()+ ", CachedLength: "+ fileInfo.size+ ", CurrentLength: "+ file.getLen());
    }
  }
  return result;
}
