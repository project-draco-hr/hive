{
  FileStatus fs=file.getFileStatus();
  ReaderImpl.FooterInfo fi=null;
  ByteBuffer original=bb.duplicate();
  try {
    fi=ReaderImpl.extractMetaInfoFromFooter(bb,fs.getPath());
  }
 catch (  Exception ex) {
    byte[] data=new byte[original.remaining()];
    System.arraycopy(original.array(),original.arrayOffset() + original.position(),data,0,data.length);
    String msg="Failed to parse the footer stored in cache for file ID " + file.getFileId() + " "+ original+ " [ "+ Hex.encodeHexString(data)+ " ]";
    LOG.error(msg,ex);
    return null;
  }
  return new FileInfo(fs.getModificationTime(),fs.getLen(),fi.getStripes(),fi.getMetadata(),fi.getFooter().getTypesList(),fi.getFooter().getStatisticsList(),fi.getFileMetaInfo(),fi.getFileMetaInfo().writerVersion,file.getFileId());
}
