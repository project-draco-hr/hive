{
  if (isVectorMode(conf)) {
    RecordReader<NullWritable,VectorizedRowBatch> vorr=voif.getRecordReader(inputSplit,conf,reporter);
    return (RecordReader)vorr;
  }
  FileSplit fSplit=(FileSplit)inputSplit;
  reporter.setStatus(fSplit.toString());
  Path path=fSplit.getPath();
  FileSystem fs=path.getFileSystem(conf);
  Reader reader=null;
  if (!(fSplit instanceof OrcSplit)) {
    reader=OrcFile.createReader(fs,path);
  }
 else {
    OrcSplit orcSplit=(OrcSplit)fSplit;
    if (orcSplit.hasFooter()) {
      FileMetaInfo fMetaInfo=orcSplit.getFileMetaInfo();
      reader=OrcFile.createReader(fs,path,fMetaInfo);
    }
 else {
      reader=OrcFile.createReader(fs,path);
    }
  }
  return new OrcRecordReader(reader,conf,fSplit.getStart(),fSplit.getLength());
}
