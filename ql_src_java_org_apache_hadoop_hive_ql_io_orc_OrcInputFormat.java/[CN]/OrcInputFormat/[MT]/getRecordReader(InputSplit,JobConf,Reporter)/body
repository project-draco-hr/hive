{
  if (isVectorMode(conf)) {
    org.apache.hadoop.mapred.RecordReader<NullWritable,VectorizedRowBatch> vorr=voif.getRecordReader(inputSplit,conf,reporter);
    return (org.apache.hadoop.mapred.RecordReader)vorr;
  }
  FileSplit fSplit=(FileSplit)inputSplit;
  reporter.setStatus(fSplit.toString());
  Path path=fSplit.getPath();
  FileSystem fs=path.getFileSystem(conf);
  Reader reader=null;
  if (!(fSplit instanceof OrcSplit)) {
    reader=OrcFile.createReader(fs,path,conf);
  }
 else {
    OrcSplit orcSplit=(OrcSplit)fSplit;
    if (orcSplit.hasFooter()) {
      FileMetaInfo fMetaInfo=orcSplit.getFileMetaInfo();
      reader=OrcFile.createReader(fs,path,fMetaInfo,conf);
    }
 else {
      reader=OrcFile.createReader(fs,path,conf);
    }
  }
  return new OrcRecordReader(reader,conf,fSplit.getStart(),fSplit.getLength());
}
