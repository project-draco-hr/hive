{
  List<SplitStrategy<?>> splitStrategies=new ArrayList<SplitStrategy<?>>();
  SplitStrategy<?> splitStrategy;
  List<HdfsFileStatusWithId> acidSchemaFiles=new ArrayList<HdfsFileStatusWithId>();
  if (baseFiles.isEmpty()) {
    splitStrategy=determineSplitStrategy(combinedCtx,context,fs,dir,dirInfo,acidSchemaFiles,false,parsedDeltas,readerTypes,ugi,allowSyntheticFileIds);
    if (splitStrategy != null) {
      splitStrategies.add(splitStrategy);
    }
    return splitStrategies;
  }
  List<HdfsFileStatusWithId> originalSchemaFiles=new ArrayList<HdfsFileStatusWithId>();
  for (  AcidBaseFileInfo acidBaseFileInfo : baseFiles) {
    if (acidBaseFileInfo.isOriginal()) {
      originalSchemaFiles.add(acidBaseFileInfo.getHdfsFileStatusWithId());
    }
 else {
      acidSchemaFiles.add(acidBaseFileInfo.getHdfsFileStatusWithId());
    }
  }
  if (!originalSchemaFiles.isEmpty()) {
    splitStrategy=determineSplitStrategy(combinedCtx,context,fs,dir,dirInfo,originalSchemaFiles,true,parsedDeltas,readerTypes,ugi,allowSyntheticFileIds);
    if (splitStrategy != null) {
      splitStrategies.add(splitStrategy);
    }
  }
  if (!acidSchemaFiles.isEmpty()) {
    splitStrategy=determineSplitStrategy(combinedCtx,context,fs,dir,dirInfo,acidSchemaFiles,false,parsedDeltas,readerTypes,ugi,allowSyntheticFileIds);
    if (splitStrategy != null) {
      splitStrategies.add(splitStrategy);
    }
  }
  return splitStrategies;
}
