{
  TypeDescription schema=OrcInputFormat.getDesiredRowTypeDescr(conf,true,Integer.MAX_VALUE);
  Reader.Options readerOptions=new Reader.Options().schema(schema);
  final List<OrcProto.Type> schemaTypes=OrcUtils.getOrcTypes(schema);
  readerOptions.include(OrcInputFormat.genIncludedColumns(schemaTypes,conf,SCHEMA_TYPES_IS_ORIGINAL));
  OrcInputFormat.setSearchArgument(readerOptions,schemaTypes,conf,SCHEMA_TYPES_IS_ORIGINAL);
  return readerOptions;
}
