{
  if (isDebugEnabled) {
    LOG.debug("getSplits started");
  }
  Configuration conf=job;
  if (HiveConf.getBoolVar(job,HiveConf.ConfVars.HIVE_ORC_MS_FOOTER_CACHE_ENABLED)) {
    conf=new HiveConf(conf,OrcInputFormat.class);
  }
  List<OrcSplit> result=generateSplitsInfo(conf,new Context(conf,numSplits,createExternalCaches()));
  if (isDebugEnabled) {
    LOG.debug("getSplits finished");
  }
  return result.toArray(new InputSplit[result.size()]);
}
