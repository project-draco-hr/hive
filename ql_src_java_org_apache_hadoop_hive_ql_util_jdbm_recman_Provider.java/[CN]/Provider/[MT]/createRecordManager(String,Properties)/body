{
  RecordManager recman;
  String value;
  int cacheSize;
  recman=new BaseRecordManager(name);
  value=options.getProperty(RecordManagerOptions.DISABLE_TRANSACTIONS,"false");
  if (value.equalsIgnoreCase("TRUE")) {
    ((BaseRecordManager)recman).disableTransactions();
  }
  value=options.getProperty(RecordManagerOptions.CACHE_SIZE,"1000");
  cacheSize=Integer.parseInt(value);
  value=options.getProperty(RecordManagerOptions.CACHE_TYPE,RecordManagerOptions.NORMAL_CACHE);
  if (value.equalsIgnoreCase(RecordManagerOptions.NORMAL_CACHE)) {
    MRU cache=new MRU(cacheSize);
    recman=new CacheRecordManager(recman,cache);
  }
 else   if (value.equalsIgnoreCase(RecordManagerOptions.SOFT_REF_CACHE)) {
    throw new IllegalArgumentException("Soft reference cache not implemented");
  }
 else   if (value.equalsIgnoreCase(RecordManagerOptions.WEAK_REF_CACHE)) {
    throw new IllegalArgumentException("Weak reference cache not implemented");
  }
 else {
    throw new IllegalArgumentException("Invalid cache type: " + value);
  }
  return recman;
}
