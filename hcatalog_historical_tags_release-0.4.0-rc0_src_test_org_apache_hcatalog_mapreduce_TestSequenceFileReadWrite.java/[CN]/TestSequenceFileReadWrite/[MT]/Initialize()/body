{
  hiveConf=new HiveConf(this.getClass());
  hiveConf.set(HiveConf.ConfVars.PREEXECHOOKS.varname,"");
  hiveConf.set(HiveConf.ConfVars.POSTEXECHOOKS.varname,"");
  hiveConf.set(HiveConf.ConfVars.HIVE_SUPPORT_CONCURRENCY.varname,"false");
  driver=new Driver(hiveConf);
  SessionState.start(new CliSessionState(hiveConf));
  props=new Properties();
  props.setProperty("fs.default.name",cluster.getProperties().getProperty("fs.default.name"));
  fullFileNameBasic=cluster.getProperties().getProperty("fs.default.name") + basicFile;
  int numRows=3;
  input=new String[numRows];
  for (int i=0; i < numRows; i++) {
    String col1="a" + i;
    String col2="b" + i;
    input[i]=i + "," + col1+ ","+ col2;
  }
  MiniCluster.deleteFile(cluster,basicFile);
  MiniCluster.createInputFile(cluster,basicFile,input);
  server=new PigServer(ExecType.LOCAL,props);
}
