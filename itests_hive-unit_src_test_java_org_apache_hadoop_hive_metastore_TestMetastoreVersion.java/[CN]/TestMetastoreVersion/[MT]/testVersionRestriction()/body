{
  System.setProperty(HiveConf.ConfVars.METASTORE_SCHEMA_VERIFICATION.toString(),"true");
  hiveConf=new HiveConf(this.getClass());
  assertTrue(hiveConf.getBoolVar(HiveConf.ConfVars.METASTORE_SCHEMA_VERIFICATION));
  assertFalse(hiveConf.getBoolVar(HiveConf.ConfVars.METASTORE_AUTO_CREATE_ALL));
  try {
    SessionState.start(new CliSessionState(hiveConf));
    Hive.get(hiveConf).getMSC();
    fail("An exception is expected since schema is not created.");
  }
 catch (  Exception re) {
    LOG.info("Exception in testVersionRestriction: " + re,re);
    String msg=HiveStringUtils.stringifyException(re);
    assertTrue("Expected 'Version information not found in metastore' in: " + msg,msg.contains("Version information not found in metastore"));
  }
}
