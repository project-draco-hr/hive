{
  StructObjectInspector oi=(StructObjectInspector)serDe.getObjectInspector();
  List<? extends StructField> fieldRefs=oi.getAllStructFieldRefs();
  assertEquals(expectedFieldsData.length,fieldRefs.size());
  Object row=serDe.deserialize(t);
  for (int i=0; i < fieldRefs.size(); i++) {
    Object fieldData=oi.getStructFieldData(row,fieldRefs.get(i));
    if (fieldData != null) {
      fieldData=((LazyPrimitive)fieldData).getWritableObject();
    }
    assertEquals("Field " + i,expectedFieldsData[i],fieldData);
  }
  assertEquals(Text.class,serDe.getSerializedClass());
  Text serializedText=(Text)serDe.serialize(row,oi);
  assertEquals("Serialized data",s,serializedText.toString());
}
