{
  if (grantMapStr != null && !grantMapStr.trim().equals("")) {
    String[] grantArrayStr=grantMapStr.split(";");
    Map<String,List<PrivilegeGrantInfo>> grantsMap=new HashMap<String,List<PrivilegeGrantInfo>>();
    for (    String grantStr : grantArrayStr) {
      String[] principalListAndPrivList=grantStr.split(":");
      if (principalListAndPrivList.length != 2 || principalListAndPrivList[0] == null || principalListAndPrivList[0].trim().equals("")) {
        throw new HiveException("Can not understand the config privilege definition " + grantStr);
      }
      String userList=principalListAndPrivList[0];
      String privList=principalListAndPrivList[1];
      checkPrivilege(privList);
      String[] grantArray=privList.split(",");
      List<PrivilegeGrantInfo> grantInfoList=new ArrayList<PrivilegeGrantInfo>();
      String grantor=null;
      if (SessionState.get().getAuthenticator() != null) {
        grantor=SessionState.get().getAuthenticator().getUserName();
      }
      for (      String grant : grantArray) {
        grantInfoList.add(new PrivilegeGrantInfo(grant,-1,grantor,PrincipalType.USER,true));
      }
      String[] users=userList.split(",");
      for (      String user : users) {
        grantsMap.put(user,grantInfoList);
      }
    }
    return grantsMap;
  }
  return null;
}
