{
  CreateTableAutomaticGrant grants=new CreateTableAutomaticGrant();
  grants.userGrants=getGrantMap(HiveConf.getVar(conf,HiveConf.ConfVars.HIVE_AUTHORIZATION_TABLE_USER_GRANTS));
  grants.groupGrants=getGrantMap(HiveConf.getVar(conf,HiveConf.ConfVars.HIVE_AUTHORIZATION_TABLE_GROUP_GRANTS));
  grants.roleGrants=getGrantMap(HiveConf.getVar(conf,HiveConf.ConfVars.HIVE_AUTHORIZATION_TABLE_ROLE_GRANTS));
  List<PrivilegeGrantInfo> ownerGrantInfoList=new ArrayList<PrivilegeGrantInfo>();
  String grantor=null;
  if (SessionState.get() != null && SessionState.get().getAuthenticator() != null) {
    grantor=SessionState.get().getAuthenticator().getUserName();
    ownerGrantInfoList.add(new PrivilegeGrantInfo(Privilege.ALL.getPriv(),-1,grantor,PrincipalType.USER,true));
    if (grants.userGrants == null) {
      grants.userGrants=new HashMap<String,List<PrivilegeGrantInfo>>();
    }
    grants.userGrants.put(grantor,ownerGrantInfoList);
  }
  return grants;
}
