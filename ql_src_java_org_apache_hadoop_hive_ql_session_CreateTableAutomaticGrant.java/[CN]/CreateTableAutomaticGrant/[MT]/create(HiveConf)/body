{
  CreateTableAutomaticGrant grants=new CreateTableAutomaticGrant();
  grants.userGrants=getGrantMap(HiveConf.getVar(conf,HiveConf.ConfVars.HIVE_AUTHORIZATION_TABLE_USER_GRANTS));
  grants.groupGrants=getGrantMap(HiveConf.getVar(conf,HiveConf.ConfVars.HIVE_AUTHORIZATION_TABLE_GROUP_GRANTS));
  grants.roleGrants=getGrantMap(HiveConf.getVar(conf,HiveConf.ConfVars.HIVE_AUTHORIZATION_TABLE_ROLE_GRANTS));
  String grantor=null;
  if (SessionState.get() != null && SessionState.get().getAuthenticator() != null) {
    grantor=SessionState.get().getAuthenticator().getUserName();
    List<PrivilegeGrantInfo> ownerGrant=getGrantorInfoList(HiveConf.getVar(conf,HiveConf.ConfVars.HIVE_AUTHORIZATION_TABLE_OWNER_GRANTS));
    if (ownerGrant != null) {
      if (grants.userGrants == null) {
        grants.userGrants=new HashMap<String,List<PrivilegeGrantInfo>>();
      }
      grants.userGrants.put(grantor,ownerGrant);
    }
  }
  return grants;
}
