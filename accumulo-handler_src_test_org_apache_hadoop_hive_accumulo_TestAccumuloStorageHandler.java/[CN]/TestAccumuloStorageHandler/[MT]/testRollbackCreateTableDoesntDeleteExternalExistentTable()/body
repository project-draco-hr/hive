{
  MockInstance inst=new MockInstance(test.getMethodName());
  Connector conn=inst.getConnector("root",new PasswordToken(""));
  AccumuloStorageHandler storageHandler=Mockito.mock(AccumuloStorageHandler.class);
  String tableName="table";
  conn.tableOperations().create(tableName);
  AccumuloConnectionParameters connectionParams=Mockito.mock(AccumuloConnectionParameters.class);
  Table table=Mockito.mock(Table.class);
  Mockito.doCallRealMethod().when(storageHandler).rollbackCreateTable(table);
  Mockito.doCallRealMethod().when(storageHandler).commitDropTable(table,true);
  Mockito.when(storageHandler.getTableName(table)).thenReturn(tableName);
  Mockito.when(storageHandler.isExternalTable(table)).thenReturn(true);
  Mockito.when(connectionParams.getConnector()).thenReturn(conn);
  storageHandler.connectionParams=connectionParams;
  storageHandler.rollbackCreateTable(table);
  Assert.assertTrue(conn.tableOperations().exists(tableName));
}
