{
  if (isListBucketingAlterTableConcatenate) {
    if (this.tmpPathFixedConcatenate) {
      checkPartitionsMatch(path);
    }
 else {
      fixTmpPath(path,listBucketingDepth);
      tmpPathFixedConcatenate=true;
    }
  }
 else {
    if (hasDynamicPartitions || (listBucketingDepth > 0)) {
      if (tmpPathFixed) {
        checkPartitionsMatch(path);
      }
 else {
        int depthDiff=path.depth() - tmpPath.depth();
        fixTmpPath(path,depthDiff);
        tmpPathFixed=true;
      }
    }
  }
}
