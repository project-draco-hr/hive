{
  if (invocation.getMethod().getName().equals("sendSourceStateUpdate")) {
    LlapNodeId nodeId=(LlapNodeId)invocation.getArguments()[1];
    final LlapProtocolClientProxy.ExecuteRequestCallback callback=(LlapProtocolClientProxy.ExecuteRequestCallback)invocation.getArguments()[2];
    if (nodeId.getHostname().equals(LlapTaskCommunicatorWrapperForTest.HOSTS[0])) {
      new Thread(){
        public void run(){
          callback.indicateError(new IOException("Force failing " + LlapTaskCommunicatorWrapperForTest.HOSTS[0]));
          successInvoked.set(true);
          signalOpDoneIfBothInvoked();
        }
      }
.start();
    }
 else {
      new Thread(){
        public void run(){
          callback.setResponse(LlapDaemonProtocolProtos.SourceStateUpdatedResponseProto.getDefaultInstance());
          failInvoked.set(true);
          signalOpDoneIfBothInvoked();
        }
      }
.start();
    }
  }
  return null;
}
