{
  HiveConf.setVar(conf,HiveConf.ConfVars.LLAP_DAEMON_SERVICE_HOSTS,"fake-non-zk-cluster");
  userPayload=TezUtils.createUserPayloadFromConf(conf);
  doReturn(appAttemptId).when(taskCommunicatorContext).getApplicationAttemptId();
  doReturn(new Credentials()).when(taskCommunicatorContext).getAMCredentials();
  doReturn(userPayload).when(taskCommunicatorContext).getInitialUserPayload();
  doReturn(appId.toString()).when(taskCommunicatorContext).getCurrentAppIdentifier();
  DagInfo dagInfo=mock(DagInfo.class);
  doReturn(dagInfo).when(taskCommunicatorContext).getCurrentDagInfo();
  doReturn(DAG_NAME).when(dagInfo).getName();
  doReturn(new Credentials()).when(dagInfo).getCredentials();
  doReturn(new LinkedList<String>()).when(taskCommunicatorContext).getInputVertexNames(any(String.class));
  this.taskCommunicator=new LlapTaskCommunicatorForTest(taskCommunicatorContext,llapProxy);
  this.taskCommunicator.initialize();
  this.taskCommunicator.start();
}
