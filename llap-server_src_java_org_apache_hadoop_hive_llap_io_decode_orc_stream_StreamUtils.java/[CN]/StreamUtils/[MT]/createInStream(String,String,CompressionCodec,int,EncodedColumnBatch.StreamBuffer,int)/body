{
  if (streamBuffer == null) {
    return null;
  }
  int numBuffers=streamBuffer.cacheBuffers.size();
  List<DiskRange> input=new ArrayList<>(numBuffers);
  int totalLength=0;
  LlapMemoryBuffer lmb=streamBuffer.cacheBuffers.get(compressionBufferIdx);
  input.add(new RecordReaderImpl.CacheChunk(lmb,lmb.byteBuffer.position(),lmb.byteBuffer.limit()));
  totalLength+=lmb.byteBuffer.remaining();
  if (compressionBufferIdx != streamBuffer.cacheBuffers.size() - 1) {
    lmb=streamBuffer.cacheBuffers.get(compressionBufferIdx + 1);
    input.add(new RecordReaderImpl.CacheChunk(lmb,lmb.byteBuffer.position(),lmb.byteBuffer.limit()));
    totalLength+=lmb.byteBuffer.remaining();
  }
  return InStream.create(fileName,streamName,input,totalLength,codec,bufferSize,null);
}
