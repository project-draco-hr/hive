{
  if (streamBuffer == null) {
    return null;
  }
  int numBuffers=streamBuffer.cacheBuffers.size();
  List<ByteBuffer> input=Lists.newArrayList();
  List<Long> offsetsList=Lists.newArrayList();
  long totalLength=0;
  for (int i=0; i < numBuffers; i++) {
    ByteBuffer data=streamBuffer.cacheBuffers.get(i).byteBuffer.duplicate();
    input.add(data);
    offsetsList.add(totalLength);
    totalLength+=data.remaining();
  }
  ByteBuffer[] buffers=input.toArray(new ByteBuffer[input.size()]);
  long[] offsets=Longs.toArray(offsetsList);
  return InStream.create(fileName,streamName,buffers,offsets,totalLength,codec,bufferSize);
}
