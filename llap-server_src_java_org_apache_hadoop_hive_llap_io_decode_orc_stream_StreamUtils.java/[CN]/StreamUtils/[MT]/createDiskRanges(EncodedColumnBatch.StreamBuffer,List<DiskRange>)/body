{
  long totalLength=0;
  for (  LlapMemoryBuffer memoryBuffer : streamBuffer.cacheBuffers) {
    ByteBuffer buffer=memoryBuffer.byteBuffer.duplicate();
    RecordReaderImpl.BufferChunk bufferChunk=new RecordReaderImpl.BufferChunk(buffer,totalLength);
    diskRanges.add(bufferChunk);
    totalLength+=buffer.remaining();
  }
  return totalLength;
}
