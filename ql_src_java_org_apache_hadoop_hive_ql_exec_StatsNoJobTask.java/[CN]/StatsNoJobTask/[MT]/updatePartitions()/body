{
  if (!partUpdates.isEmpty()) {
    List<Partition> updatedParts=Lists.newArrayList(partUpdates.values());
    if (updatedParts.contains(null) && work.isStatsReliable()) {
      LOG.debug("Stats requested to be reliable. Empty stats found and hence failing the task.");
      return -1;
    }
 else {
      LOG.debug("Bulk updating partitions..");
      EnvironmentContext environmentContext=new EnvironmentContext();
      environmentContext.putToProperties(StatsSetupConst.STATS_GENERATED,StatsSetupConst.TASK);
      db.alterPartitions(tableFullName,Lists.newArrayList(partUpdates.values()),environmentContext);
      LOG.debug("Bulk updated " + partUpdates.values().size() + " partitions.");
    }
  }
  return 0;
}
