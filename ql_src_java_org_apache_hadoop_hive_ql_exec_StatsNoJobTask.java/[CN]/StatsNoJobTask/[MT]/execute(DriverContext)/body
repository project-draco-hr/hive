{
  LOG.info("Executing stats (no job) task");
  String tableName="";
  ExecutorService threadPool=null;
  Hive db=getHive();
  try {
    tableName=work.getTableSpecs().tableName;
    table=db.getTable(tableName);
    int numThreads=HiveConf.getIntVar(conf,ConfVars.HIVE_STATS_GATHER_NUM_THREADS);
    tableFullName=table.getDbName() + "." + table.getTableName();
    threadPool=Executors.newFixedThreadPool(numThreads,new ThreadFactoryBuilder().setDaemon(true).setNameFormat("StatsNoJobTask-Thread-%d").build());
    partUpdates=new MapMaker().concurrencyLevel(numThreads).makeMap();
    LOG.info("Initialized threadpool for stats computation with " + numThreads + " threads");
  }
 catch (  HiveException e) {
    LOG.error("Cannot get table " + tableName,e);
    console.printError("Cannot get table " + tableName,e.toString());
  }
  return aggregateStats(threadPool,db);
}
