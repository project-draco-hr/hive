{
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(AllTypesRecord.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(fs,testFilePath,conf,inspector,100000,CompressionKind.NONE,10000,1000);
  Map<String,String> m=new HashMap<String,String>(2);
  m.put("k1","v1");
  writer.addRow(new AllTypesRecord(true,(byte)10,(short)100,1000,10000L,4.0f,20.0,HiveDecimal.create(new BigDecimal(4.2222)),new Timestamp(1416967764000L),new Date(1416967764000L),"string",new HiveChar("hello",5),new HiveVarchar("hello",10),m,Arrays.asList(100,200),new AllTypesRecord.Struct(10,"foo")));
  m.clear();
  m.put("k3","v3");
  writer.addRow(new AllTypesRecord(false,(byte)20,(short)200,2000,20000L,8.0f,40.0,HiveDecimal.create(new BigDecimal(2.2222)),new Timestamp(1416967364000L),new Date(1411967764000L),"abcd",new HiveChar("world",5),new HiveVarchar("world",10),m,Arrays.asList(200,300),new AllTypesRecord.Struct(20,"bar")));
  writer.close();
  PrintStream origOut=System.out;
  String outputFilename="orc-file-dump.out";
  ByteArrayOutputStream myOut=new ByteArrayOutputStream();
  System.setOut(new PrintStream(myOut));
  FileDump.main(new String[]{testFilePath.toString(),"-d"});
  System.out.flush();
  System.setOut(origOut);
  String[] lines=myOut.toString().split("\n");
  assertEquals("{\"b\":true,\"bt\":10,\"s\":100,\"i\":1000,\"l\":10000,\"f\":4,\"d\":20,\"de\":\"4.222199999999999953\",\"t\":\"2014-11-25 18:09:24\",\"dt\":\"2014-11-25\",\"str\":\"string\",\"c\":\"hello                                                                                                                                                                                                                                                          \",\"vc\":\"hello\",\"m\":[{\"_key\":\"k1\",\"_value\":\"v1\"}],\"a\":[100,200],\"st\":{\"i\":10,\"s\":\"foo\"}}",lines[0]);
  assertEquals("{\"b\":false,\"bt\":20,\"s\":200,\"i\":2000,\"l\":20000,\"f\":8,\"d\":40,\"de\":\"2.222199999999999953\",\"t\":\"2014-11-25 18:02:44\",\"dt\":\"2014-09-28\",\"str\":\"abcd\",\"c\":\"world                                                                                                                                                                                                                                                          \",\"vc\":\"world\",\"m\":[{\"_key\":\"k3\",\"_value\":\"v3\"}],\"a\":[200,300],\"st\":{\"i\":20,\"s\":\"bar\"}}",lines[1]);
}
