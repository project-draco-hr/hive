{
  try {
    barrStr.reset();
    StructObjectInspector soi=(StructObjectInspector)objInspector;
    List<? extends StructField> fields=soi.getAllStructFieldRefs();
    for (int i=0; i < numColumns; i++) {
      Object o=soi.getStructFieldData(obj,fields.get(i));
      ObjectInspector oi=fields.get(i).getFieldObjectInspector();
      serializeField(o,oi,row.get(i));
    }
    tbOut.writeEndOfRecord();
    serializeBytesWritable.set(barrStr.getData(),0,barrStr.getLength());
  }
 catch (  IOException e) {
    throw new SerDeException(e.getMessage());
  }
  return serializeBytesWritable;
}
