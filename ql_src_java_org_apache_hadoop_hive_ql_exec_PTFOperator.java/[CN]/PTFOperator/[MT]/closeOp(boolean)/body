{
  super.closeOp(abort);
  if (inputPart.size() != 0) {
    if (isMapOperator) {
      processMapFunction();
    }
 else {
      processInputPartition();
    }
  }
  inputPart.close();
  inputPart=null;
  for (PTFInputDef iDef=conf.getFuncDef(); iDef != null; iDef=iDef.getInput()) {
    if (iDef instanceof PartitionedTableFunctionDef) {
      ((PartitionedTableFunctionDef)iDef).getTFunction().close();
    }
  }
}
