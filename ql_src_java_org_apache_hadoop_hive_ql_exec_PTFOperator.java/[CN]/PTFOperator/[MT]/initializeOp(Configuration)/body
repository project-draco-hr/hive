{
  hiveConf=new HiveConf(jobConf,PTFOperator.class);
  Operator<? extends OperatorDesc> parentOp=getParentOperators().get(0);
  if (parentOp instanceof ExtractOperator) {
    isMapOperator=false;
  }
 else {
    isMapOperator=true;
  }
  reconstructQueryDef(hiveConf);
  inputPart=createFirstPartitionForChain(inputObjInspectors[0],hiveConf,isMapOperator);
  if (isMapOperator) {
    PartitionedTableFunctionDef tDef=conf.getStartOfChain();
    outputObjInspector=tDef.getRawInputShape().getOI();
  }
 else {
    outputObjInspector=conf.getFuncDef().getOutputShape().getOI();
  }
  setupKeysWrapper(inputObjInspectors[0]);
  super.initializeOp(jobConf);
}
