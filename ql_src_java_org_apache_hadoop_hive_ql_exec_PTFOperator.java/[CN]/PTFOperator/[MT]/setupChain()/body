{
  Stack<PartitionedTableFunctionDef> fnDefs=new Stack<PartitionedTableFunctionDef>();
  PTFInputDef iDef=conf.getFuncDef();
  while (iDef instanceof PartitionedTableFunctionDef) {
    fnDefs.push((PartitionedTableFunctionDef)iDef);
    iDef=((PartitionedTableFunctionDef)iDef).getInput();
  }
  PTFInvocation curr=null, first=null;
  while (!fnDefs.isEmpty()) {
    PartitionedTableFunctionDef currFn=fnDefs.pop();
    curr=new PTFInvocation(curr,currFn.getTFunction());
    if (first == null) {
      first=curr;
    }
  }
  return first;
}
