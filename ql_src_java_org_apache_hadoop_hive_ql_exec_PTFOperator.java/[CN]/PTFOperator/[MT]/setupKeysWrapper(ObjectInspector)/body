{
  PartitionDef pDef=conf.getStartOfChain().getPartition();
  List<PTFExpressionDef> exprs=pDef.getExpressions();
  int numExprs=exprs.size();
  ExprNodeEvaluator[] keyFields=new ExprNodeEvaluator[numExprs];
  ObjectInspector[] keyOIs=new ObjectInspector[numExprs];
  ObjectInspector[] currentKeyOIs=new ObjectInspector[numExprs];
  for (int i=0; i < numExprs; i++) {
    PTFExpressionDef exprDef=exprs.get(i);
    keyFields[i]=ExprNodeEvaluatorFactory.get(exprDef.getExprNode());
    keyOIs[i]=keyFields[i].initialize(inputOI);
    currentKeyOIs[i]=ObjectInspectorUtils.getStandardObjectInspector(keyOIs[i],ObjectInspectorCopyOption.WRITABLE);
  }
  keyWrapperFactory=new KeyWrapperFactory(keyFields,keyOIs,currentKeyOIs);
  newKeys=keyWrapperFactory.getKeyWrapper();
}
