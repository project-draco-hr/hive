{
  TxnDbUtil.setConfValues(conf);
  CompactorThread t=null;
switch (type) {
case 'i':
    t=new Initiator();
  break;
case 'w':
t=new Worker();
break;
case 'c':
t=new Cleaner();
break;
default :
throw new RuntimeException("Huh? Unknown thread type.");
}
t.setThreadId((int)t.getId());
t.setHiveConf(conf);
stop.boolVal=true;
t.init(stop);
t.run();
}
