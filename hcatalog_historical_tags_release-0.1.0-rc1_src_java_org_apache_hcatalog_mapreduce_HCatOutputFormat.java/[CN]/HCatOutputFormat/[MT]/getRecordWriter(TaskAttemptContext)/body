{
  HCatRecordWriter rw=new HCatRecordWriter(context);
  OutputJobInfo info=getJobInfo(context);
  Path workFile=rw.getStorageDriver().getWorkFilePath(context,info.getLocation());
  Path tblPath=new Path(info.getTable().getSd().getLocation());
  FileSystem fs=tblPath.getFileSystem(context.getConfiguration());
  FileStatus tblPathStat=fs.getFileStatus(tblPath);
  fs.setPermission(workFile,tblPathStat.getPermission());
  try {
    fs.setOwner(workFile,null,tblPathStat.getGroup());
  }
 catch (  AccessControlException ace) {
  }
  return rw;
}
