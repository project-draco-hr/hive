{
  final FileSystem fs=path.getFileSystem(conf);
  if (!fs.exists(path)) {
    return;
  }
  Path parPath=path.getParent();
  FileStatus stat=fs.getFileStatus(path);
  FileUtils.checkFileAccessWithImpersonation(fs,stat,FsAction.WRITE,user);
  FileStatus parStatus=fs.getFileStatus(parPath);
  if (!parStatus.getPermission().getStickyBit()) {
    return;
  }
  if (parStatus.getOwner().equals(user)) {
    return;
  }
  FileStatus childStatus=fs.getFileStatus(path);
  if (childStatus.getOwner().equals(user)) {
    return;
  }
  String msg=String.format("Permission Denied: User %s can't delete %s because sticky bit is" + " set on the parent dir and user does not own this file or its parent",user,path);
  throw new IOException(msg);
}
