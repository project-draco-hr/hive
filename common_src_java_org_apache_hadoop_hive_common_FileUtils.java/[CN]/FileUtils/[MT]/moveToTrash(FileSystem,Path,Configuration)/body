{
  LOG.info("deleting  " + f);
  HadoopShims hadoopShim=ShimLoader.getHadoopShims();
  boolean skipTrash=HiveConf.getBoolVar(conf,HiveConf.ConfVars.HIVE_WAREHOUSE_DATA_SKIPTRASH);
  if (skipTrash) {
    LOG.info("Not moving " + f + " to trash due to configuration "+ HiveConf.ConfVars.HIVE_WAREHOUSE_DATA_SKIPTRASH+ " is set to true.");
  }
 else   if (hadoopShim.moveToAppropriateTrash(fs,f,conf)) {
    LOG.info("Moved to trash: " + f);
    return true;
  }
  boolean result=fs.delete(f,true);
  if (!result) {
    LOG.error("Failed to delete " + f);
  }
  return result;
}
