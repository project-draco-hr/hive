{
  if (!path.isAbsolute()) {
    return path.makeQualified(FileSystem.get(conf));
  }
  URI fsUri=FileSystem.getDefaultUri(conf);
  URI pathUri=path.toUri();
  String scheme=pathUri.getScheme();
  String authority=pathUri.getAuthority();
  if (scheme != null && (authority != null || fsUri.getAuthority() == null)) {
    return path;
  }
  if (scheme == null) {
    scheme=fsUri.getScheme();
  }
  if (authority == null) {
    authority=fsUri.getAuthority();
    if (authority == null) {
      authority="";
    }
  }
  return new Path(scheme + ":" + "//"+ authority+ pathUri.getPath());
}
