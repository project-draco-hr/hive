{
  LOG.info("deleting  " + f);
  HadoopShims hadoopShim=ShimLoader.getHadoopShims();
  boolean result=false;
  try {
    result=hadoopShim.moveToAppropriateTrash(fs,f,conf);
    if (result) {
      LOG.info("Moved to trash: " + f);
      return true;
    }
  }
 catch (  IOException ioe) {
    if (forceDelete) {
      LOG.warn(ioe.getMessage() + "; Force to delete it.");
    }
 else {
      throw ioe;
    }
  }
  if (forceDelete) {
    result=fs.delete(f,true);
    if (!result) {
      LOG.error("Failed to delete " + f);
    }
  }
  return result;
}
