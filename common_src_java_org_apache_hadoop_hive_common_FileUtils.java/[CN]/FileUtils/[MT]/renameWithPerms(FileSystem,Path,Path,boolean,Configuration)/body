{
  LOG.info("Renaming " + sourcePath + " to "+ destPath);
  if (fs.exists(destPath)) {
    throw new IOException("Cannot rename the source path. The destination " + "path already exists.");
  }
  if (!inheritPerms) {
    return fs.rename(sourcePath,destPath);
  }
 else {
    if (fs.rename(sourcePath,destPath)) {
      HadoopShims shims=ShimLoader.getHadoopShims();
      HdfsFileStatus fullFileStatus=shims.getFullFileStatus(conf,fs,destPath.getParent());
      try {
        shims.setFullFileStatus(conf,fullFileStatus,fs,destPath);
      }
 catch (      Exception e) {
        LOG.warn("Error setting permissions or group of " + destPath,e);
      }
      return true;
    }
    return false;
  }
}
