{
  if (!fileStatus.getOwner().equals(userName)) {
    return false;
  }
  if ((!fileStatus.isDir()) || (!recurse)) {
    return true;
  }
  FileStatus[] childStatuses=fs.listStatus(fileStatus.getPath());
  for (  FileStatus childStatus : childStatuses) {
    if (!isOwnerOfFileHierarchy(fs,childStatus,userName,true)) {
      return false;
    }
  }
  return true;
}
