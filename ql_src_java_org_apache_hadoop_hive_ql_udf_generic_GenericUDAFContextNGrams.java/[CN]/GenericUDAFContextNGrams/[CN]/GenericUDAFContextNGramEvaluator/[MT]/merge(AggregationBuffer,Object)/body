{
  if (obj == null) {
    return;
  }
  NGramAggBuf myagg=(NGramAggBuf)agg;
  List partial=(List)loi.getList(obj);
  int contextSize=Integer.parseInt(partial.get(partial.size() - 1).toString());
  partial.remove(partial.size() - 1);
  if (myagg.context.size() > 0) {
    if (contextSize != myagg.context.size()) {
      throw new HiveException(getClass().getSimpleName() + ": found a mismatch in the" + " context string lengths. This is usually caused by passing a non-constant"+ " expression for the context.");
    }
  }
 else {
    for (int i=partial.size() - contextSize; i < partial.size(); i++) {
      String word=partial.get(i).toString();
      if (word.equals("")) {
        myagg.context.add(null);
      }
 else {
        myagg.context.add(word);
      }
    }
    partial.subList(partial.size() - contextSize,partial.size()).clear();
    myagg.nge.merge(partial);
  }
}
