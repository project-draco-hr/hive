{
  Partition hivePtn=new Partition();
  hivePtn.setDbName(dbName);
  hivePtn.setTableName(tableName);
  hivePtn.setValues(values);
  hivePtn.setParameters(parameters);
  if (sd.getLocation() == null) {
    LOG.warn("Partition location is not set! Attempting to construct default partition location.");
    try {
      String partName=Warehouse.makePartName(HCatSchemaUtils.getFieldSchemas(hcatTable.getPartCols()),values);
      sd.setLocation(new Path(hcatTable.getSd().getLocation(),partName).toString());
    }
 catch (    MetaException exception) {
      throw new HCatException("Could not construct default partition-path for " + hcatTable.getDbName() + "."+ hcatTable.getTableName()+ "["+ values+ "]");
    }
  }
  hivePtn.setSd(sd);
  hivePtn.setCreateTime((int)(System.currentTimeMillis() / 1000));
  hivePtn.setLastAccessTimeIsSet(false);
  return hivePtn;
}
