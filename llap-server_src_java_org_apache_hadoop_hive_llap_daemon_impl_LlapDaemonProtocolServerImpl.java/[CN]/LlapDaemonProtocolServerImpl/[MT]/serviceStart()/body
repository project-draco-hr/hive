{
  Configuration conf=getConfig();
  int numHandlers=daemonConf.getInt(LlapDaemonConfiguration.LLAP_DAEMON_RPC_NUM_HANDLERS,LlapDaemonConfiguration.LLAP_DAEMON_RPC_NUM_HANDLERS_DEFAULT);
  int port=daemonConf.getInt(LlapDaemonConfiguration.LLAP_DAEMON_RPC_PORT,LlapDaemonConfiguration.LLAP_DAEMON_RPC_PORT_DEFAULT);
  InetSocketAddress addr=new InetSocketAddress(port);
  LOG.info("Attempting to start LlapDaemonProtocol on port=" + port + ", with numHandlers="+ numHandlers);
  try {
    server=createServer(LlapDaemonProtocolBlockingPB.class,addr,conf,numHandlers,LlapDaemonProtocolProtos.LlapDaemonProtocol.newReflectiveBlockingService(this));
    server.start();
  }
 catch (  IOException e) {
    LOG.error("Failed to run RPC Server on port: " + port,e);
    throw new RuntimeException(e);
  }
  InetSocketAddress serverBindAddress=NetUtils.getConnectAddress(server);
  this.bindAddress.set(NetUtils.createSocketAddrForHost(serverBindAddress.getAddress().getCanonicalHostName(),serverBindAddress.getPort()));
  LOG.info("Instantiated LlapDaemonProtocol at " + bindAddress);
}
