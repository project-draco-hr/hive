{
  org.apache.hadoop.mapred.InputSplit baseSplit;
  outputSchema=(HCatSchema)HCatUtil.deserialize(taskContext.getConfiguration().get(HCatConstants.HCAT_KEY_OUTPUT_SCHEMA));
  if (split instanceof HCatSplit) {
    baseSplit=((HCatSplit)split).getBaseSplit();
  }
 else {
    throw new IOException("Not a HCatSplit");
  }
  if (outputSchema == null) {
    outputSchema=((HCatSplit)split).getTableSchema();
  }
  dataSchema=((HCatSplit)split).getDataSchema();
  Properties properties=new Properties();
  for (  Map.Entry<String,String> param : ((HCatSplit)split).getPartitionInfo().getJobProperties().entrySet()) {
    properties.setProperty(param.getKey(),param.getValue());
  }
}
