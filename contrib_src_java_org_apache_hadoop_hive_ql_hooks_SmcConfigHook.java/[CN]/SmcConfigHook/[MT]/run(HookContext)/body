{
  HiveConf conf=hookContext.getConf();
  if (!isEnabled(conf)) {
    return;
  }
  Object configObj=getConfigObject(conf);
  if (configObj == null || !(configObj instanceof JSONObject)) {
    LOG.error("config not properly set!");
    return;
  }
  JSONObject configJson=(JSONObject)configObj;
  @SuppressWarnings("unchecked") Iterator<String> i=(Iterator<String>)configJson.keys();
  while (i.hasNext()) {
    String key=i.next();
    Object valueObj=configJson.get(key);
    String value=valueObj.toString();
    conf.set(key,value);
    LOG.debug("Setting " + key + " to "+ value);
  }
}
