{
  int poolSize=hiveConf.getIntVar(ConfVars.HIVE_SERVER2_ASYNC_EXEC_THREADS);
  LOG.info("HiveServer2: Background operation thread pool size: " + poolSize);
  int poolQueueSize=hiveConf.getIntVar(ConfVars.HIVE_SERVER2_ASYNC_EXEC_WAIT_QUEUE_SIZE);
  LOG.info("HiveServer2: Background operation thread wait queue size: " + poolQueueSize);
  long keepAliveTime=HiveConf.getTimeVar(hiveConf,ConfVars.HIVE_SERVER2_ASYNC_EXEC_KEEPALIVE_TIME,TimeUnit.SECONDS);
  LOG.info("HiveServer2: Background operation thread keepalive time: " + keepAliveTime + " seconds");
  String threadPoolName="HiveServer2-Background-Pool";
  backgroundOperationPool=new ThreadPoolExecutor(poolSize,poolSize,keepAliveTime,TimeUnit.SECONDS,new LinkedBlockingQueue<Runnable>(poolQueueSize),new ThreadFactoryWithGarbageCleanup(threadPoolName));
  backgroundOperationPool.allowCoreThreadTimeOut(true);
  checkInterval=HiveConf.getTimeVar(hiveConf,ConfVars.HIVE_SERVER2_SESSION_CHECK_INTERVAL,TimeUnit.MILLISECONDS);
  sessionTimeout=HiveConf.getTimeVar(hiveConf,ConfVars.HIVE_SERVER2_IDLE_SESSION_TIMEOUT,TimeUnit.MILLISECONDS);
}
