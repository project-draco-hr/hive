{
  if (className == null) {
    return null;
  }
  try {
    Class<? extends HCatStorageHandler> handlerClass=(Class<? extends HCatStorageHandler>)Class.forName(className,true,JavaUtils.getClassLoader());
    HCatStorageHandler storageHandler=(HCatStorageHandler)ReflectionUtils.newInstance(handlerClass,conf);
    return storageHandler;
  }
 catch (  ClassNotFoundException e) {
    throw new HiveException("Error in loading storage handler." + e.getMessage(),e);
  }
}
