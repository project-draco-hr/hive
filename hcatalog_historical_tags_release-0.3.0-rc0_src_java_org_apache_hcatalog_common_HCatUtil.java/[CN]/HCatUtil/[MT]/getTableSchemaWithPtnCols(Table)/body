{
  HCatSchema tableSchema=extractSchemaFromStorageDescriptor(table.getSd());
  if (table.getPartitionKeys().size() != 0) {
    for (    FieldSchema fs : table.getPartitionKeys()) {
      tableSchema.append(HCatSchemaUtils.getHCatFieldSchema(fs));
    }
  }
  return tableSchema;
}
