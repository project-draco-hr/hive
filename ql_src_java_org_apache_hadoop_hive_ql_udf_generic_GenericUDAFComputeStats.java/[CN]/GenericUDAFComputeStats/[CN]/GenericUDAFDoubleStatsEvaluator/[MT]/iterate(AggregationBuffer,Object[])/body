{
  Object p=parameters[0];
  DoubleStatsAgg myagg=(DoubleStatsAgg)agg;
  if (myagg.firstItem) {
    int numVectors=PrimitiveObjectInspectorUtils.getInt(parameters[1],numVectorsOI);
    initNDVEstimator(myagg,numVectors);
    myagg.firstItem=false;
    myagg.numBitVectors=numVectors;
  }
  if (p == null) {
    myagg.countNulls++;
  }
 else {
    try {
      double v=PrimitiveObjectInspectorUtils.getDouble(p,inputOI);
      if (v < myagg.min) {
        myagg.min=v;
      }
      if (v > myagg.max) {
        myagg.max=v;
      }
      myagg.numDV.addToEstimator(v);
    }
 catch (    NumberFormatException e) {
      if (!warned) {
        warned=true;
        LOG.warn(getClass().getSimpleName() + " " + StringUtils.stringifyException(e));
        LOG.warn(getClass().getSimpleName() + " ignoring similar exceptions.");
      }
    }
  }
}
