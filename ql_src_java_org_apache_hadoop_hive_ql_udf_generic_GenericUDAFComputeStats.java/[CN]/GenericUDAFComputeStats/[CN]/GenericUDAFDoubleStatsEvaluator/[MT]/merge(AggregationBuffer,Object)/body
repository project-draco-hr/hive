{
  if (partial != null) {
    DoubleStatsAgg myagg=(DoubleStatsAgg)agg;
    if (myagg.firstItem) {
      Object partialValue=soi.getStructFieldData(partial,numBitVectorsField);
      int numVectors=numBitVectorsFieldOI.get(partialValue);
      initNDVEstimator(myagg,numVectors);
      myagg.firstItem=false;
      myagg.numBitVectors=numVectors;
    }
    Object partialValue=soi.getStructFieldData(partial,minField);
    if (myagg.min > minFieldOI.get(partialValue)) {
      myagg.min=minFieldOI.get(partialValue);
    }
    partialValue=soi.getStructFieldData(partial,maxField);
    if (myagg.max < maxFieldOI.get(partialValue)) {
      myagg.max=maxFieldOI.get(partialValue);
    }
    partialValue=soi.getStructFieldData(partial,countNullsField);
    myagg.countNulls+=countNullsFieldOI.get(partialValue);
    partialValue=soi.getStructFieldData(partial,ndvField);
    String v=ndvFieldOI.getPrimitiveJavaObject(partialValue);
    NumDistinctValueEstimator o=new NumDistinctValueEstimator(v,myagg.numBitVectors);
    myagg.numDV.mergeEstimators(o);
  }
}
