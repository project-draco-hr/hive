{
  Object p=parameters[0];
  StringStatsAgg myagg=(StringStatsAgg)agg;
  if (myagg.firstItem) {
    int numVectors=PrimitiveObjectInspectorUtils.getInt(parameters[1],numVectorsOI);
    initNDVEstimator(myagg,numVectors);
    myagg.firstItem=false;
    myagg.numBitVectors=numVectors;
  }
  if (p == null) {
    myagg.countNulls++;
  }
 else {
    try {
      String v=PrimitiveObjectInspectorUtils.getString(p,inputOI);
      int len=v.length();
      if (len > myagg.maxLength) {
        myagg.maxLength=len;
      }
      myagg.sumLength+=len;
      myagg.count++;
      myagg.numDV.addToEstimator(v);
    }
 catch (    NumberFormatException e) {
      if (!warned) {
        warned=true;
        LOG.warn(getClass().getSimpleName() + " " + StringUtils.stringifyException(e));
        LOG.warn(getClass().getSimpleName() + " ignoring similar exceptions.");
      }
    }
  }
}
