{
  if (partial != null) {
    StringStatsAgg myagg=(StringStatsAgg)agg;
    if (myagg.firstItem) {
      Object partialValue=soi.getStructFieldData(partial,numBitVectorsField);
      int numVectors=numBitVectorsFieldOI.get(partialValue);
      initNDVEstimator(myagg,numVectors);
      myagg.firstItem=false;
      myagg.numBitVectors=numVectors;
    }
    Object partialValue=soi.getStructFieldData(partial,maxLengthField);
    if (myagg.maxLength < maxLengthFieldOI.get(partialValue)) {
      myagg.maxLength=maxLengthFieldOI.get(partialValue);
    }
    partialValue=soi.getStructFieldData(partial,sumLengthField);
    myagg.sumLength+=sumLengthFieldOI.get(partialValue);
    partialValue=soi.getStructFieldData(partial,countField);
    myagg.count+=countFieldOI.get(partialValue);
    partialValue=soi.getStructFieldData(partial,countNullsField);
    myagg.countNulls+=countNullsFieldOI.get(partialValue);
    partialValue=soi.getStructFieldData(partial,ndvField);
    String v=ndvFieldOI.getPrimitiveJavaObject(partialValue);
    NumDistinctValueEstimator o=new NumDistinctValueEstimator(v,myagg.numBitVectors);
    myagg.numDV.mergeEstimators(o);
  }
}
