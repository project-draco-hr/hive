{
  StringStatsAgg myagg=(StringStatsAgg)agg;
  long numDV=0;
  double avgLength=0.0;
  long total=myagg.count + myagg.countNulls;
  if (myagg.numBitVectors != 0) {
    numDV=myagg.numDV.estimateNumDistinctValues();
  }
  if (total != 0) {
    avgLength=(double)(myagg.sumLength / (1.0 * total));
  }
  ((Text)result[0]).set(myagg.columnType);
  ((LongWritable)result[1]).set(myagg.maxLength);
  ((DoubleWritable)result[2]).set(avgLength);
  ((LongWritable)result[3]).set(myagg.countNulls);
  ((LongWritable)result[4]).set(numDV);
  return result;
}
