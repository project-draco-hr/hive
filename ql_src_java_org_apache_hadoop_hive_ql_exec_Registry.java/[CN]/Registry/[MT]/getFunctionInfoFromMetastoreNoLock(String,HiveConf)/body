{
  try {
    String[] parts=FunctionUtils.getQualifiedFunctionNameParts(functionName);
    Function func=Hive.get(conf).getFunction(parts[0].toLowerCase(),parts[1]);
    if (func == null) {
      return null;
    }
    FunctionInfo fi=registerPermanentFunction(functionName,func.getClassName(),true,FunctionTask.toFunctionResource(func.getResourceUris()));
    if (fi == null) {
      LOG.error(func.getClassName() + " is not a valid UDF class and was not registered");
      return null;
    }
    return fi;
  }
 catch (  Throwable e) {
    LOG.info("Unable to look up " + functionName + " in metastore",e);
  }
  return null;
}
