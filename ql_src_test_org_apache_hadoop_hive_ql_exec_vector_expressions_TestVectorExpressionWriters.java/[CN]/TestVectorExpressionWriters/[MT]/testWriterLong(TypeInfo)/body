{
  LongColumnVector lcv=VectorizedRowGroupGenUtil.generateLongColumnVector(true,false,vectorSize,new Random(10));
  lcv.isNull[3]=true;
  VectorExpressionWriter vew=getWriter(type);
  for (int i=0; i < vectorSize; i++) {
    Writable w=(Writable)vew.writeValue(lcv,i);
    if (!(w instanceof NullWritable)) {
      Writable expected=getWritableValue(type,lcv.vector[i]);
      if (expected instanceof TimestampWritable) {
        TimestampWritable t1=(TimestampWritable)expected;
        TimestampWritable t2=(TimestampWritable)w;
        Assert.assertTrue(t1.getNanos() == t2.getNanos());
        Assert.assertTrue(t1.getSeconds() == t2.getSeconds());
        continue;
      }
      Assert.assertEquals(expected,w);
    }
 else {
      Assert.assertTrue(lcv.isNull[i]);
    }
  }
}
