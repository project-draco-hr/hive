{
  List<String> columnFamilies=Arrays.asList("testFamily");
  RevisionManager rm=null;
  List<Put> myPuts=new ArrayList<Put>();
  long revision;
  try {
    rm=HBaseRevisionManagerUtil.getOpenedRevisionManager(hcatConf);
    rm.open();
    Transaction tsx=rm.beginWriteTransaction(tName,columnFamilies);
    Put put=new Put(Bytes.toBytes("testRow"));
    revision=tsx.getRevisionNumber();
    put.add(FAMILY,QUALIFIER1,revision,Bytes.toBytes("textValue-" + value));
    myPuts.add(put);
    if (commit != null) {
      if (commit) {
        rm.commitWriteTransaction(tsx);
      }
 else {
        rm.abortWriteTransaction(tsx);
      }
    }
  }
  finally {
    if (rm != null)     rm.close();
  }
  HTable table=new HTable(getHbaseConf(),Bytes.toBytes(tName));
  table.put(myPuts);
  return revision;
}
