{
  baseRecordWriters=new LinkedHashMap<String,BaseRecordWriterContainer>();
  String[] aliases=getOutputFormatAliases(context);
  for (  String alias : aliases) {
    LOGGER.info("Creating record writer for alias: " + alias);
    TaskAttemptContext aliasContext=getTaskAttemptContext(alias,context);
    Configuration aliasConf=aliasContext.getConfiguration();
    String outDir=aliasConf.get("mapred.output.dir");
    if (outDir != null) {
      Path outputDir=new Path(outDir);
      FileSystem fs=outputDir.getFileSystem(aliasConf);
      if (!fs.exists(outputDir)) {
        fs.mkdirs(outputDir);
      }
    }
    OutputFormat<?,?> outputFormat=getOutputFormatInstance(aliasContext);
    baseRecordWriters.put(alias,new BaseRecordWriterContainer(outputFormat.getRecordWriter(aliasContext),aliasContext));
  }
}
