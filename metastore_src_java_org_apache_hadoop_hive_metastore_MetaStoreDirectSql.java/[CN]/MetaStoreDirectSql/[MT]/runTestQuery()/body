{
  Transaction tx=pm.currentTransaction();
  String selfTestQuery="select \"DB_ID\" from \"DBS\"";
  try {
    pm.newQuery("javax.jdo.query.SQL",selfTestQuery).execute();
    tx.commit();
    return true;
  }
 catch (  Exception ex) {
    LOG.warn("Self-test query [" + selfTestQuery + "] failed; direct SQL is disabled",ex);
    tx.rollback();
    return false;
  }
}
