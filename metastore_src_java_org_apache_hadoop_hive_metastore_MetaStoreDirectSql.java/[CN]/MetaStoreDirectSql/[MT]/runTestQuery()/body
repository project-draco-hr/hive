{
  Transaction tx=pm.currentTransaction();
  Query query=null;
  String selfTestQuery="select \"DB_ID\" from \"DBS\"";
  try {
    query=pm.newQuery("javax.jdo.query.SQL",selfTestQuery);
    query.execute();
    tx.commit();
    return true;
  }
 catch (  Exception ex) {
    LOG.warn("Self-test query [" + selfTestQuery + "] failed; direct SQL is disabled",ex);
    tx.rollback();
    return false;
  }
 finally {
    if (query != null) {
      query.closeAll();
    }
  }
}
