{
  long partsFound=0;
  boolean doTrace=LOG.isDebugEnabled();
  String qText="select count(\"COLUMN_NAME\") from \"PART_COL_STATS\"" + " where \"DB_NAME\" = ? and \"TABLE_NAME\" = ? " + " and \"COLUMN_NAME\" in (" + makeParams(colNames.size()) + ")"+ " and \"PARTITION_NAME\" in ("+ makeParams(partNames.size())+ ")"+ " group by \"PARTITION_NAME\"";
  long start=doTrace ? System.nanoTime() : 0;
  Query query=pm.newQuery("javax.jdo.query.SQL",qText);
  Object qResult=query.executeWithArray(prepareParams(dbName,tableName,partNames,colNames));
  long end=doTrace ? System.nanoTime() : 0;
  timingTrace(doTrace,qText,start,end);
  ForwardQueryResult fqr=(ForwardQueryResult)qResult;
  Iterator<?> iter=fqr.iterator();
  while (iter.hasNext()) {
    if (StatObjectConverter.extractSqlLong(iter.next()) == colNames.size()) {
      partsFound++;
    }
  }
  return partsFound;
}
