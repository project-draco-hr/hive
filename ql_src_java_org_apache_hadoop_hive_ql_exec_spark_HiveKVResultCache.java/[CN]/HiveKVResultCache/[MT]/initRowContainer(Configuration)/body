{
  RowContainer container;
  try {
    container=new RowContainer(IN_MEMORY_CACHE_SIZE,conf,Reporter.NULL);
    String fileFormat=HiveConf.getVar(conf,HiveConf.ConfVars.HIVEQUERYRESULTFILEFORMAT);
    TableDesc tableDesc=PlanUtils.getDefaultQueryOutputTableDesc(COL_NAMES,COL_TYPES,fileFormat);
    SerDe serDe=(SerDe)tableDesc.getDeserializer();
    ObjectInspector oi=ObjectInspectorUtils.getStandardObjectInspector(serDe.getObjectInspector(),ObjectInspectorCopyOption.WRITABLE);
    container.setSerDe(serDe,oi);
    container.setTableDesc(tableDesc);
  }
 catch (  Exception ex) {
    throw new RuntimeException("Failed to create RowContainer",ex);
  }
  return container;
}
