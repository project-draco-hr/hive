{
  byte[] hiveKeyBytes=KryoSerializer.serialize(key);
  BytesWritable wrappedHiveKey=new BytesWritable(hiveKeyBytes);
  List<BytesWritable> row=new ArrayList<BytesWritable>(2);
  row.add(wrappedHiveKey);
  row.add(value);
synchronized (this) {
    try {
      if (cursor == 0) {
        container.addRow(row);
      }
 else {
        if (backupContainer == null) {
          backupContainer=initRowContainer(conf);
        }
        backupContainer.addRow(row);
      }
    }
 catch (    HiveException ex) {
      throw new RuntimeException("Failed to add KV pair to RowContainer",ex);
    }
  }
}
