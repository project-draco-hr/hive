{
  HCatRecord r;
  try {
    r=new LazyHCatRecord(serde.deserialize(currentValue),serde.getObjectInspector());
    DefaultHCatRecord dr=new DefaultHCatRecord(outputSchema.size());
    int i=0;
    for (    String fieldName : outputSchema.getFieldNames()) {
      Integer dataPosn=null;
      if ((dataPosn=dataSchema.getPosition(fieldName)) != null) {
        dr.set(i,r.get(fieldName,dataSchema));
      }
 else {
        dr.set(i,valuesNotInDataCols.get(fieldName));
      }
      i++;
    }
    return dr;
  }
 catch (  Exception e) {
    throw new IOException("Failed to create HCatRecord ",e);
  }
}
