{
synchronized (lock) {
    boolean added=preemptionQueue.offer(taskWrapper);
    if (!added) {
      LOG.warn("Failed to add element {} to preemption queue. Terminating",taskWrapper);
      Thread.getDefaultUncaughtExceptionHandler().uncaughtException(Thread.currentThread(),new IllegalStateException("Preemption queue full. Cannot proceed"));
    }
    taskWrapper.setIsInPreemptableQueue(true);
    if (metrics != null) {
      metrics.setExecutorNumPreemptableRequests(preemptionQueue.size());
    }
  }
}
