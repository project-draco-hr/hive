{
synchronized (lock) {
    TaskWrapper taskWrapper=knownTasks.remove(fragmentId);
    if (taskWrapper != null) {
      if (taskWrapper.inWaitQueue) {
        if (isDebugEnabled) {
          LOG.debug("Removing {} from waitQueue",fragmentId);
        }
        taskWrapper.setIsInWaitQueue(false);
        waitQueue.remove(taskWrapper);
      }
      if (taskWrapper.inPreemptionQueue) {
        if (isDebugEnabled) {
          LOG.debug("Removing {} from preemptionQueue",fragmentId);
        }
        taskWrapper.setIsInPreemptableQueue(false);
        preemptionQueue.remove(taskWrapper);
      }
      taskWrapper.getTaskRunnerCallable().killTask();
    }
 else {
      LOG.info("Ignoring killFragment request for {} since it isn't known",fragmentId);
    }
    lock.notify();
  }
}
