{
  Path tgtPath=null;
  if (tblDesc.getLocation() == null) {
    if (table.getDataLocation() != null) {
      tgtPath=new Path(table.getDataLocation().toString(),Warehouse.makePartPath(partSpec.getPartSpec()));
    }
 else {
      Database parentDb=db.getDatabase(tblDesc.getDatabaseName());
      tgtPath=new Path(wh.getTablePath(parentDb,tblDesc.getTableName()),Warehouse.makePartPath(partSpec.getPartSpec()));
    }
  }
 else {
    tgtPath=new Path(tblDesc.getLocation(),Warehouse.makePartPath(partSpec.getPartSpec()));
  }
  checkTargetLocationEmpty(fs,tgtPath,replicationSpec);
  partSpec.setLocation(tgtPath.toString());
}
