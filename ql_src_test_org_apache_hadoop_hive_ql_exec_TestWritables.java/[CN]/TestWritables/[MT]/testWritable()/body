{
  try {
    ByteStream.Output bos=new ByteStream.Output();
    DataOutputStream dos=new DataOutputStream(bos);
    HiveObjectSerializer hos=new NaiiveSerializer();
    WritableHiveObject who=null;
    WritableHiveObject.setSerialFormat();
    for (int i=0; i < 5; i++) {
      who=new WritableHiveObject(i,null,hos);
      who.setHo(r[i]);
      who.write(dos);
    }
    ByteStream.Input bin=new ByteStream.Input(bos.getData(),0,bos.getCount());
    DataInputStream din=new DataInputStream(bin);
    for (int i=0; i < 5; i++) {
      who.readFields(din);
      HiveObject ho=who.getHo();
      for (int j=0; j < 3; j++) {
        SerDeField sdf=ho.getFieldFromExpression("" + j);
        String str=(String)ho.get(sdf).getJavaObject();
        assertEquals(str,new String("" + (i - 1 + j)));
      }
      assertEquals(who.getTag(),i);
    }
    System.out.println("testWritable OK");
  }
 catch (  Exception e) {
    e.printStackTrace();
    throw (e);
  }
}
