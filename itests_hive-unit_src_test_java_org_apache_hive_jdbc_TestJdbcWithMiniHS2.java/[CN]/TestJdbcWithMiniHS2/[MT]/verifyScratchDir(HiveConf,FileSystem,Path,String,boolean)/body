{
  String dirType=isLocal ? "Local" : "DFS";
  FsPermission expectedFSPermission=new FsPermission(HiveConf.getVar(conf,HiveConf.ConfVars.SCRATCHDIRPERMISSION));
  assertTrue("The expected " + dirType + " scratch dir does not exist for the user: "+ userName,fs.exists(scratchDirPath));
  if (fs.exists(scratchDirPath) && !isLocal) {
    assertEquals("DFS scratch dir permissions don't match",expectedFSPermission,fs.getFileStatus(scratchDirPath).getPermission());
  }
}
