{
  if (miniHS2.isStarted()) {
    miniHS2.stop();
  }
  HiveConf conf=new HiveConf();
  String userName;
  setSerializeInTasksInConf(conf);
  miniHS2=new MiniHS2(conf);
  Map<String,String> confOverlay=new HashMap<String,String>();
  miniHS2.start(confOverlay);
  userName=System.getProperty("user.name");
  hs2Conn=getConnection(miniHS2.getJdbcURL(),userName,"password");
  Statement stmt=hs2Conn.createStatement();
  stmt.execute("drop table if exists testThriftSerializeShow");
  stmt.execute("create table testThriftSerializeShow (a int)");
  ResultSet rs=stmt.executeQuery("show tables");
  assertTrue(rs.next());
  stmt.execute("describe testThriftSerializeShow");
  stmt.execute("explain select a from testThriftSerializeShow");
  stmt.execute("drop table testThriftSerializeShow");
  stmt.close();
}
