{
  HiveConf testConf=new HiveConf();
  Set<String> funcNames=FunctionRegistry.getFunctionNames();
  String funcNameStr="";
  for (  String funcName : funcNames) {
    funcNameStr+="," + funcName;
  }
  funcNameStr=funcNameStr.substring(1);
  testConf.setVar(ConfVars.HIVE_SERVER2_BUILTIN_UDF_WHITELIST,funcNameStr);
  testConf.setVar(ConfVars.HIVE_SERVER2_BUILTIN_UDF_BLACKLIST,"reflect");
  miniHS2=new MiniHS2(testConf);
  miniHS2.start(new HashMap<String,String>());
  hs2Conn=getConnection(miniHS2.getJdbcURL(),System.getProperty("user.name"),"bar");
  Statement stmt=hs2Conn.createStatement();
  try {
    stmt.executeQuery("SELECT reflect('java.lang.String', 'valueOf', 1) ");
    fail("reflect() udf invocation should fail");
  }
 catch (  SQLException e) {
  }
}
