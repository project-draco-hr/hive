{
  if (!tbl.isPartitioned()) {
    return stats;
  }
  List<ColStatistics> pStats=new ArrayList<ColStatistics>();
  List<FieldSchema> pCols=tbl.getPartCols();
  for (  FieldSchema pC : pCols) {
    neededCols.add(pC.getName());
    ColStatistics cStats=stats.getColumnStatisticsForColumn(tblAlias,pC.getName());
    if (cStats == null) {
      PrunedPartitionList partList=ctx.parseCtx.getOpToPartList().get(tableScanOp);
      cStats=new ColStatistics(tblAlias,pC.getName(),pC.getType());
      cStats.setCountDistint(partList.getPartitions().size());
      pStats.add(cStats);
    }
  }
  if (pStats.size() > 0) {
    stats=stats.clone();
    stats.addToColumnStats(pStats);
  }
  return stats;
}
