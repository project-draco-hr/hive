{
  Context ctx=(Context)procCtx;
  HiveRel input=(HiveRel)ctx.getParentNode((Operator<? extends OperatorDesc>)nd,0);
  LimitOperator limitOp=(LimitOperator)nd;
  final RexNode fetch;
  if (limitOp.getConf().getLimit() >= 0) {
    fetch=ctx.cluster.getRexBuilder().makeExactLiteral(BigDecimal.valueOf(limitOp.getConf().getLimit()));
  }
 else {
    fetch=null;
  }
  RelTraitSet traitSet=ctx.cluster.traitSetOf(HiveRel.CONVENTION);
  RelCollation canonizedCollation=traitSet.canonize(RelCollationImpl.EMPTY);
  HiveRel sortRel=new HiveSortRel(ctx.cluster,traitSet,input,canonizedCollation,null,fetch);
  ctx.propagatePosMap(sortRel,input);
  ctx.hiveOpToRelNode.put(limitOp,sortRel);
  return sortRel;
}
