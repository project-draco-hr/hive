{
  String dbName="default";
  String tableName="timeoutpart";
  String partName="ds=today";
  List<String> partVals=Arrays.asList("today");
  long now=System.currentTimeMillis();
  ColumnStatistics cs=new ColumnStatistics();
  ColumnStatisticsDesc desc=new ColumnStatisticsDesc(false,dbName,tableName);
  desc.setLastAnalyzed(now);
  desc.setPartName(partName);
  cs.setStatsDesc(desc);
  ColumnStatisticsObj obj=new ColumnStatisticsObj();
  obj.setColName("col1");
  obj.setColType("boolean");
  ColumnStatisticsData data=new ColumnStatisticsData();
  data.setBooleanStats(new BooleanColumnStatsData());
  obj.setStatsData(data);
  cs.addToStatsObj(obj);
  hrw.updateStatistics(dbName,tableName,partName,partVals,cs);
  StatsCache.getInstance(null).makeWayOld();
  List<ColumnStatistics> results=hrw.getPartitionStatistics(dbName,tableName,Arrays.asList(partName,"fred"),Arrays.asList(partVals,Arrays.asList("fred")),Arrays.asList("col1","col2","col3"));
  Assert.assertEquals(2,results.size());
  Assert.assertEquals(0,results.get(0).getStatsObjSize());
  Assert.assertEquals(0,results.get(1).getStatsObjSize());
}
