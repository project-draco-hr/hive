{
  String dbName="default";
  String tableName="cleaning";
  long now=System.currentTimeMillis();
  ColumnStatistics cs=new ColumnStatistics();
  ColumnStatisticsDesc desc=new ColumnStatisticsDesc(true,dbName,tableName);
  desc.setLastAnalyzed(now);
  cs.setStatsDesc(desc);
  for (int i=0; i < 15; i++) {
    ColumnStatisticsObj obj=new ColumnStatisticsObj();
    obj.setColName("col" + i);
    obj.setColType("boolean");
    ColumnStatisticsData data=new ColumnStatisticsData();
    data.setBooleanStats(new BooleanColumnStatsData());
    obj.setStatsData(data);
    cs.addToStatsObj(obj);
  }
  hrw.updateStatistics(dbName,tableName,null,null,cs);
  Assert.assertEquals(15,StatsCache.getInstance(null).cacheSize());
  StatsCache.getInstance(null).makeWayOld();
  cs=new ColumnStatistics();
  desc=new ColumnStatisticsDesc(true,dbName,tableName);
  desc.setLastAnalyzed(now);
  cs.setStatsDesc(desc);
  ColumnStatisticsObj obj=new ColumnStatisticsObj();
  obj.setColName("col16");
  obj.setColType("boolean");
  ColumnStatisticsData data=new ColumnStatisticsData();
  data.setBooleanStats(new BooleanColumnStatsData());
  obj.setStatsData(data);
  cs.addToStatsObj(obj);
  hrw.updateStatistics(dbName,tableName,null,null,cs);
  while (StatsCache.getInstance(null).cleaning()) {
    Thread.sleep(250);
  }
  Assert.assertEquals(1,StatsCache.getInstance(null).cacheSize());
}
