{
  if (timeZoneId == null || timeZoneId.isEmpty()) {
    timeZoneId=readerTimeZone.getID();
  }
  if (!baseTimestampMap.containsKey(timeZoneId)) {
    writerTimeZone=TimeZone.getTimeZone(timeZoneId);
    hasSameTZRules=writerTimeZone.hasSameRules(readerTimeZone);
    SimpleDateFormat sdf=new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
    sdf.setTimeZone(writerTimeZone);
    try {
      long epoch=sdf.parse(WriterImpl.BASE_TIMESTAMP_STRING).getTime() / WriterImpl.MILLIS_PER_SECOND;
      baseTimestampMap.put(timeZoneId,epoch);
      return epoch;
    }
 catch (    ParseException e) {
      throw new IOException("Unable to create base timestamp",e);
    }
 finally {
      sdf.setTimeZone(readerTimeZone);
    }
  }
  return baseTimestampMap.get(timeZoneId);
}
