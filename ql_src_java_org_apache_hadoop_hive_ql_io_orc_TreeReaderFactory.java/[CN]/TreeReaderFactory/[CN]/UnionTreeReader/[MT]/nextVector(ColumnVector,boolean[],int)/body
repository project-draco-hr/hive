{
  UnionColumnVector result=(UnionColumnVector)previousVector;
  super.nextVector(result,isNull,batchSize);
  if (result.noNulls || !(result.isRepeating && result.isNull[0])) {
    result.isRepeating=false;
    tags.nextVector(result.noNulls ? null : result.isNull,result.tags,batchSize);
    boolean[] ignore=new boolean[(int)batchSize];
    for (int f=0; f < result.fields.length; ++f) {
      for (int r=0; r < batchSize; ++r) {
        ignore[r]=(!result.noNulls && result.isNull[r]) || result.tags[r] != f;
      }
      fields[f].nextVector(result.fields[f],ignore,batchSize);
    }
  }
}
