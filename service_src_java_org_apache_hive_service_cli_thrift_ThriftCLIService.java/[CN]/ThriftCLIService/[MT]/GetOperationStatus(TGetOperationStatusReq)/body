{
  TGetOperationStatusResp resp=new TGetOperationStatusResp();
  try {
    OperationStatus operationStatus=cliService.getOperationStatus(new OperationHandle(req.getOperationHandle()));
    resp.setOperationState(operationStatus.getState().toTOperationState());
    HiveSQLException opException=operationStatus.getOperationException();
    resp.setTaskStatus(operationStatus.getTaskStatus());
    resp.setOperationStarted(operationStatus.getOperationStarted());
    resp.setOperationCompleted(operationStatus.getOperationCompleted());
    if (opException != null) {
      resp.setSqlState(opException.getSQLState());
      resp.setErrorCode(opException.getErrorCode());
      resp.setErrorMessage(opException.getMessage());
    }
    resp.setStatus(OK_STATUS);
  }
 catch (  Exception e) {
    LOG.warn("Error getting operation status: ",e);
    resp.setStatus(HiveSQLException.toTStatus(e));
  }
  return resp;
}
