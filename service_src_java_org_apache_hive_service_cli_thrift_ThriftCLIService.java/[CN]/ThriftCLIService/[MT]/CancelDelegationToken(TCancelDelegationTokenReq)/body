{
  TCancelDelegationTokenResp resp=new TCancelDelegationTokenResp();
  if (hiveAuthFactory == null || !hiveAuthFactory.isSASLKerberosUser()) {
    resp.setStatus(unsecureTokenErrorStatus());
  }
 else {
    try {
      cliService.cancelDelegationToken(new SessionHandle(req.getSessionHandle()),hiveAuthFactory,req.getDelegationToken());
      resp.setStatus(OK_STATUS);
    }
 catch (    HiveSQLException e) {
      LOG.error("Error canceling delegation token",e);
      resp.setStatus(HiveSQLException.toTStatus(e));
    }
  }
  return resp;
}
