{
  TCloseSessionResp resp=new TCloseSessionResp();
  try {
    SessionHandle sessionHandle=new SessionHandle(req.getSessionHandle());
    cliService.closeSession(sessionHandle);
    LOG.info("Closed a session, current sessions: " + sessionCount.decrementAndGet());
    resp.setStatus(OK_STATUS);
    ThriftCLIServerContext context=(ThriftCLIServerContext)currentServerContext.get();
    if (context != null) {
      context.setSessionHandle(null);
    }
  }
 catch (  Exception e) {
    LOG.warn("Error closing session: ",e);
    resp.setStatus(HiveSQLException.toTStatus(e));
  }
  return resp;
}
