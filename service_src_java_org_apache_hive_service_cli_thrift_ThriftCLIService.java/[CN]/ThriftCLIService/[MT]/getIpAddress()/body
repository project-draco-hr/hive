{
  String clientIpAddress;
  if (cliService.getHiveConf().getVar(ConfVars.HIVE_SERVER2_TRANSPORT_MODE).equalsIgnoreCase("http")) {
    clientIpAddress=SessionManager.getIpAddress();
  }
 else {
    if (isKerberosAuthMode()) {
      clientIpAddress=hiveAuthFactory.getIpAddress();
    }
 else {
      clientIpAddress=TSetIpAddressProcessor.getUserIpAddress();
    }
  }
  LOG.debug("Client's IP Address: " + clientIpAddress);
  return clientIpAddress;
}
