{
  TGetResultSetMetadataResp resp=new TGetResultSetMetadataResp();
  try {
    TableSchema schema=cliService.getResultSetMetadata(new OperationHandle(req.getOperationHandle()));
    resp.setSchema(schema.toTTableSchema());
    resp.setStatus(OK_STATUS);
  }
 catch (  Exception e) {
    LOG.warn("Error getting result set metadata: ",e);
    resp.setStatus(HiveSQLException.toTStatus(e));
  }
  return resp;
}
