{
  connParams.getRejectedHostZnodePaths().add(connParams.getCurrentHostZnodePath());
  String oldServerHost=connParams.getHost();
  int oldServerPort=connParams.getPort();
  try {
    ZooKeeperHiveClientHelper.configureConnParams(connParams);
    connParams.setJdbcUriString(connParams.getJdbcUriString().replace(oldServerHost + ":" + oldServerPort,connParams.getHost() + ":" + connParams.getPort()));
    LOG.info("Selected HiveServer2 instance with uri: " + connParams.getJdbcUriString());
  }
 catch (  ZooKeeperHiveClientException e) {
    LOG.error(e.getMessage());
    return false;
  }
  return true;
}
