{
  connParams.getRejectedHostZnodePaths().add(connParams.getCurrentHostZnodePath());
  String serverUriString=ZooKeeperHiveClientHelper.getNextServerUriFromZooKeeper(connParams);
  URI serverUri=null;
  try {
    serverUri=new URI(null,serverUriString,null,null,null);
  }
 catch (  URISyntaxException e) {
    throw new ZooKeeperHiveClientException(e);
  }
  String oldServerHost=connParams.getHost();
  int oldServerPort=connParams.getPort();
  String newServerHost=serverUri.getHost();
  int newServerPort=serverUri.getPort();
  connParams.setHost(newServerHost);
  connParams.setPort(newServerPort);
  connParams.setJdbcUriString(connParams.getJdbcUriString().replace(oldServerHost + ":" + oldServerPort,newServerHost + ":" + newServerPort));
}
