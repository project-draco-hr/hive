{
  String serviceDiscoveryMode=connParams.getSessionVars().get(JdbcConnectionParams.SERVICE_DISCOVERY_MODE);
  if ((serviceDiscoveryMode != null) && (JdbcConnectionParams.SERVICE_DISCOVERY_MODE_ZOOKEEPER.equalsIgnoreCase(serviceDiscoveryMode))) {
    return resolveAuthorityUsingZooKeeper(connParams);
  }
 else {
    String authority=connParams.getAuthorityList()[0];
    URI jdbcURI=URI.create(URI_HIVE_PREFIX + "//" + authority);
    if ((jdbcURI.getAuthority() != null) && (jdbcURI.getHost() == null)) {
      throw new JdbcUriParseException("Bad URL format. Hostname not found " + " in authority part of the url: " + jdbcURI.getAuthority() + ". Are you missing a '/' after the hostname ?");
    }
    return jdbcURI.getAuthority();
  }
}
