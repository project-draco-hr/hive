{
  String serviceDiscoveryMode=connParams.getSessionVars().get(JdbcConnectionParams.SERVICE_DISCOVERY_MODE);
  if ((serviceDiscoveryMode != null) && (JdbcConnectionParams.SERVICE_DISCOVERY_MODE_ZOOKEEPER.equalsIgnoreCase(serviceDiscoveryMode))) {
    connParams.setZooKeeperEnsemble(joinStringArray(connParams.getAuthorityList(),","));
    ZooKeeperHiveClientHelper.configureConnParams(connParams);
  }
 else {
    String authority=connParams.getAuthorityList()[0];
    URI jdbcURI=URI.create(URI_HIVE_PREFIX + "//" + authority);
    if (jdbcURI.getAuthority() != null) {
      String host=jdbcURI.getHost();
      int port=jdbcURI.getPort();
      if (host == null) {
        throw new JdbcUriParseException("Bad URL format. Hostname not found " + " in authority part of the url: " + jdbcURI.getAuthority() + ". Are you missing a '/' after the hostname ?");
      }
      if (port <= 0) {
        port=Integer.parseInt(Utils.DEFAULT_PORT);
      }
      connParams.setHost(jdbcURI.getHost());
      connParams.setPort(jdbcURI.getPort());
    }
  }
}
