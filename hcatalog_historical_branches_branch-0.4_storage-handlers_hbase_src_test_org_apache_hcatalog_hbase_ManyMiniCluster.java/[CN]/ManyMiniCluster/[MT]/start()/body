{
  try {
    if (!started) {
      FileUtil.fullyDelete(workDir);
      if (miniMRClusterEnabled) {
        setupMRCluster();
      }
      if (miniZookeeperClusterEnabled || miniHBaseClusterEnabled) {
        miniZookeeperClusterEnabled=true;
        setupZookeeper();
      }
      if (miniHBaseClusterEnabled) {
        setupHBaseCluster();
      }
      if (miniHiveMetastoreEnabled) {
        setUpMetastore();
      }
    }
  }
 catch (  Exception e) {
    throw new IllegalStateException("Failed to setup cluster",e);
  }
}
