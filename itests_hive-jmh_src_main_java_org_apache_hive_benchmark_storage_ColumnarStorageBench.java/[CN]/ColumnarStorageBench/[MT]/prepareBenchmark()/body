{
  if (format.equalsIgnoreCase("parquet")) {
    storageFormatTest=new ParquetStorageFormatTest();
  }
 else   if (format.equalsIgnoreCase("orc")) {
    storageFormatTest=new OrcStorageFormatTest();
  }
 else {
    throw new IllegalArgumentException("Invalid file format argument: " + format);
  }
  for (int i=0; i < rows.length; i++) {
    recordWritable[i]=storageFormatTest.serialize(rows[i],oi);
  }
  fs=FileSystem.getLocal(new Configuration());
  writeFile=createTempFile();
  writePath=new Path(writeFile.getPath());
  readFile=createTempFile();
  readPath=new Path(readFile.getPath());
  RecordWriter writer=storageFormatTest.getRecordWriter(readPath);
  storageFormatTest.writeRecords(writer,recordWritable);
  writer.close(false);
}
