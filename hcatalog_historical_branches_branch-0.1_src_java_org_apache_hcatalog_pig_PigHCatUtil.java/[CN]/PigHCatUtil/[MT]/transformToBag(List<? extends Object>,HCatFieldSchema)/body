{
  if (list == null) {
    return null;
  }
  HCatFieldSchema elementSubFieldSchema=hfs.getArrayElementSchema().getFields().get(0);
  if (elementSubFieldSchema.getType() == Type.STRUCT) {
    DataBag db=new DefaultDataBag();
    for (    Object o : list) {
      db.add(transformToTuple((List<Object>)o,elementSubFieldSchema));
    }
    return db;
  }
 else {
    return new HCatArrayBag(list);
  }
}
