{
  NTileBuffer rb=(NTileBuffer)agg;
  ArrayList<IntWritable> res=new ArrayList<IntWritable>(rb.numRows);
  int bucketsz=rb.numRows / rb.numBuckets;
  int rem=rb.numRows % rb.numBuckets;
  int start=0;
  int bucket=1;
  while (start < rb.numRows) {
    int end=start + bucketsz;
    if (rem > 0) {
      end++;
      rem--;
    }
    end=Math.min(rb.numRows,end);
    for (int i=start; i < end; i++) {
      res.add(new IntWritable(bucket));
    }
    start=end;
    bucket++;
  }
  return res;
}
