{
  List<byte[]> resultBytes=new ArrayList<byte[]>();
  int count=0;
  if (hashMapResult.hasRows()) {
    WriteBuffers.ByteSegmentRef ref=hashMapResult.first();
    while (ref != null) {
      count++;
      byte[] bytes=ref.getBytes();
      int offset=(int)ref.getOffset();
      int length=ref.getLength();
      resultBytes.add(Arrays.copyOfRange(bytes,offset,offset + length));
      ref=hashMapResult.next();
    }
  }
 else {
    assertTrue(hashMapResult.isEof());
  }
  if (randomByteArrayStream.size() != count) {
    assertTrue(false);
  }
  for (int i=0; i < count; ++i) {
    byte[] bytes=resultBytes.get(i);
    if (!randomByteArrayStream.contains(bytes)) {
      assertTrue(false);
    }
  }
}
