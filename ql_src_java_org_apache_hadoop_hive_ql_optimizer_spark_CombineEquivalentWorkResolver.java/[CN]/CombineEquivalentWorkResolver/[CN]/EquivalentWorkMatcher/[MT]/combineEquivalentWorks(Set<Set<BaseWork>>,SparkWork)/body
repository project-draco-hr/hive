{
  Set<BaseWork> removedWorks=Sets.newHashSet();
  for (  Set<BaseWork> workSet : equivalentWorks) {
    if (workSet.size() > 1) {
      Iterator<BaseWork> iterator=workSet.iterator();
      BaseWork first=iterator.next();
      while (iterator.hasNext()) {
        BaseWork next=iterator.next();
        replaceWork(next,first,sparkWork);
        removedWorks.add(next);
      }
    }
  }
  return removedWorks;
}
