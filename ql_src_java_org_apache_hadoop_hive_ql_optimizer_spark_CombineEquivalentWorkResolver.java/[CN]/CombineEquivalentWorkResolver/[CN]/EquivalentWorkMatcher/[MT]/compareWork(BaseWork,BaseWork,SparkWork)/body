{
  if (!first.getClass().getName().equals(second.getClass().getName())) {
    return false;
  }
  if (!hasSameParent(first,second,sparkWork)) {
    return false;
  }
  if (sparkWork.getLeaves().contains(first) && sparkWork.getLeaves().contains(second)) {
    return false;
  }
  Set<Operator<?>> firstRootOperators=first.getAllRootOperators();
  Set<Operator<?>> secondRootOperators=second.getAllRootOperators();
  if (firstRootOperators.size() != secondRootOperators.size()) {
    return false;
  }
  Iterator<Operator<?>> firstIterator=firstRootOperators.iterator();
  Iterator<Operator<?>> secondIterator=secondRootOperators.iterator();
  while (firstIterator.hasNext()) {
    boolean result=compareOperatorChain(firstIterator.next(),secondIterator.next());
    if (!result) {
      return result;
    }
  }
  return true;
}
