{
  HTableInterface htab=getHTable(table);
  byte[] stop=Arrays.copyOf(keyPrefix,keyPrefix.length);
  stop[stop.length - 1]++;
  Scan s=new Scan(keyPrefix,stop);
  s.addColumn(colFam,colName);
  if (filter != null)   s.setFilter(filter);
  ResultScanner scanner=htab.getScanner(s);
  List<Partition> parts=new ArrayList<Partition>();
  int numToFetch=maxResults < 0 ? Integer.MAX_VALUE : maxResults;
  Iterator<Result> iter=scanner.iterator();
  for (int i=0; i < numToFetch && iter.hasNext(); i++) {
    PartitionWritable p=new PartitionWritable();
    HBaseUtils.deserialize(p,iter.next().getValue(colFam,colName));
    parts.add(p.part);
  }
  return parts;
}
