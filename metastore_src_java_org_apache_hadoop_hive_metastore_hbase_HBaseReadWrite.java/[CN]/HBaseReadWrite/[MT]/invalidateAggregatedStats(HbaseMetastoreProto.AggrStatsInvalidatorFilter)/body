{
  Iterator<Result> results=scan(AGGR_STATS_TABLE,new AggrStatsInvalidatorFilter(filter));
  if (!results.hasNext())   return Collections.emptyList();
  List<Delete> deletes=new ArrayList<>();
  List<StatsCache.StatsCacheKey> keys=new ArrayList<>();
  while (results.hasNext()) {
    Result result=results.next();
    deletes.add(new Delete(result.getRow()));
    keys.add(new StatsCache.StatsCacheKey(result.getRow()));
  }
  HTableInterface htab=conn.getHBaseTable(AGGR_STATS_TABLE);
  htab.delete(deletes);
  return keys;
}
