{
  byte[] keyPrefix=null;
  if (dbName != null) {
    keyPrefix=HBaseUtils.buildKeyWithTrailingSeparator(dbName);
  }
  Filter filter=null;
  if (regex != null) {
    filter=new RowFilter(CompareFilter.CompareOp.EQUAL,new RegexStringComparator(regex));
  }
  Iterator<Result> iter=scan(TABLE_TABLE,keyPrefix,HBaseUtils.getEndPrefix(keyPrefix),CATALOG_CF,CATALOG_COL,filter);
  List<Table> tables=new ArrayList<>();
  while (iter.hasNext()) {
    Result result=iter.next();
    HBaseUtils.StorageDescriptorParts sdParts=HBaseUtils.deserializeTable(result.getRow(),result.getValue(CATALOG_CF,CATALOG_COL));
    StorageDescriptor sd=getStorageDescriptor(sdParts.sdHash);
    HBaseUtils.assembleStorageDescriptor(sd,sdParts);
    tables.add(sdParts.containingTable);
  }
  return tables;
}
