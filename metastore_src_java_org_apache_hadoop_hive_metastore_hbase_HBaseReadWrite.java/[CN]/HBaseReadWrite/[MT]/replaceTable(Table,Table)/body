{
  byte[] hash;
  byte[] oldHash=HBaseUtils.hashStorageDescriptor(oldTable.getSd(),md);
  byte[] newHash=HBaseUtils.hashStorageDescriptor(newTable.getSd(),md);
  if (Arrays.equals(oldHash,newHash)) {
    hash=oldHash;
  }
 else {
    decrementStorageDescriptorRefCount(oldTable.getSd());
    hash=putStorageDescriptor(newTable.getSd());
  }
  byte[][] serialized=HBaseUtils.serializeTable(newTable,hash);
  store(TABLE_TABLE,serialized[0],CATALOG_CF,CATALOG_COL,serialized[1]);
  tableCache.put(new ObjectPair<String,String>(newTable.getDbName(),newTable.getTableName()),newTable);
}
