{
  List<String> protoNames=new ArrayList<>(partNames.size() + 3);
  protoNames.add(dbName);
  protoNames.add(tableName);
  protoNames.add(colName);
  protoNames.addAll(partNames);
  BloomFilter bloom=new BloomFilter(partNames.size(),STATS_BF_ERROR_RATE);
  for (  String partName : partNames) {
    bloom.add(partName.getBytes(HBaseUtils.ENCODING));
  }
  byte[] serializedFilter=HBaseUtils.serializeBloomFilter(dbName,tableName,bloom);
  byte[] serializedStats=HBaseUtils.serializeAggrStats(stats);
  store(AGGR_STATS_TABLE,key,CATALOG_CF,new byte[][]{AGGR_STATS_BLOOM_COL,AGGR_STATS_STATS_COL},new byte[][]{serializedFilter,serializedStats});
}
