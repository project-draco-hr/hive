{
  if (maxPartitions < 0)   maxPartitions=Integer.MAX_VALUE;
  Collection<Partition> cached=partCache.getAllForTable(dbName,tableName);
  if (cached != null) {
    return maxPartitions < cached.size() ? new ArrayList<>(cached).subList(0,maxPartitions) : new ArrayList<>(cached);
  }
  byte[] keyPrefix=HBaseUtils.buildPartitionKey(dbName,tableName,new ArrayList<String>(),new ArrayList<String>(),false);
  List<Partition> parts=scanPartitionsWithFilter(dbName,tableName,keyPrefix,HBaseUtils.getEndPrefix(keyPrefix),-1,null);
  partCache.put(dbName,tableName,parts,true);
  return maxPartitions < parts.size() ? parts.subList(0,maxPartitions) : parts;
}
