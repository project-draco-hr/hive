{
  Iterator<Result> iter=scan(PART_TABLE,startRow,endRow,CATALOG_CF,CATALOG_COL,filter);
  List<FieldSchema> tablePartitions=getTable(dbName,tableName).getPartitionKeys();
  List<Partition> parts=new ArrayList<>();
  int numToFetch=maxResults < 0 ? Integer.MAX_VALUE : maxResults;
  for (int i=0; i < numToFetch && iter.hasNext(); i++) {
    Result result=iter.next();
    HBaseUtils.StorageDescriptorParts sdParts=HBaseUtils.deserializePartition(dbName,tableName,tablePartitions,result.getRow(),result.getValue(CATALOG_CF,CATALOG_COL));
    StorageDescriptor sd=getStorageDescriptor(sdParts.sdHash);
    HBaseUtils.assembleStorageDescriptor(sd,sdParts);
    parts.add(sdParts.containingPartition);
  }
  return parts;
}
