{
  Path parent=new Path(SessionState.get().getHdfsScratchDirURIString(),SPARK_DIR);
  Path sparkDir=new Path(parent,sessionId);
  FileSystem fs=sparkDir.getFileSystem(conf);
  FsPermission fsPermission=new FsPermission(HiveConf.getVar(conf,HiveConf.ConfVars.SCRATCHDIRPERMISSION));
  fs.mkdirs(sparkDir,fsPermission);
  fs.deleteOnExit(sparkDir);
  return sparkDir;
}
