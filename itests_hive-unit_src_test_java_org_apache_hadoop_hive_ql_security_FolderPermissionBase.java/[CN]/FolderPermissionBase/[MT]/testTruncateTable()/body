{
  String tableName="truncatetable";
  String partition=warehouseDir + "/" + tableName+ "/part1=1";
  CommandProcessorResponse ret=driver.run("CREATE TABLE " + tableName + " (key STRING, value STRING) PARTITIONED BY (part1 INT)");
  Assert.assertEquals(0,ret.getResponseCode());
  setPermission(warehouseDir + "/" + tableName);
  ret=driver.run("insert into table " + tableName + " partition(part1='1') select key,value from mysrc where part1='1' and part2='1'");
  Assert.assertEquals(0,ret.getResponseCode());
  assertExistence(warehouseDir + "/" + tableName);
  verifyPermission(warehouseDir + "/" + tableName);
  verifyPermission(partition);
  ret=driver.run("TRUNCATE TABLE " + tableName);
  Assert.assertEquals(0,ret.getResponseCode());
  assertExistence(warehouseDir + "/" + tableName);
  verifyPermission(warehouseDir + "/" + tableName);
  ret=driver.run("insert into table " + tableName + " partition(part1='1') select key,value from mysrc where part1='1' and part2='1'");
  Assert.assertEquals(0,ret.getResponseCode());
  verifyPermission(warehouseDir + "/" + tableName);
  assertExistence(partition);
  verifyPermission(partition);
  ret=driver.run("TRUNCATE TABLE " + tableName + " partition(part1='1')");
  Assert.assertEquals(0,ret.getResponseCode());
  assertExistence(partition);
  verifyPermission(partition);
}
