{
  String tableName="dualdynamicpart";
  CommandProcessorResponse ret=driver.run("CREATE TABLE " + tableName + " (key string, value string) partitioned by (part1 string, part2 string)");
  Assert.assertEquals(0,ret.getResponseCode());
  assertExistence(warehouseDir + "/" + tableName);
  setPermission(warehouseDir + "/" + tableName,0);
  ret=driver.run("insert into table " + tableName + " partition (part1,part2) select key,value,part1,part2 from mysrc");
  Assert.assertEquals(0,ret.getResponseCode());
  verifyDualPartitionTable(warehouseDir + "/" + tableName,0);
  setDualPartitionTable(warehouseDir + "/" + tableName,1);
  ret=driver.run("insert overwrite table " + tableName + " partition (part1,part2) select key,value,part1,part2 from mysrc");
  Assert.assertEquals(0,ret.getResponseCode());
  verifyDualPartitionTable(warehouseDir + "/" + tableName,1);
}
