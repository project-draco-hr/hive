{
  String tableName="nonpart";
  CommandProcessorResponse ret=driver.run("CREATE TABLE " + tableName + " (key string, value string)");
  Assert.assertEquals(0,ret.getResponseCode());
  String tableLoc=warehouseDir + "/" + tableName;
  assertExistence(warehouseDir + "/" + tableName);
  setPermission(warehouseDir + "/" + tableName);
  ret=driver.run("insert into table " + tableName + " select key,value from mysrc");
  Assert.assertEquals(0,ret.getResponseCode());
  verifyPermission(warehouseDir + "/" + tableName);
  Assert.assertTrue(listStatus(tableLoc).size() > 0);
  for (  String child : listStatus(tableLoc)) {
    verifyPermission(child);
  }
  setPermission(warehouseDir + "/" + tableName,1);
  ret=driver.run("insert overwrite table " + tableName + " select key,value from mysrc");
  Assert.assertEquals(0,ret.getResponseCode());
  verifyPermission(warehouseDir + "/" + tableName,1);
  Assert.assertTrue(listStatus(tableLoc).size() > 0);
  for (  String child : listStatus(tableLoc)) {
    verifyPermission(child,1);
  }
}
