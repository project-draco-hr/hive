{
  String myLocation=warehouseDir + "/exim";
  FileSystem fs=FileSystem.get(new URI(myLocation),conf);
  fs.mkdirs(new Path(myLocation));
  setPermission(myLocation);
  myLocation=myLocation + "/temp";
  CommandProcessorResponse ret=driver.run("export table mysrc to '" + myLocation + "'");
  Assert.assertEquals(0,ret.getResponseCode());
  assertExistence(myLocation);
  verifyPermission(myLocation);
  assertExistence(myLocation + "/part1=1/part2=1");
  verifyPermission(myLocation + "/part1=1/part2=1");
  Assert.assertTrue(listStatus(myLocation + "/part1=1/part2=1").size() > 0);
  for (  String child : listStatus(myLocation + "/part1=1/part2=1")) {
    verifyPermission(child);
  }
  assertExistence(myLocation + "/part1=2/part2=2");
  verifyPermission(myLocation + "/part1=2/part2=2");
  Assert.assertTrue(listStatus(myLocation + "/part1=2/part2=2").size() > 0);
  for (  String child : listStatus(myLocation + "/part1=2/part2=2")) {
    verifyPermission(child);
  }
  String testDb="eximdb";
  ret=driver.run("CREATE DATABASE " + testDb);
  Assert.assertEquals(0,ret.getResponseCode());
  assertExistence(warehouseDir + "/" + testDb+ ".db");
  setPermission(warehouseDir + "/" + testDb+ ".db",1);
  ret=driver.run("USE " + testDb);
  Assert.assertEquals(0,ret.getResponseCode());
  ret=driver.run("import from '" + myLocation + "'");
  Assert.assertEquals(0,ret.getResponseCode());
  assertExistence(warehouseDir + "/" + testDb+ ".db/mysrc");
  verifyPermission(warehouseDir + "/" + testDb+ ".db/mysrc",1);
  myLocation=warehouseDir + "/" + testDb+ ".db/mysrc";
  assertExistence(myLocation);
  verifyPermission(myLocation,1);
  assertExistence(myLocation + "/part1=1/part2=1");
  verifyPermission(myLocation + "/part1=1/part2=1",1);
  Assert.assertTrue(listStatus(myLocation + "/part1=1/part2=1").size() > 0);
  for (  String child : listStatus(myLocation + "/part1=1/part2=1")) {
    verifyPermission(child,1);
  }
  assertExistence(myLocation + "/part1=2/part2=2");
  verifyPermission(myLocation + "/part1=2/part2=2",1);
  Assert.assertTrue(listStatus(myLocation + "/part1=2/part2=2").size() > 0);
  for (  String child : listStatus(myLocation + "/part1=2/part2=2")) {
    verifyPermission(child,1);
  }
}
