{
  String tableName="singledynamicpart";
  CommandProcessorResponse ret=driver.run("CREATE TABLE " + tableName + " (key string, value string) partitioned by (part1 string)");
  Assert.assertEquals(0,ret.getResponseCode());
  String tableLoc=warehouseDir + "/" + tableName;
  assertExistence(tableLoc);
  setPermission(tableLoc,0);
  ret=driver.run("insert into table " + tableName + " partition (part1) select key,value,part1 from mysrc");
  Assert.assertEquals(0,ret.getResponseCode());
  verifySinglePartition(tableLoc,0);
  setPermission(tableLoc,1);
  ret=driver.run("insert overwrite table " + tableName + " partition (part1) select key,value,part1 from mysrc");
  Assert.assertEquals(0,ret.getResponseCode());
  verifySinglePartition(tableLoc,1);
  ret=driver.run("DROP TABLE " + tableName);
  Assert.assertEquals(0,ret.getResponseCode());
  ret=driver.run("CREATE TABLE " + tableName + " (key string, value string) partitioned by (part1 string)");
  Assert.assertEquals(0,ret.getResponseCode());
  assertExistence(warehouseDir + "/" + tableName);
  setPermission(warehouseDir + "/" + tableName);
  ret=driver.run("insert overwrite table " + tableName + " partition (part1) select key,value,part1 from mysrc");
  Assert.assertEquals(0,ret.getResponseCode());
  verifySinglePartition(tableLoc,0);
}
