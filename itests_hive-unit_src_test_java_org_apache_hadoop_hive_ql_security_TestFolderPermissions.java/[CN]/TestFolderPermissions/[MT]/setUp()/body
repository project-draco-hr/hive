{
  testDir=System.getProperty("test.warehouse.dir");
  conf=new HiveConf(TestFolderPermissions.class);
  fs=FileSystem.get(new URI(testDir),conf);
  dataFileDir=conf.get("test.data.files").replace('\\','/').replace("c:","");
  dataFilePath=new Path(dataFileDir,"kv1.txt");
  int port=MetaStoreUtils.findFreePort();
  conf.setBoolVar(HiveConf.ConfVars.HIVE_SUPPORT_CONCURRENCY,false);
  conf.setBoolVar(HiveConf.ConfVars.HIVE_WAREHOUSE_SUBDIR_INHERIT_PERMS,true);
  conf.setVar(HiveConf.ConfVars.DYNAMICPARTITIONINGMODE,"nonstrict");
  MetaStoreUtils.startMetaStore(port,ShimLoader.getHadoopThriftAuthBridge());
  SessionState.start(new CliSessionState(conf));
  driver=new Driver(conf);
  setupDataTable();
}
