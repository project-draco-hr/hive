{
  super.setUp();
  testDir=System.getProperty("test.warehouse.dir");
  conf=new HiveConf(this.getClass());
  dataFileDir=conf.get("test.data.files").replace('\\','/').replace("c:","");
  dataFilePath=new Path(dataFileDir,"kv1.txt");
  int port=MetaStoreUtils.findFreePort();
  conf.setBoolVar(HiveConf.ConfVars.HIVE_SUPPORT_CONCURRENCY,false);
  conf.setBoolVar(HiveConf.ConfVars.HIVE_WAREHOUSE_SUBDIR_INHERIT_PERMS,true);
  System.setProperty(HiveConf.ConfVars.METASTORE_PRE_EVENT_LISTENERS.varname,"");
  MetaStoreUtils.startMetaStore(port,ShimLoader.getHadoopThriftAuthBridge());
  SessionState.start(new CliSessionState(conf));
  driver=new Driver(conf);
}
