{
  String testDb="mydb";
  String tableName="createtable";
  CommandProcessorResponse ret=driver.run("CREATE DATABASE " + testDb);
  Assert.assertEquals(0,ret.getResponseCode());
  assertExistence(testDir + "/" + testDb+ ".db");
  setPermissions(testDir + "/" + testDb+ ".db",FsPermission.createImmutable((short)0777));
  ret=driver.run("USE " + testDb);
  Assert.assertEquals(0,ret.getResponseCode());
  ret=driver.run("CREATE TABLE " + tableName + " (key string, value string)");
  Assert.assertEquals(0,ret.getResponseCode());
  ret=driver.run("insert into table " + tableName + " select key,value from default.mysrc");
  assertExistence(testDir + "/" + testDb+ ".db/"+ tableName);
  Assert.assertEquals("rwxrwxrwx",getPermissions(testDir + "/" + testDb+ ".db/"+ tableName).toString());
  ret=driver.run("USE default");
  Assert.assertEquals(0,ret.getResponseCode());
}
