{
  CommandProcessorResponse ret=driver.run("DROP TABLE IF EXISTS mysrc");
  assertEquals(0,ret.getResponseCode());
  ret=driver.run("CREATE TABLE mysrc (key STRING, value STRING) STORED AS TEXTFILE");
  assertEquals(0,ret.getResponseCode());
  ret=driver.run("LOAD DATA LOCAL INPATH '" + dataFilePath + "' INTO TABLE mysrc");
  assertEquals(0,ret.getResponseCode());
  ret=driver.run("CREATE TABLE newtable (key string, value string) partitioned by (part1 int, part2 int)");
  assertEquals(0,ret.getResponseCode());
  assertExistence(testDir + "/newtable");
  setPermissions(testDir + "/newtable",FsPermission.createImmutable((short)0777));
  ret=driver.run("insert into table newtable partition(part1='1',part2='1') select * from mysrc");
  assertEquals(0,ret.getResponseCode());
  Assert.assertEquals("rwxrwxrwx",getPermissions(testDir + "/newtable/part1=1").toString());
  Assert.assertEquals("rwxrwxrwx",getPermissions(testDir + "/newtable/part1=1/part2=1").toString());
}
