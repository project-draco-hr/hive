{
  LlapMemoryBuffer futureAlloc=cache.createUnallocated();
  cacheBuffers.add(futureAlloc);
  ProcCacheChunk cc=new ProcCacheChunk(cbStartOffset,cbEndOffset,!isUncompressed,fullCompressionBlock,futureAlloc);
  toDecompress.add(cc);
  lastChunk.chunk.position(lastChunk.chunk.position() + lastPartLength);
  if (lastChunk.chunk.remaining() <= 0) {
    if (DebugUtils.isTraceOrcEnabled()) {
      LOG.info("Replacing " + lastChunk + " with "+ cc+ " in the buffers");
    }
    ranges.set(cc);
  }
 else {
    DiskRange before=ranges.previous();
    ranges.add(cc);
    ranges.next();
    if (DebugUtils.isTraceOrcEnabled()) {
      LOG.info("Adding " + cc + " before "+ before+ " in the buffers");
    }
  }
}
