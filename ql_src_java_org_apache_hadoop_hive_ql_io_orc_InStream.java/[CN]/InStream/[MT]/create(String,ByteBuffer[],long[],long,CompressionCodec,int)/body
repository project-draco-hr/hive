{
  if (codec == null) {
    return new UncompressedStream(name,input,offsets,length);
  }
 else {
    return new CompressedStream(name,input,offsets,length,codec,bufferSize);
  }
}
