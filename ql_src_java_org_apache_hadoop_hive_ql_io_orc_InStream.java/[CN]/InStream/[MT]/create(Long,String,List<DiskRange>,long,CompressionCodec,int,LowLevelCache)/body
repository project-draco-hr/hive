{
  if (codec == null) {
    return new UncompressedStream(fileId,name,input,length);
  }
 else {
    return new CompressedStream(fileId,name,input,length,codec,bufferSize,cache);
  }
}
