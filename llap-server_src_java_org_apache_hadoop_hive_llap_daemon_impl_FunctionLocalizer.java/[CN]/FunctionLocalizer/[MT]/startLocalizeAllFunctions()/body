{
  Hive hive=Hive.get(false);
  try {
    hive.getMSC(HiveConf.getBoolVar(conf,ConfVars.HIVE_IN_TEST),true);
  }
 catch (  MetaException e) {
    throw new HiveException(e);
  }
  List<Function> fns=hive.getAllFunctions();
  for (  Function fn : fns) {
    String fqfn=fn.getDbName() + "." + fn.getFunctionName();
    List<ResourceUri> resources=fn.getResourceUris();
    if (resources == null || resources.isEmpty())     continue;
    FnResources result=new FnResources();
    resourcesByFn.put(fqfn,result);
    workQueue.add(new LocalizeFn(fqfn,resources,result,fn.getClassName(),false));
  }
  workQueue.add(new RefreshClassloader());
}
