{
  GenericUDFDateFormat udf=new GenericUDFDateFormat();
  ObjectInspector valueOI0=PrimitiveObjectInspectorFactory.writableStringObjectInspector;
  Text fmtText=new Text("EEEE");
  ObjectInspector valueOI1=PrimitiveObjectInspectorFactory.getPrimitiveWritableConstantObjectInspector(TypeInfoFactory.stringTypeInfo,fmtText);
  ObjectInspector[] arguments={valueOI0,valueOI1};
  udf.initialize(arguments);
  runAndVerifyStr("2015-04-05",fmtText,"Sunday",udf);
  runAndVerifyStr("2015-04-06",fmtText,"Monday",udf);
  runAndVerifyStr("2015-04-07",fmtText,"Tuesday",udf);
  runAndVerifyStr("2015-04-08",fmtText,"Wednesday",udf);
  runAndVerifyStr("2015-04-09",fmtText,"Thursday",udf);
  runAndVerifyStr("2015-04-10",fmtText,"Friday",udf);
  runAndVerifyStr("2015-04-11",fmtText,"Saturday",udf);
  runAndVerifyStr("2015-04-12",fmtText,"Sunday",udf);
  runAndVerifyStr("2016-02-30",fmtText,"Tuesday",udf);
  runAndVerifyStr("2014-01-32",fmtText,"Saturday",udf);
  runAndVerifyStr("01/14/2014",fmtText,null,udf);
  runAndVerifyStr(null,fmtText,null,udf);
  runAndVerifyStr("2015-04-05 10:30:45",fmtText,"Sunday",udf);
  runAndVerifyStr("2015-04-06 10:30:45",fmtText,"Monday",udf);
  runAndVerifyStr("2015-04-07 10:30:45",fmtText,"Tuesday",udf);
  runAndVerifyStr("2015-04-08 10:30:45",fmtText,"Wednesday",udf);
  runAndVerifyStr("2015-04-09 10:30",fmtText,"Thursday",udf);
  runAndVerifyStr("2015-04-10 10:30:45.123",fmtText,"Friday",udf);
  runAndVerifyStr("2015-04-11T10:30:45",fmtText,"Saturday",udf);
  runAndVerifyStr("2015-04-12 10",fmtText,"Sunday",udf);
  runAndVerifyStr("2016-02-30 10:30:45",fmtText,"Tuesday",udf);
  runAndVerifyStr("2014-01-32 10:30:45",fmtText,"Saturday",udf);
  runAndVerifyStr("01/14/2014 10:30:45",fmtText,null,udf);
  runAndVerifyStr("2016-02-28T10:30:45",fmtText,"Sunday",udf);
}
