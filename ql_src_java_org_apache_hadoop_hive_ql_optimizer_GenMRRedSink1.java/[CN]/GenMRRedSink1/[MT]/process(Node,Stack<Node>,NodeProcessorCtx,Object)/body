{
  ReduceSinkOperator op=(ReduceSinkOperator)nd;
  GenMRProcContext ctx=(GenMRProcContext)opProcCtx;
  Map<Operator<? extends Serializable>,GenMapRedCtx> mapCurrCtx=ctx.getMapCurrCtx();
  GenMapRedCtx mapredCtx=mapCurrCtx.get((Operator<? extends Serializable>)stack.get(stack.size() - 2));
  Task<? extends Serializable> currTask=mapredCtx.getCurrTask();
  mapredWork currPlan=(mapredWork)currTask.getWork();
  Operator<? extends Serializable> currTopOp=mapredCtx.getCurrTopOp();
  String currAliasId=mapredCtx.getCurrAliasId();
  Operator<? extends Serializable> reducer=op.getChildOperators().get(0);
  HashMap<Operator<? extends Serializable>,Task<? extends Serializable>> opTaskMap=ctx.getOpTaskMap();
  Task<? extends Serializable> opMapTask=opTaskMap.get(reducer);
  ctx.setCurrTopOp(currTopOp);
  ctx.setCurrAliasId(currAliasId);
  ctx.setCurrTask(currTask);
  if (opMapTask == null) {
    if (currPlan.getReducer() == null)     GenMapRedUtils.initPlan(op,ctx);
 else     GenMapRedUtils.splitPlan(op,ctx);
  }
 else {
    GenMapRedUtils.joinPlan(op,null,opMapTask,ctx,-1,false,false,false);
    currTask=opMapTask;
    ctx.setCurrTask(currTask);
  }
  mapCurrCtx.put(op,new GenMapRedCtx(ctx.getCurrTask(),ctx.getCurrTopOp(),ctx.getCurrAliasId()));
  return null;
}
