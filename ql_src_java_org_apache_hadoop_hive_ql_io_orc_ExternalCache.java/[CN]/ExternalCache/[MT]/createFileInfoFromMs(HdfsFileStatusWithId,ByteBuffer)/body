{
  if (bb == null)   return null;
  FileStatus fs=file.getFileStatus();
  ReaderImpl.FooterInfo fi=null;
  ByteBuffer copy=bb.duplicate();
  try {
    fi=ReaderImpl.extractMetaInfoFromFooter(copy,fs.getPath());
  }
 catch (  Exception ex) {
    byte[] data=new byte[bb.remaining()];
    System.arraycopy(bb.array(),bb.arrayOffset() + bb.position(),data,0,data.length);
    String msg="Failed to parse the footer stored in cache for file ID " + file.getFileId() + " "+ bb+ " [ "+ Hex.encodeHexString(data)+ " ]";
    LOG.error(msg,ex);
    return null;
  }
  return new FileInfo(fs.getModificationTime(),fs.getLen(),fi.getStripes(),fi.getMetadata(),fi.getFooter().getTypesList(),fi.getFooter().getStatisticsList(),fi.getFileMetaInfo(),fi.getFileMetaInfo().writerVersion,file.getFileId());
}
