{
  RpcServer server=autoClose(new RpcServer(emptyConfig));
  Rpc[] rpcs=createRpcConnection(server);
  Rpc client=rpcs[1];
  final AtomicInteger closeCount=new AtomicInteger();
  client.addListener(new Rpc.Listener(){
    @Override public void rpcClosed(    Rpc rpc){
      closeCount.incrementAndGet();
    }
  }
);
  client.close();
  client.close();
  assertEquals(1,closeCount.get());
}
