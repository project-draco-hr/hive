{
  AggregationBuffer[] aggs=null;
  Object[][] lastInvoke=null;
  boolean keysAreEqual=(currentKeys != null && newKeys != null) ? newKeys.equals(currentKeys) : false;
  if (currentKeys != null && !keysAreEqual) {
    if (!conf.isDontResetAggrsDistinct()) {
      forward(currentKeys.getKeyArray(),aggregations);
      countAfterReport=0;
    }
  }
  if (currentKeys == null || !keysAreEqual) {
    if (currentKeys == null) {
      currentKeys=newKeys.copyKey();
    }
 else {
      currentKeys.copyKey(newKeys);
    }
    if (!conf.isDontResetAggrsDistinct()) {
      resetAggregations(aggregations);
    }
    for (int i=0; i < aggregationsParametersLastInvoke.length; i++) {
      aggregationsParametersLastInvoke[i]=null;
    }
  }
  aggs=aggregations;
  lastInvoke=aggregationsParametersLastInvoke;
  updateAggregations(aggs,row,rowInspector,false,false,lastInvoke);
}
