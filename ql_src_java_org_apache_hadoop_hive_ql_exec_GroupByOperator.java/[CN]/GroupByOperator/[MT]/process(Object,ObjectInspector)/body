{
  try {
    ArrayList<Object> newKeys=new ArrayList<Object>(keyFields.length);
    for (int i=0; i < keyFields.length; i++) {
      keyFields[i].evaluate(row,rowInspector,tempInspectableObject);
      newKeys.add(tempInspectableObject.o);
      if (firstRow) {
        objectInspectors.set(i,tempInspectableObject.oi);
      }
    }
    if (firstRow) {
      firstRow=false;
      ArrayList<String> fieldNames=new ArrayList<String>(objectInspectors.size());
      for (int i=0; i < objectInspectors.size(); i++) {
        fieldNames.add(Integer.valueOf(i).toString());
      }
      outputObjectInspector=ObjectInspectorFactory.getStandardStructObjectInspector(fieldNames,objectInspectors);
    }
    if (hashAggr)     processHashAggr(row,rowInspector,newKeys);
 else     processAggr(row,rowInspector,newKeys);
  }
 catch (  HiveException e) {
    throw e;
  }
catch (  Exception e) {
    throw new HiveException(e);
  }
}
