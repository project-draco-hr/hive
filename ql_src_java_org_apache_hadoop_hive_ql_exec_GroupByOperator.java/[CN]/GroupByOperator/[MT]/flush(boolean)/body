{
  if (complete) {
    Iterator iter=hashAggregations.entrySet().iterator();
    while (iter.hasNext()) {
      Map.Entry<ArrayList<Object>,UDAFEvaluator[]> m=(Map.Entry)iter.next();
      forward(m.getKey(),m.getValue());
    }
    hashAggregations.clear();
    hashAggregations=null;
    return;
  }
  int oldSize=hashAggregations.size();
  LOG.trace("Hash Tbl flush: #hash table = " + oldSize);
  Iterator iter=hashAggregations.entrySet().iterator();
  int numDel=0;
  while (iter.hasNext()) {
    Map.Entry<ArrayList<Object>,UDAFEvaluator[]> m=(Map.Entry)iter.next();
    forward(m.getKey(),m.getValue());
    iter.remove();
    numDel++;
    if (numDel * 10 >= oldSize)     return;
  }
}
