{
  if (complete) {
    Iterator<Map.Entry<KeyWrapper,AggregationBuffer[]>> iter=hashAggregations.entrySet().iterator();
    while (iter.hasNext()) {
      Map.Entry<KeyWrapper,AggregationBuffer[]> m=iter.next();
      forward(m.getKey().keys,m.getValue());
    }
    hashAggregations.clear();
    hashAggregations=null;
    LOG.warn("Hash Table completed flushed");
    return;
  }
  int oldSize=hashAggregations.size();
  LOG.warn("Hash Tbl flush: #hash table = " + oldSize);
  Iterator<Map.Entry<KeyWrapper,AggregationBuffer[]>> iter=hashAggregations.entrySet().iterator();
  int numDel=0;
  while (iter.hasNext()) {
    Map.Entry<KeyWrapper,AggregationBuffer[]> m=iter.next();
    forward(m.getKey().keys,m.getValue());
    iter.remove();
    numDel++;
    if (numDel * 10 >= oldSize) {
      LOG.warn("Hash Table flushed: new size = " + hashAggregations.size());
      return;
    }
  }
}
