{
  try {
    String className=tbl.getProperty(org.apache.hadoop.hive.serde.Constants.SERIALIZATION_CLASS);
    Class<?> recordClass=Class.forName(className);
    String protoName=tbl.getProperty(org.apache.hadoop.hive.serde.Constants.SERIALIZATION_FORMAT);
    if (protoName == null) {
      protoName="TBinaryProtocol";
    }
    TProtocolFactory tp=TReflectionUtils.getProtocolFactoryByName(protoName);
    tsd=new ThriftByteStreamTypedSerDe(recordClass,tp,tp);
    inStreaming=job.get("hive.streaming.select") != null;
  }
 catch (  Exception e) {
    throw new SerDeException(e);
  }
}
