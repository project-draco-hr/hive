{
  if (scriptError != null) {
    throw new HiveException(scriptError);
  }
  try {
    text=(Text)scriptInputSerializer.serialize(row,rowInspector);
    scriptOut.write(text.getBytes(),0,text.getLength());
    scriptOut.write(Utilities.newLineCode);
  }
 catch (  SerDeException e) {
    LOG.error("Error in serializing the row: " + e.getMessage());
    scriptError=e;
    serialize_error_count.set(serialize_error_count.get() + 1);
    throw new HiveException(e);
  }
catch (  IOException e) {
    LOG.error("Error in writing to script: " + e.getMessage());
    scriptError=e;
    throw new HiveException(e);
  }
}
