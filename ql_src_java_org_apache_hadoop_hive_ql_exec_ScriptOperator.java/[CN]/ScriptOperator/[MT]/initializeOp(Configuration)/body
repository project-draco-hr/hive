{
  super.initializeOp(hconf);
  firstRow=true;
  statsMap.put(Counter.DESERIALIZE_ERRORS.toString(),deserialize_error_count);
  statsMap.put(Counter.SERIALIZE_ERRORS.toString(),serialize_error_count);
  try {
    this.hconf=hconf;
    scriptOutputDeserializer=conf.getScriptOutputInfo().getDeserializerClass().newInstance();
    SerDeUtils.initializeSerDe(scriptOutputDeserializer,hconf,conf.getScriptOutputInfo().getProperties(),null);
    scriptInputSerializer=(Serializer)conf.getScriptInputInfo().getDeserializerClass().newInstance();
    scriptInputSerializer.initialize(hconf,conf.getScriptInputInfo().getProperties());
    outputObjInspector=scriptOutputDeserializer.getObjectInspector();
  }
 catch (  Exception e) {
    throw new HiveException(ErrorMsg.SCRIPT_INIT_ERROR.getErrorCodedMsg(),e);
  }
}
