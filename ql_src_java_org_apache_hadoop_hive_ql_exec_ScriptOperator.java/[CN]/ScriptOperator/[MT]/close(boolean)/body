{
  boolean new_abort=abort;
  if (!abort) {
    if (scriptError != null) {
      throw new HiveException(scriptError);
    }
    try {
      scriptOutWriter.close();
      int exitVal=scriptPid.waitFor();
      if (exitVal != 0) {
        LOG.error("Script failed with code " + exitVal);
        new_abort=true;
      }
      ;
    }
 catch (    IOException e) {
      LOG.error("Got ioexception: " + e.getMessage());
      e.printStackTrace();
      new_abort=true;
    }
catch (    InterruptedException e) {
    }
  }
  try {
    outThread.join(0);
    errThread.join(0);
    scriptPid.destroy();
  }
 catch (  Exception e) {
  }
  super.close(new_abort);
  if (new_abort && !abort) {
    throw new HiveException("Hit error while closing ..");
  }
}
