{
  if (scriptError != null) {
    throw new HiveException(scriptError);
  }
  try {
    Writable res=scriptInputSerializer.serialize(row,inputObjInspectors[tag]);
    scriptOutWriter.write(res);
  }
 catch (  SerDeException e) {
    LOG.error("Error in serializing the row: " + e.getMessage());
    scriptError=e;
    serialize_error_count.set(serialize_error_count.get() + 1);
    throw new HiveException(e);
  }
catch (  IOException e) {
    if (isBrokenPipeException(e) && allowPartialConsumption()) {
      setDone(true);
      LOG.warn("Got broken pipe during write: ignoring exception and setting operator to done");
    }
 else {
      LOG.error("Error in writing to script: " + e.getMessage());
      if (isBrokenPipeException(e)) {
        displayBrokenPipeInfo();
      }
      scriptError=e;
      throw new HiveException(e);
    }
  }
}
