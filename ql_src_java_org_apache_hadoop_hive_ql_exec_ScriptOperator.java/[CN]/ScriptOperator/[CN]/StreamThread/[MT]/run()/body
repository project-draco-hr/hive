{
  LineReader lineReader=null;
  try {
    Text row=new Text();
    lineReader=new LineReader((InputStream)in,hconf);
    while (true) {
      row.clear();
      long bytes=lineReader.readLine(row);
      if (bytes <= 0) {
        break;
      }
      proc.processLine(row);
    }
    LOG.info("StreamThread " + name + " done");
  }
 catch (  Throwable th) {
    scriptError=th;
    LOG.warn(StringUtils.stringifyException(th));
  }
 finally {
    try {
      if (lineReader != null) {
        lineReader.close();
      }
      in.close();
      proc.close();
    }
 catch (    Exception e) {
      LOG.warn(name + ": error in closing ..");
      LOG.warn(StringUtils.stringifyException(e));
    }
  }
}
