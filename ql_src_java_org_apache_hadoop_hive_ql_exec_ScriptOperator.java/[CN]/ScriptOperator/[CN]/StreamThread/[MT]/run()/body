{
  try {
    Writable row=in.createRow();
    while (true) {
      long bytes=in.next(row);
      if (bytes <= 0) {
        break;
      }
      proc.processLine(row);
    }
    LOG.info("StreamThread " + name + " done");
  }
 catch (  Throwable th) {
    scriptError=th;
    LOG.warn("Exception in StreamThread.run(): " + th.getMessage() + "\nCause: "+ th.getCause());
    LOG.warn(StringUtils.stringifyException(th));
  }
 finally {
    try {
      if (in != null) {
        in.close();
      }
    }
 catch (    Exception e) {
      LOG.warn(name + ": error in closing ..");
      LOG.warn(StringUtils.stringifyException(e));
    }
    try {
      if (null != proc) {
        proc.close();
      }
    }
 catch (    Exception e) {
      LOG.warn(": error in closing .." + StringUtils.stringifyException(e));
    }
  }
}
