{
  String stringLine=line.toString();
  int len=0;
  if (line instanceof Text) {
    len=((Text)line).getLength();
  }
 else   if (line instanceof BytesWritable) {
    len=((BytesWritable)line).getSize();
  }
  long now=System.currentTimeMillis();
  if (now - lastReportTime > 60 * 1000 && reporter != null) {
    LOG.info("ErrorStreamProcessor calling reporter.progress()");
    lastReportTime=now;
    reporter.progress();
  }
  if (reporter != null) {
    if (counterStatus != null) {
      if (counterStatus.process(stringLine)) {
        return;
      }
    }
  }
  if ((maxBytes < 0) || (bytesCopied < maxBytes)) {
    System.err.println(stringLine);
  }
  if (bytesCopied < maxBytes && bytesCopied + len >= maxBytes) {
    System.err.println("Operator " + id + " "+ getName()+ ": exceeding stderr limit of "+ maxBytes+ " bytes, will truncate stderr messages.");
  }
  bytesCopied+=len;
}
