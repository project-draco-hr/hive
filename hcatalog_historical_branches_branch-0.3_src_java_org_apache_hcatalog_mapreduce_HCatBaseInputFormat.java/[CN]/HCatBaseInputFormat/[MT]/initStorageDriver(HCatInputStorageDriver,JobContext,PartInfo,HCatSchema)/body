{
  storageDriver.setInputPath(context,partitionInfo.getLocation());
  if (partitionInfo.getPartitionSchema() != null) {
    storageDriver.setOriginalSchema(context,partitionInfo.getPartitionSchema());
  }
  storageDriver.setPartitionValues(context,partitionInfo.getPartitionValues());
  HCatSchema outputSchema=null;
  String outputSchemaString=context.getConfiguration().get(HCatConstants.HCAT_KEY_OUTPUT_SCHEMA);
  if (outputSchemaString != null) {
    outputSchema=(HCatSchema)HCatUtil.deserialize(outputSchemaString);
  }
 else {
    outputSchema=tableSchema;
  }
  storageDriver.setOutputSchema(context,outputSchema);
  storageDriver.initialize(context,partitionInfo.getInputStorageDriverProperties());
}
