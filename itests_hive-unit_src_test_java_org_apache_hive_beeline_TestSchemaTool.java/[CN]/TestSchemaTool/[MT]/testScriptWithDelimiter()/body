{
  String testScript[]={"-- this is a comment","DROP TABLE IF EXISTS fooTab;","DELIMITER $$","/*!1234 this is comment code like mysql */$$","CREATE TABLE fooTab(id INTEGER)$$","CREATE PROCEDURE fooProc()","SELECT * FROM fooTab;","CALL barProc();","END PROCEDURE$$","DELIMITER ;","DROP TABLE footab;","-- ending comment"};
  String resultScript[]={"DROP TABLE IF EXISTS fooTab","/*!1234 this is comment code like mysql */","CREATE TABLE fooTab(id INTEGER)","CREATE PROCEDURE fooProc()" + " " + "SELECT * FROM fooTab;"+ " "+ "CALL barProc();"+ " "+ "END PROCEDURE","DROP TABLE footab"};
  String expectedSQL=StringUtils.join(resultScript,System.getProperty("line.separator")) + System.getProperty("line.separator");
  File testScriptFile=generateTestScript(testScript);
  NestedScriptParser testDbParser=HiveSchemaHelper.getDbCommandParser("mysql");
  String flattenedSql=testDbParser.buildCommand(testScriptFile.getParentFile().getPath(),testScriptFile.getName());
  assertEquals(expectedSQL,flattenedSql);
}
