{
  if (inputOI instanceof UnionObjectInspector) {
    this.inputOI=(UnionObjectInspector)inputOI;
    this.outputOI=outputOI;
    inputTagsOIs=this.inputOI.getObjectInspectors();
    outputTagsOIs=outputOI.getObjectInspectors();
    int minFields=Math.min(inputTagsOIs.size(),outputTagsOIs.size());
    fieldConverters=new ArrayList<Converter>(minFields);
    for (int f=0; f < minFields; f++) {
      fieldConverters.add(getConverter(inputTagsOIs.get(f),outputTagsOIs.get(f)));
    }
    output=outputOI.create();
  }
 else   if (!(inputOI instanceof VoidObjectInspector)) {
    throw new RuntimeException("Hive internal error: conversion of " + inputOI.getTypeName() + " to "+ outputOI.getTypeName()+ "not supported yet.");
  }
}
