{
  if (inputOI instanceof UnionObjectInspector) {
    this.inputOI=(UnionObjectInspector)inputOI;
    this.outputOI=outputOI;
    inputFields=this.inputOI.getObjectInspectors();
    outputFields=outputOI.getObjectInspectors();
    int minFields=Math.min(inputFields.size(),outputFields.size());
    fieldConverters=new ArrayList<Converter>(minFields);
    for (int f=0; f < minFields; f++) {
      fieldConverters.add(getConverter(inputFields.get(f),outputFields.get(f)));
    }
    output=outputOI.create();
  }
 else   if (!(inputOI instanceof VoidObjectInspector)) {
    throw new RuntimeException("Hive internal error: conversion of " + inputOI.getTypeName() + " to "+ outputOI.getTypeName()+ "not supported yet.");
  }
}
