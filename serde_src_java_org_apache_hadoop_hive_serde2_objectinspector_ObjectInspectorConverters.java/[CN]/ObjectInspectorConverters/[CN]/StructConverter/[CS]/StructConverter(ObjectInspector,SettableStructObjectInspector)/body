{
  if (inputOI instanceof StructObjectInspector) {
    this.inputOI=(StructObjectInspector)inputOI;
    this.outputOI=outputOI;
    inputFields=this.inputOI.getAllStructFieldRefs();
    outputFields=outputOI.getAllStructFieldRefs();
    assert(inputFields.size() == outputFields.size());
    fieldConverters=new ArrayList<Converter>(inputFields.size());
    for (int f=0; f < inputFields.size(); f++) {
      fieldConverters.add(getConverter(inputFields.get(f).getFieldObjectInspector(),outputFields.get(f).getFieldObjectInspector()));
    }
    output=outputOI.create();
  }
 else   if (!(inputOI instanceof VoidObjectInspector)) {
    throw new RuntimeException("Hive internal error: conversion of " + inputOI.getTypeName() + " to "+ outputOI.getTypeName()+ "not supported yet.");
  }
}
