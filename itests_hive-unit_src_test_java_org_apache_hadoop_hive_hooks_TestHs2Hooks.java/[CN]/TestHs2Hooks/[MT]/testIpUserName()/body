{
  Properties connProp=new Properties();
  connProp.setProperty("user",System.getProperty("user.name"));
  connProp.setProperty("password","");
  HiveConnection connection=new HiveConnection("jdbc:hive2://localhost:10000/default",connProp);
  connection.createStatement().execute("show tables");
  Assert.assertEquals(System.getProperty("user.name"),PostExecHook.userName);
  Assert.assertNotNull(PostExecHook.ipAddress);
  Assert.assertTrue(PostExecHook.ipAddress.contains("127.0.0.1"));
  Assert.assertEquals(System.getProperty("user.name"),PreExecHook.userName);
  Assert.assertNotNull(PreExecHook.ipAddress);
  Assert.assertTrue(PreExecHook.ipAddress.contains("127.0.0.1"));
  connection.close();
}
