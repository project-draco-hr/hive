{
  String fileSystem=scheme + ":" + authority;
  String dir=fsScratchDirs.get(fileSystem);
  if (dir == null) {
    Path dirPath=new Path(scheme,authority,scratchDir);
    if (mkdir) {
      try {
        FileSystem fs=dirPath.getFileSystem(conf);
        if (!fs.mkdirs(dirPath))         throw new RuntimeException("Cannot make directory: " + dirPath.toString());
      }
 catch (      IOException e) {
        throw new RuntimeException(e);
      }
    }
    dir=dirPath.toString();
    fsScratchDirs.put(fileSystem,dir);
  }
  return dir;
}
