{
  List<Operator<? extends Serializable>> childOps=input.getChildOperators();
  input.setChildOperators(null);
  RowResolver inputRR=pctx.getOpParseCtx().get(input).getRR();
  ArrayList<exprNodeDesc> exprs=new ArrayList<exprNodeDesc>();
  ArrayList<String> outputs=new ArrayList<String>();
  List<String> outputCols=input.getConf().getOutputColumnNames();
  RowResolver outputRS=new RowResolver();
  Map<String,exprNodeDesc> colExprMap=new HashMap<String,exprNodeDesc>();
  for (int i=0; i < outputCols.size(); i++) {
    String internalName=outputCols.get(i);
    String[] nm=inputRR.reverseLookup(internalName);
    ColumnInfo valueInfo=inputRR.get(nm[0],nm[1]);
    exprNodeDesc colDesc=new exprNodeColumnDesc(valueInfo.getType(),valueInfo.getInternalName(),nm[0],valueInfo.getIsPartitionCol());
    exprs.add(colDesc);
    outputs.add(internalName);
    outputRS.put(nm[0],nm[1],new ColumnInfo(internalName,valueInfo.getType(),nm[0],valueInfo.getIsPartitionCol()));
    colExprMap.put(internalName,colDesc);
  }
  selectDesc select=new selectDesc(exprs,outputs,false);
  SelectOperator sel=(SelectOperator)putOpInsertMap(OperatorFactory.getAndMakeChild(select,new RowSchema(inputRR.getColumnInfos()),input),inputRR);
  sel.setColumnExprMap(colExprMap);
  sel.setChildOperators(childOps);
  for (  Operator<? extends Serializable> ch : childOps) {
    ch.replaceParent(input,sel);
  }
}
