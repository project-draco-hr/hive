{
  MapJoinDesc mapJoinDescriptor=getMapJoinDesc(hconf,op,leftInputJoin,baseSrc,mapAliases,mapJoinPos,noCheckOuterJoin,adjustParentsChildren);
  RowSchema outputRS=op.getSchema();
  MapJoinOperator mapJoinOp=(MapJoinOperator)OperatorFactory.getAndMakeChild(mapJoinDescriptor,new RowSchema(outputRS.getSignature()),op.getParentOperators());
  mapJoinOp.getConf().setReversedExprs(op.getConf().getReversedExprs());
  Map<String,ExprNodeDesc> colExprMap=op.getColumnExprMap();
  mapJoinOp.setColumnExprMap(colExprMap);
  List<Operator<? extends OperatorDesc>> childOps=op.getChildOperators();
  for (  Operator<? extends OperatorDesc> childOp : childOps) {
    childOp.replaceParent(op,mapJoinOp);
  }
  mapJoinOp.setPosToAliasMap(op.getPosToAliasMap());
  mapJoinOp.setChildOperators(childOps);
  op.setChildOperators(null);
  op.setParentOperators(null);
  return mapJoinOp;
}
