{
  Long rowCnt=0L;
  if (tbl.isPartitioned()) {
    for (    Partition part : hive.getAllPartitionsOf(tbl)) {
      long partRowCnt=Long.parseLong(part.getParameters().get(StatsSetupConst.ROW_COUNT));
      if (partRowCnt < 1) {
        Log.debug("Partition doesn't have upto date stats " + part.getSpec());
        return null;
      }
      rowCnt+=partRowCnt;
    }
  }
 else {
    rowCnt=Long.parseLong(tbl.getProperty(StatsSetupConst.ROW_COUNT));
    if (rowCnt < 1) {
      Log.debug("Table doesn't have upto date stats " + tbl.getTableName());
      rowCnt=null;
    }
  }
  return rowCnt;
}
