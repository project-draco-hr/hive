{
  Long rowCnt=0L;
  if (tbl.isPartitioned()) {
    for (    Partition part : pctx.getPrunedPartitions(tsOp.getConf().getAlias(),tsOp).getPartitions()) {
      if (!StatsSetupConst.areStatsUptoDate(part.getParameters())) {
        return null;
      }
      long partRowCnt=Long.parseLong(part.getParameters().get(StatsSetupConst.ROW_COUNT));
      if (partRowCnt < 1) {
        Logger.debug("Partition doesn't have upto date stats " + part.getSpec());
        return null;
      }
      rowCnt+=partRowCnt;
    }
  }
 else {
    if (!StatsSetupConst.areStatsUptoDate(tbl.getParameters())) {
      return null;
    }
    rowCnt=Long.parseLong(tbl.getProperty(StatsSetupConst.ROW_COUNT));
    if (rowCnt < 1) {
      Logger.debug("Table doesn't have upto date stats " + tbl.getTableName());
      rowCnt=null;
    }
  }
  return rowCnt;
}
