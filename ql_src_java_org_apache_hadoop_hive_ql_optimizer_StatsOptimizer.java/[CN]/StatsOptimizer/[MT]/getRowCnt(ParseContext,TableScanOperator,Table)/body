{
  Long rowCnt=0L;
  if (tbl.isPartitioned()) {
    for (    Partition part : pctx.getPrunedPartitions(tsOp.getConf().getAlias(),tsOp).getPartitions()) {
      if (!StatsSetupConst.areBasicStatsUptoDate(part.getParameters())) {
        return null;
      }
      Long partRowCnt=Long.parseLong(part.getParameters().get(StatsSetupConst.ROW_COUNT));
      if (partRowCnt == null) {
        Logger.debug("Partition doesn't have up to date stats " + part.getSpec());
        return null;
      }
      rowCnt+=partRowCnt;
    }
  }
 else {
    if (!StatsSetupConst.areBasicStatsUptoDate(tbl.getParameters())) {
      return null;
    }
    rowCnt=Long.parseLong(tbl.getProperty(StatsSetupConst.ROW_COUNT));
    if (rowCnt == null) {
      Logger.debug("Table doesn't have up to date stats " + tbl.getTableName());
      rowCnt=null;
    }
  }
  return rowCnt;
}
