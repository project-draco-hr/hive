{
  Operator<? extends OperatorDesc> start=childReduceSink;
  while (start != null) {
    if (start.getParentOperators() == null || start.getParentOperators().size() != 1) {
      return null;
    }
    boolean allowed=false;
    if ((start instanceof SelectOperator) || (start instanceof FilterOperator) || (start instanceof ExtractOperator)|| (start instanceof ForwardOperator)|| (start instanceof ScriptOperator)|| (start instanceof ReduceSinkOperator)) {
      allowed=true;
    }
    if (!allowed) {
      return null;
    }
    if ((start instanceof ScriptOperator) && !HiveConf.getBoolVar(pGraphContext.getConf(),HiveConf.ConfVars.HIVESCRIPTOPERATORTRUST)) {
      return null;
    }
    start=start.getParentOperators().get(0);
    if (start instanceof ReduceSinkOperator) {
      return (ReduceSinkOperator)start;
    }
  }
  return null;
}
