{
  List<Operator<?>> parents=join.getParentOperators();
  T[] result=(T[])Array.newInstance(target,parents.size());
  for (int tag=0; tag < result.length; tag++) {
    Operator<?> cursor=parents.get(tag);
    for (; cursor != null; cursor=getSingleParent(cursor)) {
      if (target.isAssignableFrom(cursor.getClass())) {
        result[tag]=(T)cursor;
        break;
      }
    }
    if (result[tag] == null) {
      throw new IllegalStateException("failed to find " + target.getSimpleName() + " from "+ join+ " on tag "+ tag);
    }
  }
  return result;
}
