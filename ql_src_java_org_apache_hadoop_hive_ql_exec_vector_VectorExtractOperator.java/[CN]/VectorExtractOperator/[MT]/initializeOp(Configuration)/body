{
  StructObjectInspector structInputObjInspector=(StructObjectInspector)inputObjInspectors[0];
  List<? extends StructField> fields=structInputObjInspector.getAllStructFieldRefs();
  ArrayList<ObjectInspector> ois=new ArrayList<ObjectInspector>();
  ArrayList<String> colNames=new ArrayList<String>();
  for (int i=keyColCount; i < fields.size(); i++) {
    StructField field=fields.get(i);
    String fieldName=field.getFieldName();
    int dotIndex=fieldName.indexOf(".");
    colNames.add(fieldName.substring(dotIndex + 1));
    ois.add(field.getFieldObjectInspector());
  }
  outputObjInspector=ObjectInspectorFactory.getStandardStructObjectInspector(colNames,ois);
  remainingColCount=fields.size() - keyColCount;
  outputBatch=new VectorizedRowBatch(remainingColCount);
  initializeChildren(hconf);
}
