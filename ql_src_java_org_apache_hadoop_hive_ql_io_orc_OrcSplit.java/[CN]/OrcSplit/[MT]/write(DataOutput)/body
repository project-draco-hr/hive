{
  super.write(out);
  int flags=(hasBase ? BASE_FLAG : 0) | (isOriginal ? ORIGINAL_FLAG : 0) | (hasFooter ? FOOTER_FLAG : 0);
  out.writeByte(flags);
  out.writeInt(deltas.size());
  for (  Long delta : deltas) {
    out.writeLong(delta);
  }
  if (hasFooter) {
    Text.writeString(out,fileMetaInfo.compressionType);
    WritableUtils.writeVInt(out,fileMetaInfo.bufferSize);
    WritableUtils.writeVInt(out,fileMetaInfo.metadataSize);
    ByteBuffer footerBuff=fileMetaInfo.footerBuffer;
    footerBuff.reset();
    WritableUtils.writeVInt(out,footerBuff.limit() - footerBuff.position());
    out.write(footerBuff.array(),footerBuff.position(),footerBuff.limit() - footerBuff.position());
  }
}
