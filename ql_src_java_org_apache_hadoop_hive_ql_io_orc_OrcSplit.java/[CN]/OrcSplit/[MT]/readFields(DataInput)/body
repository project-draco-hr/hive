{
  super.readFields(in);
  byte flags=in.readByte();
  hasFooter=(FOOTER_FLAG & flags) != 0;
  isOriginal=(ORIGINAL_FLAG & flags) != 0;
  hasBase=(BASE_FLAG & flags) != 0;
  boolean hasLongFileId=(HAS_LONG_FILEID_FLAG & flags) != 0, hasWritableFileId=(HAS_SYNTHETIC_FILEID_FLAG & flags) != 0;
  if (hasLongFileId && hasWritableFileId) {
    throw new IOException("Invalid split - both file ID types present");
  }
  deltas.clear();
  int numDeltas=in.readInt();
  for (int i=0; i < numDeltas; i++) {
    AcidInputFormat.DeltaMetaData dmd=new AcidInputFormat.DeltaMetaData();
    dmd.readFields(in);
    deltas.add(dmd);
  }
  if (hasFooter) {
    int tailLen=WritableUtils.readVInt(in);
    byte[] tailBuffer=new byte[tailLen];
    in.readFully(tailBuffer);
    OrcProto.FileTail fileTail=OrcProto.FileTail.parseFrom(tailBuffer);
    orcTail=new OrcTail(fileTail,null);
  }
  if (hasLongFileId) {
    fileKey=in.readLong();
  }
 else   if (hasWritableFileId) {
    SyntheticFileId fileId=new SyntheticFileId();
    fileId.readFields(in);
    this.fileKey=fileId;
  }
  fileLen=in.readLong();
}
