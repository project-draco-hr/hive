{
  super.readFields(in);
  byte flags=in.readByte();
  hasFooter=(FOOTER_FLAG & flags) != 0;
  isOriginal=(ORIGINAL_FLAG & flags) != 0;
  hasBase=(BASE_FLAG & flags) != 0;
  deltas.clear();
  int numDeltas=in.readInt();
  for (int i=0; i < numDeltas; i++) {
    deltas.add(in.readLong());
  }
  if (hasFooter) {
    String compressionType=Text.readString(in);
    int bufferSize=WritableUtils.readVInt(in);
    int metadataSize=WritableUtils.readVInt(in);
    int footerBuffSize=WritableUtils.readVInt(in);
    ByteBuffer footerBuff=ByteBuffer.allocate(footerBuffSize);
    in.readFully(footerBuff.array(),0,footerBuffSize);
    fileMetaInfo=new ReaderImpl.FileMetaInfo(compressionType,bufferSize,metadataSize,footerBuff);
  }
}
