{
  super.readFields(in);
  byte flags=in.readByte();
  hasFooter=(FOOTER_FLAG & flags) != 0;
  isOriginal=(ORIGINAL_FLAG & flags) != 0;
  hasBase=(BASE_FLAG & flags) != 0;
  boolean hasLongFileId=(HAS_LONG_FILEID_FLAG & flags) != 0, hasWritableFileId=(HAS_SYNTHETIC_FILEID_FLAG & flags) != 0;
  if (hasLongFileId && hasWritableFileId) {
    throw new IOException("Invalid split - both file ID types present");
  }
  deltas.clear();
  int numDeltas=in.readInt();
  for (int i=0; i < numDeltas; i++) {
    AcidInputFormat.DeltaMetaData dmd=new AcidInputFormat.DeltaMetaData();
    dmd.readFields(in);
    deltas.add(dmd);
  }
  if (hasFooter) {
    String compressionType=Text.readString(in);
    int bufferSize=WritableUtils.readVInt(in);
    int metadataSize=WritableUtils.readVInt(in);
    int footerBuffSize=WritableUtils.readVInt(in);
    ByteBuffer footerBuff=ByteBuffer.allocate(footerBuffSize);
    in.readFully(footerBuff.array(),0,footerBuffSize);
    OrcFile.WriterVersion writerVersion=ReaderImpl.getWriterVersion(WritableUtils.readVInt(in));
    fileMetaInfo=new FileMetaInfo(compressionType,bufferSize,metadataSize,footerBuff,writerVersion);
  }
  if (hasLongFileId) {
    fileKey=in.readLong();
  }
 else   if (hasWritableFileId) {
    SyntheticFileId fileId=new SyntheticFileId();
    fileId.readFields(in);
    this.fileKey=fileId;
  }
}
