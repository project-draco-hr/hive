{
  super.readFields(in);
  byte flags=in.readByte();
  hasFooter=(FOOTER_FLAG & flags) != 0;
  isOriginal=(ORIGINAL_FLAG & flags) != 0;
  hasBase=(BASE_FLAG & flags) != 0;
  boolean hasFileId=(HAS_FILEID_FLAG & flags) != 0;
  deltas.clear();
  int numDeltas=in.readInt();
  for (int i=0; i < numDeltas; i++) {
    deltas.add(in.readLong());
  }
  if (hasFooter) {
    String compressionType=Text.readString(in);
    int bufferSize=WritableUtils.readVInt(in);
    int metadataSize=WritableUtils.readVInt(in);
    int footerBuffSize=WritableUtils.readVInt(in);
    ByteBuffer footerBuff=ByteBuffer.allocate(footerBuffSize);
    in.readFully(footerBuff.array(),0,footerBuffSize);
    OrcFile.WriterVersion writerVersion=ReaderImpl.getWriterVersion(WritableUtils.readVInt(in));
    fileMetaInfo=new FileMetaInfo(compressionType,bufferSize,metadataSize,footerBuff,writerVersion);
  }
  if (hasFileId) {
    fileId=in.readLong();
  }
  LOG.error("TODO# Got file ID " + fileId + " for "+ getPath());
}
