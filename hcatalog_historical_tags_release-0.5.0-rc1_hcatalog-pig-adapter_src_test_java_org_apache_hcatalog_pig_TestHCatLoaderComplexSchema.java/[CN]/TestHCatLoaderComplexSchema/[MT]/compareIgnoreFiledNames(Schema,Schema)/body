{
  if (expected == null || got == null) {
    if (expected == got) {
      return "";
    }
 else {
      return "\nexpected " + expected + " got "+ got;
    }
  }
  if (expected.size() != got.size()) {
    return "\nsize expected " + expected.size() + " ("+ expected+ ") got "+ got.size()+ " ("+ got+ ")";
  }
  String message="";
  for (int i=0; i < expected.size(); i++) {
    FieldSchema expectedField=expected.getField(i);
    FieldSchema gotField=got.getField(i);
    if (expectedField.type != gotField.type) {
      message+="\ntype expected " + expectedField.type + " ("+ expectedField+ ") got "+ gotField.type+ " ("+ gotField+ ")";
    }
 else {
      message+=compareIgnoreFiledNames(expectedField.schema,gotField.schema);
    }
  }
  return message;
}
