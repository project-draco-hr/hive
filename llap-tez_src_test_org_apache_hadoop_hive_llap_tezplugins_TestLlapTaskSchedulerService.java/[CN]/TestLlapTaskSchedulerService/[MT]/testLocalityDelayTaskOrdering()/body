{
  LlapTaskSchedulerService.LocalityDelayConf localityDelayConf=new LlapTaskSchedulerService.LocalityDelayConf(3000);
  ControlledClock clock=new ControlledClock(new MonotonicClock());
  clock.setTime(clock.getTime());
  DelayQueue<LlapTaskSchedulerService.TaskInfo> delayedQueue=new DelayQueue<>();
  LlapTaskSchedulerService.TaskInfo taskInfo1=new LlapTaskSchedulerService.TaskInfo(localityDelayConf,clock,new Object(),new Object(),mock(Priority.class),mock(Resource.class),null,null,clock.getTime());
  clock.setTime(clock.getTime() + 1000);
  LlapTaskSchedulerService.TaskInfo taskInfo2=new LlapTaskSchedulerService.TaskInfo(localityDelayConf,clock,new Object(),new Object(),mock(Priority.class),mock(Resource.class),null,null,clock.getTime());
  delayedQueue.add(taskInfo1);
  delayedQueue.add(taskInfo2);
  assertEquals(taskInfo1,delayedQueue.peek());
}
