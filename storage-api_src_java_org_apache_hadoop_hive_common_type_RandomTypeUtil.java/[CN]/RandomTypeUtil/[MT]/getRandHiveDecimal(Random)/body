{
  int precision;
  int scale;
  while (true) {
    StringBuilder sb=new StringBuilder();
    precision=1 + r.nextInt(18);
    scale=0 + r.nextInt(precision + 1);
    int integerDigits=precision - scale;
    if (r.nextBoolean()) {
      sb.append("-");
    }
    if (integerDigits == 0) {
      sb.append("0");
    }
 else {
      sb.append(getRandString(r,DECIMAL_CHARS,integerDigits));
    }
    if (scale != 0) {
      sb.append(".");
      sb.append(getRandString(r,DECIMAL_CHARS,scale));
    }
    HiveDecimal bd=HiveDecimal.create(sb.toString());
    precision=bd.precision();
    scale=bd.scale();
    if (scale > precision) {
      continue;
    }
    precision=HiveDecimal.SYSTEM_DEFAULT_PRECISION;
    scale=HiveDecimal.SYSTEM_DEFAULT_SCALE;
    return new HiveDecimalAndPrecisionScale(bd,precision,scale);
  }
}
