{
  if (dynamicPartitioningUsed) {
    for (    RecordWriter<? super WritableComparable<?>,? super Writable> bwriter : baseDynamicWriters.values()) {
      bwriter.close(context);
    }
    for (    HCatOutputStorageDriver osd : baseDynamicStorageDrivers.values()) {
      OutputCommitter baseOutputCommitter=osd.getOutputFormat().getOutputCommitter(context);
      if (baseOutputCommitter.needsTaskCommit(context)) {
        baseOutputCommitter.commitTask(context);
      }
    }
  }
 else {
    baseWriter.close(context);
  }
}
