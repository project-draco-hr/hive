{
  final List<RexNode> terms=RelOptUtil.conjunctions(e);
  final List<RexNode> notTerms=new ArrayList<>();
  final List<RexNode> nullOperands=new ArrayList<>();
  final List<RexNode> notNullOperands=new ArrayList<>();
  final List<RexNode> comparedOperands=new ArrayList<>();
  for (int i=0; i < terms.size(); i++) {
    final RexNode term=terms.get(i);
switch (term.getKind()) {
case NOT:
      notTerms.add(((RexCall)term).getOperands().get(0));
    terms.remove(i);
  --i;
break;
case LITERAL:
if (!RexLiteral.booleanValue(term)) {
return term;
}
 else {
terms.remove(i);
--i;
}
break;
case EQUALS:
case NOT_EQUALS:
case LESS_THAN:
case GREATER_THAN:
case LESS_THAN_OR_EQUAL:
case GREATER_THAN_OR_EQUAL:
RexCall call=(RexCall)term;
RexNode left=call.getOperands().get(0);
comparedOperands.add(left);
if (left.getKind() == SqlKind.CAST) {
RexCall leftCast=(RexCall)left;
comparedOperands.add(leftCast.getOperands().get(0));
}
RexNode right=call.getOperands().get(1);
comparedOperands.add(right);
if (right.getKind() == SqlKind.CAST) {
RexCall rightCast=(RexCall)right;
comparedOperands.add(rightCast.getOperands().get(0));
}
break;
case IN:
comparedOperands.add(((RexCall)term).operands.get(0));
break;
case BETWEEN:
comparedOperands.add(((RexCall)term).operands.get(1));
break;
case IS_NOT_NULL:
notNullOperands.add(((RexCall)term).getOperands().get(0));
terms.remove(i);
--i;
break;
case IS_NULL:
nullOperands.add(((RexCall)term).getOperands().get(0));
}
}
if (terms.isEmpty() && notTerms.isEmpty() && notNullOperands.isEmpty()) {
return rexBuilder.makeLiteral(true);
}
if (!Collections.disjoint(nullOperands,comparedOperands)) {
return rexBuilder.makeLiteral(false);
}
for (RexNode operand : notNullOperands) {
if (!comparedOperands.contains(operand)) {
terms.add(rexBuilder.makeCall(SqlStdOperatorTable.IS_NOT_NULL,operand));
}
}
for (RexNode notDisjunction : notTerms) {
final List<RexNode> terms2=RelOptUtil.conjunctions(notDisjunction);
if (terms.containsAll(terms2)) {
return rexBuilder.makeLiteral(false);
}
}
for (RexNode notDisjunction : notTerms) {
terms.add(rexBuilder.makeCall(SqlStdOperatorTable.NOT,notDisjunction));
}
return RexUtil.composeConjunction(rexBuilder,terms,false);
}
