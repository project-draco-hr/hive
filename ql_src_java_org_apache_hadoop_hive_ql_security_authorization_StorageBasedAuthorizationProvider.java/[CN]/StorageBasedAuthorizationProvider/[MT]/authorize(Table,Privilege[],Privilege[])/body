{
  try {
    initWh();
  }
 catch (  MetaException ex) {
    throw hiveException(ex);
  }
  DropPrivilegeExtractor privExtractor=new DropPrivilegeExtractor(readRequiredPriv,writeRequiredPriv);
  readRequiredPriv=privExtractor.getReadReqPriv();
  writeRequiredPriv=privExtractor.getWriteReqPriv();
  if (privExtractor.hasDropPrivilege || requireCreatePrivilege(readRequiredPriv) || requireCreatePrivilege(writeRequiredPriv)) {
    authorize(hive_db.getDatabase(table.getDbName()),new Privilege[]{},new Privilege[]{Privilege.ALTER_DATA});
  }
  Path path=table.getDataLocation();
  if (privExtractor.hasDropPrivilege() && table.getTableType() != TableType.EXTERNAL_TABLE) {
    checkDeletePermission(path,getConf(),authenticator.getUserName());
  }
  if (path != null) {
    authorize(path,readRequiredPriv,writeRequiredPriv);
  }
}
