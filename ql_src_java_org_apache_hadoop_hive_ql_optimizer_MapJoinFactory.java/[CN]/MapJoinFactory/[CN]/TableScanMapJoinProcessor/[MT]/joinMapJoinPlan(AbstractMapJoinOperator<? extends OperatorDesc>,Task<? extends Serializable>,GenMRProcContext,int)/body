{
  MapredWork plan=(MapredWork)oldTask.getWork();
  Operator<? extends OperatorDesc> currTopOp=opProcCtx.getCurrTopOp();
  List<Operator<? extends OperatorDesc>> seenOps=opProcCtx.getSeenOps();
  String currAliasId=opProcCtx.getCurrAliasId();
  if (!seenOps.contains(currTopOp)) {
    seenOps.add(currTopOp);
    boolean local=false;
    if (pos != -1) {
      local=(pos == ((MapJoinDesc)op.getConf()).getPosBigTable()) ? false : true;
    }
    GenMapRedUtils.setTaskPlan(currAliasId,currTopOp,plan,local,opProcCtx);
    setupBucketMapJoinInfo(plan,op);
  }
  currTopOp=null;
  opProcCtx.setCurrTopOp(currTopOp);
  opProcCtx.setCurrTask(oldTask);
}
