{
  try {
    Object encodedRow=encode(record);
    int bucket=getBucket(encodedRow);
    updaters.get(bucket).insert(transactionId,encodedRow);
  }
 catch (  IOException e) {
    throw new StreamingIOFailure("Error writing record in transaction(" + transactionId + ")",e);
  }
}
