{
  HiveTxnManager txnMgr=null;
  String txnMgrName=conf.getVar(HiveConf.ConfVars.HIVE_TXN_MANAGER);
  if (txnMgrName == null || txnMgrName.isEmpty()) {
    throw new LockException(ErrorMsg.TXNMGR_NOT_SPECIFIED.getMsg());
  }
  try {
    HiveTxnManagerImpl impl=(HiveTxnManagerImpl)ReflectionUtils.newInstance(conf.getClassByName(txnMgrName),conf);
    impl.setHiveConf(conf);
    txnMgr=impl;
  }
 catch (  ClassNotFoundException e) {
    throw new LockException(ErrorMsg.TXNMGR_NOT_INSTANTIATED.getMsg());
  }
  return txnMgr;
}
