{
  Category typeCategory=fieldTypeInfo.getCategory();
  HCatFieldSchema hCatFieldSchema;
  if (Category.PRIMITIVE == typeCategory) {
    hCatFieldSchema=new HCatFieldSchema(fieldName,getPrimitiveHType(fieldTypeInfo),null);
  }
 else   if (Category.STRUCT == typeCategory) {
    HCatSchema subSchema=constructHCatSchema((StructTypeInfo)fieldTypeInfo);
    hCatFieldSchema=new HCatFieldSchema(fieldName,HCatFieldSchema.Type.STRUCT,subSchema,null);
  }
 else   if (Category.LIST == typeCategory) {
    HCatSchema subSchema=getHCatSchema(((ListTypeInfo)fieldTypeInfo).getListElementTypeInfo());
    hCatFieldSchema=new HCatFieldSchema(fieldName,HCatFieldSchema.Type.ARRAY,subSchema,null);
  }
 else   if (Category.MAP == typeCategory) {
    HCatFieldSchema.Type mapKeyType=getPrimitiveHType(((MapTypeInfo)fieldTypeInfo).getMapKeyTypeInfo());
    HCatSchema subSchema=getHCatSchema(((MapTypeInfo)fieldTypeInfo).getMapValueTypeInfo());
    hCatFieldSchema=new HCatFieldSchema(fieldName,HCatFieldSchema.Type.MAP,mapKeyType,subSchema,null);
  }
 else {
    throw new TypeNotPresentException(fieldTypeInfo.getTypeName(),null);
  }
  return hCatFieldSchema;
}
