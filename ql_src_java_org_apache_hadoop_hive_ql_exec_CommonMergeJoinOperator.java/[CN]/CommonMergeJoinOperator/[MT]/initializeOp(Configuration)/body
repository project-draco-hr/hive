{
  super.initializeOp(hconf);
  firstFetchHappened=false;
  initializeChildren(hconf);
  int maxAlias=0;
  for (byte pos=0; pos < order.length; pos++) {
    if (pos > maxAlias) {
      maxAlias=pos;
    }
  }
  maxAlias+=1;
  nextGroupStorage=new RowContainer[maxAlias];
  candidateStorage=new RowContainer[maxAlias];
  keyWritables=new ArrayList[maxAlias];
  nextKeyWritables=new ArrayList[maxAlias];
  fetchDone=new boolean[maxAlias];
  foundNextKeyGroup=new boolean[maxAlias];
  int bucketSize;
  int oldVar=HiveConf.getIntVar(hconf,HiveConf.ConfVars.HIVEMAPJOINBUCKETCACHESIZE);
  if (oldVar != 100) {
    bucketSize=oldVar;
  }
 else {
    bucketSize=HiveConf.getIntVar(hconf,HiveConf.ConfVars.HIVESMBJOINCACHEROWS);
  }
  for (byte pos=0; pos < order.length; pos++) {
    RowContainer<List<Object>> rc=JoinUtil.getRowContainer(hconf,rowContainerStandardObjectInspectors[pos],pos,bucketSize,spillTableDesc,conf,!hasFilter(pos),reporter);
    nextGroupStorage[pos]=rc;
    RowContainer<List<Object>> candidateRC=JoinUtil.getRowContainer(hconf,rowContainerStandardObjectInspectors[pos],pos,bucketSize,spillTableDesc,conf,!hasFilter(pos),reporter);
    candidateStorage[pos]=candidateRC;
  }
  for (byte pos=0; pos < order.length; pos++) {
    if (pos != posBigTable) {
      fetchDone[pos]=false;
    }
    foundNextKeyGroup[pos]=false;
  }
  sources=((TezContext)MapredContext.get()).getRecordSources();
}
