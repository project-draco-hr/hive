{
  final int fieldCount=getRowType().getFieldCount();
  if (fieldsUsed.equals(ImmutableBitSet.range(fieldCount)) && extraFields.isEmpty()) {
    return this;
  }
  final List<RexNode> exprList=new ArrayList<>();
  final List<String> nameList=new ArrayList<>();
  final RexBuilder rexBuilder=getCluster().getRexBuilder();
  final List<RelDataTypeField> fields=getRowType().getFieldList();
  for (  int i : fieldsUsed) {
    RelDataTypeField field=fields.get(i);
    exprList.add(rexBuilder.makeInputRef(this,i));
    nameList.add(field.getName());
  }
  for (  RelDataTypeField extraField : extraFields) {
    exprList.add(rexBuilder.ensureType(extraField.getType(),rexBuilder.constantNull(),true));
    nameList.add(extraField.getName());
  }
  HiveProject hp=(HiveProject)relBuilder.push(this).project(exprList,nameList).build();
  hp.setSynthetic();
  return hp;
}
