{
  if (byteArrayRef == null) {
    byteArrayRef=new ByteArrayRef();
  }
  String rowStr;
  if (blob instanceof BytesWritable) {
    BytesWritable b=(BytesWritable)blob;
    rowStr=new String(b.getBytes());
  }
 else   if (blob instanceof Text) {
    Text rowText=(Text)blob;
    rowStr=rowText.toString();
  }
 else {
    throw new SerDeException(getClass() + ": expects either BytesWritable or Text object!");
  }
  byteArrayRef.setData(rowStr.replaceAll(Pattern.quote(fieldDelimited),"\1").getBytes());
  cachedLazyStruct.init(byteArrayRef,0,byteArrayRef.getData().length);
  cachedLazyStruct.parseMultiDelimit(rowStr.getBytes(),fieldDelimited.getBytes());
  return cachedLazyStruct;
}
