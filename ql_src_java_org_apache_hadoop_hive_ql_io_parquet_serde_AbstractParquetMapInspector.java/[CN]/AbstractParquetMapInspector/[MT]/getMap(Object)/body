{
  if (data == null) {
    return null;
  }
  if (data instanceof ArrayWritable) {
    final Writable[] mapContainer=((ArrayWritable)data).get();
    if (mapContainer == null || mapContainer.length == 0) {
      return null;
    }
    final Writable[] mapArray=((ArrayWritable)mapContainer[0]).get();
    final Map<Writable,Writable> map=new LinkedHashMap<Writable,Writable>();
    for (    final Writable obj : mapArray) {
      final ArrayWritable mapObj=(ArrayWritable)obj;
      final Writable[] arr=mapObj.get();
      map.put(arr[0],arr[1]);
    }
    return map;
  }
  if (data instanceof Map) {
    return (Map)data;
  }
  throw new UnsupportedOperationException("Cannot inspect " + data.getClass().getCanonicalName());
}
