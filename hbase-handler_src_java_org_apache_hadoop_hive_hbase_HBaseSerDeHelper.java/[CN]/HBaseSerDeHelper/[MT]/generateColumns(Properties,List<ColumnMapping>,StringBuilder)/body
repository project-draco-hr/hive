{
  if (columnsMapping == null) {
    throw new IllegalArgumentException("columnsMapping cannot be null");
  }
  if (sb == null) {
    throw new IllegalArgumentException("StringBuilder cannot be null");
  }
  for (int i=0; i < columnsMapping.size(); i++) {
    ColumnMapping colMap=columnsMapping.get(i);
    if (colMap.hbaseRowKey) {
      sb.append("key").append(StringUtils.COMMA_STR);
    }
 else     if (colMap.qualifierName == null) {
      if (colMap.qualifierPrefix != null) {
        sb.append(filter(colMap.familyName)).append("_").append(filter(colMap.qualifierPrefix) + i).append(StringUtils.COMMA_STR);
      }
 else {
        sb.append(filter(colMap.familyName)).append("_").append("col" + i).append(StringUtils.COMMA_STR);
      }
    }
 else {
      sb.append(filter(colMap.familyName)).append("_").append(filter(colMap.qualifierName)).append(StringUtils.COMMA_STR);
    }
  }
  trim(sb);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Generated columns: [" + sb.toString() + "]");
  }
}
