{
  if (token != JsonToken.FIELD_NAME) {
    throw new IOException("Field name expected");
  }
  String fieldName=p.getText();
  int fpos;
  try {
    fpos=s.getPosition(fieldName);
  }
 catch (  NullPointerException npe) {
    fpos=getPositionFromHiveInternalColumnName(fieldName);
    LOG.debug("NPE finding position for field [{}] in schema [{}]",fieldName,s);
    if (!fieldName.equalsIgnoreCase(getHiveInternalColumnName(fpos))) {
      LOG.error("Hive internal column name {} and position " + "encoding {} for the column name are at odds",fieldName,fpos);
      throw npe;
    }
    if (fpos == -1) {
      return;
    }
  }
  HCatFieldSchema hcatFieldSchema=s.getFields().get(fpos);
  Object currField=extractCurrentField(p,null,hcatFieldSchema,false);
  r.set(fpos,currField);
}
