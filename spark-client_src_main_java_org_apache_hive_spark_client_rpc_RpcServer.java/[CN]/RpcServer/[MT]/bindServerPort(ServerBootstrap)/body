{
  List<Integer> ports=config.getServerPorts();
  if (ports.contains(0)) {
    return serverBootstrap.bind(0).sync();
  }
 else {
    Random rand=new Random();
    while (!ports.isEmpty()) {
      int index=rand.nextInt(ports.size());
      int port=ports.get(index);
      ports.remove(index);
      try {
        return serverBootstrap.bind(port).sync();
      }
 catch (      Exception e) {
      }
    }
    throw new IOException("No available ports from configured RPC Server ports for HiveServer2");
  }
}
