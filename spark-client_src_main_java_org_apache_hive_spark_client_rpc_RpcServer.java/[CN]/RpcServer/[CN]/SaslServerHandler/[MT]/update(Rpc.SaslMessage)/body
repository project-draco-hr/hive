{
  if (clientId == null) {
    Preconditions.checkArgument(challenge.clientId != null,"Missing client ID in SASL handshake.");
    clientId=challenge.clientId;
    client=pendingClients.get(clientId);
    Preconditions.checkArgument(client != null,"Unexpected client ID '%s' in SASL handshake.",clientId);
  }
  return new Rpc.SaslMessage(server.evaluateResponse(challenge.payload));
}
