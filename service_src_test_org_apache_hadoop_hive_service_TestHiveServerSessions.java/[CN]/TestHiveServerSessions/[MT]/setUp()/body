{
  super.setUp();
  port=findFreePort();
  server=new Thread(new Runnable(){
    public void run(){
      HiveServer.main(new String[]{"-p",String.valueOf(port)});
    }
  }
);
  server.start();
  Thread.sleep(5000);
  for (int i=0; i < transports.length; i++) {
    TSocket transport=new TSocket("localhost",port);
    transport.open();
    transports[i]=transport;
    clients[i]=new HiveClient(new TBinaryProtocol(transport));
  }
}
