{
  Properties schema=this.getSchema(tableName);
  Table tbl=MetaStoreUtils.getTable(schema);
  List<FieldSchema> partKeys=tbl.getPartitionKeys();
  if (partKeys.size() != partVals.size()) {
    throw new MetaException("Invalid partition key values: " + partVals);
  }
  LinkedHashMap<String,String> pm=new LinkedHashMap<String,String>(partKeys.size());
  for (int i=0; i < partKeys.size(); i++) {
    if (partVals.get(i) == null || partVals.get(i).length() == 0) {
      throw new MetaException("Invalid partition spec: " + partVals);
    }
    pm.put(partKeys.get(i).getName(),partVals.get(i));
  }
  Path partPath=wh.getPartitionPath(dbName,tableName,pm);
  Partition tPartition=new Partition();
  tPartition.setValues(partVals);
  tPartition.setSd(tbl.getSd());
  tPartition.setParameters(new HashMap<String,String>());
  tPartition.getSd().setLocation(partPath.toString());
  return tPartition;
}
