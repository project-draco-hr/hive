{
  TException firstException=null;
  for (  URI store : this.metastoreUris) {
    try {
      this.open(store);
      Map<String,String> schema_map=client.get_schema(tableName);
      Properties p=new Properties();
      for (Iterator it=schema_map.entrySet().iterator(); it.hasNext(); ) {
        Map.Entry e=(Map.Entry)it.next();
        String key=(String)e.getKey();
        String val=(String)e.getValue();
        p.setProperty(key,val);
      }
      p=MetaStoreUtils.hive1Tohive3ClassNames(p);
      this.close();
      return p;
    }
 catch (    TException e) {
      System.err.println("get_schema got exception: " + e);
      e.printStackTrace();
      if (firstException == null) {
        firstException=e;
      }
    }
catch (    UnknownTableException e) {
      LOG.error(StringUtils.stringifyException(e));
      throw new NoSuchObjectException(e.getMessage());
    }
catch (    UnknownDBException e) {
      LOG.error(StringUtils.stringifyException(e));
      throw new NoSuchObjectException(e.getMessage());
    }
  }
  throw firstException;
}
