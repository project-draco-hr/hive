{
  if (configuration == null) {
    configuration=new HiveConf(MetaStoreClient.class);
  }
  wh=new Warehouse(configuration);
  if (HiveConf.getVar(configuration,HiveConf.ConfVars.METASTOREURIS) != null) {
    String metastoreUrisString[]=HiveConf.getVar(configuration,HiveConf.ConfVars.METASTOREURIS).split(",");
    this.metastoreUris=new URI[metastoreUrisString.length];
    try {
      int i=0;
      for (      String s : metastoreUrisString) {
        URI tmpUri=new URI(s.trim());
        if (tmpUri.getScheme() == null) {
          throw new IllegalArgumentException("URI: " + s + " does not have a scheme");
        }
        this.metastoreUris[i++]=tmpUri;
      }
    }
 catch (    IllegalArgumentException e) {
      throw (e);
    }
catch (    Exception e) {
      System.err.println("Exception getting uri to connect to the store with: " + e.getMessage());
      e.printStackTrace();
    }
  }
 else   if (HiveConf.getVar(configuration,HiveConf.ConfVars.METASTOREDIRECTORY) != null) {
    this.metastoreUris=new URI[1];
    try {
      this.metastoreUris[0]=new URI(HiveConf.getVar(configuration,HiveConf.ConfVars.METASTOREDIRECTORY));
    }
 catch (    URISyntaxException e) {
      System.err.println("Exception getting uri to connect to the store with: " + e.getMessage());
      e.printStackTrace();
    }
  }
 else {
    System.err.println("NOT getting uris from conf");
    throw new RuntimeException("MetaStoreURIs not found in conf file");
  }
  this.conf=configuration;
  transport=null;
  client=null;
  open=false;
}
