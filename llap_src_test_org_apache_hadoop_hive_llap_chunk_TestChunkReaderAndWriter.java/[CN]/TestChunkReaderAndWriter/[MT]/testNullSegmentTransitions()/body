{
  Random random=new Random(1234);
  ChunkWriterImpl writer=new ChunkWriterImpl();
  BufferInProgress buf=new BufferInProgress(createBuffer(LARGE_BUFFER));
  writer.prepare(buf);
  int ncount1=1, ncount2=3, ncount3=60, ncount4=3;
  Long[] src=new Long[ncount1 + ncount2 + ncount3+ ncount4+ 1];
  int offset=0;
  offset=writeNulls(writer,ncount1,src,offset);
  long[] tmp=new long[1];
  tmp[0]=random.nextLong();
  src[offset]=tmp[0];
  writer.writeLongs(tmp,0,1,NullsState.NEXT_NULL);
  ++offset;
  offset=writeNulls(writer,ncount2,src,offset);
  offset=writeNulls(writer,ncount3,src,offset);
  offset=writeNulls(writer,ncount4,src,offset);
  writer.finishCurrentSegment();
  verifyValues(completeChunk(writer,buf),src);
}
