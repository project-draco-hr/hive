{
  Random random=new Random(1234);
  ChunkWriterImpl writer=new ChunkWriterImpl();
  BufferInProgress buf=new BufferInProgress(createBuffer(128 * 8));
  writer.prepare(buf);
  long[] tmp=new long[122];
  Long[] src=new Long[tmp.length + 2];
  src[0]=tmp[0]=3;
  writer.writeLongs(tmp,0,1,NullsState.NEXT_NULL);
  src[1]=null;
  writer.writeNulls(1,true);
  for (int i=0; i < tmp.length; ++i) {
    src[i + 2]=tmp[i]=random.nextLong();
  }
  writer.writeLongs(tmp,0,tmp.length,NullsState.NEXT_NULL);
  writer.finishCurrentSegment();
  verifyValues(completeChunk(writer,buf),src);
}
