{
  Random random=new Random(1234);
  ChunkWriterImpl writer=new ChunkWriterImpl();
  BufferInProgress buf=new BufferInProgress(createBuffer(LARGE_BUFFER));
  writer.prepare(buf);
  int repeating1=10, rcount1=5, repeating2=-10, rcount2=5, repeating3=4, rcount3=15;
  int nrcount1=30, nrcount2=30, nrcount3=30;
  long[] src=new long[rcount1 + rcount2 + rcount3+ nrcount1+ nrcount2+ nrcount3];
  int offset=0;
  offset=writeRepeatedValues(writer,repeating1,rcount1,src,offset);
  offset=writeLongs(random,writer,nrcount1,src,offset);
  offset=writeRepeatedValues(writer,repeating2,rcount2,src,offset);
  offset=writeLongs(random,writer,nrcount2,src,offset);
  offset=writeRepeatedValues(writer,repeating3,rcount3,src,offset);
  offset=writeLongs(random,writer,nrcount3,src,offset);
  writer.finishCurrentSegment();
  verifyValues(completeChunk(writer,buf),src);
}
