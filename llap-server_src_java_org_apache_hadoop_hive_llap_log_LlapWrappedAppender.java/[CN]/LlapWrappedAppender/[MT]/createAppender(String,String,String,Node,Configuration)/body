{
  if (config == null) {
    LOGGER.error("PluginConfiguration not expected to be null");
    return null;
  }
  if (node == null) {
    LOGGER.error("Node must be specified as an appender specification");
    return null;
  }
  boolean renameFileOnClose=DEFAULT_RENAME_FILES_ON_CLOSE;
  if (Strings.isNotBlank(renameFileOnCloseProvided)) {
    renameFileOnClose=Boolean.parseBoolean(renameFileOnCloseProvided);
  }
  String renamedFileSuffix=DEFAULT_RENAMED_FILE_SUFFIX;
  if (Strings.isNotBlank(renamedFileSuffixProvided)) {
    renamedFileSuffix=renamedFileSuffixProvided;
  }
  return new LlapWrappedAppender(name,node,config,renameFileOnClose,renamedFileSuffix);
}
