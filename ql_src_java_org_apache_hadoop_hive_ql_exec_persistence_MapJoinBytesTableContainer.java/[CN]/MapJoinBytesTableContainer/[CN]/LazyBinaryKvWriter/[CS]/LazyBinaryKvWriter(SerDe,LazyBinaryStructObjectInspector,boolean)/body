{
  this.keySerDe=keySerDe;
  if (hasFilterTag) {
    List<? extends StructField> fields=valSoi.getAllStructFieldRefs();
    int ix=fields.size() - 1;
    if (!(fields.get(ix).getFieldObjectInspector() instanceof ShortObjectInspector)) {
      throw new SerDeException("Has filter tag, but corresponding OI is " + fields.get(ix).getFieldObjectInspector());
    }
    filterGetter=new LazyBinaryStruct.SingleFieldGetter(valSoi,fields.size() - 1);
  }
 else {
    filterGetter=null;
  }
}
