{
  try {
    alias=(byte)tag;
    if (hashMapRowGetters == null) {
      hashMapRowGetters=new ReusableGetAdaptor[mapJoinTables.length];
      MapJoinKey refKey=getRefKey(alias);
      for (byte pos=0; pos < order.length; pos++) {
        if (pos != alias) {
          hashMapRowGetters[pos]=mapJoinTables[pos].createGetter(refKey);
        }
      }
    }
    ReusableGetAdaptor firstSetKey=null;
    int fieldCount=joinKeys[alias].size();
    boolean joinNeeded=false;
    for (byte pos=0; pos < order.length; pos++) {
      if (pos != alias) {
        ReusableGetAdaptor adaptor;
        if (firstSetKey == null) {
          adaptor=firstSetKey=hashMapRowGetters[pos];
          setMapJoinKey(firstSetKey,row,alias);
        }
 else {
          adaptor=hashMapRowGetters[pos];
          adaptor.setFromOther(firstSetKey);
        }
        MapJoinRowContainer rowContainer=adaptor.getCurrentRows();
        if (rowContainer != null && unwrapContainer[pos] != null) {
          Object[] currentKey=firstSetKey.getCurrentKey();
          rowContainer=unwrapContainer[pos].setInternal(rowContainer,currentKey);
        }
        if (rowContainer == null || firstSetKey.hasAnyNulls(fieldCount,nullsafes)) {
          if (!noOuterJoin) {
            joinNeeded=true;
            storage[pos]=dummyObjVectors[pos];
          }
 else {
            storage[pos]=emptyList;
          }
        }
 else {
          joinNeeded=true;
          storage[pos]=rowContainer.copy();
          aliasFilterTags[pos]=rowContainer.getAliasFilter();
        }
      }
    }
    if (joinNeeded) {
      List<Object> value=getFilteredValue(alias,row);
      storage[alias].addRow(value);
      checkAndGenObject();
    }
    storage[tag].clearRows();
    for (byte pos=0; pos < order.length; pos++) {
      if (pos != tag) {
        storage[pos]=null;
      }
    }
  }
 catch (  Exception e) {
    String msg="Unexpected exception: " + e.getMessage();
    LOG.error(msg,e);
    throw new HiveException(msg,e);
  }
}
