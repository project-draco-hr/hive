{
  try {
    if (firstRow) {
      generateMapMetaData();
      loadHashTable();
      firstRow=false;
    }
    alias=(byte)tag;
    key=computeMapJoinKey(row,alias);
    boolean joinNeeded=false;
    for (byte pos=0; pos < order.length; pos++) {
      if (pos != alias) {
        MapJoinRowContainer rowContainer=mapJoinTables[pos].get(key);
        if (rowContainer == null || key.hasAnyNulls(nullsafes)) {
          if (!noOuterJoin) {
            joinNeeded=true;
            storage[pos]=dummyObjVectors[pos];
          }
 else {
            storage[pos]=emptyList;
          }
        }
 else {
          joinNeeded=true;
          storage[pos]=rowContainer.copy();
          aliasFilterTags[pos]=rowContainer.getAliasFilter();
        }
      }
    }
    if (joinNeeded) {
      List<Object> value=getFilteredValue(alias,row);
      storage[alias].add(value);
      checkAndGenObject();
    }
    storage[tag].clear();
    for (byte pos=0; pos < order.length; pos++) {
      if (pos != tag) {
        storage[pos]=null;
      }
    }
  }
 catch (  SerDeException e) {
    throw new HiveException(e);
  }
}
