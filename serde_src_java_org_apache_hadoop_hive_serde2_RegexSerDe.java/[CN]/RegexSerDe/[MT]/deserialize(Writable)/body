{
  Text rowText=(Text)blob;
  Matcher m=inputPattern.matcher(rowText.toString());
  if (m.groupCount() != numColumns) {
    throw new SerDeException("Number of matching groups doesn't match the number of columns");
  }
  if (!m.matches()) {
    unmatchedRowsCount++;
    if (!alreadyLoggedNoMatch) {
      LOG.warn("" + unmatchedRowsCount + " unmatched rows are found: "+ rowText);
      alreadyLoggedNoMatch=true;
    }
    return null;
  }
  for (int c=0; c < numColumns; c++) {
    try {
      row.set(c,m.group(c + 1));
    }
 catch (    RuntimeException e) {
      partialMatchedRowsCount++;
      if (!alreadyLoggedPartialMatch) {
        LOG.warn("" + partialMatchedRowsCount + " partially unmatched rows are found, "+ " cannot find group "+ c+ ": "+ rowText);
        alreadyLoggedPartialMatch=true;
      }
      row.set(c,null);
    }
  }
  return row;
}
