def cmd_test(patches=[], revision=None, one_file_report=False):
    cmd_prepare(patches, revision)
    if (args.singlehost == False):
        local.cd((master_base_path + '/trunk'))
        local.run('chmod -R 777 *')
        local.run((('rm -rf "' + master_base_path) + '/templogs/"'))
        local.run((('mkdir -p "' + master_base_path) + '/templogs/"'))
        tests = ['TestRemoteHiveMetaStore', 'TestEmbeddedHiveMetaStore', 'TestSetUGIOnBothClientServer', 'TestSetUGIOnOnlyClient', 'TestSetUGIOnOnlyServer']
        for test in tests:
            local.run(((('sudo -u root ant -Divy.default.ivy.user.dir={0} '.format(ivy_path) + ' -Dtestcase=') + test) + ' test'))
            local.run((('cp "`find . -name "TEST-*.xml"`" "' + master_base_path) + '/templogs/"'))
    cmd_run_tests(one_file_report)
