{
  if (curReader != null) {
    curReader.close();
    curReader=null;
    if (idx > 0) {
      progress+=split.getLength(idx - 1);
    }
  }
  if (idx == split.getNumPaths()) {
    return false;
  }
  try {
    InputSplitShim newSplit=new InputSplitShim(jc,split.delegate);
    curReader=rrConstructor.newInstance(new Object[]{(InputSplit)newSplit,jc,reporter,Integer.valueOf(idx)});
    jc.set("map.input.file",split.getPath(idx).toString());
    jc.setLong("map.input.start",0);
    jc.setLong("map.input.length",split.getLength(idx));
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
  idx++;
  return true;
}
