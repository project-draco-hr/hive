{
  Path[] paths=FileUtil.stat2Paths(listStatus(job));
  long blockSize=job.getLong("dfs.block.size",67108864);
  if (paths.length != 0) {
    long[] lengths=new long[paths.length];
    long totLength=0;
    for (int i=0; i < paths.length; i++) {
      FileSystem fs=paths[i].getFileSystem(job);
      lengths[i]=fs.getContentSummary(paths[i]).getLength();
      totLength+=lengths[i];
    }
    numSplits=(int)Math.max(numSplits,(int)totLength / blockSize);
    LOG.debug("Total Length " + totLength + ", block size "+ blockSize+ ", number of splits: "+ numSplits);
  }
  if (numSplits < 1)   numSplits=1;
  return numSplits;
}
