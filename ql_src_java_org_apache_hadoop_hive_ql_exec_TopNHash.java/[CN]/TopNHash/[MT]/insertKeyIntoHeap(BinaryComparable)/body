{
  if (usage > threshold) {
    return excluded == 0 ? DISABLE : FLUSH;
  }
  int size=indexes.size();
  int index=size < topN ? size : evicted;
  keys[index]=Arrays.copyOf(key.getBytes(),key.getLength());
  if (null != indexes.store(index)) {
    return FORWARD;
  }
  if (size == topN) {
    evicted=indexes.removeBiggest();
    if (index == evicted) {
      excluded++;
      return EXCLUDED;
    }
    removed(evicted);
  }
  return index;
}
