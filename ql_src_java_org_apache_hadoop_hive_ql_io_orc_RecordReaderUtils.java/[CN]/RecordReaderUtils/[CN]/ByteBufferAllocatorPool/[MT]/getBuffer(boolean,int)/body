{
  TreeMap<Key,ByteBuffer> tree=getBufferTree(direct);
  Map.Entry<Key,ByteBuffer> entry=tree.ceilingEntry(new Key(length,0));
  if (entry == null) {
    return direct ? ByteBuffer.allocateDirect(length) : ByteBuffer.allocate(length);
  }
  tree.remove(entry.getKey());
  return entry.getValue();
}
