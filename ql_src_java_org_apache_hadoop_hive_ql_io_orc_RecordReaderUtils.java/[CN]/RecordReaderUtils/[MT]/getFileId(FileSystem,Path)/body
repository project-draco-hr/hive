{
  String pathStr=path.toUri().getPath();
  if (fileSystem instanceof DistributedFileSystem) {
    DFSClient client=((DistributedFileSystem)fileSystem).getClient();
    return client.getFileInfo(pathStr).getFileId();
  }
  int nameHash=pathStr.hashCode();
  long fileSize=fileSystem.getFileStatus(path).getLen();
  long id=((fileSize ^ (fileSize >>> 32)) << 32) | ((long)nameHash & 0xffffffffL);
  RecordReaderImpl.LOG.warn("Cannot get unique file ID from " + fileSystem.getClass().getSimpleName() + "; using "+ id+ "("+ pathStr+ ","+ nameHash+ ","+ fileSize+ ")");
  return id;
}
