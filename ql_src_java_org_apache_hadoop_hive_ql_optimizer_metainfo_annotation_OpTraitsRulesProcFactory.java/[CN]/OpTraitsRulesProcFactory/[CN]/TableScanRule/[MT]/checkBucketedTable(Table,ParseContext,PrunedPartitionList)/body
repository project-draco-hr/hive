{
  if (tbl.isPartitioned()) {
    List<Partition> partitions=prunedParts.getNotDeniedPartns();
    if (!partitions.isEmpty()) {
      for (      Partition p : partitions) {
        List<String> fileNames=AbstractBucketJoinProc.getBucketFilePathsOfPartition(p.getDataLocation(),pGraphContext);
        int bucketCount=p.getBucketCount();
        if (fileNames.size() != 0 && fileNames.size() != bucketCount) {
          return false;
        }
      }
    }
  }
 else {
    List<String> fileNames=AbstractBucketJoinProc.getBucketFilePathsOfPartition(tbl.getDataLocation(),pGraphContext);
    Integer num=new Integer(tbl.getNumBuckets());
    if (fileNames.size() != 0 && fileNames.size() != num) {
      return false;
    }
  }
  return true;
}
