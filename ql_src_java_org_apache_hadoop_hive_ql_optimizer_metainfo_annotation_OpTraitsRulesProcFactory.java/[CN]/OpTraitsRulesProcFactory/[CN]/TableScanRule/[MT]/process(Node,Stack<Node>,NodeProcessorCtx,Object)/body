{
  TableScanOperator ts=(TableScanOperator)nd;
  AnnotateOpTraitsProcCtx opTraitsCtx=(AnnotateOpTraitsProcCtx)procCtx;
  Table table=opTraitsCtx.getParseContext().getTopToTable().get(ts);
  PrunedPartitionList prunedPartList=null;
  try {
    prunedPartList=opTraitsCtx.getParseContext().getPrunedPartitions(ts.getConf().getAlias(),ts);
  }
 catch (  HiveException e) {
    prunedPartList=null;
  }
  boolean bucketMapJoinConvertible=checkBucketedTable(table,opTraitsCtx.getParseContext(),prunedPartList);
  List<List<String>> bucketCols=new ArrayList<List<String>>();
  int numBuckets=-1;
  if (bucketMapJoinConvertible) {
    bucketCols.add(table.getBucketCols());
    numBuckets=table.getNumBuckets();
  }
  OpTraits opTraits=new OpTraits(bucketCols,numBuckets);
  ts.setOpTraits(opTraits);
  return null;
}
