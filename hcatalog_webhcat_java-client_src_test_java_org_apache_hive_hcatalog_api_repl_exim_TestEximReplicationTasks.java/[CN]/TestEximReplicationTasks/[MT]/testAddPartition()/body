{
  Table t=new Table();
  t.setDbName("testdb");
  t.setTableName("testtable");
  List<FieldSchema> pkeys=HCatSchemaUtils.getFieldSchemas(HCatSchemaUtils.getHCatSchema("a:int,b:string").getFields());
  t.setPartitionKeys(pkeys);
  List<Partition> addedPtns=new ArrayList<Partition>();
  addedPtns.add(createPtn(t,Arrays.asList("120","abc")));
  addedPtns.add(createPtn(t,Arrays.asList("201","xyz")));
  NotificationEvent event=new NotificationEvent(getEventId(),getTime(),HCatConstants.HCAT_ADD_PARTITION_EVENT,msgFactory.buildAddPartitionMessage(t,addedPtns.iterator()).toString());
  event.setDbName(t.getDbName());
  event.setTableName(t.getTableName());
  HCatNotificationEvent hev=new HCatNotificationEvent(event);
  ReplicationTask rtask=ReplicationTask.create(client,hev);
  assertEquals(hev.toString(),rtask.getEvent().toString());
  verifyAddPartitionReplicationTask(rtask,t,addedPtns);
}
