{
  assertEquals(InsertReplicationTask.class,rtask.getClass());
  assertEquals(true,rtask.needsStagingDirs());
  assertEquals(false,rtask.isActionable());
  rtask.withSrcStagingDirProvider(stagingDirectoryProvider).withDstStagingDirProvider(stagingDirectoryProvider).withDbNameMapping(debugMapping).withTableNameMapping(debugMapping);
  assertEquals(true,rtask.isActionable());
  List<? extends Command> srcCommands=Lists.newArrayList(rtask.getSrcWhCommands());
  assertEquals(1,srcCommands.size());
  assertEquals(ExportCommand.class,srcCommands.get(0).getClass());
  ExportCommand exportCommand=getExpectedExportCommand(rtask,getPtnDesc(table,ptn),false);
  CommandTestUtils.compareCommands(exportCommand,srcCommands.get(0),true);
  List<? extends Command> dstCommands=Lists.newArrayList(rtask.getDstWhCommands());
  assertEquals(1,dstCommands.size());
  assertEquals(ImportCommand.class,dstCommands.get(0).getClass());
  ImportCommand importCommand=getExpectedImportCommand(rtask,getPtnDesc(table,ptn),false);
  CommandTestUtils.compareCommands(importCommand,dstCommands.get(0),true);
}
