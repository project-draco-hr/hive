{
  Path tblDir;
  Configuration conf=context.getConf();
  try {
    Warehouse wh=new Warehouse(conf);
    if (loc == null || loc.isEmpty()) {
      Hive hive=context.getHive();
      tblDir=wh.getTablePath(hive.getDatabase(hive.getCurrentDatabase()),tableName).getParent();
    }
 else {
      tblDir=wh.getDnsPath(new Path(loc));
    }
    try {
      AuthUtils.authorize(tblDir,FsAction.WRITE,conf);
    }
 catch (    HCatException e) {
      throw new SemanticException(e);
    }
  }
 catch (  MetaException e) {
    throw new SemanticException(e);
  }
catch (  HiveException e) {
    throw new SemanticException(e);
  }
}
