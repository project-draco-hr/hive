{
  if (recType == RecordTypes.SessionStart) {
    sessionId=values.get(Keys.SESSION_ID.name());
  }
 else   if (recType == RecordTypes.QueryStart || recType == RecordTypes.QueryEnd) {
    String key=values.get(Keys.QUERY_ID.name());
    QueryInfo ji;
    if (jobInfoMap.containsKey(key)) {
      ji=jobInfoMap.get(key);
      ji.hm.putAll(values);
    }
 else {
      ji=new QueryInfo();
      ji.hm=new HashMap<String,String>();
      ji.hm.putAll(values);
      jobInfoMap.put(key,ji);
    }
  }
 else   if (recType == RecordTypes.TaskStart || recType == RecordTypes.TaskEnd || recType == RecordTypes.TaskProgress) {
    String jobid=values.get(Keys.QUERY_ID.name());
    String taskid=values.get(Keys.TASK_ID.name());
    String key=jobid + ":" + taskid;
    TaskInfo ti;
    if (taskInfoMap.containsKey(key)) {
      ti=taskInfoMap.get(key);
      ti.hm.putAll(values);
    }
 else {
      ti=new TaskInfo();
      ti.hm=new HashMap<String,String>();
      ti.hm.putAll(values);
      taskInfoMap.put(key,ti);
    }
  }
}
