{
  LongColumnVector input1=new LongColumnVector(10);
  DoubleColumnVector input2=new DoubleColumnVector(10);
  MapColumnVector input=new MapColumnVector(10,input1,input2);
  input.init();
  LongColumnVector output1=new LongColumnVector(30);
  DoubleColumnVector output2=new DoubleColumnVector(30);
  MapColumnVector output=new MapColumnVector(10,output1,output2);
  output.init();
  input.noNulls=false;
  input.isNull[6]=true;
  input.childCount=11;
  Arrays.fill(output1.vector,-1);
  for (int i=0; i < 10; ++i) {
    input1.vector[i]=10 * i;
    input2.vector[i]=100 * i;
    input.offsets[i]=i;
    input.lengths[i]=2;
    output.offsets[i]=i + 2;
    output.lengths[i]=3;
  }
  output.childCount=30;
  output.setElement(3,6,input);
  assertEquals(30,output.childCount);
  StringBuilder buf=new StringBuilder();
  output.stringifyValue(buf,3);
  assertEquals("null",buf.toString());
  output.setElement(3,5,input);
  assertEquals(30,output.offsets[3]);
  assertEquals(2,output.lengths[3]);
  assertEquals(32,output.childCount);
  buf=new StringBuilder();
  output.stringifyValue(buf,3);
  assertEquals("[{\"key\": 50, \"value\": 500.0}," + " {\"key\": 60, \"value\": 600.0}]",buf.toString());
  output.setElement(3,4,input);
  assertEquals(34,output.childCount);
  assertEquals(34,output1.vector.length);
  assertEquals(50,output1.vector[30]);
  assertEquals(60,output1.vector[31]);
  buf=new StringBuilder();
  output.stringifyValue(buf,3);
  assertEquals("[{\"key\": 40, \"value\": 400.0}," + " {\"key\": 50, \"value\": 500.0}]",buf.toString());
  input.reset();
  assertEquals(false,input1.isRepeating);
  assertEquals(true,input.noNulls);
  output.reset();
  assertEquals(0,output.childCount);
  input.isRepeating=true;
  input.offsets[0]=0;
  input.lengths[0]=10;
  output.setElement(2,7,input);
  assertEquals(10,output.childCount);
  buf=new StringBuilder();
  output.stringifyValue(buf,2);
  assertEquals("[{\"key\": 0, \"value\": 0.0}," + " {\"key\": 10, \"value\": 100.0}," + " {\"key\": 20, \"value\": 200.0},"+ " {\"key\": 30, \"value\": 300.0},"+ " {\"key\": 40, \"value\": 400.0},"+ " {\"key\": 50, \"value\": 500.0},"+ " {\"key\": 60, \"value\": 600.0},"+ " {\"key\": 70, \"value\": 700.0},"+ " {\"key\": 80, \"value\": 800.0},"+ " {\"key\": 90, \"value\": 900.0}]",buf.toString());
}
