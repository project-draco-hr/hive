{
  try {
    if (expr == null || expr.equals(""))     throw new RuntimeException("Need non empty expression");
    if (partCols != null) {
      int pos=partCols.indexOf(expr);
      if (pos != -1) {
        return partFields.get(pos);
      }
    }
    String realExpr;
    if (myField != null) {
      if (expr.charAt(0) == '[') {
        realExpr=myField.getName() + expr;
      }
 else {
        realExpr=myField.getName() + "." + expr;
      }
    }
 else {
      realExpr=expr;
    }
    if (!ExpressionUtils.isComplexExpression(realExpr)) {
      return tableSerDe.getFieldFromExpression(null,realExpr);
    }
 else {
      return new ComplexSerDeField(null,realExpr,tableSerDe);
    }
  }
 catch (  SerDeException e) {
    e.printStackTrace();
    throw new HiveException(e);
  }
}
