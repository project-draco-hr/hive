{
  MRInputLegacy theMRInput=null;
  for (  Entry<String,LogicalInput> inp : inputs.entrySet()) {
    if (inp.getValue() instanceof MRInputLegacy) {
      if (theMRInput != null) {
        throw new IllegalArgumentException("Only one MRInput is expected");
      }
      theMRInput=(MRInputLegacy)inp.getValue();
    }
 else {
      throw new IOException("Expecting only one input of type MRInputLegacy. Found type: " + inp.getClass().getCanonicalName());
    }
  }
  theMRInput.init();
  return theMRInput;
}
