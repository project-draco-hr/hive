{
  final Map<?,?> sourceMap=inspector.getMap(obj);
  final ObjectInspector keyInspector=inspector.getMapKeyObjectInspector();
  final ObjectInspector valueInspector=inspector.getMapValueObjectInspector();
  final List<ArrayWritable> array=new ArrayList<ArrayWritable>();
  if (sourceMap != null) {
    for (    final Entry<?,?> keyValue : sourceMap.entrySet()) {
      final Writable key=createObject(keyValue.getKey(),keyInspector);
      final Writable value=createObject(keyValue.getValue(),valueInspector);
      if (key != null) {
        Writable[] arr=new Writable[2];
        arr[0]=key;
        arr[1]=value;
        array.add(new ArrayWritable(Writable.class,arr));
      }
    }
  }
  if (array.size() > 0) {
    final ArrayWritable subArray=new ArrayWritable(ArrayWritable.class,array.toArray(new ArrayWritable[array.size()]));
    return new ArrayWritable(Writable.class,new Writable[]{subArray});
  }
 else {
    return null;
  }
}
