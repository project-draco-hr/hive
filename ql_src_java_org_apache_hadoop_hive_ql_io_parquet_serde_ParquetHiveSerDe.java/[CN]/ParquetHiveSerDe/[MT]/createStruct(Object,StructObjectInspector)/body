{
  final List<? extends StructField> fields=inspector.getAllStructFieldRefs();
  final Writable[] arr=new Writable[fields.size()];
  for (int i=0; i < fields.size(); i++) {
    final StructField field=fields.get(i);
    final Object subObj=inspector.getStructFieldData(obj,field);
    final ObjectInspector subInspector=field.getFieldObjectInspector();
    arr[i]=createObject(subObj,subInspector);
  }
  return new ArrayWritable(Writable.class,arr);
}
