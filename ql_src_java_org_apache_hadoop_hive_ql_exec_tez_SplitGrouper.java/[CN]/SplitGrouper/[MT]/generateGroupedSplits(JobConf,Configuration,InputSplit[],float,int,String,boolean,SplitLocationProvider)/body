{
  MapWork work=populateMapWork(jobConf,inputName);
  Multimap<Integer,InputSplit> bucketSplitMultiMap=ArrayListMultimap.<Integer,InputSplit>create();
  int i=0;
  InputSplit prevSplit=null;
  for (  InputSplit s : splits) {
    if (schemaEvolved(s,prevSplit,groupAcrossFiles,work)) {
      ++i;
      prevSplit=s;
    }
    bucketSplitMultiMap.put(i,s);
  }
  LOG.info("# Src groups for split generation: " + (i + 1));
  Multimap<Integer,InputSplit> groupedSplits=this.group(jobConf,bucketSplitMultiMap,availableSlots,waves,locationProvider);
  return groupedSplits;
}
