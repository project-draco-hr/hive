{
  List<TaskLocationHint> locationHints=Lists.newArrayListWithCapacity(splits.length);
  for (  InputSplit split : splits) {
    String rack=(split instanceof TezGroupedSplit) ? ((TezGroupedSplit)split).getRack() : null;
    if (rack == null) {
      if (split.getLocations() != null) {
        locationHints.add(TaskLocationHint.createTaskLocationHint(new HashSet<String>(Arrays.asList(split.getLocations())),null));
      }
 else {
        locationHints.add(TaskLocationHint.createTaskLocationHint(null,null));
      }
    }
 else {
      locationHints.add(TaskLocationHint.createTaskLocationHint(null,Collections.singleton(rack)));
    }
  }
  return locationHints;
}
