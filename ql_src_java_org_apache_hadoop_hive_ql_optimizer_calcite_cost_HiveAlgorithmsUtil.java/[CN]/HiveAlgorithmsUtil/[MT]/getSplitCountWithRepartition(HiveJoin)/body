{
  final Double maxSplitSize=join.getCluster().getPlanner().getContext().unwrap(HiveAlgorithmsConf.class).getMaxSplitSize();
  RelMetadataQuery mq=RelMetadataQuery.instance();
  final Double averageRowSize=mq.getAverageRowSize(join);
  final Double rowCount=mq.getRowCount(join);
  if (averageRowSize == null || rowCount == null) {
    return null;
  }
  final Double totalSize=averageRowSize * rowCount;
  final Double splitCount=totalSize / maxSplitSize;
  return splitCount.intValue();
}
