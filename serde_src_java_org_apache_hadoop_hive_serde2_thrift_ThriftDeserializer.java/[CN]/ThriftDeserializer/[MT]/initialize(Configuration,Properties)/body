{
  try {
    String className=tbl.getProperty(org.apache.hadoop.hive.serde.Constants.SERIALIZATION_CLASS);
    Class<?> recordClass=job.getClassByName(className);
    String protoName=tbl.getProperty(org.apache.hadoop.hive.serde.Constants.SERIALIZATION_FORMAT);
    if (protoName == null) {
      protoName="TBinaryProtocol";
    }
    protoName=protoName.replace("com.facebook.thrift.protocol","org.apache.thrift.protocol");
    TProtocolFactory tp=TReflectionUtils.getProtocolFactoryByName(protoName);
    tsd=new ThriftByteStreamTypedSerDe(recordClass,tp,tp);
  }
 catch (  Exception e) {
    throw new SerDeException(e);
  }
}
