{
  String clsStr=HiveConf.getVar(conf,authorizationProviderConfKey);
  HiveAuthorizationProvider ret=null;
  try {
    Class<? extends HiveAuthorizationProvider> cls=null;
    if (clsStr == null || clsStr.trim().equals("")) {
      cls=DefaultHiveAuthorizationProvider.class;
    }
 else {
      Class<?> configClass=Class.forName(clsStr,true,JavaUtils.getClassLoader());
      if (nullIfOtherClass && !HiveAuthorizationProvider.class.isAssignableFrom(configClass)) {
        return null;
      }
      cls=(Class<? extends HiveAuthorizationProvider>)configClass;
    }
    if (cls != null) {
      ret=ReflectionUtils.newInstance(cls,conf);
    }
  }
 catch (  Exception e) {
    throw new HiveException(e);
  }
  ret.setAuthenticator(authenticator);
  return ret;
}
