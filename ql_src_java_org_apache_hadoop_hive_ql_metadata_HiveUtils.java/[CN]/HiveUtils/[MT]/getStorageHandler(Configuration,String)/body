{
  if (className == null) {
    return null;
  }
  try {
    Class<? extends HiveStorageHandler> handlerClass=(Class<? extends HiveStorageHandler>)Class.forName(className,true,Utilities.getSessionSpecifiedClassLoader());
    HiveStorageHandler storageHandler=ReflectionUtils.newInstance(handlerClass,conf);
    return storageHandler;
  }
 catch (  ClassNotFoundException e) {
    throw new HiveException("Error in loading storage handler." + e.getMessage(),e);
  }
}
