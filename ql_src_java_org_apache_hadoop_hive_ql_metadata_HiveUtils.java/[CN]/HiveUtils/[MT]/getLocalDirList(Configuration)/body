{
  String localDirList;
  if (LlapProxy.isDaemon()) {
    localDirList=HiveConf.getVar(conf,HiveConf.ConfVars.LLAP_DAEMON_WORK_DIRS);
    if (localDirList != null && !localDirList.isEmpty()) {
      return localDirList;
    }
  }
  if (HiveConf.getVar(conf,HiveConf.ConfVars.HIVE_EXECUTION_ENGINE).equals("tez")) {
    TezContext tezContext=(TezContext)TezContext.get();
    if (tezContext != null && tezContext.getTezProcessorContext() != null) {
      return StringUtils.arrayToString(tezContext.getTezProcessorContext().getWorkDirs());
    }
  }
  return null;
}
