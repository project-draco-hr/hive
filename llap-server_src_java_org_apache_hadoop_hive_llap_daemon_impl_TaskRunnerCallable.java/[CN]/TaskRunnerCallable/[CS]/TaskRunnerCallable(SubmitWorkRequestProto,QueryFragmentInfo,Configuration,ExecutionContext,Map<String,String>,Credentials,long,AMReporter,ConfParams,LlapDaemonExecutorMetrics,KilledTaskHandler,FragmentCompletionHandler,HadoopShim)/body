{
  this.request=request;
  this.fragmentInfo=fragmentInfo;
  this.conf=conf;
  this.executionContext=executionContext;
  this.envMap=envMap;
  this.objectRegistry=new ObjectRegistryImpl();
  this.credentials=credentials;
  this.memoryAvailable=memoryAvailable;
  this.confParams=confParams;
  this.jobToken=TokenCache.getSessionToken(credentials);
  this.taskSpec=Converters.getTaskSpecfromProto(request.getFragmentSpec());
  this.amReporter=amReporter;
  this.amReporter.registerTask(request.getAmHost(),request.getAmPort(),request.getUser(),jobToken,fragmentInfo.getQueryInfo().getQueryIdentifier());
  this.metrics=metrics;
  this.requestId=request.getFragmentSpec().getFragmentIdentifierString();
  this.queryId=request.getFragmentSpec().getDagName();
  this.killedTaskHandler=killedTaskHandler;
  this.fragmentCompletionHanler=fragmentCompleteHandler;
  this.tezHadoopShim=tezHadoopShim;
}
