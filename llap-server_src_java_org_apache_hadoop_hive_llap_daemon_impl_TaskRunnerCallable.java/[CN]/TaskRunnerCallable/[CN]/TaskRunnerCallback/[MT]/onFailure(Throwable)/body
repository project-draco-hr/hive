{
  LOG.error("TezTaskRunner execution failed for : " + getTaskIdentifierString(request),t);
  isCompleted.set(true);
  fragmentCompletionHanler.fragmentComplete(fragmentInfo);
  taskRunnerCallable.shutdown();
  HistoryLogger.logFragmentEnd(request.getApplicationIdString(),request.getContainerIdString(),executionContext.getHostName(),request.getFragmentSpec().getDagName(),request.getFragmentSpec().getVertexName(),request.getFragmentSpec().getFragmentNumber(),request.getFragmentSpec().getAttemptNumber(),taskRunnerCallable.threadName,taskRunnerCallable.startTime,false);
  if (metrics != null) {
    metrics.decrExecutorNumQueuedRequests();
  }
}
