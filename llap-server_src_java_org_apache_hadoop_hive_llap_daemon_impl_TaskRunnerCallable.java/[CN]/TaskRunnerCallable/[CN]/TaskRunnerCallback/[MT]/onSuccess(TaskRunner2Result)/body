{
switch (result.getEndReason()) {
case SUCCESS:
    LOG.info("Successfully finished {}",requestId);
  metrics.incrExecutorTotalSuccess();
break;
case CONTAINER_STOP_REQUESTED:
LOG.warn("Unexpected CONTAINER_STOP_REQUEST for {}",requestId);
break;
case KILL_REQUESTED:
break;
case COMMUNICATION_FAILURE:
LOG.info("Failed to run {} due to communication failure",requestId);
metrics.incrExecutorTotalExecutionFailed();
break;
case TASK_ERROR:
LOG.info("Failed to run {} due to task error",requestId);
metrics.incrExecutorTotalExecutionFailed();
break;
}
taskRunnerCallable.shutdown();
HistoryLogger.logFragmentEnd(request.getApplicationIdString(),request.getContainerIdString(),executionContext.getHostName(),request.getFragmentSpec().getDagName(),request.getFragmentSpec().getVertexName(),request.getFragmentSpec().getFragmentNumber(),request.getFragmentSpec().getAttemptNumber(),taskRunnerCallable.threadName,taskRunnerCallable.startTime,true);
metrics.decrExecutorNumQueuedRequests();
}
