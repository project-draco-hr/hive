{
  MutatorClient client=new MutatorClientBuilder().addSinkTable(databaseName,tableName,createPartitions).metaStoreUri(metaStoreUri).build();
  Transaction transaction=client.newTransaction();
  List<AcidTable> tables=client.getTables();
  transaction.begin();
  BucketIdResolver bucketIdResolver=mutatorFactory.newBucketIdResolver(tables.get(0).getTotalBuckets());
  record1=bucketIdResolver.attachBucketIdToRecord(record1);
  MutatorCoordinator coordinator=new MutatorCoordinatorBuilder().metaStoreUri(metaStoreUri).table(tables.get(0)).mutatorFactory(mutatorFactory).build();
  coordinator.insert(partitionValues1,record1);
  coordinator.update(partitionValues2,record2);
  coordinator.delete(partitionValues3,record3);
  coordinator.close();
  transaction.commit();
  client.close();
}
