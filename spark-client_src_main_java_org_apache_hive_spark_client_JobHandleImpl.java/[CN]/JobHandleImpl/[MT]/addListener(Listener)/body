{
synchronized (listeners) {
    listeners.add(l);
    if (state.ordinal() >= State.CANCELLED.ordinal()) {
      for (      Integer i : sparkJobIds) {
        l.onSparkJobStarted(this,i);
      }
    }
    fireStateChange(state,l);
    if (state.ordinal() < State.CANCELLED.ordinal()) {
      for (      Integer i : sparkJobIds) {
        l.onSparkJobStarted(this,i);
      }
    }
  }
}
