{
  ExprNodeGenericFuncDesc gfDesc=null;
  if (!deep) {
    return null;
  }
  List<ExprNodeDesc> args=new LinkedList<ExprNodeDesc>();
  for (  RexNode operand : call.operands) {
    args.add(operand.accept(this));
  }
  if (call.isA(SqlKind.CAST) && (call.operands.size() == 1) && SqlTypeUtil.equalSansNullability(dTFactory,call.getType(),call.operands.get(0).getType())) {
    return args.get(0);
  }
 else {
    GenericUDF hiveUdf=SqlFunctionConverter.getHiveUDF(call.getOperator(),call.getType(),args.size());
    if (hiveUdf == null) {
      throw new RuntimeException("Cannot find UDF for " + call.getType() + " "+ call.getOperator()+ "["+ call.getOperator().getKind()+ "]/"+ args.size());
    }
    try {
      gfDesc=ExprNodeGenericFuncDesc.newInstance(hiveUdf,args);
    }
 catch (    UDFArgumentException e) {
      LOG.error(e);
      throw new RuntimeException(e);
    }
  }
  return gfDesc;
}
