{
  if (valueMap.size() != table.getPartitionKeys().size()) {
    throw new HCatException(ErrorType.ERROR_INVALID_PARTITION_VALUES,"Table " + table.getTableName() + " has "+ table.getPartitionKeys().size()+ " partition keys, got "+ valueMap.size());
  }
  List<String> values=new ArrayList<String>();
  for (  FieldSchema schema : table.getPartitionKeys()) {
    String value=valueMap.get(schema.getName().toLowerCase());
    if (value == null) {
      throw new HCatException(ErrorType.ERROR_MISSING_PARTITION_KEY,"Key " + schema.getName() + " of table "+ table.getTableName());
    }
    values.add(value);
  }
  return values;
}
