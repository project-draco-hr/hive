{
  LOG.info("deleting  " + f);
  HadoopShims hadoopShim=ShimLoader.getHadoopShims();
  boolean skipTrash=HiveConf.getBoolVar(conf,HiveConf.ConfVars.HIVE_WAREHOUSE_DATA_SKIPTRASH);
  try {
    if (skipTrash) {
      LOG.info("Not moving" + f + " to trash due to configuration "+ HiveConf.ConfVars.HIVE_WAREHOUSE_DATA_SKIPTRASH+ " is set to true.");
    }
 else     if (hadoopShim.moveToAppropriateTrash(fs,f,conf)) {
      LOG.info("Moved to trash: " + f);
      return true;
    }
    if (fs.delete(f,true)) {
      LOG.info("Deleted the diretory " + f);
      return true;
    }
    if (fs.exists(f)) {
      throw new MetaException("Unable to delete directory: " + f);
    }
  }
 catch (  FileNotFoundException e) {
    return true;
  }
catch (  Exception e) {
    Warehouse.closeFs(fs);
    MetaStoreUtils.logAndThrowMetaException(e);
  }
  return false;
}
