{
  LOG.info("deleting  " + f);
  Configuration dupConf=new Configuration(conf);
  FileSystem.setDefaultUri(dupConf,fs.getUri());
  try {
    Trash trashTmp=new Trash(dupConf);
    if (trashTmp.moveToTrash(f)) {
      LOG.info("Moved to trash: " + f);
      return true;
    }
    if (fs.delete(f,true)) {
      LOG.info("Deleted the diretory " + f);
      return true;
    }
    if (fs.exists(f)) {
      throw new MetaException("Unable to delete directory: " + f);
    }
  }
 catch (  FileNotFoundException e) {
    return true;
  }
catch (  Exception e) {
    Warehouse.closeFs(fs);
    MetaStoreUtils.logAndThrowMetaException(e);
  }
  return false;
}
