{
switch (fieldOI.getPrimitiveCategory()) {
case BINARY:
    if (schema.getType() == Type.BYTES) {
      ByteBuffer bb=ByteBuffer.wrap((byte[])fieldOI.getPrimitiveJavaObject(structFieldData));
      return bb.rewind();
    }
 else     if (schema.getType() == Type.FIXED) {
      Fixed fixed=new GenericData.Fixed(schema,(byte[])fieldOI.getPrimitiveJavaObject(structFieldData));
      return fixed;
    }
 else {
      throw new AvroSerdeException("Unexpected Avro schema for Binary TypeInfo: " + schema.getType());
    }
case UNKNOWN:
  throw new AvroSerdeException("Received UNKNOWN primitive category.");
case VOID:
return null;
default :
return fieldOI.getPrimitiveJavaObject(structFieldData);
}
}
