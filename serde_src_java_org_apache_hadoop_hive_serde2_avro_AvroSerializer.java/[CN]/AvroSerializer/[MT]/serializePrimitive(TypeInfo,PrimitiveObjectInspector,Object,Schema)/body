{
switch (fieldOI.getPrimitiveCategory()) {
case BINARY:
    if (schema.getType() == Type.BYTES) {
      return AvroSerdeUtils.getBufferFromBytes((byte[])fieldOI.getPrimitiveJavaObject(structFieldData));
    }
 else     if (schema.getType() == Type.FIXED) {
      Fixed fixed=new GenericData.Fixed(schema,(byte[])fieldOI.getPrimitiveJavaObject(structFieldData));
      return fixed;
    }
 else {
      throw new AvroSerdeException("Unexpected Avro schema for Binary TypeInfo: " + schema.getType());
    }
case DECIMAL:
  HiveDecimal dec=(HiveDecimal)fieldOI.getPrimitiveJavaObject(structFieldData);
return AvroSerdeUtils.getBufferFromDecimal(dec,((DecimalTypeInfo)typeInfo).scale());
case CHAR:
HiveChar ch=(HiveChar)fieldOI.getPrimitiveJavaObject(structFieldData);
return ch.getStrippedValue();
case VARCHAR:
HiveVarchar vc=(HiveVarchar)fieldOI.getPrimitiveJavaObject(structFieldData);
return vc.getValue();
case DATE:
Date date=((DateObjectInspector)fieldOI).getPrimitiveJavaObject(structFieldData);
return DateWritable.dateToDays(date);
case UNKNOWN:
throw new AvroSerdeException("Received UNKNOWN primitive category.");
case VOID:
return null;
default :
return fieldOI.getPrimitiveJavaObject(structFieldData);
}
}
