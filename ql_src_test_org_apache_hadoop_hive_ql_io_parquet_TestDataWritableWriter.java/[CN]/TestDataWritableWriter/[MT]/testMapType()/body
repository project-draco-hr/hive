{
  String columnNames="mapCol";
  String columnTypes="map<string,int>";
  String fileSchema="message hive_schema {\n" + "  optional group mapCol (MAP) {\n" + "    repeated group map (MAP_KEY_VALUE) {\n"+ "      required binary key;\n"+ "      optional int32 value;\n"+ "    }\n"+ "  }\n"+ "}\n";
  ArrayWritable hiveRecord=createGroup(createGroup(createArray(createString("key1"),createInt(1)),createArray(createString("key2"),createInt(2)),createArray(createString("key3"),createNull())));
  writeParquetRecord(fileSchema,getParquetWritable(columnNames,columnTypes,hiveRecord));
  startMessage();
  startField("mapCol",0);
  startGroup();
  startField("map",0);
  startGroup();
  startField("key",0);
  addString("key1");
  endField("key",0);
  startField("value",1);
  addInteger(1);
  endField("value",1);
  endGroup();
  startGroup();
  startField("key",0);
  addString("key2");
  endField("key",0);
  startField("value",1);
  addInteger(2);
  endField("value",1);
  endGroup();
  startGroup();
  startField("key",0);
  addString("key3");
  endField("key",0);
  endGroup();
  endField("map",0);
  endGroup();
  endField("mapCol",0);
  endMessage();
}
