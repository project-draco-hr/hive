{
  String schemaStr="message hive_schema {\n" + "  optional group mapCol (MAP) {\n" + "    repeated group map (MAP_KEY_VALUE) {\n"+ "      required binary key;\n"+ "      optional group value {\n"+ "        required int32 value;"+ "      }\n"+ "    }\n"+ "  }\n"+ "}\n";
  ArrayWritable hiveRecord=createGroup(createGroup(createArray(createGroup(createString("key1"),createInt(1)))));
  try {
    writeParquetRecord(schemaStr,hiveRecord);
    fail();
  }
 catch (  RuntimeException e) {
    assertEquals("Parquet record is malformed: Field value is not an ArrayWritable object: " + "optional group value {\n  required int32 value;\n}",e.getMessage());
  }
}
