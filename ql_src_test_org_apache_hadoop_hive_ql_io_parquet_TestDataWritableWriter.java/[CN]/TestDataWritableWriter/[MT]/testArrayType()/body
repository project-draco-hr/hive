{
  String schemaStr="message hive_schema {\n" + "  optional group arrayCol (LIST) {\n" + "    repeated group bag {\n"+ "      optional int32 array_element;\n"+ "    }\n"+ "  }\n"+ "}\n";
  ArrayWritable hiveRecord=createGroup(createGroup(createArray(createInt(1),createNull(),createInt(2))));
  writeParquetRecord(schemaStr,hiveRecord);
  startMessage();
  startField("arrayCol",0);
  startGroup();
  startField("bag",0);
  startGroup();
  startField("array_element",0);
  addInteger(1);
  endField("array_element",0);
  endGroup();
  startGroup();
  endGroup();
  startGroup();
  startField("array_element",0);
  addInteger(2);
  endField("array_element",0);
  endGroup();
  endField("bag",0);
  endGroup();
  endField("arrayCol",0);
  endMessage();
}
