{
  String tblLoc=null;
  String inputFormattCls=null;
  String outputFormattCls=null;
  if (part != null) {
    if (par != null) {
      if (par.getLocation() != null) {
        tblLoc=par.getDataLocation().toString();
      }
      inputFormattCls=par.getInputFormatClass().getName();
      outputFormattCls=par.getOutputFormatClass().getName();
    }
  }
 else {
    if (tbl.getPath() != null) {
      tblLoc=tbl.getDataLocation().toString();
    }
    inputFormattCls=tbl.getInputFormatClass().getName();
    outputFormattCls=tbl.getOutputFormatClass().getName();
  }
  MapBuilder builder=MapBuilder.create();
  builder.put("tableName",tbl.getTableName());
  builder.put("owner",tbl.getOwner());
  builder.put("location",tblLoc);
  builder.put("inputFormat",inputFormattCls);
  builder.put("outputFormat",outputFormattCls);
  builder.put("columns",makeColsUnformatted(tbl.getCols()));
  builder.put("partitioned",tbl.isPartitioned());
  if (tbl.isPartitioned())   builder.put("partitionColumns",makeColsUnformatted(tbl.getPartCols()));
  putFileSystemsStats(builder,makeTableStatusLocations(tbl,db,par),conf,tbl.getPath());
  return builder.build();
}
