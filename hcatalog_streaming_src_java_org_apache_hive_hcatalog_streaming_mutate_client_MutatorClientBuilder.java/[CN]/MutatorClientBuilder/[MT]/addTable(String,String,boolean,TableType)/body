{
  if (databaseName == null) {
    throw new IllegalArgumentException("Database cannot be null");
  }
  if (tableName == null) {
    throw new IllegalArgumentException("Table cannot be null");
  }
  String key=(databaseName + "." + tableName).toUpperCase();
  AcidTable previous=tables.get(key);
  if (previous != null) {
    if (tableType == TableType.SINK && previous.getTableType() != TableType.SINK) {
      tables.remove(key);
    }
 else {
      throw new IllegalArgumentException("Table has already been added: " + databaseName + "."+ tableName);
    }
  }
  Table table=new Table();
  table.setDbName(databaseName);
  table.setTableName(tableName);
  tables.put(key,new AcidTable(databaseName,tableName,createPartitions,tableType));
}
