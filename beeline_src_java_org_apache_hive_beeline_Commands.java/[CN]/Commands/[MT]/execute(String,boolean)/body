{
  if (line == null || line.length() == 0) {
    return false;
  }
  try {
    while (!(line.trim().endsWith(";"))) {
      StringBuilder prompt=new StringBuilder(beeLine.getPrompt());
      for (int i=0; i < prompt.length() - 1; i++) {
        if (prompt.charAt(i) != '>') {
          prompt.setCharAt(i,i % 2 == 0 ? '.' : ' ');
        }
      }
      String extra=beeLine.getConsoleReader().readLine(prompt.toString());
      if (!beeLine.isComment(extra)) {
        line+=" " + extra;
      }
    }
  }
 catch (  Exception e) {
    beeLine.handleException(e);
  }
  if (line.endsWith(";")) {
    line=line.substring(0,line.length() - 1);
  }
  if (!(beeLine.assertConnection())) {
    return false;
  }
  String sql=line;
  if (sql.startsWith(BeeLine.COMMAND_PREFIX)) {
    sql=sql.substring(1);
  }
  String prefix=call ? "call" : "sql";
  if (sql.startsWith(prefix)) {
    sql=sql.substring(prefix.length());
  }
  if (beeLine.getBatch() != null) {
    beeLine.getBatch().add(sql);
    return true;
  }
  try {
    Statement stmnt=null;
    boolean hasResults;
    try {
      long start=System.currentTimeMillis();
      if (call) {
        stmnt=beeLine.getDatabaseConnection().getConnection().prepareCall(sql);
        hasResults=((CallableStatement)stmnt).execute();
      }
 else {
        stmnt=beeLine.createStatement();
        hasResults=stmnt.execute(sql);
      }
      beeLine.showWarnings();
      if (hasResults) {
        do {
          ResultSet rs=stmnt.getResultSet();
          try {
            int count=beeLine.print(rs);
            long end=System.currentTimeMillis();
            beeLine.info(beeLine.loc("rows-selected",count) + " " + beeLine.locElapsedTime(end - start));
          }
  finally {
            rs.close();
          }
        }
 while (BeeLine.getMoreResults(stmnt));
      }
 else {
        int count=stmnt.getUpdateCount();
        long end=System.currentTimeMillis();
        beeLine.info(beeLine.loc("rows-affected",count) + " " + beeLine.locElapsedTime(end - start));
      }
    }
 catch (    Exception e) {
      beeLine.error(e);
      throw e;
    }
 finally {
      if (stmnt != null) {
        stmnt.close();
      }
    }
  }
 catch (  Exception e) {
    return beeLine.error(e);
  }
  beeLine.showWarnings();
  return true;
}
