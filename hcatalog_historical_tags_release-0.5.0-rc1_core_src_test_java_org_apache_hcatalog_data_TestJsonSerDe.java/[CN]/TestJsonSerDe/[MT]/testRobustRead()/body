{
  Configuration conf=new Configuration();
  for (  Pair<Properties,HCatRecord> e : getData()) {
    Properties tblProps=e.first;
    HCatRecord r=e.second;
    Properties internalTblProps=new Properties();
    for (    Map.Entry pe : tblProps.entrySet()) {
      if (!pe.getKey().equals(serdeConstants.LIST_COLUMNS)) {
        internalTblProps.put(pe.getKey(),pe.getValue());
      }
 else {
        internalTblProps.put(pe.getKey(),getInternalNames((String)pe.getValue()));
      }
    }
    LOG.info("orig tbl props:{}",tblProps);
    LOG.info("modif tbl props:{}",internalTblProps);
    JsonSerDe wjsd=new JsonSerDe();
    wjsd.initialize(conf,internalTblProps);
    JsonSerDe rjsd=new JsonSerDe();
    rjsd.initialize(conf,tblProps);
    LOG.info("ORIG:{}",r);
    Writable s=wjsd.serialize(r,wjsd.getObjectInspector());
    LOG.info("ONE:{}",s);
    Object o1=wjsd.deserialize(s);
    LOG.info("deserialized ONE : {} ",o1);
    Object o2=rjsd.deserialize(s);
    LOG.info("deserialized TWO : {} ",o2);
    assertTrue(HCatDataCheckUtil.recordsEqual(r,(HCatRecord)o2));
  }
}
