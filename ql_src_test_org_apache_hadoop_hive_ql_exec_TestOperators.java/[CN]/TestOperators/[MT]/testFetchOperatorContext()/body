{
  HiveConf conf=new HiveConf();
  conf.set("hive.support.concurrency","false");
  SessionState.start(conf);
  String cmd="create table fetchOp (id int, name string) " + "partitioned by (state string) " + "row format delimited fields terminated by '|' "+ "stored as "+ "inputformat 'org.apache.hadoop.hive.ql.exec.TestOperators$CustomInFmt' "+ "outputformat 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' "+ "tblproperties ('myprop1'='val1', 'myprop2' = 'val2')";
  Driver driver=new Driver();
  driver.init();
  CommandProcessorResponse response=driver.run(cmd);
  assertEquals(0,response.getResponseCode());
  List<Object> result=new ArrayList<Object>();
  cmd="load data local inpath '../data/files/employee.dat' " + "overwrite into table fetchOp partition (state='CA')";
  driver.init();
  response=driver.run(cmd);
  assertEquals(0,response.getResponseCode());
  cmd="load data local inpath '../data/files/employee2.dat' " + "overwrite into table fetchOp partition (state='OR')";
  driver.init();
  response=driver.run(cmd);
  assertEquals(0,response.getResponseCode());
  cmd="select * from fetchOp";
  driver.init();
  driver.setMaxRows(500);
  response=driver.run(cmd);
  assertEquals(0,response.getResponseCode());
  driver.getResults(result);
  assertEquals(20,result.size());
  driver.close();
}
