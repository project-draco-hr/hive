{
  this.hconf=hconf;
  JoinDesc desc=joinOp.getConf();
  skewKeyDefinition=desc.getSkewKeyDefinition();
  skewKeysTableObjectInspector=new HashMap<Byte,StructObjectInspector>(numAliases);
  tblDesc=desc.getSkewKeysValuesTables();
  tblSerializers=new HashMap<Byte,SerDe>(numAliases);
  bigKeysExistingMap=new HashMap<Byte,Boolean>(numAliases);
  taskId=Utilities.getTaskId(hconf);
  int[][] filterMap=desc.getFilterMap();
  for (int i=0; i < numAliases; i++) {
    Byte alias=conf.getTagOrder()[i];
    List<ObjectInspector> skewTableKeyInspectors=new ArrayList<ObjectInspector>();
    StructObjectInspector soi=(StructObjectInspector)joinOp.inputObjInspectors[alias];
    StructField sf=soi.getStructFieldRef(Utilities.ReduceField.KEY.toString());
    List<? extends StructField> keyFields=((StructObjectInspector)sf.getFieldObjectInspector()).getAllStructFieldRefs();
    int keyFieldSize=keyFields.size();
    for (int k=0; k < keyFieldSize; k++) {
      skewTableKeyInspectors.add(keyFields.get(k).getFieldObjectInspector());
    }
    TableDesc joinKeyDesc=desc.getKeyTableDesc();
    List<String> keyColNames=Utilities.getColumnNames(joinKeyDesc.getProperties());
    StructObjectInspector structTblKeyInpector=ObjectInspectorFactory.getStandardStructObjectInspector(keyColNames,skewTableKeyInspectors);
    try {
      SerDe serializer=(SerDe)ReflectionUtils.newInstance(tblDesc.get(alias).getDeserializerClass(),null);
      serializer.initialize(null,tblDesc.get(alias).getProperties());
      tblSerializers.put((byte)i,serializer);
    }
 catch (    SerDeException e) {
      LOG.error("Skewjoin will be disabled due to " + e.getMessage(),e);
      joinOp.handleSkewJoin=false;
      break;
    }
    boolean hasFilter=filterMap != null && filterMap[i] != null;
    TableDesc valTblDesc=JoinUtil.getSpillTableDesc(alias,joinOp.spillTableDesc,conf,!hasFilter);
    List<String> valColNames=new ArrayList<String>();
    if (valTblDesc != null) {
      valColNames=Utilities.getColumnNames(valTblDesc.getProperties());
    }
    StructObjectInspector structTblValInpector=ObjectInspectorFactory.getStandardStructObjectInspector(valColNames,joinOp.joinValuesStandardObjectInspectors.get((byte)i));
    StructObjectInspector structTblInpector=ObjectInspectorFactory.getUnionStructObjectInspector(Arrays.asList(new StructObjectInspector[]{structTblValInpector,structTblKeyInpector}));
    skewKeysTableObjectInspector.put((byte)i,structTblInpector);
  }
  for (int i=0; i < numAliases; i++) {
    Byte alias=conf.getTagOrder()[i];
    RowContainer<ArrayList<Object>> rc=(RowContainer)joinOp.storage.get(Byte.valueOf((byte)i));
    if (rc != null) {
      rc.setSerDe(tblSerializers.get((byte)i),skewKeysTableObjectInspector.get((byte)i));
      rc.setTableDesc(tblDesc.get(alias));
    }
  }
}
