{
  Properties props=new Properties();
  StringBuffer columnsBuffer=new StringBuffer();
  StringBuffer typesBuffer=new StringBuffer();
  boolean isFirst=true;
  for (  FieldDesc colDesc : schema.getColumns()) {
    if (!isFirst) {
      columnsBuffer.append(',');
      typesBuffer.append(',');
    }
    columnsBuffer.append(colDesc.getName());
    typesBuffer.append(colDesc.getTypeDesc().toString());
    isFirst=false;
  }
  String columns=columnsBuffer.toString();
  String types=typesBuffer.toString();
  props.put(serdeConstants.LIST_COLUMNS,columns);
  props.put(serdeConstants.LIST_COLUMN_TYPES,types);
  props.put(serdeConstants.ESCAPE_CHAR,"\\");
  SerDe serde=new LazySimpleSerDe();
  serde.initialize(conf,props);
  return serde;
}
