{
  String planFileName=null;
  String jobConfFileName=null;
  boolean noLog=false;
  String files=null;
  boolean localtask=false;
  try {
    for (int i=0; i < args.length; i++) {
      if (args[i].equals("-plan")) {
        planFileName=args[++i];
      }
 else       if (args[i].equals("-jobconffile")) {
        jobConfFileName=args[++i];
      }
 else       if (args[i].equals("-nolog")) {
        noLog=true;
      }
 else       if (args[i].equals("-files")) {
        files=args[++i];
      }
 else       if (args[i].equals("-localtask")) {
        localtask=true;
      }
    }
  }
 catch (  IndexOutOfBoundsException e) {
    System.err.println("Missing argument to option");
    printUsage();
  }
  JobConf conf;
  if (localtask) {
    conf=new JobConf(MapredLocalTask.class);
  }
 else {
    conf=new JobConf(ExecDriver.class);
  }
  if (jobConfFileName != null) {
    conf.addResource(new Path(jobConfFileName));
  }
  if (files != null) {
    conf.set("tmpfiles",files);
  }
  if (UserGroupInformation.isSecurityEnabled()) {
    String hadoopAuthToken=System.getenv(UserGroupInformation.HADOOP_TOKEN_FILE_LOCATION);
    if (hadoopAuthToken != null) {
      conf.set("mapreduce.job.credentials.binary",hadoopAuthToken);
    }
  }
  boolean isSilent=HiveConf.getBoolVar(conf,HiveConf.ConfVars.HIVESESSIONSILENT);
  String queryId=HiveConf.getVar(conf,HiveConf.ConfVars.HIVEQUERYID,"").trim();
  if (queryId.isEmpty()) {
    queryId="unknown-" + System.currentTimeMillis();
  }
  System.setProperty(HiveConf.ConfVars.HIVEQUERYID.toString(),queryId);
  if (noLog) {
    org.apache.logging.log4j.Logger logger=org.apache.logging.log4j.LogManager.getRootLogger();
    NullAppender appender=NullAppender.createNullAppender();
    appender.addToLogger(logger.getName(),Level.ERROR);
    appender.start();
  }
 else {
    setupChildLog4j(conf);
  }
  Logger LOG=LoggerFactory.getLogger(ExecDriver.class.getName());
  LogHelper console=new LogHelper(LOG,isSilent);
  if (planFileName == null) {
    console.printError("Must specify Plan File Name");
    printUsage();
  }
  for (  Appender appender : ((org.apache.logging.log4j.core.Logger)LogManager.getRootLogger()).getAppenders().values()) {
    if (appender instanceof FileAppender) {
      console.printInfo("Execution log at: " + ((FileAppender)appender).getFileName());
    }
 else     if (appender instanceof RollingFileAppender) {
      console.printInfo("Execution log at: " + ((RollingFileAppender)appender).getFileName());
    }
  }
  Path p=new Path(planFileName);
  FileSystem fs=FileSystem.getLocal(conf);
  InputStream pathData=fs.open(p);
  String auxJars=HiveConf.getVar(conf,HiveConf.ConfVars.HIVEAUXJARS);
  String addedJars=HiveConf.getVar(conf,HiveConf.ConfVars.HIVEADDEDJARS);
  try {
    ClassLoader loader=conf.getClassLoader();
    if (StringUtils.isNotBlank(auxJars)) {
      loader=Utilities.addToClassPath(loader,StringUtils.split(auxJars,","));
    }
    if (StringUtils.isNotBlank(addedJars)) {
      loader=Utilities.addToClassPath(loader,StringUtils.split(addedJars,","));
    }
    conf.setClassLoader(loader);
    Thread.currentThread().setContextClassLoader(loader);
  }
 catch (  Exception e) {
    throw new HiveException(e.getMessage(),e);
  }
  int ret;
  if (localtask) {
    memoryMXBean=ManagementFactory.getMemoryMXBean();
    MapredLocalWork plan=Utilities.deserializePlan(pathData,MapredLocalWork.class,conf);
    MapredLocalTask ed=new MapredLocalTask(plan,conf,isSilent);
    ret=ed.executeInProcess(new DriverContext());
  }
 else {
    MapredWork plan=Utilities.deserializePlan(pathData,MapredWork.class,conf);
    ExecDriver ed=new ExecDriver(plan,conf,isSilent);
    ret=ed.execute(new DriverContext());
  }
  if (ret != 0) {
    System.exit(ret);
  }
}
