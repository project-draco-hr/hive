{
  Map<String,ArrayList<String>> pa=work.getMapWork().getPathToAliases();
  if (pa != null) {
    List<Operator<? extends OperatorDesc>> opList=new ArrayList<Operator<? extends OperatorDesc>>();
    if (work.getReduceWork() != null) {
      opList.add(work.getReduceWork().getReducer());
    }
    for (    List<String> ls : pa.values()) {
      for (      String a : ls) {
        opList.add(work.getMapWork().getAliasToWork().get(a));
        while (!opList.isEmpty()) {
          Operator<? extends OperatorDesc> op=opList.remove(0);
          if (op instanceof FileSinkOperator) {
            FileSinkDesc fdesc=((FileSinkOperator)op).getConf();
            String tempDir=fdesc.getDirName();
            if (tempDir != null) {
              Path tempPath=Utilities.toTempPath(new Path(tempDir));
              LOG.info("Making Temp Directory: " + tempDir);
              FileSystem fs=tempPath.getFileSystem(job);
              fs.mkdirs(tempPath);
            }
          }
          if (op.getChildOperators() != null) {
            opList.addAll(op.getChildOperators());
          }
        }
      }
    }
  }
}
