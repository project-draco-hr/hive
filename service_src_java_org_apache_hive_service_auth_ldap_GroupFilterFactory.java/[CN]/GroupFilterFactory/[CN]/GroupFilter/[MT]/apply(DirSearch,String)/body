{
  LOG.info("Authenticating user '{}' using group membership",user);
  List<String> memberOf=null;
  try {
    String userDn=ldap.findUserDn(user);
    memberOf=ldap.findGroupsForUser(userDn);
    LOG.debug("User {} member of : {}",userDn,memberOf);
  }
 catch (  NamingException e) {
    throw new AuthenticationException("LDAP Authentication failed for user",e);
  }
  for (  String groupDn : memberOf) {
    String shortName=LdapUtils.getShortName(groupDn);
    if (groupFilter.contains(shortName)) {
      LOG.info("Authentication succeeded based on group membership");
      return;
    }
  }
  LOG.info("Authentication failed based on user membership");
  throw new AuthenticationException("Authentication failed: " + "User not a member of specified list");
}
