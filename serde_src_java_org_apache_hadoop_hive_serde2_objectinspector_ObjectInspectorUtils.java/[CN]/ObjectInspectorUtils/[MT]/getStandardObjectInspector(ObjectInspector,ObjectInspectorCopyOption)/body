{
  ObjectInspector result=null;
switch (oi.getCategory()) {
case PRIMITIVE:
{
      PrimitiveObjectInspector poi=(PrimitiveObjectInspector)oi;
switch (objectInspectorOption) {
case KEEP:
{
          result=poi;
          break;
        }
case JAVA:
{
        result=PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(poi.getPrimitiveCategory());
        break;
      }
case WRITABLE:
{
      result=PrimitiveObjectInspectorFactory.getPrimitiveWritableObjectInspector(poi.getPrimitiveCategory());
      break;
    }
}
break;
}
case LIST:
{
ListObjectInspector loi=(ListObjectInspector)oi;
result=ObjectInspectorFactory.getStandardListObjectInspector(loi.getListElementObjectInspector());
break;
}
case MAP:
{
MapObjectInspector moi=(MapObjectInspector)oi;
result=ObjectInspectorFactory.getStandardMapObjectInspector(moi.getMapKeyObjectInspector(),moi.getMapValueObjectInspector());
break;
}
case STRUCT:
{
StructObjectInspector soi=(StructObjectInspector)oi;
List<? extends StructField> fields=soi.getAllStructFieldRefs();
List<String> fieldNames=new ArrayList<String>(fields.size());
List<ObjectInspector> fieldObjectInspectors=new ArrayList<ObjectInspector>(fields.size());
for (StructField f : fields) {
fieldNames.add(f.getFieldName());
fieldObjectInspectors.add(f.getFieldObjectInspector());
}
result=ObjectInspectorFactory.getStandardStructObjectInspector(fieldNames,fieldObjectInspectors);
break;
}
default :
{
throw new RuntimeException("Unknown ObjectInspector category!");
}
}
return result;
}
