{
  ObjectInspector result=null;
switch (oi.getCategory()) {
case PRIMITIVE:
{
      PrimitiveObjectInspector poi=(PrimitiveObjectInspector)oi;
switch (objectInspectorOption) {
case KEEP:
{
          result=poi;
          break;
        }
case JAVA:
{
        result=PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(poi.getPrimitiveCategory());
        break;
      }
case WRITABLE:
{
      result=PrimitiveObjectInspectorFactory.getPrimitiveWritableObjectInspector(poi.getPrimitiveCategory());
      break;
    }
}
break;
}
case LIST:
{
ListObjectInspector loi=(ListObjectInspector)oi;
result=ObjectInspectorFactory.getStandardListObjectInspector(getStandardObjectInspector(loi.getListElementObjectInspector(),objectInspectorOption));
break;
}
case MAP:
{
MapObjectInspector moi=(MapObjectInspector)oi;
result=ObjectInspectorFactory.getStandardMapObjectInspector(getStandardObjectInspector(moi.getMapKeyObjectInspector(),objectInspectorOption),getStandardObjectInspector(moi.getMapValueObjectInspector(),objectInspectorOption));
break;
}
case STRUCT:
{
StructObjectInspector soi=(StructObjectInspector)oi;
List<? extends StructField> fields=soi.getAllStructFieldRefs();
List<String> fieldNames=new ArrayList<String>(fields.size());
List<ObjectInspector> fieldObjectInspectors=new ArrayList<ObjectInspector>(fields.size());
for (StructField f : fields) {
fieldNames.add(f.getFieldName());
fieldObjectInspectors.add(getStandardObjectInspector(f.getFieldObjectInspector(),objectInspectorOption));
}
result=ObjectInspectorFactory.getStandardStructObjectInspector(fieldNames,fieldObjectInspectors);
break;
}
default :
{
throw new RuntimeException("Unknown ObjectInspector category!");
}
}
return result;
}
