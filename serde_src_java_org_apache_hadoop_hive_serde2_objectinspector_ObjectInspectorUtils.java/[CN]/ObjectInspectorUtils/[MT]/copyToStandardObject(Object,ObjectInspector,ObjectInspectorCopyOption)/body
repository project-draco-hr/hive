{
  if (o == null) {
    return null;
  }
  Object result=null;
switch (oi.getCategory()) {
case PRIMITIVE:
{
      PrimitiveObjectInspector loi=(PrimitiveObjectInspector)oi;
switch (objectInspectorOption) {
case DEFAULT:
{
          if (loi.preferWritable()) {
            result=loi.getPrimitiveWritableObject(loi.copyObject(o));
          }
 else {
            result=loi.getPrimitiveJavaObject(o);
          }
          break;
        }
case JAVA:
{
        result=loi.getPrimitiveJavaObject(o);
        break;
      }
case WRITABLE:
{
      result=loi.getPrimitiveWritableObject(loi.copyObject(o));
      break;
    }
}
break;
}
case LIST:
{
ListObjectInspector loi=(ListObjectInspector)oi;
int length=loi.getListLength(o);
ArrayList<Object> list=new ArrayList<Object>(length);
for (int i=0; i < length; i++) {
list.add(copyToStandardObject(loi.getListElement(o,i),loi.getListElementObjectInspector(),objectInspectorOption));
}
result=list;
break;
}
case MAP:
{
MapObjectInspector moi=(MapObjectInspector)oi;
HashMap<Object,Object> map=new HashMap<Object,Object>();
Map<? extends Object,? extends Object> omap=moi.getMap(o);
for (Map.Entry<? extends Object,? extends Object> entry : omap.entrySet()) {
map.put(copyToStandardObject(entry.getKey(),moi.getMapKeyObjectInspector(),objectInspectorOption),copyToStandardObject(entry.getValue(),moi.getMapValueObjectInspector(),objectInspectorOption));
}
result=map;
break;
}
case STRUCT:
{
StructObjectInspector soi=(StructObjectInspector)oi;
List<? extends StructField> fields=soi.getAllStructFieldRefs();
ArrayList<Object> struct=new ArrayList<Object>(fields.size());
for (StructField f : fields) {
struct.add(copyToStandardObject(soi.getStructFieldData(o,f),f.getFieldObjectInspector(),objectInspectorOption));
}
result=struct;
break;
}
default :
{
throw new RuntimeException("Unknown ObjectInspector category!");
}
}
return result;
}
