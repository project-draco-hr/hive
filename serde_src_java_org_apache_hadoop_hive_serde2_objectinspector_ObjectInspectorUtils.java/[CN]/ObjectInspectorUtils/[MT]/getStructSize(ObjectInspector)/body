{
  if (oi.getCategory() != Category.STRUCT) {
    throw new SerDeException("Unexpected category " + oi.getCategory());
  }
  return ((StructObjectInspector)oi).getAllStructFieldRefs().size();
}
