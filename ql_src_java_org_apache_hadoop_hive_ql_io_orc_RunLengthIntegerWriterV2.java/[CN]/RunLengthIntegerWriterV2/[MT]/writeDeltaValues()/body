{
  int len=0;
  int fb=bitsDeltaMax;
  int efb=0;
  if (isFixedDelta) {
    if (fixedRunLength > MIN_REPEAT) {
      len=fixedRunLength - 1;
      fixedRunLength=0;
    }
 else {
      len=variableRunLength - 1;
      variableRunLength=0;
    }
  }
 else {
    if (fb == 1) {
      fb=2;
    }
    efb=SerializationUtils.encodeBitWidth(fb);
    efb=efb << 1;
    len=variableRunLength - 1;
    variableRunLength=0;
  }
  int tailBits=(len & 0x100) >>> 8;
  int headerFirstByte=getOpcode() | efb | tailBits;
  int headerSecondByte=len & 0xff;
  output.write(headerFirstByte);
  output.write(headerSecondByte);
  if (signed) {
    SerializationUtils.writeVslong(output,literals[0]);
  }
 else {
    SerializationUtils.writeVulong(output,literals[0]);
  }
  if (isFixedDelta) {
    SerializationUtils.writeVslong(output,fixedDelta);
  }
 else {
    SerializationUtils.writeVslong(output,adjDeltas[0]);
    SerializationUtils.writeInts(adjDeltas,1,adjDeltas.length - 1,fb,output);
  }
}
