{
  long startTime=System.currentTimeMillis();
  System.out.println(">>> STARTED " + testName);
  File scriptFile=File.createTempFile(testName,"temp");
  scriptFile.deleteOnExit();
  PrintStream os=new PrintStream(new FileOutputStream(scriptFile));
  os.print(scriptText);
  os.close();
  if (shouldMatch) {
    try {
      String output=testCommandLineScript(scriptFile.getAbsolutePath());
      long elapsedTime=(System.currentTimeMillis() - startTime) / 1000;
      String time="(" + elapsedTime + "s)";
      if (output.contains(expectedPattern)) {
        System.out.println(">>> PASSED " + testName + " "+ time);
      }
 else {
        System.err.println("Output: " + output);
        System.err.println(">>> FAILED " + testName + " (ERROR) "+ time);
        Assert.fail(testName);
      }
    }
 catch (    Throwable e) {
      e.printStackTrace();
      throw e;
    }
  }
 else {
    try {
      String output=testCommandLineScript(scriptFile.getAbsolutePath());
      long elapsedTime=(System.currentTimeMillis() - startTime) / 1000;
      String time="(" + elapsedTime + "s)";
      if (output.contains(expectedPattern)) {
        System.err.println("Output: " + output);
        System.err.println(">>> FAILED " + testName + " (ERROR) "+ time);
        Assert.fail(testName);
      }
 else {
        System.out.println(">>> PASSED " + testName + " "+ time);
      }
    }
 catch (    Throwable e) {
      System.err.println("Exception: " + e.toString());
      e.printStackTrace();
      throw e;
    }
  }
  scriptFile.delete();
}
