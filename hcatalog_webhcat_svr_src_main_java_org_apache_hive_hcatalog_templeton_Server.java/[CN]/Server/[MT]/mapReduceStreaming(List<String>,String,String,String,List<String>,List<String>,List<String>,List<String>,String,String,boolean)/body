{
  verifyUser();
  verifyParam(inputs,"input");
  verifyParam(mapper,"mapper");
  verifyParam(reducer,"reducer");
  Map<String,Object> userArgs=new HashMap<String,Object>();
  userArgs.put("user.name",getDoAsUser());
  userArgs.put("input",inputs);
  userArgs.put("output",output);
  userArgs.put("mapper",mapper);
  userArgs.put("reducer",reducer);
  userArgs.put("files",files);
  userArgs.put("define",defines);
  userArgs.put("cmdenv",cmdenvs);
  userArgs.put("arg",args);
  userArgs.put("statusdir",statusdir);
  userArgs.put("callback",callback);
  userArgs.put("enablelog",Boolean.toString(enablelog));
  checkEnableLogPrerequisite(enablelog,statusdir);
  StreamingDelegator d=new StreamingDelegator(appConf);
  return d.run(getDoAsUser(),userArgs,inputs,output,mapper,reducer,files,defines,cmdenvs,args,statusdir,callback,getCompletedUrl(),enablelog,JobType.STREAMING);
}
