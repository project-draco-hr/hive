{
  if (theSecurityContext == null) {
    return null;
  }
  String userName=null;
  if (theSecurityContext.getUserPrincipal() == null) {
    userName=Main.UserNameHandler.getUserName(request);
  }
 else {
    userName=theSecurityContext.getUserPrincipal().getName();
  }
  if (userName == null) {
    return null;
  }
  return UserGroupInformation.createRemoteUser(userName).getShortUserName();
}
