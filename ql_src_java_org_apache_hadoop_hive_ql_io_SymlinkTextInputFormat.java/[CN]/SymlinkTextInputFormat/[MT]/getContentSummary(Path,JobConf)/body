{
  long[] summary={0,0,0};
  List<Path> targetPaths=new ArrayList<Path>();
  List<Path> symlinkPaths=new ArrayList<Path>();
  try {
    getTargetPathsFromSymlinksDirs(job,new Path[]{p},targetPaths,symlinkPaths);
  }
 catch (  Exception e) {
    throw new IOException("Error parsing symlinks from specified job input path.",e);
  }
  for (  Path path : targetPaths) {
    FileSystem fs=path.getFileSystem(job);
    ContentSummary cs=fs.getContentSummary(path);
    summary[0]+=cs.getLength();
    summary[1]+=cs.getFileCount();
    summary[2]+=cs.getDirectoryCount();
  }
  return new ContentSummary(summary[0],summary[1],summary[2]);
}
