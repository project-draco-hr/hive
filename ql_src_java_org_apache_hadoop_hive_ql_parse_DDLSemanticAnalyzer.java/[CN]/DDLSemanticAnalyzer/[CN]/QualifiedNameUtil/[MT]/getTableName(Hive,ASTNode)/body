{
  String tableName=null;
  String fullyQualifiedName=getFullyQualifiedName(ast);
  String attemptTableName=getAttemptTableName(db,fullyQualifiedName,false);
  if (attemptTableName != null) {
    return attemptTableName;
  }
  if (fullyQualifiedName.split(delimiter).length == 3) {
    if (ast.getChildCount() == 2) {
      throw new SemanticException(ErrorMsg.INVALID_TABLE_OR_COLUMN.getMsg(fullyQualifiedName));
    }
 else {
      tableName=fullyQualifiedName.substring(0,fullyQualifiedName.lastIndexOf('.'));
    }
  }
 else   if (fullyQualifiedName.split(delimiter).length == 2) {
    tableName=fullyQualifiedName;
  }
 else {
    throw new SemanticException(ErrorMsg.INVALID_TABLE.getMsg(fullyQualifiedName));
  }
  return tableName;
}
