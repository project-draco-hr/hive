{
  String tblName=getUnescapedName((ASTNode)ast.getChild(0));
  String newComment=null;
  String newType=null;
  newType=getTypeStringFromAST((ASTNode)ast.getChild(3));
  boolean first=false;
  String flagCol=null;
  ASTNode positionNode=null;
  if (ast.getChildCount() == 6) {
    newComment=unescapeSQLString(ast.getChild(4).getText());
    positionNode=(ASTNode)ast.getChild(5);
  }
 else   if (ast.getChildCount() == 5) {
    if (ast.getChild(4).getType() == HiveParser.StringLiteral) {
      newComment=unescapeSQLString(ast.getChild(4).getText());
    }
 else {
      positionNode=(ASTNode)ast.getChild(4);
    }
  }
  if (positionNode != null) {
    if (positionNode.getChildCount() == 0) {
      first=true;
    }
 else {
      flagCol=unescapeIdentifier(positionNode.getChild(0).getText());
    }
  }
  String oldColName=ast.getChild(1).getText();
  String newColName=ast.getChild(2).getText();
  Table tab=null;
  try {
    tab=db.getTable(tblName);
  }
 catch (  HiveException e) {
    throw new SemanticException(ErrorMsg.INVALID_TABLE.getMsg(tblName),e);
  }
  SkewedInfo skewInfo=tab.getTTable().getSd().getSkewedInfo();
  if ((null != skewInfo) && (null != skewInfo.getSkewedColNames()) && skewInfo.getSkewedColNames().contains(oldColName)) {
    throw new SemanticException(oldColName + ErrorMsg.ALTER_TABLE_NOT_ALLOWED_RENAME_SKEWED_COLUMN.getMsg());
  }
  AlterTableDesc alterTblDesc=new AlterTableDesc(tblName,unescapeIdentifier(oldColName),unescapeIdentifier(newColName),newType,newComment,first,flagCol);
  addInputsOutputsAlterTable(tblName,null,alterTblDesc);
  rootTasks.add(TaskFactory.get(new DDLWork(getInputs(),getOutputs(),alterTblDesc),conf));
}
