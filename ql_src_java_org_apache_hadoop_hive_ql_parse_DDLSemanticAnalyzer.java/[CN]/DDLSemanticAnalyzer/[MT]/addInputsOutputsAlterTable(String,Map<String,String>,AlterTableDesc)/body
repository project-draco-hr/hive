{
  Table tab=getTable(tableName,true);
  WriteEntity.WriteType writeType=desc == null ? WriteEntity.WriteType.DDL_EXCLUSIVE : WriteEntity.determineAlterTableWriteType(desc.getOp());
  if (partSpec == null || partSpec.isEmpty()) {
    inputs.add(new ReadEntity(tab));
    outputs.add(new WriteEntity(tab,writeType));
  }
 else {
    ReadEntity re=new ReadEntity(tab);
    re.noLockNeeded();
    inputs.add(re);
    if (desc == null || desc.getOp() != AlterTableDesc.AlterTableTypes.ALTERPROTECTMODE) {
      Partition part=getPartition(tab,partSpec,true);
      outputs.add(new WriteEntity(part,writeType));
    }
 else {
      for (      Partition part : getPartitions(tab,partSpec,true)) {
        outputs.add(new WriteEntity(part,writeType));
      }
    }
  }
  if (desc != null) {
    validateAlterTableType(tab,desc.getOp(),desc.getExpectView());
    if (desc.getOp() == AlterTableDesc.AlterTableTypes.DROPPROPS && desc.getIsDropIfExists() == false) {
      Iterator<String> keyItr=desc.getProps().keySet().iterator();
      while (keyItr.hasNext()) {
        String currKey=keyItr.next();
        if (tab.getTTable().getParameters().containsKey(currKey) == false) {
          String errorMsg="The following property " + currKey + " does not exist in "+ tab.getTableName();
          throw new SemanticException(ErrorMsg.ALTER_TBL_UNSET_NON_EXIST_PROPERTY.getMsg(errorMsg));
        }
      }
    }
  }
}
