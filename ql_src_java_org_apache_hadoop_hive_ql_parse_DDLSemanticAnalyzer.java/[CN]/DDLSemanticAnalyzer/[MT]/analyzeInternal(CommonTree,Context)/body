{
  this.ctx=ctx;
  if (ast.getToken().getType() == HiveParser.TOK_CREATETABLE)   analyzeCreateTable(ast,false);
 else   if (ast.getToken().getType() == HiveParser.TOK_CREATEEXTTABLE)   analyzeCreateTable(ast,true);
 else   if (ast.getToken().getType() == HiveParser.TOK_DROPTABLE)   analyzeDropTable(ast);
 else   if (ast.getToken().getType() == HiveParser.TOK_DESCTABLE) {
    ctx.setResFile(new Path(getTmpFileName()));
    analyzeDescribeTable(ast);
  }
 else   if (ast.getToken().getType() == HiveParser.TOK_SHOWTABLES) {
    ctx.setResFile(new Path(getTmpFileName()));
    analyzeShowTables(ast);
  }
 else   if (ast.getToken().getType() == HiveParser.TOK_ALTERTABLE_RENAME)   analyzeAlterTableRename(ast);
 else   if (ast.getToken().getType() == HiveParser.TOK_ALTERTABLE_ADDCOLS)   analyzeAlterTableModifyCols(ast,alterTableTypes.ADDCOLS);
 else   if (ast.getToken().getType() == HiveParser.TOK_ALTERTABLE_REPLACECOLS)   analyzeAlterTableModifyCols(ast,alterTableTypes.REPLACECOLS);
 else   if (ast.getToken().getType() == HiveParser.TOK_ALTERTABLE_DROPPARTS)   analyzeAlterTableDropParts(ast);
 else   if (ast.getToken().getType() == HiveParser.TOK_ALTERTABLE_PROPERTIES)   analyzeAlterTableProps(ast);
 else   if (ast.getToken().getType() == HiveParser.TOK_ALTERTABLE_SERDEPROPERTIES)   analyzeAlterTableSerdeProps(ast);
 else   if (ast.getToken().getType() == HiveParser.TOK_ALTERTABLE_SERIALIZER)   analyzeAlterTableSerde(ast);
 else   if (ast.getToken().getType() == HiveParser.TOK_SHOWPARTITIONS) {
    ctx.setResFile(new Path(getTmpFileName()));
    analyzeShowPartitions(ast);
  }
 else {
    throw new SemanticException("Unsupported command.");
  }
}
