{
  Map<String,String> newPartSpec=extractPartitionSpecs((ASTNode)ast.getChild(0));
  if (newPartSpec == null) {
    throw new SemanticException("RENAME PARTITION Missing Destination" + ast);
  }
  Table tab=null;
  try {
    tab=db.getTable(db.getCurrentDatabase(),tblName,false);
    if (tab != null) {
      inputs.add(new ReadEntity(tab));
    }
 else {
      throw new SemanticException(ErrorMsg.INVALID_TABLE.getMsg(tblName));
    }
  }
 catch (  HiveException e) {
    throw new SemanticException(ErrorMsg.INVALID_TABLE.getMsg(tblName));
  }
  validateAlterTableType(tab,AlterTableTypes.RENAMEPARTITION);
  List<Map<String,String>> partSpecs=new ArrayList<Map<String,String>>();
  partSpecs.add(oldPartSpec);
  partSpecs.add(newPartSpec);
  addTablePartsOutputs(tblName,partSpecs);
  RenamePartitionDesc renamePartitionDesc=new RenamePartitionDesc(db.getCurrentDatabase(),tblName,oldPartSpec,newPartSpec);
  rootTasks.add(TaskFactory.get(new DDLWork(getInputs(),getOutputs(),renamePartitionDesc),conf));
}
