{
  AlterTableDesc alterTblDesc=new AlterTableDesc(AlterTableTypes.ALTERPROTECTMODE);
  alterTblDesc.setOldName(tableName);
  alterTblDesc.setPartSpec(partSpec);
  ASTNode child=(ASTNode)ast.getChild(0);
switch (child.getToken().getType()) {
case HiveParser.TOK_ENABLE:
    alterTblDesc.setProtectModeEnable(true);
  break;
case HiveParser.TOK_DISABLE:
alterTblDesc.setProtectModeEnable(false);
break;
default :
throw new SemanticException("Set Protect mode Syntax parsing error.");
}
ASTNode grandChild=(ASTNode)child.getChild(0);
switch (grandChild.getToken().getType()) {
case HiveParser.TOK_OFFLINE:
alterTblDesc.setProtectModeType(AlterTableDesc.ProtectModeType.OFFLINE);
break;
case HiveParser.TOK_NO_DROP:
alterTblDesc.setProtectModeType(AlterTableDesc.ProtectModeType.NO_DROP);
break;
case HiveParser.TOK_READONLY:
throw new SemanticException("Potect mode READONLY is not implemented");
default :
throw new SemanticException("Only protect mode NO_DROP or OFFLINE supported");
}
try {
Table tab=db.getTable(MetaStoreUtils.DEFAULT_DATABASE_NAME,tableName,false);
if (tab != null) {
inputs.add(new ReadEntity(tab));
outputs.add(new WriteEntity(tab));
}
}
 catch (HiveException e) {
throw new SemanticException(ErrorMsg.INVALID_TABLE.getMsg(tableName));
}
rootTasks.add(TaskFactory.get(new DDLWork(getInputs(),getOutputs(),alterTblDesc),conf));
}
