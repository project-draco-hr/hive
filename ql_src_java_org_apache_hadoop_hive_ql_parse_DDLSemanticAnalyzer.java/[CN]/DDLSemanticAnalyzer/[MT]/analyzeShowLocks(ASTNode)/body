{
  String tableName=null;
  HashMap<String,String> partSpec=null;
  boolean isExtended=false;
  if (ast.getChildCount() >= 1) {
    ASTNode tableTypeExpr=(ASTNode)ast.getChild(0);
    tableName=getFullyQualifiedName((ASTNode)tableTypeExpr.getChild(0));
    if (tableTypeExpr.getChildCount() == 2) {
      ASTNode partspec=(ASTNode)tableTypeExpr.getChild(1);
      partSpec=getPartSpec(partspec);
    }
    if (ast.getChildCount() >= 2) {
      isExtended=(ast.getChild(1).getType() == HiveParser.KW_EXTENDED);
    }
  }
  ShowLocksDesc showLocksDesc=new ShowLocksDesc(ctx.getResFile(),tableName,partSpec,isExtended);
  rootTasks.add(TaskFactory.get(new DDLWork(getInputs(),getOutputs(),showLocksDesc),conf));
  setFetchTask(createFetchTask(showLocksDesc.getSchema()));
  ctx.setNeedLockMgr(true);
}
