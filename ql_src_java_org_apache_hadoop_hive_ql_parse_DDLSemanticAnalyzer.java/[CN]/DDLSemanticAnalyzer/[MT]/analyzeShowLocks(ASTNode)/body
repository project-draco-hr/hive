{
  String tableName=null;
  HashMap<String,String> partSpec=null;
  boolean isExtended=false;
  if (ast.getChildCount() >= 1) {
    for (int i=0; i < ast.getChildCount(); i++) {
      ASTNode child=(ASTNode)ast.getChild(i);
      if (child.getType() == HiveParser.TOK_TABTYPE) {
        ASTNode tableTypeExpr=(ASTNode)child;
        tableName=QualifiedNameUtil.getFullyQualifiedName((ASTNode)tableTypeExpr.getChild(0));
        if (tableTypeExpr.getChildCount() == 2) {
          ASTNode partspec=(ASTNode)tableTypeExpr.getChild(1);
          partSpec=getPartSpec(partspec);
        }
      }
 else       if (child.getType() == HiveParser.KW_EXTENDED) {
        isExtended=true;
      }
    }
  }
  ShowLocksDesc showLocksDesc=new ShowLocksDesc(ctx.getResFile(),tableName,partSpec,isExtended);
  rootTasks.add(TaskFactory.get(new DDLWork(getInputs(),getOutputs(),showLocksDesc),conf));
  setFetchTask(createFetchTask(showLocksDesc.getSchema()));
  ctx.setNeedLockMgr(true);
}
