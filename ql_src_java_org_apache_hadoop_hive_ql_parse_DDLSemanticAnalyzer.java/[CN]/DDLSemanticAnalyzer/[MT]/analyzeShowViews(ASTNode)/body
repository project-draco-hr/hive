{
  ShowTablesDesc showViewsDesc;
  String dbName=SessionState.get().getCurrentDatabase();
  String viewNames=null;
  if (ast.getChildCount() > 3) {
    throw new SemanticException(ErrorMsg.GENERIC_ERROR.getMsg());
  }
switch (ast.getChildCount()) {
case 1:
    viewNames=unescapeSQLString(ast.getChild(0).getText());
  showViewsDesc=new ShowTablesDesc(ctx.getResFile(),dbName,viewNames,TableType.VIRTUAL_VIEW);
break;
case 2:
assert(ast.getChild(0).getType() == HiveParser.TOK_FROM);
dbName=unescapeIdentifier(ast.getChild(1).getText());
validateDatabase(dbName);
showViewsDesc=new ShowTablesDesc(ctx.getResFile(),dbName);
showViewsDesc.setType(TableType.VIRTUAL_VIEW);
break;
case 3:
assert(ast.getChild(0).getType() == HiveParser.TOK_FROM);
dbName=unescapeIdentifier(ast.getChild(1).getText());
viewNames=unescapeSQLString(ast.getChild(2).getText());
validateDatabase(dbName);
showViewsDesc=new ShowTablesDesc(ctx.getResFile(),dbName,viewNames,TableType.VIRTUAL_VIEW);
break;
default :
showViewsDesc=new ShowTablesDesc(ctx.getResFile(),dbName);
showViewsDesc.setType(TableType.VIRTUAL_VIEW);
break;
}
rootTasks.add(TaskFactory.get(new DDLWork(getInputs(),getOutputs(),showViewsDesc),conf));
setFetchTask(createFetchTask(showViewsDesc.getSchema()));
}
