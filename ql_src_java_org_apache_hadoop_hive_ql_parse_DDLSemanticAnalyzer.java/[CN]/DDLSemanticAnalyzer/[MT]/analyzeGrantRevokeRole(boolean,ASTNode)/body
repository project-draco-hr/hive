{
  List<PrincipalDesc> principalDesc=analyzePrincipalListDef((ASTNode)ast.getChild(0));
  int rolesStartPos=1;
  ASTNode wAdminOption=(ASTNode)ast.getChild(1);
  if (wAdminOption.getToken().getType() == HiveParser.TOK_GRANT_WITH_ADMIN_OPTION) {
    rolesStartPos=2;
  }
  List<String> roles=new ArrayList<String>();
  for (int i=rolesStartPos; i < ast.getChildCount(); i++) {
    roles.add(unescapeIdentifier(ast.getChild(i).getText()));
  }
  String roleOwnerName="";
  if (SessionState.get() != null && SessionState.get().getAuthenticator() != null) {
    roleOwnerName=SessionState.get().getAuthenticator().getUserName();
  }
  GrantRevokeRoleDDL grantRevokeRoleDDL=new GrantRevokeRoleDDL(grant,roles,principalDesc,roleOwnerName,PrincipalType.USER,true);
  rootTasks.add(TaskFactory.get(new DDLWork(getInputs(),getOutputs(),grantRevokeRoleDDL),conf));
}
