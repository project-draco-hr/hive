{
  String tblName=getUnescapedName((ASTNode)ast.getChild(0));
  List<Map<String,String>> partSpecs=getPartitionSpecs(ast);
  DropTableDesc dropTblDesc=new DropTableDesc(tblName,partSpecs);
  try {
    Table tab=db.getTable(db.getCurrentDatabase(),tblName,false);
    if (tab != null) {
      inputs.add(new ReadEntity(tab));
    }
  }
 catch (  HiveException e) {
    throw new SemanticException(ErrorMsg.INVALID_TABLE.getMsg(tblName));
  }
  if (partSpecs != null) {
    boolean ifExists=(ast.getFirstChildWithType(TOK_IFEXISTS) != null);
    boolean throwException=!ifExists && !HiveConf.getBoolVar(conf,ConfVars.DROPIGNORESNONEXISTENT);
    addTablePartsOutputs(tblName,partSpecs,throwException,ast);
  }
  rootTasks.add(TaskFactory.get(new DDLWork(getInputs(),getOutputs(),dropTblDesc),conf));
}
