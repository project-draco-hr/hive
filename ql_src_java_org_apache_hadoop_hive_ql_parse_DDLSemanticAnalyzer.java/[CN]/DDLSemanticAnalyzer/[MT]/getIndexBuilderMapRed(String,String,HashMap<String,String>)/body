{
  try {
    String dbName=db.getCurrentDatabase();
    Index index=db.getIndex(dbName,baseTableName,indexName);
    Table indexTbl=getTable(index.getIndexTableName());
    String baseTblName=index.getOrigTableName();
    Table baseTbl=getTable(baseTblName);
    String handlerCls=index.getIndexHandlerClass();
    HiveIndexHandler handler=HiveUtils.getIndexHandler(conf,handlerCls);
    List<Partition> indexTblPartitions=null;
    List<Partition> baseTblPartitions=null;
    if (indexTbl != null) {
      indexTblPartitions=new ArrayList<Partition>();
      baseTblPartitions=preparePartitions(baseTbl,partSpec,indexTbl,db,indexTblPartitions);
    }
    List<Task<?>> ret=handler.generateIndexBuildTaskList(baseTbl,index,indexTblPartitions,baseTblPartitions,indexTbl,getInputs(),getOutputs());
    return ret;
  }
 catch (  Exception e) {
    throw new SemanticException(e);
  }
}
