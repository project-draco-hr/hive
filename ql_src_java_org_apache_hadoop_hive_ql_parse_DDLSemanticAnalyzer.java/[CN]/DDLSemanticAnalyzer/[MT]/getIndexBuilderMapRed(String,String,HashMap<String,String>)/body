{
  try {
    Index index=db.getIndex(MetaStoreUtils.DEFAULT_DATABASE_NAME,baseTableName,indexName);
    Table indexTbl=db.getTable(MetaStoreUtils.DEFAULT_DATABASE_NAME,index.getIndexTableName());
    String baseTblName=index.getOrigTableName();
    Table baseTbl=db.getTable(MetaStoreUtils.DEFAULT_DATABASE_NAME,baseTblName);
    String handlerCls=index.getIndexHandlerClass();
    HiveIndexHandler handler=HiveUtils.getIndexHandler(conf,handlerCls);
    List<Partition> indexTblPartitions=null;
    List<Partition> baseTblPartitions=null;
    if (indexTbl != null) {
      indexTblPartitions=new ArrayList<Partition>();
      baseTblPartitions=preparePartitions(baseTbl,partSpec,indexTbl,db,indexTblPartitions);
    }
    List<Task<?>> ret=handler.generateIndexBuildTaskList(baseTbl,index,indexTblPartitions,baseTblPartitions,indexTbl,db);
    return ret;
  }
 catch (  Exception e) {
    throw new SemanticException(e);
  }
}
