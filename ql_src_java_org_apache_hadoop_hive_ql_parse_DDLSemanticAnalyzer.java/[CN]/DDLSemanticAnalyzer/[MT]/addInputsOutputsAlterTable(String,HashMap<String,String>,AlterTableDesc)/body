{
  Table tab=null;
  try {
    tab=db.getTable(db.getCurrentDatabase(),tableName,true);
    inputs.add(new ReadEntity(tab));
    if ((partSpec == null) || (partSpec.isEmpty())) {
      outputs.add(new WriteEntity(tab));
    }
 else {
      Partition part=db.getPartition(tab,partSpec,false);
      if (part != null) {
        outputs.add(new WriteEntity(part));
      }
    }
  }
 catch (  HiveException e) {
    throw new SemanticException(ErrorMsg.INVALID_TABLE.getMsg(tableName));
  }
  if (desc != null) {
    validateAlterTableType(tab,desc.getOp(),desc.getExpectView());
  }
}
