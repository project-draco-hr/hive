{
  Table tab=null;
  try {
    tab=db.getTable(db.getCurrentDatabase(),tableName,true);
  }
 catch (  HiveException e) {
    throw new SemanticException(ErrorMsg.INVALID_TABLE.getMsg(tableName));
  }
  inputs.add(new ReadEntity(tab));
  if ((partSpec == null) || (partSpec.isEmpty())) {
    outputs.add(new WriteEntity(tab));
  }
 else {
    List<Partition> allPartitions=null;
    try {
      if (desc == null || desc.getOp() != AlterTableDesc.AlterTableTypes.ALTERPROTECTMODE) {
        Partition part=db.getPartition(tab,partSpec,false);
        allPartitions=new ArrayList<Partition>(1);
        allPartitions.add(part);
      }
 else {
        allPartitions=db.getPartitions(tab,partSpec);
        if (allPartitions == null || allPartitions.size() == 0) {
          throw new SemanticException(ErrorMsg.INVALID_PARTITION.getMsg(partSpec.toString()));
        }
      }
    }
 catch (    HiveException e) {
      throw new SemanticException(ErrorMsg.INVALID_PARTITION.getMsg(partSpec.toString()),e);
    }
    if (allPartitions != null) {
      for (      Partition part : allPartitions) {
        outputs.add(new WriteEntity(part));
      }
    }
  }
  if (desc != null) {
    validateAlterTableType(tab,desc.getOp(),desc.getExpectView());
  }
}
