{
  ASTNode tableTypeExpr=(ASTNode)ast.getChild(0);
  String qualifiedName=QualifiedNameUtil.getFullyQualifiedName((ASTNode)tableTypeExpr.getChild(0));
  String tableName=QualifiedNameUtil.getTableName(db,(ASTNode)(tableTypeExpr.getChild(0)));
  String dbName=QualifiedNameUtil.getDBName(db,(ASTNode)(tableTypeExpr.getChild(0)));
  Map<String,String> partSpec=QualifiedNameUtil.getPartitionSpec(db,tableTypeExpr,tableName);
  String colPath=QualifiedNameUtil.getColPath(db,tableTypeExpr,(ASTNode)tableTypeExpr.getChild(0),qualifiedName,partSpec);
  if (dbName != null) {
    validateDatabase(dbName);
  }
  if (partSpec != null) {
    validateTable(tableName,partSpec);
  }
  DescTableDesc descTblDesc=new DescTableDesc(ctx.getResFile(),tableName,partSpec,colPath);
  boolean showColStats=false;
  if (ast.getChildCount() == 2) {
    int descOptions=ast.getChild(1).getType();
    descTblDesc.setFormatted(descOptions == HiveParser.KW_FORMATTED);
    descTblDesc.setExt(descOptions == HiveParser.KW_EXTENDED);
    descTblDesc.setPretty(descOptions == HiveParser.KW_PRETTY);
    if (!colPath.equalsIgnoreCase(tableName) && descTblDesc.isFormatted()) {
      showColStats=true;
    }
  }
  inputs.add(new ReadEntity(getTable(tableName)));
  Task ddlTask=TaskFactory.get(new DDLWork(getInputs(),getOutputs(),descTblDesc),conf);
  rootTasks.add(ddlTask);
  String schema=DescTableDesc.getSchema(showColStats);
  setFetchTask(createFetchTask(schema));
  LOG.info("analyzeDescribeTable done");
}
