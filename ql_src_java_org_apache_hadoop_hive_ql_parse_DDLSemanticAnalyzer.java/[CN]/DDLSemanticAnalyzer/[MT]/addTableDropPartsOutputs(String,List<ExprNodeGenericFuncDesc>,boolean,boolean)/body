{
  Table tab=getTable(tblName);
  Iterator<ExprNodeGenericFuncDesc> i=partSpecs.iterator();
  while (i.hasNext()) {
    ExprNodeGenericFuncDesc partSpec=i.next();
    List<Partition> parts=new ArrayList<Partition>();
    boolean hasUnknown=false;
    try {
      hasUnknown=db.getPartitionsByExpr(tab,partSpec,conf,parts);
    }
 catch (    Exception e) {
      throw new SemanticException(ErrorMsg.INVALID_PARTITION.getMsg(partSpec.getExprString()),e);
    }
    if (hasUnknown) {
      throw new SemanticException("Unexpected unknown partitions for " + partSpec.getExprString());
    }
    if (parts.isEmpty()) {
      if (throwIfNonExistent) {
        throw new SemanticException(ErrorMsg.INVALID_PARTITION.getMsg(partSpec.getExprString()));
      }
    }
    for (    Partition p : parts) {
      if (!ignoreProtection && !p.canDrop()) {
        throw new SemanticException(ErrorMsg.DROP_COMMAND_NOT_ALLOWED_FOR_PARTITION.getMsg(p.getCompleteName()));
      }
      outputs.add(new WriteEntity(p));
    }
  }
}
