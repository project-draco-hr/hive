{
  String tblName=getUnescapedName((ASTNode)ast.getChild(0));
  Table tab=getTable(tblName,true);
  List<ExprNodeGenericFuncDesc> partSpecs=new ArrayList<ExprNodeGenericFuncDesc>();
  List<List<String>> names=new ArrayList<List<String>>();
  getFullPartitionSpecs(ast,tab,partSpecs,names);
  validateAlterTableType(tab,AlterTableTypes.DROPPARTITION,expectView);
  inputs.add(new ReadEntity(tab));
  boolean ignoreProtection=(ast.getFirstChildWithType(HiveParser.TOK_IGNOREPROTECTION) != null);
  if (partSpecs != null) {
    boolean ifExists=(ast.getFirstChildWithType(HiveParser.TOK_IFEXISTS) != null);
    boolean throwException=!ifExists && !HiveConf.getBoolVar(conf,ConfVars.DROPIGNORESNONEXISTENT);
    addTableDropPartsOutputs(tblName,partSpecs,throwException,ignoreProtection);
  }
  DropTableDesc dropTblDesc=new DropTableDesc(tblName,partSpecs,names,expectView,ignoreProtection);
  rootTasks.add(TaskFactory.get(new DDLWork(getInputs(),getOutputs(),dropTblDesc),conf));
}
