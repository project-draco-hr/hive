{
  String tableName=getUnescapedName((ASTNode)ast.getChild(0));
  boolean ifExists=(ast.getFirstChildWithType(HiveParser.TOK_IFEXISTS) != null);
  boolean throwException=!ifExists && !HiveConf.getBoolVar(conf,ConfVars.DROPIGNORESNONEXISTENT);
  ReplicationSpec replicationSpec=new ReplicationSpec(ast);
  Table tab=getTable(tableName,throwException);
  if (tab != null) {
    inputs.add(new ReadEntity(tab));
    outputs.add(new WriteEntity(tab,WriteEntity.WriteType.DDL_EXCLUSIVE));
  }
  boolean ifPurge=(ast.getFirstChildWithType(HiveParser.KW_PURGE) != null);
  DropTableDesc dropTblDesc=new DropTableDesc(tableName,expectedType,ifExists,ifPurge,replicationSpec);
  rootTasks.add(TaskFactory.get(new DDLWork(getInputs(),getOutputs(),dropTblDesc),conf));
}
