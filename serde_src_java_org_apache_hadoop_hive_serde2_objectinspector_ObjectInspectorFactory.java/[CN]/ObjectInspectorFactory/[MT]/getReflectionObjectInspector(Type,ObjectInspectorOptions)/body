{
  ObjectInspector oi=objectInspectorCache.get(t);
  if (oi == null) {
    oi=getReflectionObjectInspectorNoCache(t,options);
    objectInspectorCache.put(t,oi);
  }
  if ((options.equals(ObjectInspectorOptions.JAVA) && oi.getClass().equals(ThriftStructObjectInspector.class)) || (options.equals(ObjectInspectorOptions.THRIFT) && oi.getClass().equals(ReflectionStructObjectInspector.class))) {
    throw new RuntimeException("Cannot call getObjectInspectorByReflection with both JAVA and THRIFT !");
  }
  return oi;
}
