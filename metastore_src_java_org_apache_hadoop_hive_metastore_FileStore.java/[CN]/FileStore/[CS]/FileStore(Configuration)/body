{
  this.conf=conf;
  String msRootPath=HiveConf.getVar(conf,HiveConf.ConfVars.METASTOREDIRECTORY);
  if (msRootPath == null) {
    LOG.fatal("metastore.dir is empty in hadoop config");
    throw new RuntimeException("metastore.dir is empty in hadoop config");
  }
  try {
    msRoot_=new File(new URI(msRootPath).getPath());
  }
 catch (  URISyntaxException e) {
    throw new RuntimeException(msRootPath + " is not a valid URI");
  }
}
