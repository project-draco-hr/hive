{
  Queue<Operator<? extends Serializable>> opsToVisit=new LinkedList<Operator<? extends Serializable>>();
  Set<Operator<? extends Serializable>> opsVisited=new HashSet<Operator<? extends Serializable>>();
  opsToVisit.addAll(topOps);
  while (opsToVisit.size() != 0) {
    Operator<? extends Serializable> op=opsToVisit.remove();
    opsVisited.add(op);
    counters.put(op.getOperatorId(),op.getCounters());
    if (op.getDone()) {
      done.add(op.getOperatorId());
    }
    if (op.getChildOperators() != null) {
      for (      Operator<? extends Serializable> childOp : op.getChildOperators()) {
        if (!opsVisited.contains(childOp)) {
          opsToVisit.add(childOp);
        }
      }
    }
  }
}
