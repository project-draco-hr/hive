{
  Queue<Operator<? extends OperatorDesc>> opsToVisit=new LinkedList<Operator<? extends OperatorDesc>>();
  Set<Operator<? extends OperatorDesc>> opsVisited=new HashSet<Operator<? extends OperatorDesc>>();
  opsToVisit.addAll(topOps);
  while (opsToVisit.size() != 0) {
    Operator<? extends OperatorDesc> op=opsToVisit.remove();
    opsVisited.add(op);
    Map<String,Long> ctrs=op.getCounters();
    if (ctrs != null) {
      counters.put(op.getOperatorId(),op.getCounters());
    }
    if (op.getDone()) {
      done.add(op.getOperatorId());
    }
    if (op.getChildOperators() != null) {
      for (      Operator<? extends OperatorDesc> childOp : op.getChildOperators()) {
        if (!opsVisited.contains(childOp)) {
          opsToVisit.add(childOp);
        }
      }
    }
  }
}
