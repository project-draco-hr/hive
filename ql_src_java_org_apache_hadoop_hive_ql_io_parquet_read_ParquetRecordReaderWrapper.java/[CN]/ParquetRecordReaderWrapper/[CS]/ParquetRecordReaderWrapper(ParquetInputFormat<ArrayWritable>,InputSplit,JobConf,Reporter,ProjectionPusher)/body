{
  this.splitLen=oldSplit.getLength();
  this.projectionPusher=pusher;
  final ParquetInputSplit split=getSplit(oldSplit,oldJobConf);
  TaskAttemptID taskAttemptID=TaskAttemptID.forName(oldJobConf.get(IOConstants.MAPRED_TASK_ID));
  if (taskAttemptID == null) {
    taskAttemptID=new TaskAttemptID();
  }
  final TaskAttemptContext taskContext=ContextUtil.newTaskAttemptContext(oldJobConf,taskAttemptID);
  if (split != null) {
    try {
      realReader=newInputFormat.createRecordReader(split,taskContext);
      realReader.initialize(split,taskContext);
      if (realReader.nextKeyValue()) {
        firstRecord=true;
        valueObj=realReader.getCurrentValue();
      }
 else {
        eof=true;
      }
    }
 catch (    final InterruptedException e) {
      throw new IOException(e);
    }
  }
 else {
    realReader=null;
    eof=true;
  }
  if (valueObj == null) {
    valueObj=new ArrayWritable(Writable.class,new Writable[schemaSize]);
  }
}
