{
  HttpServletRequest httpRequest=(HttpServletRequest)request;
  if (methodsToIgnore == null) {
    methodsToIgnore=XSRF_METHODS_TO_IGNORE_DEFAULT;
  }
  if (headerName == null) {
    headerName=XSRF_HEADER_DEFAULT;
  }
  if (methodsToIgnore.contains(httpRequest.getMethod()) || httpRequest.getHeader(headerName) != null) {
    return true;
  }
 else {
    ((HttpServletResponse)response).sendError(HttpServletResponse.SC_BAD_REQUEST,"Missing Required Header for Vulnerability Protection");
    response.getWriter().println("XSRF filter denial, requests must contain header : " + headerName);
    return false;
  }
}
