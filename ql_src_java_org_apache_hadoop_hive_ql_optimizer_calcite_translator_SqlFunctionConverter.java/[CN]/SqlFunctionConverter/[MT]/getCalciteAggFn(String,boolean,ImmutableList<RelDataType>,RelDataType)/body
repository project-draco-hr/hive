{
  SqlAggFunction calciteAggFn=(SqlAggFunction)hiveToCalcite.get(hiveUdfName);
  if (calciteAggFn == null) {
    CalciteUDFInfo udfInfo=getUDFInfo(hiveUdfName,calciteArgTypes,calciteRetType);
switch (hiveUdfName.toLowerCase()) {
case "sum":
      calciteAggFn=new HiveSqlSumAggFunction(isDistinct,udfInfo.returnTypeInference,udfInfo.operandTypeInference,udfInfo.operandTypeChecker);
    break;
case "count":
  calciteAggFn=new HiveSqlCountAggFunction(isDistinct,udfInfo.returnTypeInference,udfInfo.operandTypeInference,udfInfo.operandTypeChecker);
break;
case "min":
calciteAggFn=new HiveSqlMinMaxAggFunction(udfInfo.returnTypeInference,udfInfo.operandTypeInference,udfInfo.operandTypeChecker,true);
break;
case "max":
calciteAggFn=new HiveSqlMinMaxAggFunction(udfInfo.returnTypeInference,udfInfo.operandTypeInference,udfInfo.operandTypeChecker,false);
break;
default :
calciteAggFn=new CalciteUDAF(isDistinct,udfInfo.udfName,udfInfo.returnTypeInference,udfInfo.operandTypeInference,udfInfo.operandTypeChecker);
break;
}
}
return calciteAggFn;
}
