{
  SqlAggFunction calciteAggFn=(SqlAggFunction)hiveToCalcite.get(hiveUdfName);
  if (calciteAggFn == null) {
    CalciteUDFInfo uInf=getUDFInfo(hiveUdfName,calciteArgTypes,calciteRetType);
switch (hiveUdfName.toLowerCase()) {
case "sum":
      calciteAggFn=new HiveSqlSumAggFunction(uInf.returnTypeInference,uInf.operandTypeInference,uInf.operandTypeChecker);
    break;
case "count":
  calciteAggFn=new HiveSqlCountAggFunction(uInf.returnTypeInference,uInf.operandTypeInference,uInf.operandTypeChecker);
break;
case "min":
calciteAggFn=new HiveSqlMinMaxAggFunction(uInf.returnTypeInference,uInf.operandTypeInference,uInf.operandTypeChecker,true);
break;
case "max":
calciteAggFn=new HiveSqlMinMaxAggFunction(uInf.returnTypeInference,uInf.operandTypeInference,uInf.operandTypeChecker,false);
break;
default :
calciteAggFn=new CalciteUDAF(uInf.udfName,uInf.returnTypeInference,uInf.operandTypeInference,uInf.operandTypeChecker);
break;
}
}
return calciteAggFn;
}
