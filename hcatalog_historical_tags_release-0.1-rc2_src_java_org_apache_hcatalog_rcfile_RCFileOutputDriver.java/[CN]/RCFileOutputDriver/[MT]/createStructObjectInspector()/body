{
  if (outputSchema == null) {
    throw new IOException("Invalid output schema specified");
  }
  List<ObjectInspector> fieldInspectors=new ArrayList<ObjectInspector>();
  List<String> fieldNames=new ArrayList<String>();
  for (  HCatFieldSchema hcatFieldSchema : outputSchema.getFields()) {
    TypeInfo type=TypeInfoUtils.getTypeInfoFromTypeString(hcatFieldSchema.getTypeString());
    fieldNames.add(hcatFieldSchema.getName());
    fieldInspectors.add(getObjectInspector(type));
  }
  StructObjectInspector structInspector=ObjectInspectorFactory.getStandardStructObjectInspector(fieldNames,fieldInspectors);
  return structInspector;
}
