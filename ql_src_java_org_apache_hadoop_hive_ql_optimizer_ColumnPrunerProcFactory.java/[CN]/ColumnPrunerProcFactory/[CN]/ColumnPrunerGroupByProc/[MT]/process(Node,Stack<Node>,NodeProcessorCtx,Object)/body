{
  GroupByOperator op=(GroupByOperator)nd;
  ColumnPrunerProcCtx cppCtx=(ColumnPrunerProcCtx)ctx;
  List<String> colLists=new ArrayList<String>();
  GroupByDesc conf=op.getConf();
  ArrayList<ExprNodeDesc> keys=conf.getKeys();
  for (  ExprNodeDesc key : keys) {
    colLists=Utilities.mergeUniqElems(colLists,key.getCols());
  }
  ArrayList<AggregationDesc> aggrs=conf.getAggregators();
  for (  AggregationDesc aggr : aggrs) {
    ArrayList<ExprNodeDesc> params=aggr.getParameters();
    for (    ExprNodeDesc param : params) {
      colLists=Utilities.mergeUniqElems(colLists,param.getCols());
    }
  }
  int groupingSetPosition=conf.getGroupingSetPosition();
  if (groupingSetPosition >= 0) {
    List<String> cols=cppCtx.genColLists(op);
    String groupingColumn=conf.getOutputColumnNames().get(groupingSetPosition);
    if (!cols.contains(groupingColumn)) {
      conf.getOutputColumnNames().remove(groupingSetPosition);
      if (op.getSchema() != null) {
        op.getSchema().getSignature().remove(groupingSetPosition);
      }
    }
  }
  cppCtx.getPrunedColLists().put(op,colLists);
  return null;
}
