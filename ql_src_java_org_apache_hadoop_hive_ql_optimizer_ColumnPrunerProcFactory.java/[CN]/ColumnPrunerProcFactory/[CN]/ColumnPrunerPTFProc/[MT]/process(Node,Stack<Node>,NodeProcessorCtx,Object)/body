{
  ColumnPrunerProcCtx cppCtx=(ColumnPrunerProcCtx)ctx;
  PTFOperator op=(PTFOperator)nd;
  PTFDesc conf=op.getConf();
  PartitionedTableFunctionDef funcDef=conf.getFuncDef();
  if (!conf.forWindowing() && !Noop.class.isInstance(funcDef.getTFunction())) {
    return super.process(nd,stack,cppCtx,nodeOutputs);
  }
  List<String> prunedCols=new ArrayList<String>(cppCtx.getPrunedColList(op.getChildOperators().get(0)));
  if (funcDef instanceof WindowTableFunctionDef) {
    WindowTableFunctionDef def=(WindowTableFunctionDef)funcDef;
    prunedCols=Utilities.mergeUniqElems(getWindowFunctionColumns(def),prunedCols);
  }
  List<ColumnInfo> newRS=prunedColumnsList(prunedCols,op.getSchema(),funcDef);
  op.getSchema().setSignature(new ArrayList<ColumnInfo>(newRS));
  ShapeDetails outputShape=funcDef.getStartOfChain().getInput().getOutputShape();
  cppCtx.getPrunedColLists().put(op,outputShape.getColumnNames());
  return null;
}
