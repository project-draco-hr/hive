{
  List<String> columnNames=Arrays.asList(shp.getSerdeProps().get(org.apache.hadoop.hive.serde.serdeConstants.LIST_COLUMNS).split(","));
  List<TypeInfo> columnTypes=TypeInfoUtils.getTypeInfosFromTypeString(shp.getSerdeProps().get(org.apache.hadoop.hive.serde.serdeConstants.LIST_COLUMN_TYPES));
  prunedCols=getLowerCasePrunedCols(prunedCols);
  StringBuilder cNames=new StringBuilder();
  StringBuilder cTypes=new StringBuilder();
  boolean addComma=false;
  for (int i=0; i < columnNames.size(); i++) {
    if (prunedCols.contains(columnNames.get(i))) {
      cNames.append(addComma ? "," : "");
      cTypes.append(addComma ? "," : "");
      cNames.append(columnNames.get(i));
      cTypes.append(columnTypes.get(i));
      addComma=true;
    }
  }
  shp.getSerdeProps().put(org.apache.hadoop.hive.serde.serdeConstants.LIST_COLUMNS,cNames.toString());
  shp.getSerdeProps().put(org.apache.hadoop.hive.serde.serdeConstants.LIST_COLUMN_TYPES,cTypes.toString());
}
