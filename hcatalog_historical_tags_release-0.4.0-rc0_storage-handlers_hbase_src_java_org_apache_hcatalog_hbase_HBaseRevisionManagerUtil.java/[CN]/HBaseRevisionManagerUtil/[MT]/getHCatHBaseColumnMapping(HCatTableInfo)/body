{
  HCatSchema hcatTableSchema=hcatTableInfo.getDataColumns();
  StorerInfo storeInfo=hcatTableInfo.getStorerInfo();
  String hbaseColumnMapping=storeInfo.getProperties().getProperty(HBaseConstants.PROPERTY_COLUMN_MAPPING_KEY);
  Map<String,String> hcatHbaseColMap=new HashMap<String,String>();
  List<String> columnFamilies=new ArrayList<String>();
  List<String> columnQualifiers=new ArrayList<String>();
  HBaseUtil.parseColumnMapping(hbaseColumnMapping,columnFamilies,null,columnQualifiers,null);
  for (  HCatFieldSchema column : hcatTableSchema.getFields()) {
    int fieldPos=hcatTableSchema.getPosition(column.getName());
    String colFamily=columnFamilies.get(fieldPos);
    if (colFamily.equals(HBaseSerDe.HBASE_KEY_COL) == false) {
      hcatHbaseColMap.put(column.getName(),colFamily);
    }
  }
  return hcatHbaseColMap;
}
