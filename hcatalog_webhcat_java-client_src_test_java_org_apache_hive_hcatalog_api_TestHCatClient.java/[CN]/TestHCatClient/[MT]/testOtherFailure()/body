{
  HCatClient client=HCatClient.create(new Configuration(hcatConf));
  String tableName="Temptable";
  boolean isExceptionCaught=false;
  client.dropTable(null,tableName,true);
  ArrayList<HCatFieldSchema> cols=new ArrayList<HCatFieldSchema>();
  cols.add(new HCatFieldSchema("id",Type.INT,"id columns"));
  cols.add(new HCatFieldSchema("value",Type.STRING,"id columns"));
  try {
    HCatCreateTableDesc tableDesc=HCatCreateTableDesc.create(null,tableName,cols).fileFormat("rcfile").build();
    client.createTable(tableDesc);
    client.getTable("foo",tableName);
  }
 catch (  Exception exp) {
    isExceptionCaught=true;
    assertTrue(exp instanceof HCatException);
    String newName="goodTable";
    client.dropTable(null,newName,true);
    HCatCreateTableDesc tableDesc2=HCatCreateTableDesc.create(null,newName,cols).fileFormat("rcfile").build();
    client.createTable(tableDesc2);
    HCatTable newTable=client.getTable(null,newName);
    assertTrue(newTable != null);
    assertTrue(newTable.getTableName().equalsIgnoreCase(newName));
  }
 finally {
    client.close();
    assertTrue("The expected exception was never thrown.",isExceptionCaught);
  }
}
