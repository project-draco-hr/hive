{
  final DruidQueryRecordReader<?,?> reader;
  final String druidQueryType=job.get(Constants.DRUID_QUERY_TYPE);
  if (druidQueryType == null) {
    reader=new DruidSelectQueryRecordReader();
    reader.initialize((HiveDruidSplit)split,job);
    return reader;
  }
switch (druidQueryType) {
case Query.TIMESERIES:
    reader=new DruidTimeseriesQueryRecordReader();
  break;
case Query.TOPN:
reader=new DruidTopNQueryRecordReader();
break;
case Query.GROUP_BY:
reader=new DruidGroupByQueryRecordReader();
break;
case Query.SELECT:
reader=new DruidSelectQueryRecordReader();
break;
default :
throw new IOException("Druid query type not recognized");
}
reader.initialize((HiveDruidSplit)split,job);
return reader;
}
