{
  final String druidQueryType=context.getConfiguration().get(Constants.DRUID_QUERY_TYPE);
  if (druidQueryType == null) {
    return new DruidSelectQueryRecordReader();
  }
  final DruidQueryRecordReader<?,?> reader;
switch (druidQueryType) {
case Query.TIMESERIES:
    reader=new DruidTimeseriesQueryRecordReader();
  break;
case Query.TOPN:
reader=new DruidTopNQueryRecordReader();
break;
case Query.GROUP_BY:
reader=new DruidGroupByQueryRecordReader();
break;
case Query.SELECT:
reader=new DruidSelectQueryRecordReader();
break;
default :
throw new IOException("Druid query type not recognized");
}
return reader;
}
