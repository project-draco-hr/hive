{
  long length;
  if (_presentStream != null) {
    List<DiskRange> presentDiskRanges=Lists.newArrayList();
    length=StreamUtils.createDiskRanges(presentStreamBuffer,presentDiskRanges);
    _presentStream.setBuffers(presentDiskRanges,length);
  }
  if (_dataStream != null) {
    List<DiskRange> dataDiskRanges=Lists.newArrayList();
    length=StreamUtils.createDiskRanges(dataStreamBuffer,dataDiskRanges);
    _dataStream.setBuffers(dataDiskRanges,length);
  }
  if (!_isDictionaryEncoding) {
    if (_lengthStream != null) {
      List<DiskRange> lengthDiskRanges=Lists.newArrayList();
      length=StreamUtils.createDiskRanges(lengthStreamBuffer,lengthDiskRanges);
      _lengthStream.setBuffers(lengthDiskRanges,length);
    }
  }
  if (!sameStripe && _isDictionaryEncoding) {
    if (_lengthStream != null) {
      List<DiskRange> lengthDiskRanges=Lists.newArrayList();
      length=StreamUtils.createDiskRanges(lengthStreamBuffer,lengthDiskRanges);
      _lengthStream.setBuffers(lengthDiskRanges,length);
    }
    if (_dictionaryStream != null) {
      List<DiskRange> dictionaryDiskRanges=Lists.newArrayList();
      length=StreamUtils.createDiskRanges(dictionaryStreamBuffer,dictionaryDiskRanges);
      _dictionaryStream.setBuffers(dictionaryDiskRanges,length);
    }
  }
}
