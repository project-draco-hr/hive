{
  getBaseOutputCommitter().cleanupJob(HCatMapRedUtil.createJobContext(context));
  try {
    HiveConf hiveConf=HCatUtil.getHiveConf(context.getConfiguration());
    HiveMetaStoreClient client=HCatUtil.createHiveClient(hiveConf);
    String tokenStrForm=client.getTokenStrForm();
    if (tokenStrForm != null && context.getConfiguration().get(HCatConstants.HCAT_KEY_TOKEN_SIGNATURE) != null) {
      client.cancelDelegationToken(tokenStrForm);
    }
  }
 catch (  Exception e) {
    LOG.warn("Failed to cancel delegation token",e);
  }
}
