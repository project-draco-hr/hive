{
  DynamicSerDeStructBase type=bt;
  DynamicSerDeHiveField parentFieldCast=(DynamicSerDeHiveField)parentField;
  if (parentFieldCast != null) {
    DynamicSerDeTypeBase t=parentFieldCast.getMetaType();
    if (t instanceof DynamicSerDeStructBase) {
      type=(DynamicSerDeStructBase)t;
    }
 else {
      throw new SerDeException("trying to getFields on a non struct type: " + t);
    }
  }
  List<SerDeField> fields=new ArrayList<SerDeField>();
  for (  DynamicSerDeField elem : type.getFieldList().getChildren()) {
    fields.add(this.getFieldFromExpression(parentField,elem.name));
  }
  return fields;
}
