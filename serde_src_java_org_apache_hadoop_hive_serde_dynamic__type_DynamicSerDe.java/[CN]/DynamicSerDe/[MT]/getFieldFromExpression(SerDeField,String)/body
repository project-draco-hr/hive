{
  DynamicSerDeStructBase type=bt;
  DynamicSerDeHiveField parentFieldCast=(DynamicSerDeHiveField)parentField;
  if (parentFieldCast != null) {
    if (parentFieldCast.isList()) {
      DynamicSerDeTypeBase elemType=parentFieldCast.getListElementMetaType();
      if (elemType instanceof DynamicSerDeStructBase) {
        type=(DynamicSerDeStructBase)elemType;
      }
 else {
        throw new SerDeException("Trying to get fields from a non struct/table type: " + elemType);
      }
    }
 else {
      DynamicSerDeTypeBase metaType=parentFieldCast.getMetaType();
      if (metaType instanceof DynamicSerDeStructBase) {
        type=(DynamicSerDeStructBase)metaType;
      }
 else {
        throw new SerDeException("Trying to get fields from a non struct/table type: " + metaType);
      }
    }
  }
  SerDeField field=new DynamicSerDeHiveField(type,fieldExpression);
  return field;
}
