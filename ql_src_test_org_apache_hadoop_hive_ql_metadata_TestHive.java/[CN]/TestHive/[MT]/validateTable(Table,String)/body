{
  Warehouse wh=new Warehouse(hiveConf);
  Table ft=null;
  try {
    tbl.getTTable().setPrivilegesIsSet(false);
    ft=hm.getTable(MetaStoreUtils.DEFAULT_DATABASE_NAME,tableName);
    assertNotNull("Unable to fetch table",ft);
    ft.checkValidity(hiveConf);
    assertEquals("Table names didn't match for table: " + tableName,tbl.getTableName(),ft.getTableName());
    assertEquals("Table owners didn't match for table: " + tableName,tbl.getOwner(),ft.getOwner());
    assertEquals("Table retention didn't match for table: " + tableName,tbl.getRetention(),ft.getRetention());
    assertEquals("Data location is not set correctly",wh.getTablePath(hm.getDatabase(DEFAULT_DATABASE_NAME),tableName).toString(),ft.getDataLocation().toString());
    tbl.setDataLocation(ft.getDataLocation());
    tbl.setCreateTime(ft.getTTable().getCreateTime());
    tbl.getParameters().put(hive_metastoreConstants.DDL_TIME,ft.getParameters().get(hive_metastoreConstants.DDL_TIME));
    assertTrue("Tables  doesn't match: " + tableName,ft.getTTable().equals(tbl.getTTable()));
    assertEquals("SerializationLib is not set correctly",tbl.getSerializationLib(),ft.getSerializationLib());
    assertEquals("Serde is not set correctly",tbl.getDeserializer().getClass().getName(),ft.getDeserializer().getClass().getName());
  }
 catch (  HiveException e) {
    System.err.println(StringUtils.stringifyException(e));
    assertTrue("Unable to fetch table correctly: " + tableName,false);
  }
}
