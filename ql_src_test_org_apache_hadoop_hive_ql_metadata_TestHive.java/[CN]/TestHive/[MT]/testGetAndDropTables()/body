{
  try {
    String dbName="db_for_testgettables";
    String table1Name="table1";
    hm.dropDatabase(dbName,true,true,true);
    Database db=new Database();
    db.setName(dbName);
    hm.createDatabase(db);
    List<String> ts=new ArrayList<String>(2);
    ts.add(table1Name);
    ts.add("table2");
    Table tbl1=createTestTable(dbName,ts.get(0));
    hm.createTable(tbl1);
    Table tbl2=createTestTable(dbName,ts.get(1));
    hm.createTable(tbl2);
    List<String> fts=hm.getTablesForDb(dbName,".*");
    assertEquals(ts,fts);
    assertEquals(2,fts.size());
    fts=hm.getTablesForDb(dbName,".*1");
    assertEquals(1,fts.size());
    assertEquals(ts.get(0),fts.get(0));
    Table table1=hm.getTable(dbName,table1Name);
    assertNotNull(table1);
    assertEquals(table1Name,table1.getTableName());
    FileSystem fs=table1.getPath().getFileSystem(hiveConf);
    assertTrue(fs.exists(table1.getPath()));
    hm.dropTable(dbName,table1Name);
    assertFalse(fs.exists(table1.getPath()));
    for (    String tableName : hm.getAllTables(dbName)) {
      Table table=hm.getTable(dbName,tableName);
      hm.dropTable(dbName,tableName);
      assertFalse(fs.exists(table.getPath()));
    }
    hm.dropDatabase(dbName);
  }
 catch (  Throwable e) {
    System.err.println(StringUtils.stringifyException(e));
    System.err.println("testGetAndDropTables() failed");
    throw e;
  }
}
