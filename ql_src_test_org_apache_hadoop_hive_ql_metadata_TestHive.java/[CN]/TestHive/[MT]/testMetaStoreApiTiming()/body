{
  Logger logger=Logger.getLogger("hive.ql.metadata.Hive");
  Level origLevel=logger.getLevel();
  logger.setLevel(Level.DEBUG);
  StringWriter writer=new StringWriter();
  WriterAppender appender=new WriterAppender(new PatternLayout(),writer);
  try {
    logger.addAppender(appender);
    hm.clearMetaCallTiming();
    hm.getAllDatabases();
    hm.dumpAndClearMetaCallTiming("test");
    String logStr=writer.toString();
    String expectedString="getAllDatabases_()=";
    Assert.assertTrue(logStr + " should contain <" + expectedString,logStr.contains(expectedString));
    writer.getBuffer().setLength(0);
    hm.dumpAndClearMetaCallTiming("test");
    logStr=writer.toString();
    Assert.assertFalse(logStr + " should not contain <" + expectedString,logStr.contains(expectedString));
  }
  finally {
    logger.setLevel(origLevel);
    logger.removeAppender(appender);
  }
}
