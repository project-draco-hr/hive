{
  Context spyContext=spy(context);
  Path mrTmpPath=new Path("hdfs://hostname/tmp/scratch");
  doReturn(mrTmpPath).when(spyContext).getMRTmpPath();
  assertEquals(mrTmpPath,spyContext.getTempDirForPath(new Path("s3a://bucket/dir")));
  assertEquals(mrTmpPath,spyContext.getTempDirForPath(new Path("file:/user")));
  assertEquals(mrTmpPath,spyContext.getTempDirForPath(new Path("file:///user")));
  Path tmpPathRelTo=new Path("hdfs://hostname/user");
  doReturn(tmpPathRelTo).when(spyContext).getExtTmpPathRelTo(any(Path.class));
  assertEquals(tmpPathRelTo,spyContext.getTempDirForPath(new Path("/user")));
}
