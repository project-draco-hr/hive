{
  try {
    if (firstRow) {
      setKeyMetaData();
      firstRow=false;
    }
    alias=order[tag];
    AbstractMapJoinKey keyMap=JoinUtil.computeMapJoinKeys(row,joinKeys.get(alias),joinKeysObjectInspectors.get(alias));
    Object[] value=JoinUtil.computeMapJoinValues(row,joinValues.get(alias),joinValuesObjectInspectors.get(alias),joinFilters.get(alias),joinFilterObjectInspectors.get(alias),filterMap == null ? null : filterMap[alias]);
    HashMapWrapper<AbstractMapJoinKey,MapJoinObjectValue> hashTable=mapJoinTables.get((byte)tag);
    MapJoinObjectValue o=hashTable.get(keyMap);
    MapJoinRowContainer<Object[]> res=null;
    boolean needNewKey=true;
    if (o == null) {
      res=new MapJoinRowContainer<Object[]>();
      res.add(value);
      if (metadataValueTag[tag] == -1) {
        metadataValueTag[tag]=order[tag];
        setValueMetaData(tag);
      }
      if (needNewKey) {
        MapJoinObjectValue valueObj=new MapJoinObjectValue(metadataValueTag[tag],res);
        rowNumber++;
        if (rowNumber > hashTableScale && rowNumber % hashTableScale == 0) {
          isAbort=hashTable.isAbort(rowNumber,console);
          if (isAbort) {
            throw new HiveException("RunOutOfMeomoryUsage");
          }
        }
        hashTable.put(keyMap,valueObj);
      }
    }
 else {
      res=o.getObj();
      res.add(value);
    }
  }
 catch (  SerDeException e) {
    throw new HiveException(e);
  }
}
