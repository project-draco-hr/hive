{
  super.setUp();
  if (isServerStarted) {
    assertNotNull("Unable to connect to the MetaStore server",client);
    hiveConf.setVar(HiveConf.ConfVars.METASTOREURIS,"thrift://localhost:" + port);
    return;
  }
  port=MetaStoreUtils.findFreePort();
  System.out.println("Starting MetaStore Server on port " + port);
  MetaStoreUtils.startMetaStore(port,ShimLoader.getHadoopThriftAuthBridge(),hiveConf);
  isServerStarted=true;
  createClient(false);
}
