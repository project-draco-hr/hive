{
  String userName=SessionState.get().getUserName();
  if (userName == null) {
    userName=SessionState.getUserFromAuthenticator();
  }
  if (userName == null) {
    throw new HiveAuthzPluginException("Cannot resolve current user name");
  }
  try {
    Hive hive=Hive.getWithFastCheck(this.conf);
    List<String> roleNames=new ArrayList<String>();
    for (    Role role : hive.listRoles(userName,PrincipalType.USER)) {
      roleNames.add(role.getRoleName());
    }
    return roleNames;
  }
 catch (  HiveException e) {
    throw new HiveAuthzPluginException(e);
  }
}
