{
  PrincipalType type=AuthorizationUtils.getThriftPrincipalType(principal.getType());
  try {
    List<HiveRoleGrant> grants=new ArrayList<HiveRoleGrant>();
    Hive hive=Hive.getWithFastCheck(this.conf);
    for (    RolePrincipalGrant grant : hive.getRoleGrantInfoForPrincipal(principal.getName(),type)) {
      grants.add(new HiveRoleGrant(grant));
    }
    return grants;
  }
 catch (  HiveException e) {
    throw new HiveAuthzPluginException(e);
  }
}
